# –¢–µ—Å—Ç Fallback –ø–æ—Å–ª–µ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞ tccd - –†–µ–∑—É–ª—å—Ç–∞—Ç—ã

## –î–∞—Ç–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è
2026-01-11 21:14

## –í—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã–µ —à–∞–≥–∏

### –®–ê–ì 1: –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫ tccd ‚úÖ
```bash
sudo killall tccd
```
**–í—ã–ø–æ–ª–Ω–µ–Ω–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º –≤—Ä—É—á–Ω—É—é**

### –®–ê–ì 2: –°–±—Ä–æ—Å –≤—Å–µ—Ö —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–π ‚úÖ
```bash
sudo tccutil reset Microphone com.nexy.assistant
sudo tccutil reset Accessibility com.nexy.assistant
sudo tccutil reset ScreenCapture com.nexy.assistant
sudo tccutil reset ListenEvent com.nexy.assistant
```

**–§–ê–ö–¢–ò–ß–ï–°–ö–ò–ô –†–ï–ó–£–õ–¨–¢–ê–¢**:
```
Successfully reset Microphone approval status for com.nexy.assistant
Successfully reset Accessibility approval status for com.nexy.assistant
Successfully reset ScreenCapture approval status for com.nexy.assistant
Successfully reset ListenEvent approval status for com.nexy.assistant
```
‚úÖ –í—Å–µ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è —Å–±—Ä–æ—à–µ–Ω—ã –≤ TCC –±–∞–∑–µ

### –®–ê–ì 3: –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–æ–≤ –î–û –∞–∫—Ç–∏–≤–∞—Ü–∏–∏ ‚ö†Ô∏è

**–§–ê–ö–¢–ò–ß–ï–°–ö–ò–ô –†–ï–ó–£–õ–¨–¢–ê–¢**:
```
Microphone: granted
Accessibility: granted
ScreenCapture: granted
InputMonitoring: granted
```

‚ö†Ô∏è **–ü—Ä–æ–±–ª–µ–º–∞**: –í—Å–µ —Å—Ç–∞—Ç—É—Å—ã –≤—Å—ë –µ—â—ë `granted` –ø–æ—Å–ª–µ —Å–±—Ä–æ—Å–∞

**–õ–æ–≥–∏ –ø—Ä–æ–≤–µ—Ä–∫–∏**:
```
üéôÔ∏è Microphone: AVFoundation auth_status raw = 3
üéôÔ∏è Microphone: GRANTED (AVFoundation)
‚ôø Accessibility: GRANTED (AXIsProcessTrusted)
üì∫ Screen Capture: GRANTED
‚å®Ô∏è Input Monitoring: IOHIDCheckAccess(ListenEvent) = 0
‚å®Ô∏è Input Monitoring: GRANTED
```

### –®–ê–ì 4: –ó–∞–ø—É—Å–∫ activate_all_permissions() ‚ö†Ô∏è

**–§–ê–ö–¢–ò–ß–ï–°–ö–ò–ô –†–ï–ó–£–õ–¨–¢–ê–¢**:
```
‚úÖ microphone: True
‚úÖ accessibility: True
‚úÖ input_monitoring: True
‚úÖ screen_capture: True
```

**–õ–æ–≥–∏ –∞–∫—Ç–∏–≤–∞—Ü–∏–∏**:
```
‚úÖ [ACTIVATOR] Microphone: –†–∞–∑—Ä–µ—à–µ–Ω–∏–µ —É–∂–µ –µ—Å—Ç—å
‚úÖ [ACTIVATOR] Accessibility: –†–∞–∑—Ä–µ—à–µ–Ω–∏–µ —É–∂–µ –µ—Å—Ç—å
‚úÖ [ACTIVATOR] Input Monitoring: –†–∞–∑—Ä–µ—à–µ–Ω–∏–µ —É–∂–µ –µ—Å—Ç—å
‚úÖ [ACTIVATOR] Screen Capture: –†–∞–∑—Ä–µ—à–µ–Ω–∏–µ —É–∂–µ –µ—Å—Ç—å
```

‚ö†Ô∏è **Fallback –ù–ï —Å—Ä–∞–±–æ—Ç–∞–ª**: –í—Å–µ –∞–∫—Ç–∏–≤–∞—Ü–∏–∏ –ø—Ä–æ–ø—É—â–µ–Ω—ã, –ø–æ—Ç–æ–º—É —á—Ç–æ —Å—Ç–∞—Ç—É—Å—ã —Å—Ä–∞–∑—É `granted`

**–°–æ–æ–±—â–µ–Ω–∏–π –æ fallback –ù–ï–¢**:
- ‚ùå –ù–µ—Ç `üîß [ACTIVATOR] {label}: –æ—Ç–∫—Ä—ã–≤–∞–µ–º System Settings...`
- ‚ùå System Settings –Ω–µ –æ—Ç–∫—Ä—ã–ª—Å—è

### –®–ê–ì 5: –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–æ–≤ –ü–û–°–õ–ï –∞–∫—Ç–∏–≤–∞—Ü–∏–∏

**–§–ê–ö–¢–ò–ß–ï–°–ö–ò–ô –†–ï–ó–£–õ–¨–¢–ê–¢**:
```
Microphone: granted
Accessibility: granted
ScreenCapture: granted
InputMonitoring: granted
```

–°—Ç–∞—Ç—É—Å—ã –Ω–µ –∏–∑–º–µ–Ω–∏–ª–∏—Å—å (–≤—Å—ë –µ—â—ë `granted`)

## –ê–Ω–∞–ª–∏–∑ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤

### ‚ùå Fallback –Ω–µ —Å—Ä–∞–±–æ—Ç–∞–ª

**–ü—Ä–∏—á–∏–Ω–∞**: –í—Å–µ —Å—Ç–∞—Ç—É—Å—ã —Å—Ä–∞–∑—É `granted` –ø–æ—Å–ª–µ `tccutil reset`, –ø–æ—ç—Ç–æ–º—É:
1. –ê–∫—Ç–∏–≤–∞—Ü–∏—è –ø—Ä–æ–ø—É—Å–∫–∞–µ—Ç—Å—è –Ω–∞ —ç—Ç–∞–ø–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ (—Å—Ç—Ä–æ–∫–∞ 36-39 –≤ activator.py)
2. Helper –Ω–µ –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è
3. Fallback –Ω–µ —Å—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç

### ‚ö†Ô∏è –ü–æ—á–µ–º—É —Å—Ç–∞—Ç—É—Å—ã –æ—Å—Ç–∞—é—Ç—Å—è `granted`?

**–í–æ–∑–º–æ–∂–Ω—ã–µ –ø—Ä–∏—á–∏–Ω—ã**:

1. **–ö–µ—à –Ω–∞ —É—Ä–æ–≤–Ω–µ –ø—Ä–æ—Ü–µ—Å—Å–∞ Python**:
   - `AXIsProcessTrusted()` –º–æ–∂–µ—Ç –∫–µ—à–∏—Ä–æ–≤–∞—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç
   - `AVFoundation.AVCaptureDevice.authorizationStatusForMediaType_()` –º–æ–∂–µ—Ç –∫–µ—à–∏—Ä–æ–≤–∞—Ç—å
   - `IOHIDCheckAccess()` –º–æ–∂–µ—Ç –∫–µ—à–∏—Ä–æ–≤–∞—Ç—å

2. **–†–∞–∑—Ä–µ—à–µ–Ω–∏—è –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª–µ–Ω—ã —á–µ—Ä–µ–∑ –¥—Ä—É–≥–æ–π –º–µ—Ö–∞–Ω–∏–∑–º**:
   - –ù–µ —á–µ—Ä–µ–∑ TCC –±–∞–∑—É
   - –ß–µ—Ä–µ–∑ —Å–∏—Å—Ç–µ–º–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –Ω–∞–ø—Ä—è–º—É—é
   - –ß–µ—Ä–µ–∑ –¥—Ä—É–≥–∏–µ –º–µ—Ö–∞–Ω–∏–∑–º—ã macOS

3. **tccutil reset –Ω–µ –ø–æ–ª–Ω–æ—Å—Ç—å—é —Å–±—Ä–∞—Å—ã–≤–∞–µ—Ç**:
   - –ú–æ–∂–µ—Ç –æ—Å—Ç–∞–≤–∞—Ç—å—Å—è –∫–µ—à –Ω–∞ —É—Ä–æ–≤–Ω–µ —Å–∏—Å—Ç–µ–º—ã
   - –ú–æ–∂–µ—Ç –±—ã—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–π

### üìã –ß—Ç–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ

1. **–ü—Ä–æ–≤–µ—Ä–∏—Ç—å TCC –±–∞–∑—É –Ω–∞–ø—Ä—è–º—É—é**:
   ```bash
   sqlite3 /Library/Application\ Support/com.apple.TCC/TCC.db "SELECT * FROM access WHERE client='com.nexy.assistant';"
   ```

2. **–ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–π —Ç–µ—Å—Ç** (AppleScript):
   ```bash
   osascript -e 'tell application "System Events" to get name of first application process whose frontmost is true'
   ```

3. **–ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å –ø—Ä–æ—Ü–µ—Å—Å Python** –ø–æ—Å–ª–µ `tccutil reset`:
   - –ö–µ—à –º–æ–∂–µ—Ç –±—ã—Ç—å –Ω–∞ —É—Ä–æ–≤–Ω–µ –ø—Ä–æ—Ü–µ—Å—Å–∞
   - –ù—É–∂–µ–Ω –Ω–æ–≤—ã–π –ø—Ä–æ—Ü–µ—Å—Å –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —Å—Ç–∞—Ç—É—Å–æ–≤

## –í—ã–≤–æ–¥—ã

### ‚úÖ –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–æ
1. `tccutil reset` –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è —É—Å–ø–µ—à–Ω–æ
2. `activate_all_permissions()` —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
3. –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–∞–±–æ—Ç–∞–µ—Ç (–≤–∏–¥–Ω–æ –≤—Å–µ —Å–æ–æ–±—â–µ–Ω–∏—è)
4. –ö–æ–¥ fallback –ø—Ä–∏—Å—É—Ç—Å—Ç–≤—É–µ—Ç –≤ `activator.py`

### ‚ùå –ü—Ä–æ–±–ª–µ–º–∞
1. **Fallback –Ω–µ —Å—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç**, –ø–æ—Ç–æ–º—É —á—Ç–æ —Å—Ç–∞—Ç—É—Å—ã –æ—Å—Ç–∞—é—Ç—Å—è `granted`
2. **–°—Ç–∞—Ç—É—Å—ã –Ω–µ —Å–±—Ä–∞—Å—ã–≤–∞—é—Ç—Å—è** –¥–∞–∂–µ –ø–æ—Å–ª–µ `tccutil reset` –∏ `killall tccd`
3. **–ù–µ–≤–æ–∑–º–æ–∂–Ω–æ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å fallback** –≤ —Ç–µ–∫—É—â–µ–º –æ–∫—Ä—É–∂–µ–Ω–∏–∏

### üîç –î–ª—è –ø–æ–ª–Ω–æ–≥–æ —Ç–µ—Å—Ç–∞ fallback –Ω—É–∂–Ω–æ

1. **–ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å –ø—Ä–æ—Ü–µ—Å—Å Python** –ø–æ—Å–ª–µ `tccutil reset`:
   ```bash
   # –í –Ω–æ–≤–æ–º –ø—Ä–æ—Ü–µ—Å—Å–µ Python
   python3 -c "from modules.permissions.first_run.status_checker import check_accessibility_status; print(check_accessibility_status())"
   ```

2. **–ò–ª–∏ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –Ω–∞ —á–∏—Å—Ç–æ–π —Å–∏—Å—Ç–µ–º–µ/–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ**:
   - –ì–¥–µ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è —Ç–æ—á–Ω–æ –Ω–µ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª–µ–Ω—ã
   - –ì–¥–µ –Ω–µ—Ç –∫–µ—à–∞ –Ω–∞ —É—Ä–æ–≤–Ω–µ –ø—Ä–æ—Ü–µ—Å—Å–∞

3. **–ò–ª–∏ –æ—Ç–∫–ª—é—á–∏—Ç—å —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è –≤—Ä—É—á–Ω—É—é –≤ System Settings**:
   - System Settings ‚Üí Privacy & Security ‚Üí Accessibility
   - –£–±—Ä–∞—Ç—å –≥–∞–ª–æ—á–∫—É –¥–ª—è `com.nexy.assistant`
   - –ó–∞—Ç–µ–º –∑–∞–ø—É—Å—Ç–∏—Ç—å `activate_all_permissions()`

## –ö—Ä–∏—Ç–µ—Ä–∏–∏ —É—Å–ø–µ—Ö–∞ (DoD)

### ‚ùå –ù–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–æ
- [ ] Fallback —Å—Ä–∞–±–æ—Ç–∞–ª (–Ω–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏–π `üîß ... –æ—Ç–∫—Ä—ã–≤–∞–µ–º System Settings`)
- [ ] –°—Ç–∞—Ç—É—Å—ã –∏–∑–º–µ–Ω–∏–ª–∏—Å—å —Å `not_determined`/`denied` –Ω–∞ `granted`
- [ ] System Settings –æ—Ç–∫—Ä—ã–ª—Å—è –¥–ª—è —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–π

### ‚úÖ –í—ã–ø–æ–ª–Ω–µ–Ω–æ
- [x] `tccutil reset` –≤—ã–ø–æ–ª–Ω–µ–Ω –¥–ª—è –≤—Å–µ—Ö —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–π
- [x] `activate_all_permissions()` –∑–∞–ø—É—â–µ–Ω
- [x] –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
- [x] –ö–æ–¥ fallback –ø—Ä–∏—Å—É—Ç—Å—Ç–≤—É–µ—Ç –≤ `activator.py`

## –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏

### –î–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è fallback –≤ production

1. **–ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–π —Ç–µ—Å—Ç**:
   - –û—Ç–∫–ª—é—á–∏—Ç—å —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è –≤ System Settings –≤—Ä—É—á–Ω—É—é
   - –ó–∞–ø—É—Å—Ç–∏—Ç—å `activate_all_permissions()`
   - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ fallback —Å—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç

2. **–ò–ª–∏ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –Ω–∞ —á–∏—Å—Ç–æ–π —Å–∏—Å—Ç–µ–º–µ**:
   - –ì–¥–µ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è —Ç–æ—á–Ω–æ –Ω–µ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª–µ–Ω—ã
   - –ì–¥–µ –Ω–µ—Ç –∫–µ—à–∞ –Ω–∞ —É—Ä–æ–≤–Ω–µ –ø—Ä–æ—Ü–µ—Å—Å–∞

3. **–ò–ª–∏ –¥–æ–±–∞–≤–∏—Ç—å –ø—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω—ã–π —Å–±—Ä–æ—Å –∫–µ—à–∞**:
   - –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å –ø—Ä–æ—Ü–µ—Å—Å Python –ø–æ—Å–ª–µ `tccutil reset`
   - –ò–ª–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –¥—Ä—É–≥–æ–π –º–µ—Ç–æ–¥ –ø—Ä–æ–≤–µ—Ä–∫–∏ —Å—Ç–∞—Ç—É—Å–æ–≤

## –§–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã

| –®–∞–≥ | –ö–æ–º–∞–Ω–¥–∞ | –†–µ–∑—É–ª—å—Ç–∞—Ç | Fallback |
|-----|---------|-----------|----------|
| 1 | `killall tccd` | ‚úÖ –í—ã–ø–æ–ª–Ω–µ–Ω–æ | - |
| 2 | `tccutil reset` | ‚úÖ –í—Å–µ —Å–±—Ä–æ—à–µ–Ω—ã | - |
| 3 | –°—Ç–∞—Ç—É—Å—ã –î–û | ‚ö†Ô∏è –í—Å–µ `granted` | - |
| 4 | `activate_all_permissions()` | ‚ö†Ô∏è –í—Å–µ –ø—Ä–æ–ø—É—â–µ–Ω—ã | ‚ùå –ù–µ —Å—Ä–∞–±–æ—Ç–∞–ª |
| 5 | –°—Ç–∞—Ç—É—Å—ã –ü–û–°–õ–ï | ‚ö†Ô∏è –í—Å–µ `granted` | - |

**–í—ã–≤–æ–¥**: Fallback –Ω–µ —Å—Ä–∞–±–æ—Ç–∞–ª, –ø–æ—Ç–æ–º—É —á—Ç–æ —Å—Ç–∞—Ç—É—Å—ã –æ—Å—Ç–∞—é—Ç—Å—è `granted` –¥–∞–∂–µ –ø–æ—Å–ª–µ —Å–±—Ä–æ—Å–∞. –î–ª—è –ø–æ–ª–Ω–æ–≥–æ —Ç–µ—Å—Ç–∞ fallback –Ω—É–∂–Ω–æ –ø–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å –ø—Ä–æ—Ü–µ—Å—Å Python –∏–ª–∏ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –Ω–∞ —á–∏—Å—Ç–æ–π —Å–∏—Å—Ç–µ–º–µ.
