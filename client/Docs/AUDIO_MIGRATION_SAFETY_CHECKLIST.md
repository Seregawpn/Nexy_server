# –ß–µ–∫-–ª–∏—Å—Ç –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ –∞—É–¥–∏–æ-—Å–∏—Å—Ç–µ–º—ã

**–¶–µ–ª—å**: –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–æ –±–µ–∑–æ–ø–∞—Å–Ω–∞—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–º–∏ —Ä–∏—Å–∫–∞–º–∏ –∏ –ø—Ä–æ–±–ª–µ–º–∞–º–∏

**–°—Ç–∞—Ç—É—Å**: –û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–π —á–µ–∫-–ª–∏—Å—Ç –ø–µ—Ä–µ–¥ –Ω–∞—á–∞–ª–æ–º —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

---

## üõ°Ô∏è 1. Impact Map –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —ç—Ç–∞–ø–∞

### –≠—Ç–∞–ø 1: –ú–æ–¥—É–ª—å audio_route_manager

**Impact Map**:

| –ö–æ–º–ø–æ–Ω–µ–Ω—Ç | –ò–∑–º–µ–Ω–µ–Ω–∏—è | –†–∏—Å–∫ | –ú–∏—Ç–∏–≥–∞—Ü–∏—è |
|-----------|-----------|------|-----------|
| `modules/audio_route_manager/` | –°–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤–æ–≥–æ –º–æ–¥—É–ª—è | –ù–∏–∑–∫–∏–π | –ò–∑–æ–ª–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –º–æ–¥—É–ª—å, –Ω–µ –≤–ª–∏—è–µ—Ç –Ω–∞ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π –∫–æ–¥ |
| `tests/test_audio_route_manager.py` | –ù–æ–≤—ã–µ —Ç–µ—Å—Ç—ã | –ù–∏–∑–∫–∏–π | –ò–∑–æ–ª–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã |
| `config/unified_config.yaml` | –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ | –ù–∏–∑–∫–∏–π | Feature flag OFF –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é |

**–ö—Ä–∏—Ç–µ—Ä–∏–∏ –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏**:
- [ ] –ú–æ–¥—É–ª—å —Å–æ–∑–¥–∞–Ω –∏ –∏–∑–æ–ª–∏—Ä–æ–≤–∞–Ω
- [ ] –¢–µ—Å—Ç—ã –ø—Ä–æ—Ö–æ–¥—è—Ç (‚â•80% –ø–æ–∫—Ä—ã—Ç–∏–µ)
- [ ] –õ–∏–Ω—Ç–µ—Ä –ø—Ä–æ—Ö–æ–¥–∏—Ç
- [ ] –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –¥–æ–±–∞–≤–ª–µ–Ω–∞ (feature flag OFF)

---

### –≠—Ç–∞–ø 2: Route Manager Core

**Impact Map**:

| –ö–æ–º–ø–æ–Ω–µ–Ω—Ç | –ò–∑–º–µ–Ω–µ–Ω–∏—è | –†–∏—Å–∫ | –ú–∏—Ç–∏–≥–∞—Ü–∏—è |
|-----------|-----------|------|-----------|
| `modules/audio_route_manager/core/route_manager.py` | –û—Å–Ω–æ–≤–Ω–∞—è –ª–æ–≥–∏–∫–∞ | –°—Ä–µ–¥–Ω–∏–π | –ò–∑–æ–ª–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –ª–æ–≥–∏–∫–∞, —Ç–µ—Å—Ç—ã |
| `modules/audio_route_manager/core/adapters/` | Adapters | –°—Ä–µ–¥–Ω–∏–π | –ò–∑–æ–ª–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –∞–¥–∞–ø—Ç–µ—Ä—ã, fallback –º–µ—Ö–∞–Ω–∏–∑–º—ã |
| `integration/core/selectors.py` | –ù–æ–≤—ã–µ selectors | –ù–∏–∑–∫–∏–π | –¢–æ–ª—å–∫–æ –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ —Ñ—É–Ω–∫—Ü–∏–π |
| `integration/core/gateways/` | –ù–æ–≤—ã–µ gateway —Ñ—É–Ω–∫—Ü–∏–∏ | –°—Ä–µ–¥–Ω–∏–π | –¢–æ–ª—å–∫–æ –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ —Ñ—É–Ω–∫—Ü–∏–π, —Ç–µ—Å—Ç—ã |

**–ö—Ä–∏—Ç–µ—Ä–∏–∏ –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏**:
- [ ] RouteManager –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω
- [ ] Adapters –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω—ã
- [ ] Selectors –¥–æ–±–∞–≤–ª–µ–Ω—ã
- [ ] Gateway —Ñ—É–Ω–∫—Ü–∏–∏ –¥–æ–±–∞–≤–ª–µ–Ω—ã –∏ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω—ã

---

### –≠—Ç–∞–ø 3: –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å EventBus

**Impact Map**:

| –ö–æ–º–ø–æ–Ω–µ–Ω—Ç | –ò–∑–º–µ–Ω–µ–Ω–∏—è | –†–∏—Å–∫ | –ú–∏—Ç–∏–≥–∞—Ü–∏—è |
|-----------|-----------|------|-----------|
| `integration/integrations/audio_route_manager_integration.py` | –ù–æ–≤–∞—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è | –í—ã—Å–æ–∫–∏–π | Feature flag, kill-switch, fallback |
| `integration/integrations/voice_recognition_integration.py` | –ê–¥–∞–ø—Ç–∞—Ü–∏—è | –í—ã—Å–æ–∫–∏–π | Feature flag, fallback –Ω–∞ —Å—Ç–∞—Ä—É—é –ª–æ–≥–∏–∫—É |
| `integration/integrations/speech_playback_integration.py` | –ê–¥–∞–ø—Ç–∞—Ü–∏—è | –í—ã—Å–æ–∫–∏–π | Feature flag, fallback –Ω–∞ —Å—Ç–∞—Ä—É—é –ª–æ–≥–∏–∫—É |
| `integration/core/simple_module_coordinator.py` | –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ | –°—Ä–µ–¥–Ω–∏–π | –ü—Ä–∞–≤–∏–ª—å–Ω—ã–π –ø–æ—Ä—è–¥–æ–∫ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ |

**–ö—Ä–∏—Ç–µ—Ä–∏–∏ –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏**:
- [ ] –ö–æ–Ω—Ç—Ä–∞–∫—Ç EventBus —Å–æ–∑–¥–∞–Ω –∏ –¥–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω
- [ ] Feature flag —Ä–∞–±–æ—Ç–∞–µ—Ç
- [ ] Kill-switch —Ä–∞–±–æ—Ç–∞–µ—Ç
- [ ] Fallback –º–µ—Ö–∞–Ω–∏–∑–º –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω
- [ ] –í—Å–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ —Å–æ–±—ã—Ç–∏—è —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è

---

## üîç 2. –†–∏—Å–∫-–∞–Ω–∞–ª–∏–∑ —Å –º–∏—Ç–∏–≥–∞—Ü–∏–µ–π

### –†–∏—Å–∫ 1: –ü–æ—Ä—è–¥–æ–∫ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏

**–û–ø–∏—Å–∞–Ω–∏–µ**: AudioRouteManager –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω –¥–æ VoiceRecognition –∏ SpeechPlayback

**–í–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å**: –°—Ä–µ–¥–Ω—è—è  
**–í–ª–∏—è–Ω–∏–µ**: –í—ã—Å–æ–∫–æ–µ (–º–æ–∂–µ—Ç –ø—Ä–∏–≤–µ—Å—Ç–∏ –∫ –æ—à–∏–±–∫–∞–º –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏)

**–ú–∏—Ç–∏–≥–∞—Ü–∏—è**:
- [ ] –û–ø—Ä–µ–¥–µ–ª–∏—Ç—å –ø—Ä–∞–≤–∏–ª—å–Ω—É—é –ø–æ–∑–∏—Ü–∏—é –≤ SimpleModuleCoordinator (–ø–æ–∑–∏—Ü–∏—è 5)
- [ ] –î–æ–±–∞–≤–∏—Ç—å –ø—Ä–æ–≤–µ—Ä–∫—É –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π –≤ —Ç–µ—Å—Ç–∞—Ö
- [ ] –î–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å –ø–æ—Ä—è–¥–æ–∫ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏

**–ü–ª–∞–Ω –æ—Ç–∫–∞—Ç–∞**: –ï—Å–ª–∏ –ø–æ—Ä—è–¥–æ–∫ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π ‚Üí –ø–µ—Ä–µ–º–µ—Å—Ç–∏—Ç—å AudioRouteManager –≤ –ø—Ä–∞–≤–∏–ª—å–Ω—É—é –ø–æ–∑–∏—Ü–∏—é

---

### –†–∏—Å–∫ 2: Breaking changes –≤ —Å–æ–±—ã—Ç–∏—è—Ö EventBus

**–û–ø–∏—Å–∞–Ω–∏–µ**: –ù–æ–≤—ã–µ —Å–æ–±—ã—Ç–∏—è –º–æ–≥—É—Ç –∫–æ–Ω—Ñ–ª–∏–∫—Ç–æ–≤–∞—Ç—å —Å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–º–∏ –∏–ª–∏ –ª–æ–º–∞—Ç—å –ø–æ–¥–ø–∏—Å—á–∏–∫–æ–≤

**–í–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å**: –ù–∏–∑–∫–∞—è  
**–í–ª–∏—è–Ω–∏–µ**: –í—ã—Å–æ–∫–æ–µ (–º–æ–∂–µ—Ç —Å–ª–æ–º–∞—Ç—å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏)

**–ú–∏—Ç–∏–≥–∞—Ü–∏—è**:
- [x] –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏ —Å–æ–±—ã—Ç–∏–π (–≤—ã–ø–æ–ª–Ω–µ–Ω–æ)
- [ ] –°–æ–∑–¥–∞—Ç—å –∫–æ–Ω—Ç—Ä–∞–∫—Ç EventBus –¥–ª—è –Ω–æ–≤—ã—Ö —Å–æ–±—ã—Ç–∏–π
- [ ] –í–∞–ª–∏–¥–∞—Ü–∏—è payload –Ω–∞ –≥—Ä–∞–Ω–∏—Ü–µ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏
- [ ] –¢–µ—Å—Ç—ã –∫–æ–Ω—Ç—Ä–∞–∫—Ç–∞ (unit + integration)

**–ü–ª–∞–Ω –æ—Ç–∫–∞—Ç–∞**: –ï—Å–ª–∏ —Å–æ–±—ã—Ç–∏—è –∫–æ–Ω—Ñ–ª–∏–∫—Ç—É—é—Ç ‚Üí –ø–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞—Ç—å —Å–æ–±—ã—Ç–∏—è –∏–ª–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –≤–µ—Ä—Å–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ

---

### –†–∏—Å–∫ 3: –†–µ–≥—Ä–µ—Å—Å–∏–∏ –≤ —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–º —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª–µ

**–û–ø–∏—Å–∞–Ω–∏–µ**: –ò–∑–º–µ–Ω–µ–Ω–∏—è –º–æ–≥—É—Ç —Å–ª–æ–º–∞—Ç—å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª (push-to-talk, playback)

**–í–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å**: –°—Ä–µ–¥–Ω—è—è  
**–í–ª–∏—è–Ω–∏–µ**: –í—ã—Å–æ–∫–æ–µ (–∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª)

**–ú–∏—Ç–∏–≥–∞—Ü–∏—è**:
- [ ] Feature flag OFF –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
- [ ] Fallback –Ω–∞ —Å—Ç–∞—Ä—É—é –ª–æ–≥–∏–∫—É –ø—Ä–∏ feature flag OFF
- [ ] –†–µ–≥—Ä–µ—Å—Å–∏–æ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã –¥–ª—è —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–≥–æ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª–∞
- [ ] –†—É—á–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤

**–ü–ª–∞–Ω –æ—Ç–∫–∞—Ç–∞**: –ï—Å–ª–∏ —Ä–µ–≥—Ä–µ—Å—Å–∏–∏ –æ–±–Ω–∞—Ä—É–∂–µ–Ω—ã ‚Üí –æ—Ç–∫–ª—é—á–∏—Ç—å feature flag (kill-switch)

---

### –†–∏—Å–∫ 4: –¶–∏–∫–ª–∏—á–µ—Å–∫–∏–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏

**–û–ø–∏—Å–∞–Ω–∏–µ**: AudioRouteManager –º–æ–∂–µ—Ç —Å–æ–∑–¥–∞—Ç—å —Ü–∏–∫–ª–∏—á–µ—Å–∫–∏–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ —Å –¥—Ä—É–≥–∏–º–∏ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è–º–∏

**–í–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å**: –ù–∏–∑–∫–∞—è  
**–í–ª–∏—è–Ω–∏–µ**: –í—ã—Å–æ–∫–æ–µ (–º–æ–∂–µ—Ç –ø—Ä–∏–≤–µ—Å—Ç–∏ –∫ –æ—à–∏–±–∫–∞–º –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏)

**–ú–∏—Ç–∏–≥–∞—Ü–∏—è**:
- [x] –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π (–≤—ã–ø–æ–ª–Ω–µ–Ω–æ)
- [ ] –í—Å–µ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è —Ç–æ–ª—å–∫–æ —á–µ—Ä–µ–∑ EventBus (–∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ)
- [ ] –ù–µ—Ç –ø—Ä—è–º—ã—Ö –∏–º–ø–æ—Ä—Ç–æ–≤ –º–µ–∂–¥—É –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è–º–∏

**–ü–ª–∞–Ω –æ—Ç–∫–∞—Ç–∞**: –ï—Å–ª–∏ —Ü–∏–∫–ª–∏—á–µ—Å–∫–∏–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ–±–Ω–∞—Ä—É–∂–µ–Ω—ã ‚Üí —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥ —á–µ—Ä–µ–∑ EventBus

---

### –†–∏—Å–∫ 5: –£—Ç–µ—á–∫–∏ –ø–∞–º—è—Ç–∏ (memory leaks)

**–û–ø–∏—Å–∞–Ω–∏–µ**: –ù–æ–≤—ã–µ –ø–æ—Ç–æ–∫–∏, callbacks, –∞–¥–∞–ø—Ç–µ—Ä—ã –º–æ–≥—É—Ç —Å–æ–∑–¥–∞–≤–∞—Ç—å —É—Ç–µ—á–∫–∏ –ø–∞–º—è—Ç–∏

**–í–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å**: –°—Ä–µ–¥–Ω—è—è  
**–í–ª–∏—è–Ω–∏–µ**: –°—Ä–µ–¥–Ω–µ–µ (–º–æ–∂–µ—Ç –ø—Ä–∏–≤–µ—Å—Ç–∏ –∫ –¥–µ–≥—Ä–∞–¥–∞—Ü–∏–∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏)

**–ú–∏—Ç–∏–≥–∞—Ü–∏—è**:
- [ ] –ü—Ä–∞–≤–∏–ª—å–Ω–æ–µ –∑–∞–∫—Ä—ã—Ç–∏–µ –ø–æ—Ç–æ–∫–æ–≤ (monitoring thread)
- [ ] –ü—Ä–∞–≤–∏–ª—å–Ω–æ–µ –∑–∞–∫—Ä—ã—Ç–∏–µ audio streams
- [ ] –ü—Ä–∞–≤–∏–ª—å–Ω–æ–µ –∑–∞–∫—Ä—ã—Ç–∏–µ AVAudioEngine
- [ ] –¢–µ—Å—Ç—ã –Ω–∞ —É—Ç–µ—á–∫–∏ –ø–∞–º—è—Ç–∏

**–ü–ª–∞–Ω –æ—Ç–∫–∞—Ç–∞**: –ï—Å–ª–∏ —É—Ç–µ—á–∫–∏ –æ–±–Ω–∞—Ä—É–∂–µ–Ω—ã ‚Üí –∏—Å–ø—Ä–∞–≤–∏—Ç—å cleanup –ª–æ–≥–∏–∫—É

---

### –†–∏—Å–∫ 6: Race conditions

**–û–ø–∏—Å–∞–Ω–∏–µ**: –ú–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ –ø–æ—Ç–æ–∫–∏ (monitoring, audio callbacks) –º–æ–≥—É—Ç —Å–æ–∑–¥–∞–≤–∞—Ç—å race conditions

**–í–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å**: –°—Ä–µ–¥–Ω—è—è  
**–í–ª–∏—è–Ω–∏–µ**: –í—ã—Å–æ–∫–æ–µ (–º–æ–∂–µ—Ç –ø—Ä–∏–≤–µ—Å—Ç–∏ –∫ –Ω–µ—Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç–∏)

**–ú–∏—Ç–∏–≥–∞—Ü–∏—è**:
- [ ] Single-flight –º–µ—Ö–∞–Ω–∏–∑–º –≤ reconcile loop
- [ ] Locks –¥–ª—è –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö —Å–µ–∫—Ü–∏–π (engine_lock, audio_lock)
- [ ] Thread-safe –æ–ø–µ—Ä–∞—Ü–∏–∏
- [ ] –¢–µ—Å—Ç—ã –Ω–∞ race conditions

**–ü–ª–∞–Ω –æ—Ç–∫–∞—Ç–∞**: –ï—Å–ª–∏ race conditions –æ–±–Ω–∞—Ä—É–∂–µ–Ω—ã ‚Üí –¥–æ–±–∞–≤–∏—Ç—å –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ locks

---

## üìã 3. –ß–µ–∫-–ª–∏—Å—Ç –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

### –ü–µ—Ä–µ–¥ –Ω–∞—á–∞–ª–æ–º —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

- [ ] **Impact Map —Å–æ–∑–¥–∞–Ω** –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —ç—Ç–∞–ø–∞
- [ ] **–†–∏—Å–∫-–∞–Ω–∞–ª–∏–∑ –≤—ã–ø–æ–ª–Ω–µ–Ω** —Å –º–∏—Ç–∏–≥–∞—Ü–∏–µ–π
- [ ] **–ö–æ–Ω—Ç—Ä–∞–∫—Ç EventBus —Å–æ–∑–¥–∞–Ω** –¥–ª—è –Ω–æ–≤—ã—Ö —Å–æ–±—ã—Ç–∏–π
- [ ] **STATE_CATALOG.md –æ–±–Ω–æ–≤–ª–µ–Ω** —Å –Ω–æ–≤—ã–º–∏ –æ—Å—è–º–∏
- [ ] **interaction_matrix.yaml –æ–±–Ω–æ–≤–ª–µ–Ω** —Å –Ω–æ–≤—ã–º–∏ –ø—Ä–∞–≤–∏–ª–∞–º–∏
- [ ] **selectors.py –æ–±–Ω–æ–≤–ª–µ–Ω** —Å –Ω–æ–≤—ã–º–∏ selectors
- [ ] **gateways.py –æ–±–Ω–æ–≤–ª–µ–Ω** —Å –Ω–æ–≤—ã–º–∏ gateway —Ñ—É–Ω–∫—Ü–∏—è–º–∏
- [ ] **unified_config.yaml –æ–±–Ω–æ–≤–ª–µ–Ω** —Å feature flag (OFF –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é)

### –í–æ –≤—Ä–µ–º—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

- [ ] **Feature flag OFF** –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
- [ ] **Kill-switch —Ä–∞–±–æ—Ç–∞–µ—Ç** (–º–≥–Ω–æ–≤–µ–Ω–Ω—ã–π –æ—Ç–∫–∞—Ç)
- [ ] **Fallback –º–µ—Ö–∞–Ω–∏–∑–º —Ä–∞–±–æ—Ç–∞–µ—Ç** (—Å—Ç–∞—Ä–∞—è –ª–æ–≥–∏–∫–∞ –ø—Ä–∏ feature flag OFF)
- [ ] **–í—Å–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ —Å–æ–±—ã—Ç–∏—è —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è**
- [ ] **–í–∞–ª–∏–¥–∞—Ü–∏—è payload** –Ω–∞ –≥—Ä–∞–Ω–∏—Ü–µ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏
- [ ] **–û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫** —á–µ—Ä–µ–∑ ErrorHandler
- [ ] **–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ** –≤ –∫–∞–Ω–æ–Ω–∏—á–µ—Å–∫–æ–º —Ñ–æ—Ä–º–∞—Ç–µ
- [ ] **–¢–µ—Å—Ç—ã –ø—Ä–æ—Ö–æ–¥—è—Ç** (unit + integration)

### –ü–æ—Å–ª–µ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

- [ ] **–†–µ–≥—Ä–µ—Å—Å–∏–æ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã** –ø—Ä–æ—Ö–æ–¥—è—Ç
- [ ] **–†—É—á–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ** –≤—Å–µ—Ö —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤
- [ ] **–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –º–µ—Ç—Ä–∏–∫** –Ω–∞—Å—Ç—Ä–æ–µ–Ω
- [ ] **–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –æ–±–Ω–æ–≤–ª–µ–Ω–∞**
- [ ] **ADR —Å–æ–∑–¥–∞–Ω** (–µ—Å–ª–∏ –Ω—É–∂–Ω–æ)

---

## üîÑ 4. –ü–ª–∞–Ω –æ—Ç–∫–∞—Ç–∞ (Rollback Plan)

### –£—Ä–æ–≤–µ–Ω—å 1: Kill-switch (–º–≥–Ω–æ–≤–µ–Ω–Ω—ã–π –æ—Ç–∫–∞—Ç)

**–î–µ–π—Å—Ç–≤–∏–µ**: –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å `audio_route_manager.kill_switch: true` –≤ `unified_config.yaml`

**–í—Ä–µ–º—è**: –ú–≥–Ω–æ–≤–µ–Ω–Ω–æ (–±–µ–∑ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è, –µ—Å–ª–∏ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è)

**–≠—Ñ—Ñ–µ–∫—Ç**: –ù–æ–≤–∞—è –ª–æ–≥–∏–∫–∞ –ø–æ–ª–Ω–æ—Å—Ç—å—é –æ—Ç–∫–ª—é—á–∞–µ—Ç—Å—è, –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Å—Ç–∞—Ä–∞—è –ª–æ–≥–∏–∫–∞

**–ü—Ä–æ–≤–µ—Ä–∫–∞**:
- [ ] Feature flag –ø—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è –≤ –∫–æ–¥–µ
- [ ] Kill-switch –∏–º–µ–µ—Ç –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç –Ω–∞–¥ feature flag
- [ ] Fallback –Ω–∞ —Å—Ç–∞—Ä—É—é –ª–æ–≥–∏–∫—É —Ä–∞–±–æ—Ç–∞–µ—Ç

---

### –£—Ä–æ–≤–µ–Ω—å 2: Feature flag OFF (–±—ã—Å—Ç—Ä—ã–π –æ—Ç–∫–∞—Ç)

**–î–µ–π—Å—Ç–≤–∏–µ**: –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å `audio_route_manager.enabled: false` –≤ `unified_config.yaml`

**–í—Ä–µ–º—è**: –ü–æ—Å–ª–µ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

**–≠—Ñ—Ñ–µ–∫—Ç**: –ù–æ–≤–∞—è –ª–æ–≥–∏–∫–∞ –æ—Ç–∫–ª—é—á–∞–µ—Ç—Å—è, –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Å—Ç–∞—Ä–∞—è –ª–æ–≥–∏–∫–∞

**–ü—Ä–æ–≤–µ—Ä–∫–∞**:
- [ ] Feature flag –ø—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è –≤ –∫–æ–¥–µ
- [ ] Fallback –Ω–∞ —Å—Ç–∞—Ä—É—é –ª–æ–≥–∏–∫—É —Ä–∞–±–æ—Ç–∞–µ—Ç
- [ ] –í—Å–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ —Ñ—É–Ω–∫—Ü–∏–∏ —Ä–∞–±–æ—Ç–∞—é—Ç

---

### –£—Ä–æ–≤–µ–Ω—å 3: –£–¥–∞–ª–µ–Ω–∏–µ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ (–ø–æ–ª–Ω—ã–π –æ—Ç–∫–∞—Ç)

**–î–µ–π—Å—Ç–≤–∏–µ**: –£–¥–∞–ª–∏—Ç—å AudioRouteManagerIntegration –∏–∑ SimpleModuleCoordinator

**–í—Ä–µ–º—è**: –¢—Ä–µ–±—É–µ—Ç—Å—è –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫ –∏ –ø–µ—Ä–µ—Å–±–æ—Ä–∫–∞

**–≠—Ñ—Ñ–µ–∫—Ç**: –ù–æ–≤–∞—è –ª–æ–≥–∏–∫–∞ –ø–æ–ª–Ω–æ—Å—Ç—å—é —É–¥–∞–ª–µ–Ω–∞, –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ —Å—Ç–∞—Ä–∞—è –ª–æ–≥–∏–∫–∞

**–ü—Ä–æ–≤–µ—Ä–∫–∞**:
- [ ] –ö–æ–¥ –∫–æ–º–ø–∏–ª–∏—Ä—É–µ—Ç—Å—è –±–µ–∑ –æ—à–∏–±–æ–∫
- [ ] –í—Å–µ —Ç–µ—Å—Ç—ã –ø—Ä–æ—Ö–æ–¥—è—Ç
- [ ] –í—Å–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ —Ñ—É–Ω–∫—Ü–∏–∏ —Ä–∞–±–æ—Ç–∞—é—Ç

---

## üìù 5. –ö–æ–Ω—Ç—Ä–∞–∫—Ç EventBus –¥–ª—è –Ω–æ–≤—ã—Ö —Å–æ–±—ã—Ç–∏–π

### –ù–æ–≤—ã–µ —Å–æ–±—ã—Ç–∏—è AudioRouteManagerIntegration

```python
AUDIO_ROUTE_MANAGER_CONTRACT = {
    "module": "audio_route_manager",
    "version": "1.0",
    "events": {
        "input": {
            "audio.input.request_start": {
                "payload": {
                    "session_id": "string (uuid4, required)",
                    "source": "string (optional, default: voice_recognition)"
                },
                "required": ["session_id"],
                "description": "–ó–∞–ø—Ä–æ—Å –∑–∞–ø—É—Å–∫–∞ audio input —á–µ—Ä–µ–∑ AudioRouteManager"
            },
            "audio.input.active": {
                "payload": {
                    "session_id": "string (uuid4, required)",
                    "device_uid": "string (required)",
                    "device_name": "string (required)",
                    "device_index": "int (optional)",
                    "sample_rate": "int (optional)"
                },
                "required": ["session_id", "device_uid", "device_name"],
                "description": "Audio input –∞–∫—Ç–∏–≤–µ–Ω, –º–æ–∂–Ω–æ –ø–æ–ª—É—á–∞—Ç—å –¥–∞–Ω–Ω—ã–µ"
            },
            "audio.input.inactive": {
                "payload": {
                    "session_id": "string (uuid4, required)"
                },
                "required": ["session_id"],
                "description": "Audio input –Ω–µ–∞–∫—Ç–∏–≤–µ–Ω"
            },
            "audio.input.device_changed": {
                "payload": {
                    "old_device_uid": "string (required)",
                    "new_device_uid": "string (required)",
                    "old_device_name": "string (optional)",
                    "new_device_name": "string (optional)"
                },
                "required": ["old_device_uid", "new_device_uid"],
                "description": "Input —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ –∏–∑–º–µ–Ω–∏–ª–æ—Å—å"
            }
        },
        "output": {
            "audio.output.ready": {
                "payload": {
                    "device_uid": "string (required)",
                    "device_name": "string (required)",
                    "device_index": "int (optional)"
                },
                "required": ["device_uid", "device_name"],
                "description": "Audio output –≥–æ—Ç–æ–≤, –º–æ–∂–Ω–æ –≤–æ—Å–ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç—å"
            },
            "audio.output.device_changed": {
                "payload": {
                    "old_device_uid": "string (required)",
                    "new_device_uid": "string (required)",
                    "old_device_name": "string (optional)",
                    "new_device_name": "string (optional)"
                },
                "required": ["old_device_uid", "new_device_uid"],
                "description": "Output —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ –∏–∑–º–µ–Ω–∏–ª–æ—Å—å"
            }
        },
        "general": {
            "audio.device.changed": {
                "payload": {
                    "type": "string (input|output, required)",
                    "old_device_uid": "string (required)",
                    "new_device_uid": "string (required)",
                    "old_device_name": "string (optional)",
                    "new_device_name": "string (optional)"
                },
                "required": ["type", "old_device_uid", "new_device_uid"],
                "description": "–£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –æ —Å–º–µ–Ω–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ (input –∏–ª–∏ output)"
            },
            "audio.route.snapshot": {
                "payload": {
                    "input_state": "string (idle|starting|active|stopping|error)",
                    "output_state": "string (idle|initializing|ready|playing|error)",
                    "input_device_uid": "string (optional)",
                    "output_device_uid": "string (optional)",
                    "reconcile_pending": "bool (optional)"
                },
                "required": ["input_state", "output_state"],
                "description": "–°–Ω–∏–º–æ–∫ —Å–æ—Å—Ç–æ—è–Ω–∏—è –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏–∏ (–¥–ª—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏)"
            }
        }
    }
}
```

### –í–∞–ª–∏–¥–∞—Ü–∏—è payload

**–ú–µ—Å—Ç–æ –≤–∞–ª–∏–¥–∞—Ü–∏–∏**: –ù–∞ –≥—Ä–∞–Ω–∏—Ü–µ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ (–≤ AudioRouteManagerIntegration)

**–ú–µ—Ç–æ–¥ –≤–∞–ª–∏–¥–∞—Ü–∏–∏**: Pydantic –∏–ª–∏ dataclasses —Å type hints

**–ü—Ä–∏–º–µ—Ä**:
```python
from dataclasses import dataclass
from typing import Optional

@dataclass
class AudioInputActivePayload:
    session_id: str
    device_uid: str
    device_name: str
    device_index: Optional[int] = None
    sample_rate: Optional[int] = None
    
    def validate(self) -> bool:
        """–í–∞–ª–∏–¥–∞—Ü–∏—è payload"""
        if not self.session_id or not self.device_uid or not self.device_name:
            return False
        return True
```

---

## üß™ 6. –¢–µ—Å—Ç-–ø–ª–∞–Ω –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏

### Unit —Ç–µ—Å—Ç—ã

- [ ] **–¢–µ—Å—Ç—ã –º–æ–¥—É–ª—è audio_route_manager**
  - [ ] DeviceDiscovery (get_input_devices, get_output_devices)
  - [ ] DeviceMapping (find_portaudio_match)
  - [ ] RouteManager (reconcile, start_input, stop_input)
  - [ ] ReconcileEngine (single-flight, debounce)
  - [ ] InputStateMachine (–ø–µ—Ä–µ—Ö–æ–¥—ã —Å–æ—Å—Ç–æ—è–Ω–∏–π)
  - [ ] OutputStateMachine (–ø–µ—Ä–µ—Ö–æ–¥—ã —Å–æ—Å—Ç–æ—è–Ω–∏–π)
  - [ ] AVFInputAdapter (start_stream, stop_stream)
  - [ ] AVFOutputAdapter (initialize_engine, play_audio_chunk)

- [ ] **–¢–µ—Å—Ç—ã selectors**
  - [ ] audio_input_active(snapshot)
  - [ ] audio_output_ready(snapshot)
  - [ ] audio_device_changed(snapshot, old_uid)

- [ ] **–¢–µ—Å—Ç—ã gateways**
  - [ ] decide_audio_input_start(snapshot) (‚â•8 pairwise –∫–æ–º–±–∏–Ω–∞—Ü–∏–π)
  - [ ] decide_audio_output_start(snapshot) (‚â•8 pairwise –∫–æ–º–±–∏–Ω–∞—Ü–∏–π)
  - [ ] decide_audio_device_switch(snapshot) (‚â•8 pairwise –∫–æ–º–±–∏–Ω–∞—Ü–∏–π)
  - [ ] –ù–µ–≥–∞—Ç–∏–≤–Ω—ã–µ —Ç–µ—Å—Ç—ã (2 –Ω–∞ –∫–∞–∂–¥—ã–π gateway)

### Integration —Ç–µ—Å—Ç—ã

- [ ] **–¢–µ—Å—Ç—ã AudioRouteManagerIntegration**
  - [ ] –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏
  - [ ] –ü–æ–¥–ø–∏—Å–∫–∏ –Ω–∞ EventBus —Å–æ–±—ã—Ç–∏—è
  - [ ] –ü—É–±–ª–∏–∫–∞—Ü–∏–∏ EventBus —Å–æ–±—ã—Ç–∏–π
  - [ ] –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —É—Å—Ç—Ä–æ–π—Å—Ç–≤ (thread)
  - [ ] –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤

- [ ] **–¢–µ—Å—Ç—ã —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏ —Å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–º–∏ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è–º–∏**
  - [ ] VoiceRecognitionIntegration —Å feature flag OFF (—Å—Ç–∞—Ä–∞—è –ª–æ–≥–∏–∫–∞)
  - [ ] VoiceRecognitionIntegration —Å feature flag ON (–Ω–æ–≤–∞—è –ª–æ–≥–∏–∫–∞)
  - [ ] SpeechPlaybackIntegration —Å feature flag OFF (—Å—Ç–∞—Ä–∞—è –ª–æ–≥–∏–∫–∞)
  - [ ] SpeechPlaybackIntegration —Å feature flag ON (–Ω–æ–≤–∞—è –ª–æ–≥–∏–∫–∞)

- [ ] **End-to-end —Ç–µ—Å—Ç—ã**
  - [ ] Push-to-talk —Å feature flag OFF
  - [ ] Push-to-talk —Å feature flag ON
  - [ ] –í–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–µ —Å feature flag OFF
  - [ ] –í–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–µ —Å feature flag ON
  - [ ] –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤ –≤–æ –≤—Ä–µ–º—è –∑–∞–ø–∏—Å–∏
  - [ ] –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤ –≤–æ –≤—Ä–µ–º—è –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏—è

### –†–µ–≥—Ä–µ—Å—Å–∏–æ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã

- [ ] **–°—É—â–µ—Å—Ç–≤—É—é—â–∏–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª (feature flag OFF)**
  - [ ] Push-to-talk —Ä–∞–±–æ—Ç–∞–µ—Ç
  - [ ] –†–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏–µ —Ä–µ—á–∏ —Ä–∞–±–æ—Ç–∞–µ—Ç
  - [ ] –í–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–µ —Ä–∞–±–æ—Ç–∞–µ—Ç
  - [ ] –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ —Ä–µ–∂–∏–º–æ–≤ —Ä–∞–±–æ—Ç–∞–µ—Ç
  - [ ] Tray menu —Ä–∞–±–æ—Ç–∞–µ—Ç
  - [ ] –°–∏–≥–Ω–∞–ª—ã —Ä–∞–±–æ—Ç–∞—é—Ç

- [ ] **–ù–æ–≤—ã–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª (feature flag ON)**
  - [ ] Push-to-talk —Ä–∞–±–æ—Ç–∞–µ—Ç
  - [ ] –†–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏–µ —Ä–µ—á–∏ —Ä–∞–±–æ—Ç–∞–µ—Ç
  - [ ] –í–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–µ —Ä–∞–±–æ—Ç–∞–µ—Ç
  - [ ] –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤ —Ä–∞–±–æ—Ç–∞–µ—Ç
  - [ ] –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —É—Å—Ç—Ä–æ–π—Å—Ç–≤ —Ä–∞–±–æ—Ç–∞–µ—Ç

---

## üîç 7. –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ —Ä–µ–≥—Ä–µ—Å—Å–∏–∏

### –ß–µ–∫-–ª–∏—Å—Ç —Ä–µ–≥—Ä–µ—Å—Å–∏–π

- [ ] **Input —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª**
  - [ ] Push-to-talk –∞–∫—Ç–∏–≤–∏—Ä—É–µ—Ç –º–∏–∫—Ä–æ—Ñ–æ–Ω
  - [ ] –†–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏–µ —Ä–µ—á–∏ —Ä–∞–±–æ—Ç–∞–µ—Ç
  - [ ] –û—Ç–º–µ–Ω–∞ –∑–∞–ø–∏—Å–∏ —Ä–∞–±–æ—Ç–∞–µ—Ç
  - [ ] –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤ —Ä–∞–±–æ—Ç–∞–µ—Ç

- [ ] **Output —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª**
  - [ ] –í–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–µ —Ä–∞–±–æ—Ç–∞–µ—Ç
  - [ ] –û—Ç–º–µ–Ω–∞ –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏—è —Ä–∞–±–æ—Ç–∞–µ—Ç
  - [ ] –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤ —Ä–∞–±–æ—Ç–∞–µ—Ç

- [ ] **–†–µ–∂–∏–º—ã –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è**
  - [ ] –ü–µ—Ä–µ—Ö–æ–¥ SLEEPING ‚Üí LISTENING —Ä–∞–±–æ—Ç–∞–µ—Ç
  - [ ] –ü–µ—Ä–µ—Ö–æ–¥ LISTENING ‚Üí PROCESSING —Ä–∞–±–æ—Ç–∞–µ—Ç
  - [ ] –ü–µ—Ä–µ—Ö–æ–¥ PROCESSING ‚Üí SLEEPING —Ä–∞–±–æ—Ç–∞–µ—Ç

- [ ] **–†–∞–∑—Ä–µ—à–µ–Ω–∏—è**
  - [ ] –ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞ –ø—Ä–∏ first_run —Ä–∞–±–æ—Ç–∞–µ—Ç
  - [ ] –ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞ –ø—Ä–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–∏ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–π —Ä–∞–±–æ—Ç–∞–µ—Ç

- [ ] **Workflows**
  - [ ] ListeningWorkflow —Ä–∞–±–æ—Ç–∞–µ—Ç
  - [ ] ProcessingWorkflow —Ä–∞–±–æ—Ç–∞–µ—Ç

---

## üìä 8. –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –º–µ—Ç—Ä–∏–∫

### –ú–µ—Ç—Ä–∏–∫–∏ –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è

- [ ] **Input –º–µ—Ç—Ä–∏–∫–∏**
  - [ ] `audio_input_start_success_rate` (—Ü–µ–ª—å: ‚â•98%)
  - [ ] `audio_input_device_switch_latency_ms` (—Ü–µ–ª—å: p95 ‚â§ 500ms)
  - [ ] `audio_input_fallback_triggered` (—Ü–µ–ª—å: ‚â§1% —Å–ª—É—á–∞–µ–≤)

- [ ] **Output –º–µ—Ç—Ä–∏–∫–∏**
  - [ ] `audio_output_start_success_rate` (—Ü–µ–ª—å: ‚â•98%)
  - [ ] `audio_output_device_switch_latency_ms` (—Ü–µ–ª—å: p95 ‚â§ 500ms)
  - [ ] `audio_output_fallback_triggered` (—Ü–µ–ª—å: ‚â§1% —Å–ª—É—á–∞–µ–≤)

- [ ] **–û–±—â–∏–µ –º–µ—Ç—Ä–∏–∫–∏**
  - [ ] `audio_reconcile_loop_duration_ms` (—Ü–µ–ª—å: p95 ‚â§ 100ms)
  - [ ] `audio_device_storm_events` (–º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥)
  - [ ] `audio_route_manager_errors` (—Ü–µ–ª—å: ‚â§0.1% —Å–ª—É—á–∞–µ–≤)

### –ü–æ—Ä–æ–≥–∏ –¥–ª—è –æ—Ç–∫–∞—Ç–∞

- [ ] –ï—Å–ª–∏ `audio_input_start_success_rate` < 95% ‚Üí –æ—Ç–∫–∞—Ç
- [ ] –ï—Å–ª–∏ `audio_output_start_success_rate` < 95% ‚Üí –æ—Ç–∫–∞—Ç
- [ ] –ï—Å–ª–∏ `audio_route_manager_errors` > 1% ‚Üí –æ—Ç–∫–∞—Ç
- [ ] –ï—Å–ª–∏ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è –æ—à–∏–±–∫–∞ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∞ ‚Üí –Ω–µ–º–µ–¥–ª–µ–Ω–Ω—ã–π –æ—Ç–∫–∞—Ç (kill-switch)

---

## ‚úÖ –ò—Ç–æ–≥–æ–≤—ã–π —á–µ–∫-–ª–∏—Å—Ç –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏

### –ü–µ—Ä–µ–¥ –Ω–∞—á–∞–ª–æ–º —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

- [ ] Impact Map —Å–æ–∑–¥–∞–Ω –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —ç—Ç–∞–ø–∞
- [ ] –†–∏—Å–∫-–∞–Ω–∞–ª–∏–∑ –≤—ã–ø–æ–ª–Ω–µ–Ω —Å –º–∏—Ç–∏–≥–∞—Ü–∏–µ–π
- [ ] –ö–æ–Ω—Ç—Ä–∞–∫—Ç EventBus —Å–æ–∑–¥–∞–Ω –∏ –¥–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω
- [ ] STATE_CATALOG.md –æ–±–Ω–æ–≤–ª–µ–Ω —Å –Ω–æ–≤—ã–º–∏ –æ—Å—è–º–∏
- [ ] interaction_matrix.yaml –æ–±–Ω–æ–≤–ª–µ–Ω —Å –Ω–æ–≤—ã–º–∏ –ø—Ä–∞–≤–∏–ª–∞–º–∏
- [ ] selectors.py –æ–±–Ω–æ–≤–ª–µ–Ω —Å –Ω–æ–≤—ã–º–∏ selectors
- [ ] gateways.py –æ–±–Ω–æ–≤–ª–µ–Ω —Å –Ω–æ–≤—ã–º–∏ gateway —Ñ—É–Ω–∫—Ü–∏—è–º–∏
- [ ] unified_config.yaml –æ–±–Ω–æ–≤–ª–µ–Ω —Å feature flag (OFF –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é)
- [ ] –ü–ª–∞–Ω –æ—Ç–∫–∞—Ç–∞ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω
- [ ] –¢–µ—Å—Ç-–ø–ª–∞–Ω —Å–æ–∑–¥–∞–Ω

### –í–æ –≤—Ä–µ–º—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

- [ ] Feature flag OFF –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
- [ ] Kill-switch —Ä–∞–±–æ—Ç–∞–µ—Ç
- [ ] Fallback –º–µ—Ö–∞–Ω–∏–∑–º —Ä–∞–±–æ—Ç–∞–µ—Ç
- [ ] –í—Å–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ —Å–æ–±—ã—Ç–∏—è —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è
- [ ] –í–∞–ª–∏–¥–∞—Ü–∏—è payload –Ω–∞ –≥—Ä–∞–Ω–∏—Ü–µ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏
- [ ] –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ —á–µ—Ä–µ–∑ ErrorHandler
- [ ] –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ –∫–∞–Ω–æ–Ω–∏—á–µ—Å–∫–æ–º —Ñ–æ—Ä–º–∞—Ç–µ
- [ ] –¢–µ—Å—Ç—ã –ø—Ä–æ—Ö–æ–¥—è—Ç (unit + integration)

### –ü–æ—Å–ª–µ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

- [ ] –†–µ–≥—Ä–µ—Å—Å–∏–æ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã –ø—Ä–æ—Ö–æ–¥—è—Ç
- [ ] –†—É—á–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤
- [ ] –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –º–µ—Ç—Ä–∏–∫ –Ω–∞—Å—Ç—Ä–æ–µ–Ω
- [ ] –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –æ–±–Ω–æ–≤–ª–µ–Ω–∞
- [ ] ADR —Å–æ–∑–¥–∞–Ω (–µ—Å–ª–∏ –Ω—É–∂–Ω–æ)

---

## üéØ –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

1. **–°–æ–∑–¥–∞—Ç—å Impact Map** –¥–ª—è –≠—Ç–∞–ø–∞ 1 (–¥–µ—Ç–∞–ª—å–Ω—ã–π)
2. **–°–æ–∑–¥–∞—Ç—å –∫–æ–Ω—Ç—Ä–∞–∫—Ç EventBus** (–≤–∞–ª–∏–¥–∞—Ü–∏—è payload)
3. **–û–±–Ω–æ–≤–∏—Ç—å –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é** (STATE_CATALOG, interaction_matrix, selectors, gateways)
4. **–ù–∞—á–∞—Ç—å —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—é** –≠—Ç–∞–ø–∞ 1 (–º–æ–¥—É–ª—å audio_route_manager)

