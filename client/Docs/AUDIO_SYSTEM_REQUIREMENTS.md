# –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è –∫ –∞—É–¥–∏–æ-—Å–∏—Å—Ç–µ–º–µ Nexy

**–°—Ç–∞—Ç—É—Å**: –ï–¥–∏–Ω—ã–π –∏—Å—Ç–æ—á–Ω–∏–∫ –∏—Å—Ç–∏–Ω—ã –¥–ª—è —Ç—Ä–µ–±–æ–≤–∞–Ω–∏–π  
**–í–µ—Ä—Å–∏—è**: 1.0  
**–î–∞—Ç–∞**: 2025-12-23  
**–û—Å–Ω–æ–≤–∞–Ω –Ω–∞**: –í—Å–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è, –ø–µ—Ä–µ–¥–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º, —Ç–µ–∫—É—â–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

---

## üìã –°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ

1. [–§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è](#1-—Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ-—Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è)
2. [–¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è](#2-—Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ-—Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è)
3. [–¢—Ä–µ–±–æ–≤–∞–Ω–∏—è –∫ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏](#3-—Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è-–∫-–ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏)
4. [–¢—Ä–µ–±–æ–≤–∞–Ω–∏—è –∫ –Ω–∞–¥–µ–∂–Ω–æ—Å—Ç–∏](#4-—Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è-–∫-–Ω–∞–¥–µ–∂–Ω–æ—Å—Ç–∏)
5. [–¢—Ä–µ–±–æ–≤–∞–Ω–∏—è –∫ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏](#5-—Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è-–∫-–±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏)
6. [–¢—Ä–µ–±–æ–≤–∞–Ω–∏—è –∫ —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏](#6-—Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è-–∫-—Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏)
7. [–¢—Ä–µ–±–æ–≤–∞–Ω–∏—è –∫ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏](#7-—Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è-–∫-–∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏)

---

## 1. –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è

### 1.1. –û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤

**REQ-001: –ú–≥–Ω–æ–≤–µ–Ω–Ω–æ–µ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤**

- **–û–ø–∏—Å–∞–Ω–∏–µ**: –°–∏—Å—Ç–µ–º–∞ –¥–æ–ª–∂–Ω–∞ –º–≥–Ω–æ–≤–µ–Ω–Ω–æ –æ–±–Ω–∞—Ä—É–∂–∏–≤–∞—Ç—å –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ/–æ—Ç–∫–ª—é—á–µ–Ω–∏–µ –∞—É–¥–∏–æ —É—Å—Ç—Ä–æ–π—Å—Ç–≤
- **–¢—Ä–µ–±–æ–≤–∞–Ω–∏–µ**: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å AVFoundation —Å NSNotificationCenter –¥–ª—è –º–≥–Ω–æ–≤–µ–Ω–Ω–æ–≥–æ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏—è
- **Fallback**: Polling –∫–∞–∂–¥—ã–µ 1-2 —Å–µ–∫—É–Ω–¥—ã, –µ—Å–ª–∏ NSNotificationCenter –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω
- **–ö—Ä–∏—Ç–µ—Ä–∏–π —É—Å–ø–µ—Ö–∞**: –ò–∑–º–µ–Ω–µ–Ω–∏–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ –æ–±–Ω–∞—Ä—É–∂–∏–≤–∞–µ—Ç—Å—è –≤ —Ç–µ—á–µ–Ω–∏–µ ‚â§1 —Å–µ–∫—É–Ω–¥—ã

**REQ-002: –ù–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è –∏–º–µ–Ω —É—Å—Ç—Ä–æ–π—Å—Ç–≤**

- **–û–ø–∏—Å–∞–Ω–∏–µ**: –ò–º–µ–Ω–∞ —É—Å—Ç—Ä–æ–π—Å—Ç–≤ –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –Ω–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞–Ω—ã –¥–ª—è —Å—Ä–∞–≤–Ω–µ–Ω–∏—è
- **–¢—Ä–µ–±–æ–≤–∞–Ω–∏–µ**: –£–¥–∞–ª–µ–Ω–∏–µ –ª–∏—à–Ω–∏—Ö –ø—Ä–æ–±–µ–ª–æ–≤, –ø—Ä–∏–≤–µ–¥–µ–Ω–∏–µ –∫ lowercase, —É–¥–∞–ª–µ–Ω–∏–µ —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã—Ö —Å–∏–º–≤–æ–ª–æ–≤
- **–ö—Ä–∏—Ç–µ—Ä–∏–π —É—Å–ø–µ—Ö–∞**: –û–¥–Ω–æ –∏ —Ç–æ –∂–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ –∏–º–µ–µ—Ç –æ–¥–∏–Ω–∞–∫–æ–≤–æ–µ –Ω–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–æ–µ –∏–º—è –ø—Ä–∏ –ø–µ—Ä–µ–ø–æ–¥–∫–ª—é—á–µ–Ω–∏–∏

**REQ-003: –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ transport —Ç–∏–ø–∞**

- **–û–ø–∏—Å–∞–Ω–∏–µ**: –°–∏—Å—Ç–µ–º–∞ –¥–æ–ª–∂–Ω–∞ –æ–ø—Ä–µ–¥–µ–ª—è—Ç—å —Ç–∏–ø —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ (Bluetooth/USB/Built-in/Unknown)
- **–¢—Ä–µ–±–æ–≤–∞–Ω–∏–µ**: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å AVFoundation –¥–ª—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è transport
- **–ö—Ä–∏—Ç–µ—Ä–∏–π —É—Å–ø–µ—Ö–∞**: Transport –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –¥–ª—è –≤—Å–µ—Ö —Ç–∏–ø–æ–≤ —É—Å—Ç—Ä–æ–π—Å—Ç–≤

---

### 1.2. –ú–∞–ø–ø–∏–Ω–≥ —É—Å—Ç—Ä–æ–π—Å—Ç–≤

**REQ-004: –ú–∞–ø–ø–∏–Ω–≥ AVFoundation ‚Üí PortAudio**

- **–û–ø–∏—Å–∞–Ω–∏–µ**: –°–∏—Å—Ç–µ–º–∞ –¥–æ–ª–∂–Ω–∞ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –º–∞–ø–ø–∏—Ä–æ–≤–∞—Ç—å AVFoundation —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ –Ω–∞ PortAudio –∏–Ω–¥–µ–∫—Å—ã
- **–¢—Ä–µ–±–æ–≤–∞–Ω–∏–µ**: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å confidence model (HIGH/MEDIUM/LOW)
- **Fallback**: –ü—Ä–∏ –Ω–∏–∑–∫–æ–π confidence –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å system default —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ
- **–ö—Ä–∏—Ç–µ—Ä–∏–π —É—Å–ø–µ—Ö–∞**: ‚â•80% success rate –º–∞–ø–ø–∏–Ω–≥–∞, FP (False Positive) ‚âà 0

**REQ-005: –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ –º–∞–ø–ø–∏–Ω–≥–∞**

- **–û–ø–∏—Å–∞–Ω–∏–µ**: –ú–∞–ø–ø–∏–Ω–≥ –¥–æ–ª–∂–µ–Ω –∫—ç—à–∏—Ä–æ–≤–∞—Ç—å—Å—è –¥–ª—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
- **–¢—Ä–µ–±–æ–≤–∞–Ω–∏–µ**: –ö—ç—à –∏–Ω–≤–∞–ª–∏–¥–∏—Ä—É–µ—Ç—Å—è –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ —É—Å—Ç—Ä–æ–π—Å—Ç–≤
- **–ö—Ä–∏—Ç–µ—Ä–∏–π —É—Å–ø–µ—Ö–∞**: –ö—ç—à –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –ø–æ–≤—Ç–æ—Ä–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤, –∏–Ω–≤–∞–ª–∏–¥–∏—Ä—É–µ—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ

---

### 1.3. –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ input (–º–∏–∫—Ä–æ—Ñ–æ–Ω)

**REQ-006: –ï–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω—ã–π –≤–ª–∞–¥–µ–ª–µ—Ü –º–∏–∫—Ä–æ—Ñ–æ–Ω–∞**

- **–û–ø–∏—Å–∞–Ω–∏–µ**: –¢–æ–ª—å–∫–æ `AudioRouteManager` –¥–æ–ª–∂–µ–Ω —É–ø—Ä–∞–≤–ª—è—Ç—å –º–∏–∫—Ä–æ—Ñ–æ–Ω–æ–º
- **–¢—Ä–µ–±–æ–≤–∞–Ω–∏–µ**: –ó–∞–ø—Ä–µ—â–µ–Ω–æ –ø—Ä—è–º–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –º–∏–∫—Ä–æ—Ñ–æ–Ω–æ–º –∏–∑ –¥—Ä—É–≥–∏—Ö –º–æ–¥—É–ª–µ–π
- **–ö—Ä–∏—Ç–µ—Ä–∏–π —É—Å–ø–µ—Ö–∞**: –ù–µ—Ç –∫–æ–Ω—Ñ–ª–∏–∫—Ç–æ–≤ –ø—Ä–∏ –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ–º –æ—Ç–∫—Ä—ã—Ç–∏–∏ –º–∏–∫—Ä–æ—Ñ–æ–Ω–∞

**REQ-007: –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–µ—Ä–µ–¥ –æ—Ç–∫—Ä—ã—Ç–∏–µ–º –º–∏–∫—Ä–æ—Ñ–æ–Ω–∞**

- **–û–ø–∏—Å–∞–Ω–∏–µ**: –°–∏—Å—Ç–µ–º–∞ –¥–æ–ª–∂–Ω–∞ –ø—Ä–æ–≤–µ—Ä—è—Ç—å `is_input_active` –ø–µ—Ä–µ–¥ –æ—Ç–∫—Ä—ã—Ç–∏–µ–º –º–∏–∫—Ä–æ—Ñ–æ–Ω–∞
- **–¢—Ä–µ–±–æ–≤–∞–Ω–∏–µ**: –ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞ –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ–≥–æ –æ—Ç–∫—Ä—ã—Ç–∏—è –º–∏–∫—Ä–æ—Ñ–æ–Ω–∞
- **–ö—Ä–∏—Ç–µ—Ä–∏–π —É—Å–ø–µ—Ö–∞**: –ö–æ–Ω—Ñ–ª–∏–∫—Ç—ã –º–∏–∫—Ä–æ—Ñ–æ–Ω–∞ –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω—ã

**REQ-008: –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ input —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞**

- **–û–ø–∏—Å–∞–Ω–∏–µ**: –°–∏—Å—Ç–µ–º–∞ –¥–æ–ª–∂–Ω–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–µ—Ä–µ–∫–ª—é—á–∞—Ç—å—Å—è –Ω–∞ –Ω–æ–≤–æ–µ input —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ –ø—Ä–∏ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–∏/–æ—Ç–∫–ª—é—á–µ–Ω–∏–∏
- **–¢—Ä–µ–±–æ–≤–∞–Ω–∏–µ**: –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –¥–æ–ª–∂–Ω–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç—å –±–µ–∑ –ø–æ—Ç–µ—Ä–∏ –¥–∞–Ω–Ω—ã—Ö (–æ—á–∏—Å—Ç–∫–∞ –±—É—Ñ–µ—Ä–∞)
- **–ö—Ä–∏—Ç–µ—Ä–∏–π —É—Å–ø–µ—Ö–∞**: –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏, –¥–∞–Ω–Ω—ã–µ –Ω–µ —Å–º–µ—à–∏–≤–∞—é—Ç—Å—è

**REQ-009: –ü–æ–¥–¥–µ—Ä–∂–∫–∞ push-to-talk**

- **–û–ø–∏—Å–∞–Ω–∏–µ**: –°–∏—Å—Ç–µ–º–∞ –¥–æ–ª–∂–Ω–∞ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—Ç—å push-to-talk (Control+N)
- **–¢—Ä–µ–±–æ–≤–∞–Ω–∏–µ**: –ú–∏–∫—Ä–æ—Ñ–æ–Ω –∞–∫—Ç–∏–≤–∏—Ä—É–µ—Ç—Å—è –ø—Ä–∏ –Ω–∞–∂–∞—Ç–∏–∏ Control+N, –¥–µ–∞–∫—Ç–∏–≤–∏—Ä—É–µ—Ç—Å—è –ø—Ä–∏ –æ—Ç–ø—É—Å–∫–∞–Ω–∏–∏
- **–ö—Ä–∏—Ç–µ—Ä–∏–π —É—Å–ø–µ—Ö–∞**: Push-to-talk —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ

---

### 1.4. –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ output (–≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–µ)

**REQ-010: –ï–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω—ã–π –≤–ª–∞–¥–µ–ª–µ—Ü output**

- **–û–ø–∏—Å–∞–Ω–∏–µ**: –¢–æ–ª—å–∫–æ `AudioRouteManager` –¥–æ–ª–∂–µ–Ω —É–ø—Ä–∞–≤–ª—è—Ç—å output
- **–¢—Ä–µ–±–æ–≤–∞–Ω–∏–µ**: –ó–∞–ø—Ä–µ—â–µ–Ω–æ –ø—Ä—è–º–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ output –∏–∑ –¥—Ä—É–≥–∏—Ö –º–æ–¥—É–ª–µ–π
- **–ö—Ä–∏—Ç–µ—Ä–∏–π —É—Å–ø–µ—Ö–∞**: –ù–µ—Ç –∫–æ–Ω—Ñ–ª–∏–∫—Ç–æ–≤ –ø—Ä–∏ –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–∏

**REQ-011: –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ output —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞**

- **–û–ø–∏—Å–∞–Ω–∏–µ**: –°–∏—Å—Ç–µ–º–∞ –¥–æ–ª–∂–Ω–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–µ—Ä–µ–∫–ª—é—á–∞—Ç—å—Å—è –Ω–∞ –Ω–æ–≤–æ–µ output —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ –ø—Ä–∏ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–∏/–æ—Ç–∫–ª—é—á–µ–Ω–∏–∏
- **–¢—Ä–µ–±–æ–≤–∞–Ω–∏–µ**: –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –¥–æ–ª–∂–Ω–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç—å —á–µ—Ä–µ–∑ recreate AVAudioEngine
- **–ö—Ä–∏—Ç–µ—Ä–∏–π —É—Å–ø–µ—Ö–∞**: –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏, –æ—á–µ—Ä–µ–¥—å –Ω–µ —Ç–µ—Ä—è–µ—Ç—Å—è

**REQ-012: –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏—è –∞—É–¥–∏–æ**

- **–û–ø–∏—Å–∞–Ω–∏–µ**: –°–∏—Å—Ç–µ–º–∞ –¥–æ–ª–∂–Ω–∞ –≤–æ—Å–ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç—å –∞—É–¥–∏–æ –æ—Ç —Å–µ—Ä–≤–µ—Ä–∞ (gRPC)
- **–¢—Ä–µ–±–æ–≤–∞–Ω–∏–µ**: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å AVAudioEngine –¥–ª—è –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏—è
- **–ö—Ä–∏—Ç–µ—Ä–∏–π —É—Å–ø–µ—Ö–∞**: –ê—É–¥–∏–æ –≤–æ—Å–ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ

---

### 1.5. –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Google Speech Recognition

**REQ-013: –ü–æ–ª—É—á–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è Google SR**

- **–û–ø–∏—Å–∞–Ω–∏–µ**: –°–∏—Å—Ç–µ–º–∞ –¥–æ–ª–∂–Ω–∞ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è—Ç—å –∞—É–¥–∏–æ-–¥–∞–Ω–Ω—ã–µ –¥–ª—è Google Speech Recognition
- **–¢—Ä–µ–±–æ–≤–∞–Ω–∏–µ**: Google SR —Ä–∞–±–æ—Ç–∞–µ—Ç —Ç–æ–ª—å–∫–æ –Ω–∞ –±—É—Ñ–µ—Ä–∞—Ö (–Ω–µ –Ω–∞–ø—Ä—è–º—É—é —Å –º–∏–∫—Ä–æ—Ñ–æ–Ω–æ–º)
- **–ö—Ä–∏—Ç–µ—Ä–∏–π —É—Å–ø–µ—Ö–∞**: Google SR –ø–æ–ª—É—á–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ, —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏–µ —Ä–∞–±–æ—Ç–∞–µ—Ç

**REQ-014: –†–µ—Å–µ–º–ø–ª–∏–Ω–≥ –¥–ª—è Google SR**

- **–û–ø–∏—Å–∞–Ω–∏–µ**: –ê—É–¥–∏–æ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å —Ä–µ—Å–µ–º–ø–ª–∏—Ä–æ–≤–∞–Ω–æ –¥–æ 16kHz mono –¥–ª—è Google SR
- **–¢—Ä–µ–±–æ–≤–∞–Ω–∏–µ**: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ª–∏–Ω–µ–π–Ω—ã–π —Ä–µ—Å–µ–º–ø–ª–∏–Ω–≥
- **–ö—Ä–∏—Ç–µ—Ä–∏–π —É—Å–ø–µ—Ö–∞**: –†–µ—Å–µ–º–ø–ª–∏–Ω–≥ —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ, –∫–∞—á–µ—Å—Ç–≤–æ —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏—è –Ω–µ —É—Ö—É–¥—à–∞–µ—Ç—Å—è

---

## 2. –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è

### 2.1. –¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏

**REQ-015: AVFoundation –¥–ª—è –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏—è —É—Å—Ç—Ä–æ–π—Å—Ç–≤**

- **–û–ø–∏—Å–∞–Ω–∏–µ**: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å AVFoundation –¥–ª—è –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏—è –∏ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ —É—Å—Ç—Ä–æ–π—Å—Ç–≤
- **–¢—Ä–µ–±–æ–≤–∞–Ω–∏–µ**: `AVAudioSession`, `NSNotificationCenter` –¥–ª—è –º–≥–Ω–æ–≤–µ–Ω–Ω–æ–≥–æ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏—è
- **–ö—Ä–∏—Ç–µ—Ä–∏–π —É—Å–ø–µ—Ö–∞**: AVFoundation –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –æ–±–Ω–∞—Ä—É–∂–∏–≤–∞–µ—Ç —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞

**REQ-016: PortAudio –¥–ª—è –º–∞–ø–ø–∏–Ω–≥–∞**

- **–û–ø–∏—Å–∞–Ω–∏–µ**: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å PortAudio (—á–µ—Ä–µ–∑ sounddevice) –¥–ª—è –º–∞–ø–ø–∏–Ω–≥–∞ —É—Å—Ç—Ä–æ–π—Å—Ç–≤
- **–¢—Ä–µ–±–æ–≤–∞–Ω–∏–µ**: `sounddevice.query_devices()` –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è —Å–ø–∏—Å–∫–∞ —É—Å—Ç—Ä–æ–π—Å—Ç–≤
- **–ö—Ä–∏—Ç–µ—Ä–∏–π —É—Å–ø–µ—Ö–∞**: –ú–∞–ø–ø–∏–Ω–≥ —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ

**REQ-017: sounddevice –¥–ª—è input**

- **–û–ø–∏—Å–∞–Ω–∏–µ**: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `sounddevice.InputStream` –¥–ª—è –∑–∞—Ö–≤–∞—Ç–∞ –∞—É–¥–∏–æ
- **–¢—Ä–µ–±–æ–≤–∞–Ω–∏–µ**: Mono / 16 kHz, callback –¥–ª—è heartbeat
- **–ö—Ä–∏—Ç–µ—Ä–∏–π —É—Å–ø–µ—Ö–∞**: –ó–∞—Ö–≤–∞—Ç –∞—É–¥–∏–æ —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ

**REQ-018: AVAudioEngine –¥–ª—è output**

- **–û–ø–∏—Å–∞–Ω–∏–µ**: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `AVAudioEngine` –¥–ª—è –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏—è –∞—É–¥–∏–æ
- **–¢—Ä–µ–±–æ–≤–∞–Ω–∏–µ**: Native device format, persistent queue
- **–ö—Ä–∏—Ç–µ—Ä–∏–π —É—Å–ø–µ—Ö–∞**: –í–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–µ —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ

---

### 2.2. State Machines

**REQ-019: Input State Machine**

- **–û–ø–∏—Å–∞–Ω–∏–µ**: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å FSM –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è input —Å–æ—Å—Ç–æ—è–Ω–∏–µ–º
- **–¢—Ä–µ–±–æ–≤–∞–Ω–∏–µ**: –°–æ—Å—Ç–æ—è–Ω–∏—è: STOPPED ‚Üí STARTING ‚Üí ACTIVE ‚Üí STOPPING ‚Üí STOPPED
- **Timeout**: STARTING timeout = 2.5s
- **Retries**: 3 –ø–æ–ø—ã—Ç–∫–∏ —Å backoff (1s ‚Üí 2s ‚Üí 4s)
- **Max —Ä–µ—Å—Ç–∞—Ä—Ç–æ–≤**: 6 / 10 –º–∏–Ω—É—Ç
- **–ö—Ä–∏—Ç–µ—Ä–∏–π —É—Å–ø–µ—Ö–∞**: FSM —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ, –≤—Å–µ –ø–µ—Ä–µ—Ö–æ–¥—ã –æ–±—Ä–∞–±–æ—Ç–∞–Ω—ã

**REQ-020: Output State Machine**

- **–û–ø–∏—Å–∞–Ω–∏–µ**: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å FSM –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è output —Å–æ—Å—Ç–æ—è–Ω–∏–µ–º
- **–¢—Ä–µ–±–æ–≤–∞–Ω–∏–µ**: –°–æ—Å—Ç–æ—è–Ω–∏—è: READY ‚Üí RECREATING ‚Üí READY
- **Timeout**: RECREATING timeout = 1.5s
- **Retries**: 2 –ø–æ–ø—ã—Ç–∫–∏
- **–ö—Ä–∏—Ç–µ—Ä–∏–π —É—Å–ø–µ—Ö–∞**: FSM —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ, –≤—Å–µ –ø–µ—Ä–µ—Ö–æ–¥—ã –æ–±—Ä–∞–±–æ—Ç–∞–Ω—ã

---

### 2.3. Reconcile Loop

**REQ-021: Single-flight –º–µ—Ö–∞–Ω–∏–∑–º**

- **–û–ø–∏—Å–∞–Ω–∏–µ**: Reconcile loop –¥–æ–ª–∂–µ–Ω –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å single-flight –º–µ—Ö–∞–Ω–∏–∑–º
- **–¢—Ä–µ–±–æ–≤–∞–Ω–∏–µ**: –¢–æ–ª—å–∫–æ –æ–¥–∏–Ω reconcile –∑–∞ —Ä–∞–∑, pending reconcile –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –ø–æ—Å–ª–µ —Ç–µ–∫—É—â–µ–≥–æ
- **–ö—Ä–∏—Ç–µ—Ä–∏–π —É—Å–ø–µ—Ö–∞**: –ù–µ—Ç –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã—Ö reconcile –æ–ø–µ—Ä–∞—Ü–∏–π

**REQ-022: Debounce –º–µ—Ö–∞–Ω–∏–∑–º**

- **–û–ø–∏—Å–∞–Ω–∏–µ**: Reconcile loop –¥–æ–ª–∂–µ–Ω –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å debounce –¥–ª—è –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏—è device storm
- **–¢—Ä–µ–±–æ–≤–∞–Ω–∏–µ**: Per-device debounce (Bluetooth: 200ms, USB: 100ms, Built-in: 100ms)
- **–ö—Ä–∏—Ç–µ—Ä–∏–π —É—Å–ø–µ—Ö–∞**: Device storm –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ, –Ω–µ—Ç —Ü–∏–∫–ª–æ–≤ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–π

**REQ-023: –î–µ—Ç–µ—Ä–º–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Ä–µ—à–µ–Ω–∏—è**

- **–û–ø–∏—Å–∞–Ω–∏–µ**: –í—Å–µ —Ä–µ—à–µ–Ω–∏—è –¥–æ–ª–∂–Ω—ã –ø—Ä–∏–Ω–∏–º–∞—Ç—å—Å—è —Ç–æ–ª—å–∫–æ —á–µ—Ä–µ–∑ reconcile loop
- **–¢—Ä–µ–±–æ–≤–∞–Ω–∏–µ**: –ó–∞–ø—Ä–µ—â–µ–Ω–∞ –ª–æ–≥–∏–∫–∞ –≤ event-handlers, —Ç–æ–ª—å–∫–æ trigger ‚Üí reconcile
- **–ö—Ä–∏—Ç–µ—Ä–∏–π —É—Å–ø–µ—Ö–∞**: –í—Å–µ —Ä–µ—à–µ–Ω–∏—è –¥–µ—Ç–µ—Ä–º–∏–Ω–∏—Ä–æ–≤–∞–Ω—ã, –Ω–µ—Ç —Å–∫—Ä—ã—Ç–æ–π –ª–æ–≥–∏–∫–∏

---

### 2.4. Thread-safety

**REQ-024: –ó–∞—â–∏—Ç–∞ shared state**

- **–û–ø–∏—Å–∞–Ω–∏–µ**: –í—Å–µ shared state –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å –∑–∞—â–∏—â–µ–Ω–æ locks
- **–¢—Ä–µ–±–æ–≤–∞–Ω–∏–µ**: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `threading.RLock` –¥–ª—è –∑–∞—â–∏—Ç—ã shared state
- **–ö—Ä–∏—Ç–µ—Ä–∏–π —É—Å–ø–µ—Ö–∞**: –ù–µ—Ç race conditions, –≤—Å–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ thread-safe

**REQ-025: –ï–¥–∏–Ω—ã–π monitoring thread**

- **–û–ø–∏—Å–∞–Ω–∏–µ**: –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —É—Å—Ç—Ä–æ–π—Å—Ç–≤ –¥–æ–ª–∂–µ–Ω –≤—ã–ø–æ–ª–Ω—è—Ç—å—Å—è –≤ –µ–¥–∏–Ω–æ–º thread
- **–¢—Ä–µ–±–æ–≤–∞–Ω–∏–µ**: –û–¥–∏–Ω monitoring thread –≤ `AudioRouteManagerIntegration`
- **–ö—Ä–∏—Ç–µ—Ä–∏–π —É—Å–ø–µ—Ö–∞**: –ù–µ—Ç –≥–æ–Ω–æ–∫ –º–µ–∂–¥—É monitoring threads

---

## 3. –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è –∫ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

### 3.1. Latency SLA

**REQ-026: Input switch latency**

- **–û–ø–∏—Å–∞–Ω–∏–µ**: –ó–∞–¥–µ—Ä–∂–∫–∞ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è input —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞
- **–¢—Ä–µ–±–æ–≤–∞–Ω–∏–µ**:
  - Built-in: ‚â§600 ms
  - USB: ‚â§800 ms
  - Bluetooth: ‚â§1200 ms (‚â§2000 –¥–æ–ø—É—Å—Ç–∏–º–æ)
- **–ö—Ä–∏—Ç–µ—Ä–∏–π —É—Å–ø–µ—Ö–∞**: –ó–∞–¥–µ—Ä–∂–∫–∞ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç SLA

**REQ-027: Output recreate latency**

- **–û–ø–∏—Å–∞–Ω–∏–µ**: –ó–∞–¥–µ—Ä–∂–∫–∞ –ø–µ—Ä–µ—Å–æ–∑–¥–∞–Ω–∏—è output —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞
- **–¢—Ä–µ–±–æ–≤–∞–Ω–∏–µ**: ‚â§600 ms (‚â§900 –¥–æ–ø—É—Å—Ç–∏–º–æ)
- **–ö—Ä–∏—Ç–µ—Ä–∏–π —É—Å–ø–µ—Ö–∞**: –ó–∞–¥–µ—Ä–∂–∫–∞ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç SLA

**REQ-028: UI/voice feedback**

- **–û–ø–∏—Å–∞–Ω–∏–µ**: UI/voice feedback —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ –∑–∞–¥–µ—Ä–∂–∫–∞ >700 ms
- **–¢—Ä–µ–±–æ–≤–∞–Ω–∏–µ**: –ù–µ –ø–æ–∫–∞–∑—ã–≤–∞—Ç—å feedback –¥–ª—è –±—ã—Å—Ç—Ä—ã—Ö –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–π
- **–ö—Ä–∏—Ç–µ—Ä–∏–π —É—Å–ø–µ—Ö–∞**: Feedback –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏

---

### 3.2. –ú–µ—Ç—Ä–∏–∫–∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

**REQ-029: Callback interval —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å**

- **–û–ø–∏—Å–∞–Ω–∏–µ**: Callback interval –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å —Å—Ç–∞–±–∏–ª—å–Ω—ã–º
- **–¢—Ä–µ–±–æ–≤–∞–Ω–∏–µ**: –í–∞—Ä–∏–∞—Ü–∏—è <15% (–¥–ª—è Bluetooth –º–æ–∂–µ—Ç –±—ã—Ç—å –≤—ã—à–µ, –Ω–æ –ø—Ä–∏–µ–º–ª–µ–º–æ)
- **–ö—Ä–∏—Ç–µ—Ä–∏–π —É—Å–ø–µ—Ö–∞**: Callback interval —Å—Ç–∞–±–∏–ª–µ–Ω, –Ω–µ—Ç –ø–æ—Å—Ç–æ—è–Ω–Ω—ã—Ö xruns

**REQ-030: –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ underruns/overflows**

- **–û–ø–∏—Å–∞–Ω–∏–µ**: –°–∏—Å—Ç–µ–º–∞ –Ω–µ –¥–æ–ª–∂–Ω–∞ –∏–º–µ—Ç—å –ø–æ—Å—Ç–æ—è–Ω–Ω—ã—Ö underruns/overflows
- **–¢—Ä–µ–±–æ–≤–∞–Ω–∏–µ**: –í—Ä–µ–º–µ–Ω–Ω—ã–µ underruns/overflows –¥–æ–ø—É—Å—Ç–∏–º—ã, –ø–æ—Å—Ç–æ—è–Ω–Ω—ã–µ ‚Äî –Ω–µ—Ç
- **–ö—Ä–∏—Ç–µ—Ä–∏–π —É—Å–ø–µ—Ö–∞**: –ù–µ—Ç –ø–æ—Å—Ç–æ—è–Ω–Ω—ã—Ö underruns/overflows

---

## 4. –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è –∫ –Ω–∞–¥–µ–∂–Ω–æ—Å—Ç–∏

### 4.1. –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫

**REQ-031: MIC_BUSY –æ–±—Ä–∞–±–æ—Ç–∫–∞**

- **–û–ø–∏—Å–∞–Ω–∏–µ**: –°–∏—Å—Ç–µ–º–∞ –¥–æ–ª–∂–Ω–∞ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å —Å–∏—Ç—É–∞—Ü–∏—é, –∫–æ–≥–¥–∞ –º–∏–∫—Ä–æ—Ñ–æ–Ω –∑–∞–Ω—è—Ç –¥—Ä—É–≥–∏–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ–º
- **–¢—Ä–µ–±–æ–≤–∞–Ω–∏–µ**: Retry √ó3, –∑–∞—Ç–µ–º state = MIC_BUSY + user feedback
- **–ö—Ä–∏—Ç–µ—Ä–∏–π —É—Å–ø–µ—Ö–∞**: MIC_BUSY –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ, –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —É–≤–µ–¥–æ–º–ª–µ–Ω

**REQ-032: NO_INPUT_AVAILABLE –æ–±—Ä–∞–±–æ—Ç–∫–∞**

- **–û–ø–∏—Å–∞–Ω–∏–µ**: –°–∏—Å—Ç–µ–º–∞ –¥–æ–ª–∂–Ω–∞ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å —Å–∏—Ç—É–∞—Ü–∏—é, –∫–æ–≥–¥–∞ –Ω–µ—Ç –¥–æ—Å—Ç—É–ø–Ω—ã—Ö input —É—Å—Ç—Ä–æ–π—Å—Ç–≤
- **–¢—Ä–µ–±–æ–≤–∞–Ω–∏–µ**: –ê–≥—Ä–µ—Å—Å–∏–≤–Ω—ã–µ retry –∑–∞–ø—Ä–µ—â–µ–Ω—ã, graceful degradation
- **–ö—Ä–∏—Ç–µ—Ä–∏–π —É—Å–ø–µ—Ö–∞**: NO_INPUT_AVAILABLE –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ

**REQ-033: –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ**

- **–û–ø–∏—Å–∞–Ω–∏–µ**: –°–∏—Å—Ç–µ–º–∞ –¥–æ–ª–∂–Ω–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≤–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—Ç—å—Å—è –ø–æ—Å–ª–µ –æ—à–∏–±–æ–∫
- **–¢—Ä–µ–±–æ–≤–∞–Ω–∏–µ**: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `AudioRecoveryManager` –¥–ª—è –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è
- **–ö—Ä–∏—Ç–µ—Ä–∏–π —É—Å–ø–µ—Ö–∞**: –°–∏—Å—Ç–µ–º–∞ –≤–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏

---

### 4.2. –£—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç—å –∫ –ø—Ä–æ–±–ª–µ–º–∞–º

**REQ-034: Device storm —É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç—å**

- **–û–ø–∏—Å–∞–Ω–∏–µ**: –°–∏—Å—Ç–µ–º–∞ –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å —É—Å—Ç–æ–π—á–∏–≤–∞ –∫ device storm (–º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è)
- **–¢—Ä–µ–±–æ–≤–∞–Ω–∏–µ**: Single-flight + debounce –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞—é—Ç —Ü–∏–∫–ª—ã –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–π
- **–ö—Ä–∏—Ç–µ—Ä–∏–π —É—Å–ø–µ—Ö–∞**: Device storm –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ, –Ω–µ—Ç —Ü–∏–∫–ª–æ–≤

**REQ-035: Race conditions —É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç—å**

- **–û–ø–∏—Å–∞–Ω–∏–µ**: –°–∏—Å—Ç–µ–º–∞ –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å —É—Å—Ç–æ–π—á–∏–≤–∞ –∫ race conditions
- **–¢—Ä–µ–±–æ–≤–∞–Ω–∏–µ**: –í—Å–µ shared state –∑–∞—â–∏—â–µ–Ω–æ locks, single-flight –º–µ—Ö–∞–Ω–∏–∑–º
- **–ö—Ä–∏—Ç–µ—Ä–∏–π —É—Å–ø–µ—Ö–∞**: –ù–µ—Ç race conditions, —Å–∏—Å—Ç–µ–º–∞ —Å—Ç–∞–±–∏–ª—å–Ω–∞

**REQ-036: System default changes —É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç—å**

- **–û–ø–∏—Å–∞–Ω–∏–µ**: –°–∏—Å—Ç–µ–º–∞ –¥–æ–ª–∂–Ω–∞ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è system default —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞
- **–¢—Ä–µ–±–æ–≤–∞–Ω–∏–µ**: –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –Ω–∞ –Ω–æ–≤–æ–µ default —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ
- **–ö—Ä–∏—Ç–µ—Ä–∏–π —É—Å–ø–µ—Ö–∞**: –ò–∑–º–µ–Ω–µ–Ω–∏—è system default –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—é—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ

---

## 5. –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è –∫ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

### 5.1. –†–∞–∑—Ä–µ—à–µ–Ω–∏—è

**REQ-037: –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–π –ø–µ—Ä–µ–¥ –∞–∫—Ç–∏–≤–∞—Ü–∏–µ–π**

- **–û–ø–∏—Å–∞–Ω–∏–µ**: –°–∏—Å—Ç–µ–º–∞ –¥–æ–ª–∂–Ω–∞ –ø—Ä–æ–≤–µ—Ä—è—Ç—å —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è –ø–µ—Ä–µ–¥ –∞–∫—Ç–∏–≤–∞—Ü–∏–µ–π input/output
- **–¢—Ä–µ–±–æ–≤–∞–Ω–∏–µ**: –ü—Ä–æ–≤–µ—Ä–∫–∞ `permissions.mic = granted` –ø–µ—Ä–µ–¥ –æ—Ç–∫—Ä—ã—Ç–∏–µ–º –º–∏–∫—Ä–æ—Ñ–æ–Ω–∞
- **–ö—Ä–∏—Ç–µ—Ä–∏–π —É—Å–ø–µ—Ö–∞**: –†–∞–∑—Ä–µ—à–µ–Ω–∏—è –ø—Ä–æ–≤–µ—Ä—è—é—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ, –Ω–µ—Ç –ø–æ–ø—ã—Ç–æ–∫ –±–µ–∑ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–π

**REQ-038: –ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞ –≤–æ –≤—Ä–µ–º—è first-run**

- **–û–ø–∏—Å–∞–Ω–∏–µ**: –°–∏—Å—Ç–µ–º–∞ –¥–æ–ª–∂–Ω–∞ –±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å –∞–∫—Ç–∏–≤–∞—Ü–∏—é input/output –≤–æ –≤—Ä–µ–º—è first-run
- **–¢—Ä–µ–±–æ–≤–∞–Ω–∏–µ**: –ü—Ä–æ–≤–µ—Ä–∫–∞ `firstRun = false` –ø–µ—Ä–µ–¥ –∞–∫—Ç–∏–≤–∞—Ü–∏–µ–π
- **–ö—Ä–∏—Ç–µ—Ä–∏–π —É—Å–ø–µ—Ö–∞**: –ê–∫—Ç–∏–≤–∞—Ü–∏—è –±–ª–æ–∫–∏—Ä—É–µ—Ç—Å—è –≤–æ –≤—Ä–µ–º—è first-run

**REQ-039: –ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞ –≤–æ –≤—Ä–µ–º—è permission restart**

- **–û–ø–∏—Å–∞–Ω–∏–µ**: –°–∏—Å—Ç–µ–º–∞ –¥–æ–ª–∂–Ω–∞ –±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å –∞–∫—Ç–∏–≤–∞—Ü–∏—é input/output –≤–æ –≤—Ä–µ–º—è permission restart
- **–¢—Ä–µ–±–æ–≤–∞–Ω–∏–µ**: –ü—Ä–æ–≤–µ—Ä–∫–∞ `permission_restart.in_progress = false` –ø–µ—Ä–µ–¥ –∞–∫—Ç–∏–≤–∞—Ü–∏–µ–π
- **–ö—Ä–∏—Ç–µ—Ä–∏–π —É—Å–ø–µ—Ö–∞**: –ê–∫—Ç–∏–≤–∞—Ü–∏—è –±–ª–æ–∫–∏—Ä—É–µ—Ç—Å—è –≤–æ –≤—Ä–µ–º—è permission restart

---

## 6. –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è –∫ —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏

### 6.1. –û–±—Ä–∞—Ç–Ω–∞—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å

**REQ-040: Feature flag –¥–ª—è –ø–æ—Å—Ç–µ–ø–µ–Ω–Ω–æ–≥–æ –ø–µ—Ä–µ—Ö–æ–¥–∞**

- **–û–ø–∏—Å–∞–Ω–∏–µ**: –°–∏—Å—Ç–µ–º–∞ –¥–æ–ª–∂–Ω–∞ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—Ç—å feature flag –¥–ª—è –ø–æ—Å—Ç–µ–ø–µ–Ω–Ω–æ–≥–æ –ø–µ—Ä–µ—Ö–æ–¥–∞
- **–¢—Ä–µ–±–æ–≤–∞–Ω–∏–µ**: `audio_route_manager.enabled: false` –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é (—Å—Ç–∞—Ä–∞—è –ª–æ–≥–∏–∫–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç)
- **–ö—Ä–∏—Ç–µ—Ä–∏–π —É—Å–ø–µ—Ö–∞**: –°—Ç–∞—Ä–∞—è –ª–æ–≥–∏–∫–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç –ø—Ä–∏ feature flag OFF, –Ω–æ–≤–∞—è ‚Äî –ø—Ä–∏ ON

**REQ-041: Fallback –Ω–∞ —Å—Ç–∞—Ä—É—é –ª–æ–≥–∏–∫—É**

- **–û–ø–∏—Å–∞–Ω–∏–µ**: –°–∏—Å—Ç–µ–º–∞ –¥–æ–ª–∂–Ω–∞ –∏–º–µ—Ç—å fallback –Ω–∞ —Å—Ç–∞—Ä—É—é –ª–æ–≥–∏–∫—É –ø—Ä–∏ –æ—à–∏–±–∫–∞—Ö
- **–¢—Ä–µ–±–æ–≤–∞–Ω–∏–µ**: –ü—Ä–∏ –æ—à–∏–±–∫–∞—Ö –≤ –Ω–æ–≤–æ–π –ª–æ–≥–∏–∫–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å—Ç–∞—Ä—É—é –ª–æ–≥–∏–∫—É
- **–ö—Ä–∏—Ç–µ—Ä–∏–π —É—Å–ø–µ—Ö–∞**: Fallback —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ

**REQ-042: Kill-switch –¥–ª—è –º–≥–Ω–æ–≤–µ–Ω–Ω–æ–≥–æ –æ—Ç–∫–∞—Ç–∞**

- **–û–ø–∏—Å–∞–Ω–∏–µ**: –°–∏—Å—Ç–µ–º–∞ –¥–æ–ª–∂–Ω–∞ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—Ç—å kill-switch –¥–ª—è –º–≥–Ω–æ–≤–µ–Ω–Ω–æ–≥–æ –æ—Ç–∫–∞—Ç–∞
- **–¢—Ä–µ–±–æ–≤–∞–Ω–∏–µ**: `audio_route_manager.kill_switch: true` ‚Üí –º–≥–Ω–æ–≤–µ–Ω–Ω—ã–π –æ—Ç–∫–∞—Ç –Ω–∞ —Å—Ç–∞—Ä—É—é –ª–æ–≥–∏–∫—É
- **–ö—Ä–∏—Ç–µ—Ä–∏–π —É—Å–ø–µ—Ö–∞**: Kill-switch —Ä–∞–±–æ—Ç–∞–µ—Ç –º–≥–Ω–æ–≤–µ–Ω–Ω–æ

---

### 6.2. –°–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å —Å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–º–∏ —Å–æ–±—ã—Ç–∏—è–º–∏

**REQ-043: –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö —Å–æ–±—ã—Ç–∏–π**

- **–û–ø–∏—Å–∞–Ω–∏–µ**: –í—Å–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ —Å–æ–±—ã—Ç–∏—è EventBus –¥–æ–ª–∂–Ω—ã —Å–æ—Ö—Ä–∞–Ω—è—Ç—å—Å—è
- **–¢—Ä–µ–±–æ–≤–∞–Ω–∏–µ**: `voice.recording_start/stop`, `voice.mic_opened/closed`, `playback.started/completed/failed` —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è
- **–ö—Ä–∏—Ç–µ—Ä–∏–π —É—Å–ø–µ—Ö–∞**: –°—É—â–µ—Å—Ç–≤—É—é—â–∏–µ —Å–æ–±—ã—Ç–∏—è —Ä–∞–±–æ—Ç–∞—é—Ç –∫–∞–∫ —Ä–∞–Ω—å—à–µ

**REQ-044: –ù–æ–≤—ã–µ —Å–æ–±—ã—Ç–∏—è –Ω–µ –∫–æ–Ω—Ñ–ª–∏–∫—Ç—É—é—Ç**

- **–û–ø–∏—Å–∞–Ω–∏–µ**: –ù–æ–≤—ã–µ —Å–æ–±—ã—Ç–∏—è –Ω–µ –¥–æ–ª–∂–Ω—ã –∫–æ–Ω—Ñ–ª–∏–∫—Ç–æ–≤–∞—Ç—å —Å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–º–∏
- **–¢—Ä–µ–±–æ–≤–∞–Ω–∏–µ**: `audio.input.active`, `audio.output.ready`, `audio.device.changed` –Ω–µ –∫–æ–Ω—Ñ–ª–∏–∫—Ç—É—é—Ç
- **–ö—Ä–∏—Ç–µ—Ä–∏–π —É—Å–ø–µ—Ö–∞**: –ù–µ—Ç –∫–æ–Ω—Ñ–ª–∏–∫—Ç–æ–≤ —Å–æ–±—ã—Ç–∏–π

---

## 7. –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è –∫ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏

### 7.1. –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å EventBus

**REQ-045: –ü–æ–¥–ø–∏—Å–∫–∏ –Ω–∞ —Å–æ–±—ã—Ç–∏—è**

- **–û–ø–∏—Å–∞–Ω–∏–µ**: AudioRouteManagerIntegration –¥–æ–ª–∂–µ–Ω –ø–æ–¥–ø–∏—Å—ã–≤–∞—Ç—å—Å—è –Ω–∞ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ —Å–æ–±—ã—Ç–∏—è
- **–¢—Ä–µ–±–æ–≤–∞–Ω–∏–µ**: –ü–æ–¥–ø–∏—Å–∫–∏ –Ω–∞ `voice.recording_start/stop`, `app.mode_changed`, `permissions.first_run_*`
- **–ö—Ä–∏—Ç–µ—Ä–∏–π —É—Å–ø–µ—Ö–∞**: –ü–æ–¥–ø–∏—Å–∫–∏ —Ä–∞–±–æ—Ç–∞—é—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ

**REQ-046: –ü—É–±–ª–∏–∫–∞—Ü–∏–∏ —Å–æ–±—ã—Ç–∏–π**

- **–û–ø–∏—Å–∞–Ω–∏–µ**: AudioRouteManagerIntegration –¥–æ–ª–∂–µ–Ω –ø—É–±–ª–∏–∫–æ–≤–∞—Ç—å –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ —Å–æ–±—ã—Ç–∏—è
- **–¢—Ä–µ–±–æ–≤–∞–Ω–∏–µ**: –ü—É–±–ª–∏–∫–∞—Ü–∏–∏ `audio.input.active`, `audio.output.ready`, `audio.device.changed`
- **–ö—Ä–∏—Ç–µ—Ä–∏–π —É—Å–ø–µ—Ö–∞**: –ü—É–±–ª–∏–∫–∞—Ü–∏–∏ —Ä–∞–±–æ—Ç–∞—é—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ

**REQ-047: –í–∞–ª–∏–¥–∞—Ü–∏—è payload**

- **–û–ø–∏—Å–∞–Ω–∏–µ**: –í—Å–µ —Å–æ–±—ã—Ç–∏—è –¥–æ–ª–∂–Ω—ã –∏–º–µ—Ç—å –≤–∞–ª–∏–¥–∞—Ü–∏—é payload
- **–¢—Ä–µ–±–æ–≤–∞–Ω–∏–µ**: –í–∞–ª–∏–¥–∞—Ü–∏—è —á–µ—Ä–µ–∑ pydantic –∏–ª–∏ dataclasses
- **–ö—Ä–∏—Ç–µ—Ä–∏–π —É—Å–ø–µ—Ö–∞**: –í–∞–ª–∏–¥–∞—Ü–∏—è —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ

---

### 7.2. –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å SimpleModuleCoordinator

**REQ-048: –ü–æ—Ä—è–¥–æ–∫ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏**

- **–û–ø–∏—Å–∞–Ω–∏–µ**: AudioRouteManagerIntegration –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω –≤ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–º –ø–æ—Ä—è–¥–∫–µ
- **–¢—Ä–µ–±–æ–≤–∞–Ω–∏–µ**: –ü–æ–∑–∏—Ü–∏—è 5, –ø–æ—Å–ª–µ PermissionRestart, –¥–æ VoiceRecognition –∏ SpeechPlayback
- **–ö—Ä–∏—Ç–µ—Ä–∏–π —É—Å–ø–µ—Ö–∞**: –ü–æ—Ä—è–¥–æ–∫ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π

**REQ-049: –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏**

- **–û–ø–∏—Å–∞–Ω–∏–µ**: AudioRouteManagerIntegration –¥–æ–ª–∂–µ–Ω –∏–º–µ—Ç—å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
- **–¢—Ä–µ–±–æ–≤–∞–Ω–∏–µ**: –ó–∞–≤–∏—Å–∏—Ç –æ—Ç EventBus, StateManager, ErrorHandler
- **–ö—Ä–∏—Ç–µ—Ä–∏–π —É—Å–ø–µ—Ö–∞**: –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ —Ä–∞–∑—Ä–µ—à–µ–Ω—ã –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ

---

### 7.3. –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–º–∏ –º–æ–¥—É–ª—è–º–∏

**REQ-050: –ê–¥–∞–ø—Ç–∞—Ü–∏—è VoiceRecognitionIntegration**

- **–û–ø–∏—Å–∞–Ω–∏–µ**: VoiceRecognitionIntegration –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –∞–¥–∞–ø—Ç–∏—Ä–æ–≤–∞–Ω–∞ –¥–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è AudioRouteManager
- **–¢—Ä–µ–±–æ–≤–∞–Ω–∏–µ**: Feature flag –ø—Ä–æ–≤–µ—Ä–∫–∞, –ø–æ–ª—É—á–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –∏–∑ AudioRouteManager
- **Fallback**: –°—Ç–∞—Ä–∞—è –ª–æ–≥–∏–∫–∞ –ø—Ä–∏ feature flag OFF
- **–ö—Ä–∏—Ç–µ—Ä–∏–π —É—Å–ø–µ—Ö–∞**: –ê–¥–∞–ø—Ç–∞—Ü–∏—è —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ, fallback —Ä–∞–±–æ—Ç–∞–µ—Ç

**REQ-051: –ê–¥–∞–ø—Ç–∞—Ü–∏—è SpeechPlaybackIntegration**

- **–û–ø–∏—Å–∞–Ω–∏–µ**: SpeechPlaybackIntegration –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –∞–¥–∞–ø—Ç–∏—Ä–æ–≤–∞–Ω–∞ –¥–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è AudioRouteManager
- **–¢—Ä–µ–±–æ–≤–∞–Ω–∏–µ**: Feature flag –ø—Ä–æ–≤–µ—Ä–∫–∞, –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ AVAudioEngine —á–µ—Ä–µ–∑ AudioRouteManager
- **Fallback**: –°—Ç–∞—Ä–∞—è –ª–æ–≥–∏–∫–∞ –ø—Ä–∏ feature flag OFF
- **–ö—Ä–∏—Ç–µ—Ä–∏–π —É—Å–ø–µ—Ö–∞**: –ê–¥–∞–ø—Ç–∞—Ü–∏—è —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ, fallback —Ä–∞–±–æ—Ç–∞–µ—Ç

**REQ-052: –ê–¥–∞–ø—Ç–∞—Ü–∏—è FirstRunPermissionsIntegration**

- **–û–ø–∏—Å–∞–Ω–∏–µ**: FirstRunPermissionsIntegration –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –∞–¥–∞–ø—Ç–∏—Ä–æ–≤–∞–Ω–∞ –¥–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è AudioRouteManager
- **–¢—Ä–µ–±–æ–≤–∞–Ω–∏–µ**: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ AudioRouteManager –¥–ª—è –∞–∫—Ç–∏–≤–∞—Ü–∏–∏ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è –º–∏–∫—Ä–æ—Ñ–æ–Ω–∞
- **Fallback**: –°—Ç–∞—Ä–∞—è –ª–æ–≥–∏–∫–∞ –ø—Ä–∏ feature flag OFF
- **–ö—Ä–∏—Ç–µ—Ä–∏–π —É—Å–ø–µ—Ö–∞**: –ê–¥–∞–ø—Ç–∞—Ü–∏—è —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ, fallback —Ä–∞–±–æ—Ç–∞–µ—Ç

---

## ‚úÖ –ò—Ç–æ–≥–æ–≤—ã–π —á–µ–∫-–ª–∏—Å—Ç —Ç—Ä–µ–±–æ–≤–∞–Ω–∏–π

### –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è

- [x] REQ-001: –ú–≥–Ω–æ–≤–µ–Ω–Ω–æ–µ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤
- [x] REQ-002: –ù–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è –∏–º–µ–Ω —É—Å—Ç—Ä–æ–π—Å—Ç–≤
- [x] REQ-003: –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ transport —Ç–∏–ø–∞
- [x] REQ-004: –ú–∞–ø–ø–∏–Ω–≥ AVFoundation ‚Üí PortAudio
- [x] REQ-005: –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ –º–∞–ø–ø–∏–Ω–≥–∞
- [x] REQ-006: –ï–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω—ã–π –≤–ª–∞–¥–µ–ª–µ—Ü –º–∏–∫—Ä–æ—Ñ–æ–Ω–∞
- [x] REQ-007: –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–µ—Ä–µ–¥ –æ—Ç–∫—Ä—ã—Ç–∏–µ–º –º–∏–∫—Ä–æ—Ñ–æ–Ω–∞
- [x] REQ-008: –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ input —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞
- [x] REQ-009: –ü–æ–¥–¥–µ—Ä–∂–∫–∞ push-to-talk
- [x] REQ-010: –ï–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω—ã–π –≤–ª–∞–¥–µ–ª–µ—Ü output
- [x] REQ-011: –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ output —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞
- [x] REQ-012: –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏—è –∞—É–¥–∏–æ
- [x] REQ-013: –ü–æ–ª—É—á–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è Google SR
- [x] REQ-014: –†–µ—Å–µ–º–ø–ª–∏–Ω–≥ –¥–ª—è Google SR

### –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è

- [x] REQ-015: AVFoundation –¥–ª—è –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏—è —É—Å—Ç—Ä–æ–π—Å—Ç–≤
- [x] REQ-016: PortAudio –¥–ª—è –º–∞–ø–ø–∏–Ω–≥–∞
- [x] REQ-017: sounddevice –¥–ª—è input
- [x] REQ-018: AVAudioEngine –¥–ª—è output
- [x] REQ-019: Input State Machine
- [x] REQ-020: Output State Machine
- [x] REQ-021: Single-flight –º–µ—Ö–∞–Ω–∏–∑–º
- [x] REQ-022: Debounce –º–µ—Ö–∞–Ω–∏–∑–º
- [x] REQ-023: –î–µ—Ç–µ—Ä–º–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Ä–µ—à–µ–Ω–∏—è
- [x] REQ-024: –ó–∞—â–∏—Ç–∞ shared state
- [x] REQ-025: –ï–¥–∏–Ω—ã–π monitoring thread

### –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è –∫ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

- [x] REQ-026: Input switch latency
- [x] REQ-027: Output recreate latency
- [x] REQ-028: UI/voice feedback
- [x] REQ-029: Callback interval —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å
- [x] REQ-030: –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ underruns/overflows

### –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è –∫ –Ω–∞–¥–µ–∂–Ω–æ—Å—Ç–∏

- [x] REQ-031: MIC_BUSY –æ–±—Ä–∞–±–æ—Ç–∫–∞
- [x] REQ-032: NO_INPUT_AVAILABLE –æ–±—Ä–∞–±–æ—Ç–∫–∞
- [x] REQ-033: –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ
- [x] REQ-034: Device storm —É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç—å
- [x] REQ-035: Race conditions —É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç—å
- [x] REQ-036: System default changes —É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç—å

### –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è –∫ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

- [x] REQ-037: –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–π –ø–µ—Ä–µ–¥ –∞–∫—Ç–∏–≤–∞—Ü–∏–µ–π
- [x] REQ-038: –ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞ –≤–æ –≤—Ä–µ–º—è first-run
- [x] REQ-039: –ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞ –≤–æ –≤—Ä–µ–º—è permission restart

### –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è –∫ —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏

- [x] REQ-040: Feature flag –¥–ª—è –ø–æ—Å—Ç–µ–ø–µ–Ω–Ω–æ–≥–æ –ø–µ—Ä–µ—Ö–æ–¥–∞
- [x] REQ-041: Fallback –Ω–∞ —Å—Ç–∞—Ä—É—é –ª–æ–≥–∏–∫—É
- [x] REQ-042: Kill-switch –¥–ª—è –º–≥–Ω–æ–≤–µ–Ω–Ω–æ–≥–æ –æ—Ç–∫–∞—Ç–∞
- [x] REQ-043: –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö —Å–æ–±—ã—Ç–∏–π
- [x] REQ-044: –ù–æ–≤—ã–µ —Å–æ–±—ã—Ç–∏—è –Ω–µ –∫–æ–Ω—Ñ–ª–∏–∫—Ç—É—é—Ç

### –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è –∫ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏

- [x] REQ-045: –ü–æ–¥–ø–∏—Å–∫–∏ –Ω–∞ —Å–æ–±—ã—Ç–∏—è
- [x] REQ-046: –ü—É–±–ª–∏–∫–∞—Ü–∏–∏ —Å–æ–±—ã—Ç–∏–π
- [x] REQ-047: –í–∞–ª–∏–¥–∞—Ü–∏—è payload
- [x] REQ-048: –ü–æ—Ä—è–¥–æ–∫ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏
- [x] REQ-049: –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
- [x] REQ-050: –ê–¥–∞–ø—Ç–∞—Ü–∏—è VoiceRecognitionIntegration
- [x] REQ-051: –ê–¥–∞–ø—Ç–∞—Ü–∏—è SpeechPlaybackIntegration
- [x] REQ-052: –ê–¥–∞–ø—Ç–∞—Ü–∏—è FirstRunPermissionsIntegration

---

**–°—Ç–∞—Ç—É—Å**: ‚úÖ –í—Å–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω—ã, –≥–æ—Ç–æ–≤–æ –∫ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

