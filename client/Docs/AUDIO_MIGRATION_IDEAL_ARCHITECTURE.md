# –ò–¥–µ–∞–ª—å–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –∞—É–¥–∏–æ-—Å–∏—Å—Ç–µ–º—ã (—Å —É—á–µ—Ç–æ–º —Ç–µ–∫—É—â–µ–≥–æ –ø—Ä–æ–µ–∫—Ç–∞)

**–°—Ç–∞—Ç—É—Å**: –ò–¥–µ–∞–ª—å–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –¥–ª—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏  
**–û—Å–Ω–æ–≤–∞–Ω –Ω–∞**: –¢–µ–∫—É—â–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞ + MVP-12 –ø—Ä–æ—Ç–æ—Ç–∏–ø—ã + AUDIO_MIGRATION_MASTER_SPECIFICATION.md

---

## üèóÔ∏è –ò–¥–µ–∞–ª—å–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞: –ü–æ–ª–Ω–∞—è —Å—Ö–µ–º–∞

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ                    –ò–î–ï–ê–õ–¨–ù–ê–Ø –ê–†–•–ò–¢–ï–ö–¢–£–†–ê NEXY                           ‚îÇ
‚îÇ                  (—Å —É—á–µ—Ç–æ–º —Ç–µ–∫—É—â–µ–≥–æ –ø—Ä–æ–µ–∫—Ç–∞)                            ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò

‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ                          1. CORE LAYER                                  ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò

‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê      ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê      ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ EventBus         ‚îÇ      ‚îÇ StateManager      ‚îÇ      ‚îÇ ErrorHandler     ‚îÇ
‚îÇ                  ‚îÇ      ‚îÇ                   ‚îÇ      ‚îÇ                  ‚îÇ
‚îÇ ‚Ä¢ subscribe()    ‚îÇ      ‚îÇ ‚Ä¢ get_state()     ‚îÇ      ‚îÇ ‚Ä¢ handle_error() ‚îÇ
‚îÇ ‚Ä¢ publish()     ‚îÇ      ‚îÇ ‚Ä¢ update_state()   ‚îÇ      ‚îÇ ‚Ä¢ log_error()    ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò      ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò      ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
         ‚îÇ                        ‚îÇ                        ‚îÇ
         ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                                 ‚îÇ
                    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
                    ‚îÇ SimpleModuleCoordinator ‚îÇ
                    ‚îÇ                         ‚îÇ
                    ‚îÇ ‚Ä¢ –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è         ‚îÇ
                    ‚îÇ ‚Ä¢ –ü–æ—Ä—è–¥–æ–∫ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–π    ‚îÇ
                    ‚îÇ ‚Ä¢ –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∂–∏–∑–Ω–µ–Ω–Ω—ã–º  ‚îÇ
                    ‚îÇ   —Ü–∏–∫–ª–æ–º                ‚îÇ
                    ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                                 ‚îÇ
                    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
                    ‚îÇ                         ‚îÇ
                    ‚ñº                         ‚ñº

‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ                     2. INTEGRATION LAYER                                ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò

‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ –ë–õ–û–ö–ò–†–£–Æ–©–ò–ï –ò–ù–¢–ï–ì–†–ê–¶–ò–ò (–∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –¥–æ –æ—Å—Ç–∞–ª—å–Ω—ã—Ö)                    ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò

1. InstanceManagerIntegration
   ‚îî‚îÄ‚Üí –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –µ–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω—ã–º —ç–∫–∑–µ–º–ø–ª—è—Ä–æ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

2. HardwareIdIntegration
   ‚îî‚îÄ‚Üí –ü–æ–ª—É—á–µ–Ω–∏–µ hardware ID

3. FirstRunPermissionsIntegration
   ‚îî‚îÄ‚Üí –ó–∞–ø—Ä–æ—Å —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–π –ø—Ä–∏ –ø–µ—Ä–≤–æ–º –∑–∞–ø—É—Å–∫–µ
   ‚îî‚îÄ‚Üí –ü—É–±–ª–∏–∫—É–µ—Ç: permissions.first_run_started/completed/failed

4. PermissionRestartIntegration
   ‚îî‚îÄ‚Üí –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫ –ø–æ—Å–ª–µ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–π
   ‚îî‚îÄ‚Üí –ü—É–±–ª–∏–∫—É–µ—Ç: permission_restart.scheduled/executing/completed

‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ –ê–£–î–ò–û-–ú–ê–†–®–†–£–¢–ò–ó–ê–¶–ò–Ø (–Ω–æ–≤–∞—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è)                                   ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò

5. AudioRouteManagerIntegration ‚Üê –ù–û–í–û–ï
   ‚îÇ
   ‚îú‚îÄ‚Üí –ú–æ–¥—É–ª—å: modules/audio_route_manager/
   ‚îÇ   ‚îú‚îÄ‚Üí DeviceDiscovery (AVFoundation)
   ‚îÇ   ‚îú‚îÄ‚Üí DeviceMapping (PortAudio)
   ‚îÇ   ‚îú‚îÄ‚Üí RouteManager (—É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏–µ–π)
   ‚îÇ   ‚îú‚îÄ‚Üí ReconcileEngine (–ø—Ä–∏–Ω—è—Ç–∏–µ —Ä–µ—à–µ–Ω–∏–π)
   ‚îÇ   ‚îú‚îÄ‚Üí InputStateMachine (FSM –¥–ª—è input)
   ‚îÇ   ‚îú‚îÄ‚Üí OutputStateMachine (FSM –¥–ª—è output)
   ‚îÇ   ‚îî‚îÄ‚Üí Adapters:
   ‚îÇ       ‚îú‚îÄ‚Üí AVFInputAdapter (sounddevice.InputStream)
   ‚îÇ       ‚îî‚îÄ‚Üí AVFOutputAdapter (AVAudioEngine)
   ‚îÇ
   ‚îú‚îÄ‚Üí –ü–æ–¥–ø–∏—Å–∫–∏:
   ‚îÇ   ‚îú‚îÄ‚Üí voice.recording_start ‚Üí –∑–∞–ø—É—Å–∫ input —á–µ—Ä–µ–∑ reconcile
   ‚îÇ   ‚îú‚îÄ‚Üí voice.recording_stop ‚Üí –æ—Å—Ç–∞–Ω–æ–≤–∫–∞ input
   ‚îÇ   ‚îú‚îÄ‚Üí app.mode_changed ‚Üí –ø—Ä–æ–≤–µ—Ä–∫–∞ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è
   ‚îÇ   ‚îú‚îÄ‚Üí permissions.first_run_* ‚Üí –±–ª–æ–∫–∏—Ä–æ–≤–∫–∞ –∞–∫—Ç–∏–≤–∞—Ü–∏–∏
   ‚îÇ   ‚îî‚îÄ‚Üí permission_restart.* ‚Üí –±–ª–æ–∫–∏—Ä–æ–≤–∫–∞ –∞–∫—Ç–∏–≤–∞—Ü–∏–∏
   ‚îÇ
   ‚îî‚îÄ‚Üí –ü—É–±–ª–∏–∫–∞—Ü–∏–∏:
       ‚îú‚îÄ‚Üí audio.input.active ‚Üí input –≥–æ—Ç–æ–≤
       ‚îú‚îÄ‚Üí audio.output.ready ‚Üí output –≥–æ—Ç–æ–≤
       ‚îú‚îÄ‚Üí audio.device.changed ‚Üí —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –æ —Å–º–µ–Ω–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞
       ‚îî‚îÄ‚Üí audio.route.snapshot ‚Üí –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞

‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ –û–°–ù–û–í–ù–´–ï –ò–ù–¢–ï–ì–†–ê–¶–ò–ò (–∑–∞–≤–∏—Å—è—Ç –æ—Ç AudioRouteManager)                     ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò

6. TrayControllerIntegration
   ‚îî‚îÄ‚Üí –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ tray icon

7. ModeManagementIntegration
   ‚îî‚îÄ‚Üí –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ä–µ–∂–∏–º–∞–º–∏ (SLEEPING/LISTENING/PROCESSING)
   ‚îî‚îÄ‚Üí –ü—É–±–ª–∏–∫—É–µ—Ç: app.mode_changed

8. InputProcessingIntegration
   ‚îî‚îÄ‚Üí –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∫–ª–∞–≤–∏–∞—Ç—É—Ä—ã (KeyboardMonitor)
   ‚îî‚îÄ‚Üí –ü—É–±–ª–∏–∫—É–µ—Ç: voice.recording_start/stop, keyboard.*

9. VoiceRecognitionIntegration ‚Üê –ê–î–ê–ü–¢–ò–†–û–í–ê–ù–ù–ê–Ø
   ‚îÇ
   ‚îú‚îÄ‚Üí –ü–æ–¥–ø–∏—Å–∫–∏:
   ‚îÇ   ‚îú‚îÄ‚Üí voice.recording_start (–æ—Ç InputProcessingIntegration)
   ‚îÇ   ‚îú‚îÄ‚Üí audio.input.active (–æ—Ç AudioRouteManagerIntegration) ‚Üê –ù–û–í–û–ï
   ‚îÇ   ‚îî‚îÄ‚Üí permissions.first_run_* (–±–ª–æ–∫–∏—Ä–æ–≤–∫–∞)
   ‚îÇ
   ‚îú‚îÄ‚Üí –õ–æ–≥–∏–∫–∞ (feature flag):
   ‚îÇ   ‚îú‚îÄ‚Üí –ï—Å–ª–∏ audio_route_manager.enabled = true:
   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚Üí –ü–æ–ª—É—á–∞–µ—Ç –∞—É–¥–∏–æ-–¥–∞–Ω–Ω—ã–µ –∏–∑ AudioRouteManager
   ‚îÇ   ‚îÇ       (–ù–ï —É–ø—Ä–∞–≤–ª—è–µ—Ç –º–∏–∫—Ä–æ—Ñ–æ–Ω–æ–º –Ω–∞–ø—Ä—è–º—É—é)
   ‚îÇ   ‚îî‚îÄ‚Üí –ï—Å–ª–∏ audio_route_manager.enabled = false:
   ‚îÇ       ‚îî‚îÄ‚Üí –°—Ç–∞—Ä–∞—è –ª–æ–≥–∏–∫–∞ (SpeechRecognizer —Å sr.Microphone)
   ‚îÇ
   ‚îî‚îÄ‚Üí –ü—É–±–ª–∏–∫–∞—Ü–∏–∏ (—Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è):
       ‚îú‚îÄ‚Üí voice.mic_opened/closed
       ‚îî‚îÄ‚Üí voice.recognition_*

10. NetworkManagerIntegration
    ‚îî‚îÄ‚Üí –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —Å–µ—Ç–∏
    ‚îî‚îÄ‚Üí –ü—É–±–ª–∏–∫—É–µ—Ç: network.online/offline

11. InterruptManagementIntegration
    ‚îî‚îÄ‚Üí –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–µ—Ä—ã–≤–∞–Ω–∏—è–º–∏
    ‚îî‚îÄ‚Üí –ü–æ–¥–ø–∏—Å—ã–≤–∞–µ—Ç—Å—è: keyboard.short_press, interrupt.request

12. ScreenshotCaptureIntegration
    ‚îî‚îÄ‚Üí –ó–∞—Ö–≤–∞—Ç —Å–∫—Ä–∏–Ω—à–æ—Ç–æ–≤
    ‚îî‚îÄ‚Üí –ü—É–±–ª–∏–∫—É–µ—Ç: screenshot.captured/error

13. GrpcClientIntegration
    ‚îî‚îÄ‚Üí gRPC –∫–ª–∏–µ–Ω—Ç
    ‚îî‚îÄ‚Üí –ü—É–±–ª–∏–∫—É–µ—Ç: grpc.response.audio, grpc.request_completed/failed

14. SpeechPlaybackIntegration ‚Üê –ê–î–ê–ü–¢–ò–†–û–í–ê–ù–ù–ê–Ø
    ‚îÇ
    ‚îú‚îÄ‚Üí –ü–æ–¥–ø–∏—Å–∫–∏:
    ‚îÇ   ‚îú‚îÄ‚Üí grpc.response.audio (–æ—Ç GrpcClientIntegration)
    ‚îÇ   ‚îú‚îÄ‚Üí audio.output.ready (–æ—Ç AudioRouteManagerIntegration) ‚Üê –ù–û–í–û–ï
    ‚îÇ   ‚îî‚îÄ‚Üí playback.cancelled (–æ—Ç InterruptManagementIntegration)
    ‚îÇ
    ‚îú‚îÄ‚Üí –õ–æ–≥–∏–∫–∞ (feature flag):
    ‚îÇ   ‚îú‚îÄ‚Üí –ï—Å–ª–∏ audio_route_manager.enabled = true:
    ‚îÇ   ‚îÇ   ‚îî‚îÄ‚Üí –ò—Å–ø–æ–ª—å–∑—É–µ—Ç AVAudioEngine —á–µ—Ä–µ–∑ AudioRouteManager
    ‚îÇ   ‚îÇ       (–ù–ï —É–ø—Ä–∞–≤–ª—è–µ—Ç output –Ω–∞–ø—Ä—è–º—É—é)
    ‚îÇ   ‚îî‚îÄ‚Üí –ï—Å–ª–∏ audio_route_manager.enabled = false:
    ‚îÇ       ‚îî‚îÄ‚Üí –°—Ç–∞—Ä–∞—è –ª–æ–≥–∏–∫–∞ (SequentialSpeechPlayer —Å sounddevice.OutputStream)
    ‚îÇ
    ‚îî‚îÄ‚Üí –ü—É–±–ª–∏–∫–∞—Ü–∏–∏ (—Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è):
        ‚îú‚îÄ‚Üí playback.started/completed/failed
        ‚îî‚îÄ‚Üí playback.cancelled

15. SignalIntegration
    ‚îî‚îÄ‚Üí –ê—É–¥–∏–æ-—Å–∏–≥–Ω–∞–ª—ã (—Ç–æ–Ω—ã)
    ‚îî‚îÄ‚Üí –ü–æ–¥–ø–∏—Å—ã–≤–∞–µ—Ç—Å—è: voice.mic_opened, playback.completed

16. UpdaterIntegration
    ‚îî‚îÄ‚Üí –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è–º–∏
    ‚îî‚îÄ‚Üí –ü—É–±–ª–∏–∫—É–µ—Ç: updater.in_progress.changed

17. AutostartManagerIntegration
    ‚îî‚îÄ‚Üí –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∞–≤—Ç–æ–∑–∞–ø—É—Å–∫–æ–º

18. WelcomeMessageIntegration
    ‚îî‚îÄ‚Üí –ü—Ä–∏–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ

19. VoiceOverDuckingIntegration
    ‚îî‚îÄ‚Üí Ducking –¥–ª—è VoiceOver

20. ActionExecutionIntegration
    ‚îî‚îÄ‚Üí –í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –¥–µ–π—Å—Ç–≤–∏–π (open_app)
```

---

## üîÑ –î–µ—Ç–∞–ª—å–Ω–∞—è —Å—Ö–µ–º–∞: –ü–æ—Ç–æ–∫ –¥–∞–Ω–Ω—ã—Ö (–∏–¥–µ–∞–ª—å–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞)

### –°—Ü–µ–Ω–∞—Ä–∏–π 1: Push-to-talk (–∑–∞–ø–∏—Å—å)

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ                    PUSH-TO-TALK FLOW                                    ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò

1. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–∞–∂–∏–º–∞–µ—Ç Control+N
   ‚îÇ
   ‚ñº
2. KeyboardMonitor (Quartz/pynput)
   ‚îî‚îÄ‚Üí –ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç: KeyEvent(PRESS)
   ‚îÇ
   ‚ñº
3. InputProcessingIntegration
   ‚îú‚îÄ‚Üí –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç: KeyEvent(PRESS)
   ‚îú‚îÄ‚Üí –ü—É–±–ª–∏–∫—É–µ—Ç: keyboard.press
   ‚îú‚îÄ‚Üí –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç: KeyEvent(LONG_PRESS)
   ‚îî‚îÄ‚Üí –ü—É–±–ª–∏–∫—É–µ—Ç: voice.recording_start {session_id: "123"}
   ‚îÇ
   ‚ñº
4. AudioRouteManagerIntegration
   ‚îú‚îÄ‚Üí –ü–æ–¥–ø–∏—Å—ã–≤–∞–µ—Ç—Å—è: voice.recording_start
   ‚îú‚îÄ‚Üí Reconcile loop:
   ‚îÇ   ‚îú‚îÄ‚Üí –°–æ–∑–¥–∞–µ—Ç Snapshot:
   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚Üí permissions.mic (–∏–∑ StateManager)
   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚Üí firstRun (–∏–∑ StateManager)
   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚Üí appMode (–∏–∑ StateManager)
   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚Üí audio.input.state (–∏–∑ RouteManager)
   ‚îÇ   ‚îÇ
   ‚îÇ   ‚îú‚îÄ‚Üí Gateway: decide_audio_input_start(snapshot)
   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚Üí –ü—Ä–æ–≤–µ—Ä—è–µ—Ç: permissions.mic = granted
   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚Üí –ü—Ä–æ–≤–µ—Ä—è–µ—Ç: firstRun = false
   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚Üí –ü—Ä–æ–≤–µ—Ä—è–µ—Ç: appMode = LISTENING
   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚Üí –†–µ—à–µ–Ω–∏–µ: START
   ‚îÇ   ‚îÇ
   ‚îÇ   ‚îú‚îÄ‚Üí DeviceDiscovery: get_input_devices()
   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚Üí AVFoundation: AVAudioSession.sharedInstance()
   ‚îÇ   ‚îÇ
   ‚îÇ   ‚îú‚îÄ‚Üí DeviceMapping: find_portaudio_match()
   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚Üí PortAudio: sd.query_devices()
   ‚îÇ   ‚îÇ
   ‚îÇ   ‚îî‚îÄ‚Üí AVFInputAdapter: start_stream()
   ‚îÇ       ‚îú‚îÄ‚Üí sounddevice.InputStream(device_index, samplerate, callback)
   ‚îÇ       ‚îî‚îÄ‚Üí input_stream.start()
   ‚îÇ
   ‚îî‚îÄ‚Üí –ü—É–±–ª–∏–∫—É–µ—Ç: audio.input.active {session_id: "123", device_uid: "..."}
   ‚îÇ
   ‚ñº
5. VoiceRecognitionIntegration
   ‚îú‚îÄ‚Üí –ü–æ–¥–ø–∏—Å—ã–≤–∞–µ—Ç—Å—è: audio.input.active
   ‚îú‚îÄ‚Üí –ü–æ–ª—É—á–∞–µ—Ç –∞—É–¥–∏–æ-–¥–∞–Ω–Ω—ã–µ –∏–∑ AudioRouteManager (callback)
   ‚îÇ   ‚îî‚îÄ‚Üí audio_buffer ‚Üí –Ω–∞–∫–æ–ø–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö
   ‚îÇ
   ‚îú‚îÄ‚Üí –ü—É–±–ª–∏–∫—É–µ—Ç: voice.mic_opened {session_id: "123"}
   ‚îÇ   ‚îî‚îÄ‚Üí SignalIntegration —Ä–µ–∞–≥–∏—Ä—É–µ—Ç (–≤–æ—Å–ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç —Ç–æ–Ω)
   ‚îÇ
   ‚îî‚îÄ‚Üí –û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –≤ Google SR:
       ‚îú‚îÄ‚Üí –†–µ—Å–µ–º–ø–ª–∏–Ω–≥: 16k mono
       ‚îú‚îÄ‚Üí speech_recognition.Recognizer().recognize_google()
       ‚îî‚îÄ‚Üí –ü—É–±–ª–∏–∫—É–µ—Ç: voice.recognition_started/completed
   ‚îÇ
   ‚ñº
6. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –æ—Ç–ø—É—Å–∫–∞–µ—Ç Control+N
   ‚îÇ
   ‚ñº
7. InputProcessingIntegration
   ‚îî‚îÄ‚Üí –ü—É–±–ª–∏–∫—É–µ—Ç: voice.recording_stop {session_id: "123"}
   ‚îÇ
   ‚ñº
8. AudioRouteManagerIntegration
   ‚îú‚îÄ‚Üí –ü–æ–¥–ø–∏—Å—ã–≤–∞–µ—Ç—Å—è: voice.recording_stop
   ‚îú‚îÄ‚Üí AVFInputAdapter: stop_stream()
   ‚îÇ   ‚îî‚îÄ‚Üí input_stream.stop() + close()
   ‚îî‚îÄ‚Üí –ü—É–±–ª–∏–∫—É–µ—Ç: audio.input.inactive {session_id: "123"}
   ‚îÇ
   ‚ñº
9. VoiceRecognitionIntegration
   ‚îú‚îÄ‚Üí –ó–∞–≤–µ—Ä—à–∞–µ—Ç —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏–µ
   ‚îî‚îÄ‚Üí –ü—É–±–ª–∏–∫—É–µ—Ç: voice.recognition_completed, voice.mic_closed
```

### –°—Ü–µ–Ω–∞—Ä–∏–π 2: –í–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–µ –æ—Ç–≤–µ—Ç–∞

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ                    PLAYBACK FLOW                                       ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò

1. GrpcClientIntegration
   ‚îî‚îÄ‚Üí –ü—É–±–ª–∏–∫—É–µ—Ç: grpc.response.audio {session_id: "123", audio_bytes: ...}
   ‚îÇ
   ‚ñº
2. SpeechPlaybackIntegration
   ‚îú‚îÄ‚Üí –ü–æ–¥–ø–∏—Å—ã–≤–∞–µ—Ç—Å—è: grpc.response.audio
   ‚îú‚îÄ‚Üí –ü—Ä–æ–≤–µ—Ä—è–µ—Ç: audio.output.ready (–æ—Ç AudioRouteManager)
   ‚îÇ
   ‚îú‚îÄ‚Üí –õ–æ–≥–∏–∫–∞ (feature flag):
   ‚îÇ   ‚îú‚îÄ‚Üí –ï—Å–ª–∏ audio_route_manager.enabled = true:
   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚Üí –ò—Å–ø–æ–ª—å–∑—É–µ—Ç: AudioRouteManager.get_output_adapter()
   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚Üí AVFOutputAdapter: play_audio_chunk()
   ‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚Üí numpy ‚Üí AVAudioPCMBuffer
   ‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚Üí AVAudioPlayerNode.scheduleBuffer_()
   ‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚Üí AVAudioEngine.start()
   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚Üí –ü—É–±–ª–∏–∫—É–µ—Ç: playback.started/completed
   ‚îÇ   ‚îÇ
   ‚îÇ   ‚îî‚îÄ‚Üí –ï—Å–ª–∏ audio_route_manager.enabled = false:
   ‚îÇ       ‚îî‚îÄ‚Üí –°—Ç–∞—Ä–∞—è –ª–æ–≥–∏–∫–∞ (SequentialSpeechPlayer)
   ‚îÇ
   ‚îî‚îÄ‚Üí –ü—É–±–ª–∏–∫—É–µ—Ç: playback.started/completed (—Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –¥–ª—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏)
   ‚îÇ
   ‚ñº
3. ProcessingWorkflow
   ‚îú‚îÄ‚Üí –ü–æ–¥–ø–∏—Å—ã–≤–∞–µ—Ç—Å—è: playback.completed
   ‚îî‚îÄ‚Üí –ü–µ—Ä–µ—Ö–æ–¥ –≤ SLEEPING —Ä–µ–∂–∏–º
```

### –°—Ü–µ–Ω–∞—Ä–∏–π 3: –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ                    DEVICE SWITCHING FLOW                                ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò

1. AudioRouteManagerIntegration (–º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ thread)
   ‚îú‚îÄ‚Üí –ö–∞–∂–¥—É—é —Å–µ–∫—É–Ω–¥—É:
   ‚îÇ   ‚îú‚îÄ‚Üí DeviceDiscovery: get_input_devices() / get_output_devices()
   ‚îÇ   ‚îú‚îÄ‚Üí PortAudio: sd.default.device[0] / sd.default.device[1]
   ‚îÇ   ‚îî‚îÄ‚Üí DeviceMapping: find_portaudio_match()
   ‚îÇ
   ‚îú‚îÄ‚Üí –û–±–Ω–∞—Ä—É–∂–∏–≤–∞–µ—Ç: –∏–∑–º–µ–Ω–µ–Ω–∏–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ (UID –∏–∑–º–µ–Ω–∏–ª—Å—è)
   ‚îÇ
   ‚îú‚îÄ‚Üí Reconcile loop:
   ‚îÇ   ‚îú‚îÄ‚Üí –°–æ–∑–¥–∞–µ—Ç Snapshot:
   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚Üí audio.input.state (active?)
   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚Üí audio.output.state (playing?)
   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚Üí audio.input.device_uid (—Å—Ç–∞—Ä–æ–µ vs –Ω–æ–≤–æ–µ)
   ‚îÇ   ‚îÇ
   ‚îÇ   ‚îú‚îÄ‚Üí Gateway: decide_audio_device_switch(snapshot)
   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚Üí –ü—Ä–æ–≤–µ—Ä—è–µ—Ç: –º–æ–∂–Ω–æ –ª–∏ –ø–µ—Ä–µ–∫–ª—é—á–∞—Ç—å (–Ω–µ –≤–æ –≤—Ä–µ–º—è –∑–∞–ø–∏—Å–∏/–≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏—è?)
   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚Üí –†–µ—à–µ–Ω–∏–µ: SWITCH
   ‚îÇ   ‚îÇ
   ‚îÇ   ‚îî‚îÄ‚Üí –í—ã–ø–æ–ª–Ω—è–µ—Ç –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ:
   ‚îÇ       ‚îú‚îÄ‚Üí Input: AVFInputAdapter.switch_device()
   ‚îÇ       ‚îÇ   ‚îú‚îÄ‚Üí –û—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç —Å—Ç–∞—Ä—ã–π stream
   ‚îÇ       ‚îÇ   ‚îú‚îÄ‚Üí –û—á–∏—â–∞–µ—Ç audio_buffer
   ‚îÇ       ‚îÇ   ‚îî‚îÄ‚Üí –°–æ–∑–¥–∞–µ—Ç –Ω–æ–≤—ã–π stream –Ω–∞ –Ω–æ–≤–æ–º —É—Å—Ç—Ä–æ–π—Å—Ç–≤–µ
   ‚îÇ       ‚îÇ
   ‚îÇ       ‚îî‚îÄ‚Üí Output: AVFOutputAdapter.switch_device()
   ‚îÇ           ‚îú‚îÄ‚Üí –û—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç engine (—Å engine_lock)
   ‚îÇ           ‚îî‚îÄ‚Üí –ü–µ—Ä–µ—Å–æ–∑–¥–∞–µ—Ç engine (–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –Ω–∞ –Ω–æ–≤–æ–º —É—Å—Ç—Ä–æ–π—Å—Ç–≤–µ)
   ‚îÇ
   ‚îî‚îÄ‚Üí –ü—É–±–ª–∏–∫—É–µ—Ç: audio.device.changed {type: "input|output", old_uid, new_uid}
   ‚îÇ
   ‚ñº
2. VoiceRecognitionIntegration / SpeechPlaybackIntegration
   ‚îú‚îÄ‚Üí –ü–æ–¥–ø–∏—Å—ã–≤–∞–µ—Ç—Å—è: audio.device.changed
   ‚îî‚îÄ‚Üí –ê–¥–∞–ø—Ç–∏—Ä—É–µ—Ç—Å—è –∫ –Ω–æ–≤–æ–º—É —É—Å—Ç—Ä–æ–π—Å—Ç–≤—É (–µ—Å–ª–∏ –Ω—É–∂–Ω–æ)
```

---

## üéØ –¢–æ—á–∫–∏ –≤—Ö–æ–¥–∞ –≤ –ø—Ä–æ–µ–∫—Ç

### –¢–æ—á–∫–∞ –≤—Ö–æ–¥–∞ 1: SimpleModuleCoordinator

**–§–∞–π–ª**: `integration/core/simple_module_coordinator.py`

**–ú–µ—Å—Ç–æ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è**:
```python
# –í –º–µ—Ç–æ–¥–µ _create_integrations() –ø–æ—Å–ª–µ PermissionRestartIntegration

# AudioRouteManager Integration (–ù–û–í–ê–Ø)
audio_route_config = config_data.get('audio_route_manager', {})
self.integrations['audio_route_manager'] = AudioRouteManagerIntegration(
    event_bus=self.event_bus,
    state_manager=self.state_manager,
    error_handler=self.error_handler,
    config=audio_route_config
)
```

**–ü–æ—Ä—è–¥–æ–∫ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏**:
- –ü–æ–∑–∏—Ü–∏—è: 5 (–ø–æ—Å–ª–µ PermissionRestart, –ø–µ—Ä–µ–¥ Tray)
- –ü—Ä–∏—á–∏–Ω–∞: –î–æ–ª–∂–µ–Ω –±—ã—Ç—å –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω –¥–æ VoiceRecognition –∏ SpeechPlayback

---

### –¢–æ—á–∫–∞ –≤—Ö–æ–¥–∞ 2: VoiceRecognitionIntegration

**–§–∞–π–ª**: `integration/integrations/voice_recognition_integration.py`

**–ú–µ—Å—Ç–æ –∏–∑–º–µ–Ω–µ–Ω–∏—è**:
```python
# –í –º–µ—Ç–æ–¥–µ __init__()
self._use_audio_route_manager = (
    unified_config.get('audio_route_manager', {}).get('enabled', False) and
    not unified_config.get('audio_route_manager', {}).get('kill_switch', False)
)

# –í –º–µ—Ç–æ–¥–µ _on_recording_start()
async def _on_recording_start(self, event):
    if self._first_run_in_progress:
        return
    
    if self._use_audio_route_manager:
        # –ù–æ–≤–∞—è –ª–æ–≥–∏–∫–∞: AudioRouteManager —É–ø—Ä–∞–≤–ª—è–µ—Ç –º–∏–∫—Ä–æ—Ñ–æ–Ω–æ–º
        session_id = event.get("session_id")
        await self.event_bus.publish("audio.input.request_start", {
            "session_id": session_id
        })
        # –ñ–¥–µ–º audio.input.active –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –∞—É–¥–∏–æ-–¥–∞–Ω–Ω—ã—Ö
    else:
        # –°—Ç–∞—Ä–∞—è –ª–æ–≥–∏–∫–∞ (fallback)
        if not self.config.simulate and self._recognizer:
            await self._recognizer.start_listening()
```

**–ù–æ–≤–∞—è –ø–æ–¥–ø–∏—Å–∫–∞**:
```python
# –í –º–µ—Ç–æ–¥–µ initialize()
await self.event_bus.subscribe("audio.input.active", self._on_audio_input_active, EventPriority.HIGH)
```

---

### –¢–æ—á–∫–∞ –≤—Ö–æ–¥–∞ 3: SpeechPlaybackIntegration

**–§–∞–π–ª**: `integration/integrations/speech_playback_integration.py`

**–ú–µ—Å—Ç–æ –∏–∑–º–µ–Ω–µ–Ω–∏—è**:
```python
# –í –º–µ—Ç–æ–¥–µ __init__()
self._use_audio_route_manager = (
    unified_config.get('audio_route_manager', {}).get('enabled', False) and
    not unified_config.get('audio_route_manager', {}).get('kill_switch', False)
)

# –í –º–µ—Ç–æ–¥–µ _on_audio_chunk()
async def _on_audio_chunk(self, event):
    if self._use_audio_route_manager:
        # –ù–æ–≤–∞—è –ª–æ–≥–∏–∫–∞: –∏—Å–ø–æ–ª—å–∑—É–µ–º AVAudioEngine —á–µ—Ä–µ–∑ AudioRouteManager
        # –ü—Ä–æ–≤–µ—Ä—è–µ–º audio.output.ready –ø–µ—Ä–µ–¥ –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–µ–º
        # –ò—Å–ø–æ–ª—å–∑—É–µ–º AVFOutputAdapter –¥–ª—è –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏—è
    else:
        # –°—Ç–∞—Ä–∞—è –ª–æ–≥–∏–∫–∞ (fallback)
        # –ò—Å–ø–æ–ª—å–∑—É–µ–º SequentialSpeechPlayer –∫–∞–∫ —Ä–∞–Ω—å—à–µ
```

**–ù–æ–≤–∞—è –ø–æ–¥–ø–∏—Å–∫–∞**:
```python
# –í –º–µ—Ç–æ–¥–µ initialize()
await self.event_bus.subscribe("audio.output.ready", self._on_audio_output_ready, EventPriority.HIGH)
```

---

### –¢–æ—á–∫–∞ –≤—Ö–æ–¥–∞ 4: unified_config.yaml

**–§–∞–π–ª**: `config/unified_config.yaml`

**–ú–µ—Å—Ç–æ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è**:
```yaml
# –ù–æ–≤—ã–π —Ä–∞–∑–¥–µ–ª (–¥–æ–±–∞–≤–ª—è–µ—Ç—Å—è –≤ –∫–æ–Ω–µ—Ü —Ñ–∞–π–ª–∞)
audio_route_manager:
  enabled: false  # Feature flag (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –≤—ã–∫–ª—é—á–µ–Ω)
  kill_switch: false  # Kill-switch –¥–ª—è –º–≥–Ω–æ–≤–µ–Ω–Ω–æ–≥–æ –æ—Ç–∫–∞—Ç–∞
  
  device_monitoring_interval_sec: 1.0
  reconcile_debounce_ms: 500
  
  input:
    fallback_samplerates: [48000, 16000, 44100, 48000]
    blocksize: 1024
    auto_device_switch: true
    
  output:
    auto_device_switch: true
    recreate_on_switch: true
```

---

### –¢–æ—á–∫–∞ –≤—Ö–æ–¥–∞ 5: STATE_CATALOG.md

**–§–∞–π–ª**: `Docs/STATE_CATALOG.md`

**–ú–µ—Å—Ç–æ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è**:
```markdown
#### 11) audio.input.state
- **–≤–ª–∞–¥–µ–ª–µ—Ü**: AudioRouteManagerIntegration owner
- **–ø–∏—à–µ—Ç**: `audio_route_manager`
- **—á–∏—Ç–∞–µ—Ç**: `voice_recognition`, `gateways`
- **–∏—Å—Ç–æ—á–Ω–∏–∫ –∏—Å—Ç–∏–Ω—ã**: RouteManager (–≤–Ω—É—Ç—Ä–µ–Ω–Ω–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ)
- **–º–µ—Ç—Ä–∏–∫–∏**: `audio_input_start_success_rate`
- **–ø—Ä–∞–≤–∏–ª–∞ –≤ interaction_matrix.yaml**: `hard_stop` –ø—Ä–∏ `error` ‚Üí `abort_listen`

#### 12) audio.output.state
- **–≤–ª–∞–¥–µ–ª–µ—Ü**: AudioRouteManagerIntegration owner
- **–ø–∏—à–µ—Ç**: `audio_route_manager`
- **—á–∏—Ç–∞–µ—Ç**: `speech_playback`, `gateways`
- **–∏—Å—Ç–æ—á–Ω–∏–∫ –∏—Å—Ç–∏–Ω—ã**: RouteManager (–≤–Ω—É—Ç—Ä–µ–Ω–Ω–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ)
- **–º–µ—Ç—Ä–∏–∫–∏**: `audio_output_start_success_rate`
- **–ø—Ä–∞–≤–∏–ª–∞ –≤ interaction_matrix.yaml**: `graceful` –ø—Ä–∏ `error` ‚Üí `retry`
```

---

### –¢–æ—á–∫–∞ –≤—Ö–æ–¥–∞ 6: interaction_matrix.yaml

**–§–∞–π–ª**: `config/interaction_matrix.yaml`

**–ú–µ—Å—Ç–æ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è**:
```yaml
axes:
  # ... —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –æ—Å–∏ ...
  audio.input.state: [idle, starting, active, stopping, error]
  audio.output.state: [idle, initializing, ready, playing, error]
  audio.input.device_uid: [string]
  audio.output.device_uid: [string]
  audio.reconcile.pending: [true, false]

rules:
  # ... —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –ø—Ä–∞–≤–∏–ª–∞ ...
  
  # Hard stop: audio.input.state = error
  - when: {audio.input.state: error}
    decision: abort
    priority: hard_stop
    gateway: decide_audio_input_start
    description: Audio input in error state - cannot proceed
    
  # Graceful: audio.output.state = error
  - when: {audio.output.state: error}
    decision: retry
    priority: graceful
    gateway: decide_audio_output_start
    description: Audio output in error state - retry with fallback
```

---

### –¢–æ—á–∫–∞ –≤—Ö–æ–¥–∞ 7: gateways.py

**–§–∞–π–ª**: `integration/core/gateways.py`

**–ú–µ—Å—Ç–æ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è**:
```python
# –ù–æ–≤—ã–µ gateway —Ñ—É–Ω–∫—Ü–∏–∏
def decide_audio_input_start(snapshot: Snapshot) -> Decision:
    """–ü—Ä–∏–Ω—è—Ç–∏–µ —Ä–µ—à–µ–Ω–∏—è –æ –∑–∞–ø—É—Å–∫–µ audio input"""
    # –ü—Ä–æ–≤–µ—Ä—è–µ—Ç: permissions.mic, firstRun, appMode, audio.input.state
    # –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç: START, ABORT, RETRY, DEGRADE

def decide_audio_output_start(snapshot: Snapshot) -> Decision:
    """–ü—Ä–∏–Ω—è—Ç–∏–µ —Ä–µ—à–µ–Ω–∏—è –æ –∑–∞–ø—É—Å–∫–µ audio output"""
    # –ü—Ä–æ–≤–µ—Ä—è–µ—Ç: audio.output.state
    # –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç: START, ABORT, RETRY, DEGRADE

def decide_audio_device_switch(snapshot: Snapshot) -> Decision:
    """–ü—Ä–∏–Ω—è—Ç–∏–µ —Ä–µ—à–µ–Ω–∏—è –æ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–∏ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞"""
    # –ü—Ä–æ–≤–µ—Ä—è–µ—Ç: audio.input.state, audio.output.state
    # –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç: SWITCH, ABORT, RETRY
```

---

### –¢–æ—á–∫–∞ –≤—Ö–æ–¥–∞ 8: selectors.py

**–§–∞–π–ª**: `integration/core/selectors.py`

**–ú–µ—Å—Ç–æ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è**:
```python
# –ù–æ–≤—ã–µ selectors
def audio_input_active(snapshot: Snapshot) -> bool:
    """–ü—Ä–æ–≤–µ—Ä–∫–∞: audio input –∞–∫—Ç–∏–≤–µ–Ω"""
    return snapshot.audio_input_state == "active"

def audio_output_ready(snapshot: Snapshot) -> bool:
    """–ü—Ä–æ–≤–µ—Ä–∫–∞: audio output –≥–æ—Ç–æ–≤"""
    return snapshot.audio_output_state == "ready"

def audio_device_changed(snapshot: Snapshot, old_uid: str) -> bool:
    """–ü—Ä–æ–≤–µ—Ä–∫–∞: —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ –∏–∑–º–µ–Ω–∏–ª–æ—Å—å"""
    return snapshot.audio_input_device_uid != old_uid
```

---

## üîÑ –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–º–∏ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞–º–∏

### Workflows

#### ListeningWorkflow

**–¢–µ–∫—É—â–∏–µ –ø–æ–¥–ø–∏—Å–∫–∏**:
- `voice.recording_start` ‚úÖ –°–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è
- `voice.recognition_completed` ‚úÖ –°–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è
- `app.mode_changed` ‚úÖ –°–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è

**–ò–∑–º–µ–Ω–µ–Ω–∏—è**: –ù–ï–¢ (–≤—Å–µ —Å–æ–±—ã—Ç–∏—è —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è)

#### ProcessingWorkflow

**–¢–µ–∫—É—â–∏–µ –ø–æ–¥–ø–∏—Å–∫–∏**:
- `screenshot.captured` ‚úÖ –°–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è
- `grpc.request_completed` ‚úÖ –°–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è
- `playback.completed` ‚úÖ –°–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è

**–ò–∑–º–µ–Ω–µ–Ω–∏—è**: –ù–ï–¢ (–≤—Å–µ —Å–æ–±—ã—Ç–∏—è —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è)

---

### StateManager

**–¢–µ–∫—É—â–∏–µ –æ—Å–∏**:
- `permissions.mic/screen/accessibility`
- `device.input`
- `network`
- `firstRun`
- `appMode`
- `permissions.restart_pending`
- `process.lifecycle`
- `update_in_progress`

**–ù–æ–≤—ã–µ –æ—Å–∏** (–¥–æ–±–∞–≤–ª—è—é—Ç—Å—è):
- `audio.input.state`
- `audio.output.state`
- `audio.input.device_uid`
- `audio.output.device_uid`
- `audio.reconcile.pending`

**–ò–∑–º–µ–Ω–µ–Ω–∏—è**: –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–µ (—Ç–æ–ª—å–∫–æ –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤—ã—Ö –æ—Å–µ–π)

---

### ErrorHandler

**–¢–µ–∫—É—â–∏–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏**:
- `INITIALIZATION`
- `RUNTIME`
- `CONFIGURATION`
- `NETWORK`
- `PERMISSION`
- `UNKNOWN`

**–ù–æ–≤—ã–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏** (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ):
- `AUDIO_INPUT`
- `AUDIO_OUTPUT`
- `AUDIO_ROUTE`

**–ò–∑–º–µ–Ω–µ–Ω–∏—è**: –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–µ (—Ç–æ–ª—å–∫–æ –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤—ã—Ö –∫–∞—Ç–µ–≥–æ—Ä–∏–π, –µ—Å–ª–∏ –Ω—É–∂–Ω–æ)

---

## ‚úÖ –ò—Ç–æ–≥–æ–≤–∞—è –∫–∞—Ä—Ç–∞ —Ç–æ—á–µ–∫ –≤—Ö–æ–¥–∞

| –¢–æ—á–∫–∞ –≤—Ö–æ–¥–∞ | –§–∞–π–ª | –¢–∏–ø –∏–∑–º–µ–Ω–µ–Ω–∏—è | –ö—Ä–∏—Ç–∏—á–Ω–æ—Å—Ç—å |
|-------------|------|---------------|-------------|
| 1. SimpleModuleCoordinator | `integration/core/simple_module_coordinator.py` | –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ | –í—ã—Å–æ–∫–∞—è |
| 2. VoiceRecognitionIntegration | `integration/integrations/voice_recognition_integration.py` | –ê–¥–∞–ø—Ç–∞—Ü–∏—è (feature flag) | –í—ã—Å–æ–∫–∞—è |
| 3. SpeechPlaybackIntegration | `integration/integrations/speech_playback_integration.py` | –ê–¥–∞–ø—Ç–∞—Ü–∏—è (feature flag) | –í—ã—Å–æ–∫–∞—è |
| 4. unified_config.yaml | `config/unified_config.yaml` | –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ | –°—Ä–µ–¥–Ω—è—è |
| 5. STATE_CATALOG.md | `Docs/STATE_CATALOG.md` | –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –æ—Å–µ–π | –°—Ä–µ–¥–Ω—è—è |
| 6. interaction_matrix.yaml | `config/interaction_matrix.yaml` | –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–∞–≤–∏–ª | –°—Ä–µ–¥–Ω—è—è |
| 7. gateways.py | `integration/core/gateways.py` | –î–æ–±–∞–≤–ª–µ–Ω–∏–µ —Ñ—É–Ω–∫—Ü–∏–π | –°—Ä–µ–¥–Ω—è—è |
| 8. selectors.py | `integration/core/selectors.py` | –î–æ–±–∞–≤–ª–µ–Ω–∏–µ —Ñ—É–Ω–∫—Ü–∏–π | –°—Ä–µ–¥–Ω—è—è |
| 9. –ù–æ–≤—ã–π –º–æ–¥—É–ª—å | `modules/audio_route_manager/` | –°–æ–∑–¥–∞–Ω–∏–µ –º–æ–¥—É–ª—è | –í—ã—Å–æ–∫–∞—è |
| 10. –ù–æ–≤–∞—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è | `integration/integrations/audio_route_manager_integration.py` | –°–æ–∑–¥–∞–Ω–∏–µ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ | –í—ã—Å–æ–∫–∞—è |

---

## üéØ –ö—Ä–∏—Ç–µ—Ä–∏–∏ –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏ –∫ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

### –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ

- [x] –í—Å–µ —Ç–æ—á–∫–∏ –≤—Ö–æ–¥–∞ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω—ã
- [x] –ü–æ—Ä—è–¥–æ–∫ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π
- [x] –ù–µ—Ç —Ü–∏–∫–ª–∏—á–µ—Å–∫–∏—Ö –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
- [x] Feature flag —Ä–∞–±–æ—Ç–∞–µ—Ç
- [x] Kill-switch —Ä–∞–±–æ—Ç–∞–µ—Ç

### –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ

- [x] –í—Å–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ —Å–æ–±—ã—Ç–∏—è —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è
- [x] –û–±—Ä–∞—Ç–Ω–∞—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å –æ–±–µ—Å–ø–µ—á–µ–Ω–∞
- [x] –ù–æ–≤—ã–µ —Å–æ–±—ã—Ç–∏—è –Ω–µ –∫–æ–Ω—Ñ–ª–∏–∫—Ç—É—é—Ç
- [x] Workflows –Ω–µ –∑–∞—Ç—Ä–∞–≥–∏–≤–∞—é—Ç—Å—è

### –ü—Ä–æ—Ü–µ—Å—Å–Ω—ã–µ

- [x] STATE_CATALOG.md –æ–±–Ω–æ–≤–ª–µ–Ω
- [x] interaction_matrix.yaml –æ–±–Ω–æ–≤–ª–µ–Ω
- [x] –ö–æ–Ω—Ç—Ä–∞–∫—Ç EventBus —Å–æ–∑–¥–∞–Ω
- [x] –ú–µ—Ç—Ä–∏–∫–∏ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω—ã

---

## üìã –ß–µ–∫-–ª–∏—Å—Ç –ø–µ—Ä–µ–¥ –Ω–∞—á–∞–ª–æ–º —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

- [ ] –°–æ–∑–¥–∞—Ç—å Impact Map –¥–ª—è –≠—Ç–∞–ø–∞ 1
- [ ] –û–±–Ω–æ–≤–∏—Ç—å STATE_CATALOG.md —Å –Ω–æ–≤—ã–º–∏ –æ—Å—è–º–∏
- [ ] –û–±–Ω–æ–≤–∏—Ç—å interaction_matrix.yaml —Å –Ω–æ–≤—ã–º–∏ –ø—Ä–∞–≤–∏–ª–∞–º–∏
- [ ] –°–æ–∑–¥–∞—Ç—å –∫–æ–Ω—Ç—Ä–∞–∫—Ç EventBus –¥–ª—è –Ω–æ–≤—ã—Ö —Å–æ–±—ã—Ç–∏–π
- [ ] –û–±–Ω–æ–≤–∏—Ç—å selectors.py —Å –Ω–æ–≤—ã–º–∏ selectors
- [ ] –û–±–Ω–æ–≤–∏—Ç—å gateways.py —Å –Ω–æ–≤—ã–º–∏ gateway —Ñ—É–Ω–∫—Ü–∏—è–º–∏
- [ ] –ù–∞—á–∞—Ç—å —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—é –≠—Ç–∞–ø–∞ 1 (–º–æ–¥—É–ª—å audio_route_manager)

