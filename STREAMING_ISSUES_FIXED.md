# –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø—Ä–æ–±–ª–µ–º —Å—Ç—Ä–∏–º–∏–Ω–≥–æ–≤–æ–≥–æ —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏—è

## üîç –ù–∞–π–¥–µ–Ω–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã

### –ü—Ä–æ–±–ª–µ–º–∞ 1: –°—Ç—Ä–∏–º–∏–Ω–≥ –Ω–µ –≤–∫–ª—é—á–µ–Ω

**–°–∏–º–ø—Ç–æ–º—ã:**
- –í –ª–æ–≥–∞—Ö: `‚úÖ [AVF] –ú–∏–∫—Ä–æ—Ñ–æ–Ω –æ—Ç–∫—Ä—ã—Ç (batch)` –≤–º–µ—Å—Ç–æ `(—Å—Ç—Ä–∏–º–∏–Ω–≥)`
- –ù–µ—Ç –ª–æ–≥–æ–≤ –æ SFSpeechRecognizer

**–ü—Ä–∏—á–∏–Ω—ã:**
1. `pyobjc-framework-Speech` –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω
2. –†–∞–∑—Ä–µ—à–µ–Ω–∏—è Speech Recognition –Ω–µ –ø–æ–ª—É—á–µ–Ω—ã
3. –ú–æ–¥—É–ª—å –Ω–µ –∏–º–ø–æ—Ä—Ç–∏—Ä—É–µ—Ç—Å—è

**–†–µ—à–µ–Ω–∏–µ:**
- –î–æ–±–∞–≤–ª–µ–Ω–∞ –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –¥–ª—è –≤—ã—è–≤–ª–µ–Ω–∏—è –ø—Ä–∏—á–∏–Ω—ã
- –í –ª–æ–≥–∞—Ö —Ç–µ–ø–µ—Ä—å –±—É–¥–µ—Ç –≤–∏–¥–Ω–æ, –ø–æ—á–µ–º—É —Å—Ç—Ä–∏–º–∏–Ω–≥ –Ω–µ –≤–∫–ª—é—á–µ–Ω

---

### –ü—Ä–æ–±–ª–µ–º–∞ 2: Batch —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏–µ –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç

**–°–∏–º–ø—Ç–æ–º—ã:**
- `‚ö†Ô∏è [AVF] SpeechRecognition –Ω–µ —Ä–∞—Å–ø–æ–∑–Ω–∞–ª –∞—É–¥–∏–æ`
- RMS = 614.21 (–Ω–µ —Ç–∏—à–∏–Ω–∞, –∞—É–¥–∏–æ –∑–∞–ø–∏—Å–∞–Ω–æ)
- Sample rate = 48000Hz

**–ü—Ä–∏—á–∏–Ω–∞:**
- Google Speech API —Ç—Ä–µ–±—É–µ—Ç **16kHz**, –∞ –º—ã –æ—Ç–ø—Ä–∞–≤–ª—è–µ–º **48kHz**

**–†–µ—à–µ–Ω–∏–µ:**
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω —Ä–µ—Å–µ–º–ø–ª–∏–Ω–≥ 48kHz ‚Üí 16kHz –ø–µ—Ä–µ–¥ –æ—Ç–ø—Ä–∞–≤–∫–æ–π –≤ Google Speech API
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `scipy.signal.resample` (–µ—Å–ª–∏ –¥–æ—Å—Ç—É–ø–µ–Ω)
- Fallback –Ω–∞ –ø—Ä–æ—Å—Ç–æ–µ —É—Å—Ä–µ–¥–Ω–µ–Ω–∏–µ, –µ—Å–ª–∏ scipy –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω

---

## ‚úÖ –ß—Ç–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ

### 1. –†–µ—Å–µ–º–ø–ª–∏–Ω–≥ –¥–ª—è batch —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏—è

**–ë—ã–ª–æ:**
```python
# –û—Ç–ø—Ä–∞–≤–ª—è–µ–º 48kHz –≤ Google Speech API (–Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç)
audio_data_obj = sr.AudioData(audio_bytes_int16, sample_rate, 2)  # 48kHz
```

**–°—Ç–∞–ª–æ:**
```python
# –ö–æ–Ω–≤–µ—Ä—Ç–∏—Ä—É–µ–º 48kHz ‚Üí 16kHz –ø–µ—Ä–µ–¥ –æ—Ç–ø—Ä–∞–≤–∫–æ–π
target_sample_rate = 16000  # Google Speech API —Å—Ç–∞–Ω–¥–∞—Ä—Ç
if sample_rate != target_sample_rate:
    from scipy import signal
    audio_array_float32 = signal.resample(audio_array_float32, num_samples)
    sample_rate = target_sample_rate

audio_data_obj = sr.AudioData(audio_bytes_int16, sample_rate, 2)  # 16kHz
```

---

### 2. –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ —Å—Ç—Ä–∏–º–∏–Ω–≥–∞

**–î–æ–±–∞–≤–ª–µ–Ω–æ:**
- –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è –ø–µ—Ä–µ–¥ –ø—Ä–æ–≤–µ—Ä–∫–æ–π —Å—Ç—Ä–∏–º–∏–Ω–≥–∞
- –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
- –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞ `is_available()`
- –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–∏—á–∏–Ω –æ—Ç–∫–ª—é—á–µ–Ω–∏—è —Å—Ç—Ä–∏–º–∏–Ω–≥–∞

**–¢–µ–ø–µ—Ä—å –≤ –ª–æ–≥–∞—Ö –±—É–¥–µ—Ç:**
```
üîç [SFSpeech] –ü—Ä–æ–≤–µ—Ä–∫–∞ —É—Å–ª–æ–≤–∏–π: _use_avf=True, _SF_SPEECH_AVAILABLE=True
üîç [SFSpeech] –ü–∞—Ä–∞–º–µ—Ç—Ä—ã: streaming_enabled=True, disable_streaming_env=False, _use_streaming=True
üîç [SFSpeech] –°–æ–∑–¥–∞–Ω–∏–µ SFSpeechRecognizerWrapper: language=en-US, on_device=True
üîç [SFSpeech] –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏...
üîç [SFSpeech] is_available() –≤–µ—Ä–Ω—É–ª: True/False
```

---

## üöÄ –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

### 1. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å Speech framework

```bash
pip3 install --break-system-packages pyobjc-framework-Speech
```

### 2. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è

–°–∏—Å—Ç–µ–º–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ ‚Üí –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å ‚Üí –ö–æ–Ω—Ñ–∏–¥–µ–Ω—Ü–∏–∞–ª—å–Ω–æ—Å—Ç—å ‚Üí –†–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏–µ —Ä–µ—á–∏ ‚Üí —Ä–∞–∑—Ä–µ—à–∏—Ç—å –¥–ª—è Nexy

### 3. –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ

```bash
python3 main.py
```

### 4. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏

**–î–ª—è —Å—Ç—Ä–∏–º–∏–Ω–≥–∞:**
```bash
grep "SFSpeech\|SPEECH" /var/folders/ys/xlx_chms3hqcs1lfyq37395c0000gn/T/nexy_debug.log
```

**–î–ª—è batch:**
```bash
grep "–†–µ—Å–µ–º–ø–ª–∏–Ω–≥\|16kHz\|48kHz" /var/folders/ys/xlx_chms3hqcs1lfyq37395c0000gn/T/nexy_debug.log
```

---

## üìä –û–∂–∏–¥–∞–µ–º—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã

### –ü–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π:

**Batch —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏–µ:**
```
üîÑ [AVF] –†–µ—Å–µ–º–ø–ª–∏–Ω–≥: 48000Hz ‚Üí 16000Hz (480000 ‚Üí 160000 samples)
üé§ [AVF] –ù–∞—á–∏–Ω–∞–µ–º —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏–µ: 320000 bytes, 16000Hz
‚úÖ [AVF] –†–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏–µ —É—Å–ø–µ—à–Ω–æ: 'Hello world' (session=...)
```

**–°—Ç—Ä–∏–º–∏–Ω–≥ (–ø–æ—Å–ª–µ —É—Å—Ç–∞–Ω–æ–≤–∫–∏ Speech framework):**
```
‚úÖ [SFSpeech] –°—Ç—Ä–∏–º–∏–Ω–≥–æ–≤–æ–µ —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏–µ –≤–∫–ª—é—á–µ–Ω–æ: language=en-US, on_device=True, timeout=5.0s
‚úÖ [AVF] –ú–∏–∫—Ä–æ—Ñ–æ–Ω –æ—Ç–∫—Ä—ã—Ç (—Å—Ç—Ä–∏–º–∏–Ω–≥) –¥–ª—è session ...
üé§ [SFSpeech] –û—Ç–ø—Ä–∞–≤–ª–µ–Ω —á–∞–Ω–∫: 38400 bytes
‚úÖ [SFSpeech] –°—Ç—Ä–∏–º–∏–Ω–≥–æ–≤—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç: 'Hello world' (session=...)
```

---

## ‚úÖ –ì–æ—Ç–æ–≤–æ –∫ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—é

–í—Å–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø—Ä–∏–º–µ–Ω–µ–Ω—ã:
- ‚úÖ –†–µ—Å–µ–º–ø–ª–∏–Ω–≥ 48kHz ‚Üí 16kHz –¥–ª—è batch
- ‚úÖ –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ —Å—Ç—Ä–∏–º–∏–Ω–≥–∞
- ‚úÖ –£–ª—É—á—à–µ–Ω–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

–ü–æ—Å–ª–µ —É—Å—Ç–∞–Ω–æ–≤–∫–∏ `pyobjc-framework-Speech` —Å—Ç—Ä–∏–º–∏–Ω–≥ –¥–æ–ª–∂–µ–Ω –∑–∞—Ä–∞–±–æ—Ç–∞—Ç—å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏.



