# –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –ø—Ä–æ–±–ª–µ–º—ã —Å –∏–∫–æ–Ω–∫–æ–π –≤ –º–µ–Ω—é –±–∞—Ä–µ

## –ü—Ä–æ–±–ª–µ–º–∞
–ò–∫–æ–Ω–∫–∞ –Ω–µ –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è –≤ –º–µ–Ω—é –±–∞—Ä–µ –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ —á–µ—Ä–µ–∑ .app, –Ω–æ —Ä–∞–±–æ—Ç–∞–µ—Ç –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ —á–µ—Ä–µ–∑ —Ç–µ—Ä–º–∏–Ω–∞–ª.

## –î–∏–∞–≥–Ω–æ—Å—Ç–∏—á–µ—Å–∫–∏–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã

–Ø –¥–æ–±–∞–≤–∏–ª —Å–ª–µ–¥—É—é—â–∏–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã –¥–ª—è –≤—ã—è–≤–ª–µ–Ω–∏—è –ø—Ä–æ–±–ª–µ–º—ã:

### 1. –î–µ—Ç–∞–ª—å–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ menu_handler.py

–í —Ñ–∞–π–ª [modules/tray_controller/macos/menu_handler.py](modules/tray_controller/macos/menu_handler.py) –¥–æ–±–∞–≤–ª–µ–Ω–æ –¥–µ—Ç–∞–ª—å–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ:
- –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏—è —Ñ–∞–π–ª–∞ –∏–∫–æ–Ω–∫–∏
- –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—É—Ç–µ–π –∫ —Ñ–∞–π–ª–∞–º
- –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è (TMPDIR)
- –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—á–µ–π –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏

### 2. –°–∫—Ä–∏–ø—Ç –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ –ª–æ–≥–æ–≤

```bash
./scripts/watch_app_logs.sh
```

–≠—Ç–æ—Ç —Å–∫—Ä–∏–ø—Ç –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –ª–æ–≥–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –µ–≥–æ —Ç–∞–∫:

1. –ó–∞–ø—É—Å—Ç–∏—Ç–µ —Å–∫—Ä–∏–ø—Ç –≤ –æ–¥–Ω–æ–º —Ç–µ—Ä–º–∏–Ω–∞–ª–µ:
   ```bash
   cd /Users/sergiyzasorin/Development/Nexy/client
   ./scripts/watch_app_logs.sh
   ```

2. –í –¥—Ä—É–≥–æ–º —Ç–µ—Ä–º–∏–Ω–∞–ª–µ –∑–∞–ø—É—Å—Ç–∏—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∏–ª–∏ –ø–µ—Ä–µ—Å–æ–±–µ—Ä–∏—Ç–µ –µ–≥–æ

3. –°–ª–µ–¥–∏—Ç–µ –∑–∞ –ª–æ–≥–∞–º–∏ —Å –º–µ—Ç–∫–æ–π üîç –î–ò–ê–ì–ù–û–°–¢–ò–ö–ê

### 3. –î–∏–∞–≥–Ω–æ—Å—Ç–∏—á–µ—Å–∫–∏–π —Å–∫—Ä–∏–ø—Ç

```bash
python3 scripts/diagnose_icon_issue.py
```

–≠—Ç–æ—Ç —Å–∫—Ä–∏–ø—Ç –ø—Ä–æ–≤–µ—Ä—è–µ—Ç:
- –î–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–π
- –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å —Å–æ–∑–¥–∞–Ω–∏—è –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤
- –î–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å PIL/Pillow
- –î–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å rumps
- –†–∞–±–æ—Ç—É –º–æ–¥—É–ª—è tray_icon

## –®–∞–≥–∏ –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏

### –®–∞–≥ 1: –ó–∞–ø—É—Å—Ç–∏—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∏–∑ —Ç–µ—Ä–º–∏–Ω–∞–ª–∞ (–≥–¥–µ –æ–Ω–æ —Ä–∞–±–æ—Ç–∞–µ—Ç)

```bash
cd /Users/sergiyzasorin/Development/Nexy/client
python3 main.py
```

–û–±—Ä–∞—Ç–∏—Ç–µ –≤–Ω–∏–º–∞–Ω–∏–µ –Ω–∞ –ª–æ–≥–∏ —Å –º–µ—Ç–∫–æ–π üîç –î–ò–ê–ì–ù–û–°–¢–ò–ö–ê. –ó–∞–ø–∏—à–∏—Ç–µ:
- –ü—É—Ç—å –∫ –∏–∫–æ–Ω–∫–µ (icon_path)
- –ó–Ω–∞—á–µ–Ω–∏–µ TMPDIR
- Current working directory

### –®–∞–≥ 2: –ó–∞–ø—É—Å—Ç–∏—Ç–µ –¥–∏–∞–≥–Ω–æ—Å—Ç–∏—á–µ—Å–∫–∏–π —Å–∫—Ä–∏–ø—Ç

```bash
python3 scripts/diagnose_icon_issue.py
```

–ü—Ä–æ–≤–µ—Ä—å—Ç–µ, –≤—Å–µ –ª–∏ –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø—Ä–æ—à–ª–∏ —É—Å–ø–µ—à–Ω–æ (‚úÖ).

### –®–∞–≥ 3: –ü–µ—Ä–µ—Å–æ–±–µ—Ä–∏—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —Å –Ω–æ–≤—ã–º –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ–º

**–í–ê–ñ–ù–û:** –°–Ω–∞—á–∞–ª–∞ –Ω—É–∂–Ω–æ –ø–µ—Ä–µ—Å–æ–±—Ä–∞—Ç—å .app —Å –æ–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–º –∫–æ–¥–æ–º –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è!

```bash
cd /Users/sergiyzasorin/Development/Nexy/client
./packaging/build_test_quick.sh
```

–≠—Ç–æ —Å–æ–∑–¥–∞—Å—Ç —Ç–µ—Å—Ç–æ–≤—ã–π .app bundle –≤ `/tmp/Nexy-test.app`.

### –®–∞–≥ 4: –ó–∞–ø—É—Å—Ç–∏—Ç–µ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –ª–æ–≥–æ–≤

–í –æ–¥–Ω–æ–º —Ç–µ—Ä–º–∏–Ω–∞–ª–µ:
```bash
./scripts/watch_app_logs.sh
```

### –®–∞–≥ 5: –ó–∞–ø—É—Å—Ç–∏—Ç–µ .app bundle

–í –¥—Ä—É–≥–æ–º —Ç–µ—Ä–º–∏–Ω–∞–ª–µ:
```bash
open /tmp/Nexy-test.app
```

–ò–õ–ò –∑–∞–ø—É—Å—Ç–∏—Ç–µ –Ω–∞–ø—Ä—è–º—É—é:
```bash
/tmp/Nexy-test.app/Contents/MacOS/Nexy
```

### –®–∞–≥ 6: –ü—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä—É–π—Ç–µ –ª–æ–≥–∏

–°–º–æ—Ç—Ä–∏—Ç–µ –Ω–∞ –ª–æ–≥–∏ –≤ –ø–µ—Ä–≤–æ–º —Ç–µ—Ä–º–∏–Ω–∞–ª–µ. –ò—â–∏—Ç–µ:

#### –ß—Ç–æ –∏—Å–∫–∞—Ç—å –≤ –ª–æ–≥–∞—Ö:

1. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å–æ–∑–¥–∞–Ω–∏–µ –∏–∫–æ–Ω–∫–∏:**
   ```
   üîç –î–ò–ê–ì–ù–û–°–¢–ò–ö–ê: create_app –≤—ã–∑–≤–∞–Ω —Å icon_path='...'
   ```
   - –ü—É—Ç—å –∫ –∏–∫–æ–Ω–∫–µ –¥–æ–ª–∂–µ–Ω —Å—É—â–µ—Å—Ç–≤–æ–≤–∞—Ç—å
   - `os.path.exists(icon_path)` –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å True

2. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è:**
   ```
   üîç –î–ò–ê–ì–ù–û–°–¢–ò–ö–ê: TMPDIR=...
   üîç –î–ò–ê–ì–ù–û–°–¢–ò–ö–ê: Current working directory=...
   ```

3. **–ò—â–∏—Ç–µ –æ—à–∏–±–∫–∏:**
   ```
   ‚ùå –î–ò–ê–ì–ù–û–°–¢–ò–ö–ê: –ò–∫–æ–Ω–∫–∞ –ù–ï —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –∏–ª–∏ –ø—É—Ç—å –ø—É—Å—Ç–æ–π!
   ```

### –®–∞–≥ 7: –°—Ä–∞–≤–Ω–∏—Ç–µ –ª–æ–≥–∏

–°—Ä–∞–≤–Ω–∏—Ç–µ –ª–æ–≥–∏ –∏–∑ –®–∞–≥–∞ 1 (—Ç–µ—Ä–º–∏–Ω–∞–ª) –∏ –®–∞–≥–∞ 5 (.app). –ù–∞–π–¥–∏—Ç–µ —Ä–∞–∑–ª–∏—á–∏—è:

- **–†–∞–∑–Ω—ã–µ –ø—É—Ç–∏ –∫ –∏–∫–æ–Ω–∫–∞–º?**
- **–†–∞–∑–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è TMPDIR?**
- **–†–∞–∑–Ω—ã–µ —Ä–∞–±–æ—á–∏–µ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏?**
- **–§–∞–π–ª –∏–∫–æ–Ω–∫–∏ –Ω–µ —Å–æ–∑–¥–∞–µ—Ç—Å—è –≤ .app?**

## –í–æ–∑–º–æ–∂–Ω—ã–µ –ø—Ä–∏—á–∏–Ω—ã –∏ —Ä–µ—à–µ–Ω–∏—è

### –ü—Ä–∏—á–∏–Ω–∞ 1: PIL/Pillow –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω –≤ .app bundle

**–ü—Ä–æ–≤–µ—Ä–∫–∞:** –í –ª–æ–≥–∞—Ö .app –±—É–¥–µ—Ç:
```
‚ö†Ô∏è –û—à–∏–±–∫–∞ —Å–æ–∑–¥–∞–Ω–∏—è –∏–∫–æ–Ω–∫–∏ —á–µ—Ä–µ–∑ Pillow: ...
```

**–†–µ—à–µ–Ω–∏–µ:** –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ PIL –≤–∫–ª—é—á–µ–Ω –≤ spec —Ñ–∞–π–ª –∏ –ø—Ä–∞–≤–∏–ª—å–Ω–æ —É–ø–∞–∫–æ–≤–∞–Ω.

### –ü—Ä–∏—á–∏–Ω–∞ 2: –ü—Ä–æ–±–ª–µ–º—ã —Å –ø—Ä–∞–≤–∞–º–∏ –¥–æ—Å—Ç—É–ø–∞ –∫ TMPDIR

**–ü—Ä–æ–≤–µ—Ä–∫–∞:** –í –ª–æ–≥–∞—Ö .app TMPDIR –æ—Ç–ª–∏—á–∞–µ—Ç—Å—è –æ—Ç —Ç–µ—Ä–º–∏–Ω–∞–ª–∞ –∏–ª–∏ –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω.

**–†–µ—à–µ–Ω–∏–µ:** –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—É—é –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é –¥–ª—è –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤.

### –ü—Ä–∏—á–∏–Ω–∞ 3: –ò–∫–æ–Ω–∫–∞ —Å–æ–∑–¥–∞–µ—Ç—Å—è, –Ω–æ rumps –Ω–µ –º–æ–∂–µ—Ç –µ—ë –∑–∞–≥—Ä—É–∑–∏—Ç—å

**–ü—Ä–æ–≤–µ—Ä–∫–∞:** –í –ª–æ–≥–∞—Ö:
```
‚úÖ –î–ò–ê–ì–ù–û–°–¢–ò–ö–ê: –ò–∫–æ–Ω–∫–∞ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç, —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º...
‚ùå –î–ò–ê–ì–ù–û–°–¢–ò–ö–ê: –û—à–∏–±–∫–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –∏–∫–æ–Ω–∫–∏: ...
```

**–†–µ—à–µ–Ω–∏–µ:** –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ñ–æ—Ä–º–∞—Ç –∏ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ PNG —Ñ–∞–π–ª–∞.

### –ü—Ä–∏—á–∏–Ω–∞ 4: –ü—Ä–æ–±–ª–µ–º—ã —Å –∫–æ–¥–∏—Ä–æ–≤–∫–æ–π –ø—É—Ç–µ–π

**–ü—Ä–æ–≤–µ—Ä–∫–∞:** –ü—É—Ç—å –∫ –∏–∫–æ–Ω–∫–µ —Å–æ–¥–µ—Ä–∂–∏—Ç –∫–∏—Ä–∏–ª–ª–∏—Ü—É –∏–ª–∏ —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã–µ —Å–∏–º–≤–æ–ª—ã.

**–†–µ—à–µ–Ω–∏–µ:** –£–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ –≤—Å–µ –ø—É—Ç–∏ –≤ ASCII –∏–ª–∏ –ø—Ä–∞–≤–∏–ª—å–Ω–æ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—é—Ç—Å—è.

## –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

–ü–æ—Å–ª–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏ —É –≤–∞—Å –±—É–¥–µ—Ç –ø–æ–ª–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Ç–æ–º, –Ω–∞ –∫–∞–∫–æ–º —ç—Ç–∞–ø–µ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç —Å–±–æ–π. –°–æ–æ–±—â–∏—Ç–µ –º–Ω–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã, –∏ –º—ã —Å–º–æ–∂–µ–º —Ç–æ—á–Ω–æ –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å –∏ –∏—Å–ø—Ä–∞–≤–∏—Ç—å –ø—Ä–æ–±–ª–µ–º—É.

## –ë—ã—Å—Ç—Ä–∞—è –∫–æ–º–∞–Ω–¥–∞ –¥–ª—è –ø–æ–ª–Ω–æ–π –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏

```bash
# –¢–µ—Ä–º–∏–Ω–∞–ª 1
cd /Users/sergiyzasorin/Development/Nexy/client
./scripts/watch_app_logs.sh

# –¢–µ—Ä–º–∏–Ω–∞–ª 2
cd /Users/sergiyzasorin/Development/Nexy/client

# –ó–∞–ø—É—Å—Ç–∏—Ç—å –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫—É –∏–∑ —Ç–µ—Ä–º–∏–Ω–∞–ª–∞
echo "=== –¢–ï–°–¢ 1: –î–∏–∞–≥–Ω–æ—Å—Ç–∏—á–µ—Å–∫–∏–π —Å–∫—Ä–∏–ø—Ç ==="
python3 scripts/diagnose_icon_issue.py

# –ó–∞–ø—É—Å—Ç–∏—Ç—å main.py –∏ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏
echo "=== –¢–ï–°–¢ 2: –ó–∞–ø—É—Å–∫ –∏–∑ —Ç–µ—Ä–º–∏–Ω–∞–ª–∞ ==="
python3 main.py
# (–ø–æ–¥–æ–∂–¥–∏—Ç–µ 5 —Å–µ–∫—É–Ω–¥, –∑–∞—Ç–µ–º Ctrl+C)

# –ü–µ—Ä–µ—Å–æ–±—Ä–∞—Ç—å –∏ –∑–∞–ø—É—Å—Ç–∏—Ç—å .app
echo "=== –¢–ï–°–¢ 3: –ü–µ—Ä–µ—Å–±–æ—Ä–∫–∞ ==="
./packaging/build_test_quick.sh

echo "=== –¢–ï–°–¢ 4: –ó–∞–ø—É—Å–∫ .app ==="
open /tmp/Nexy-test.app
# –°–º–æ—Ç—Ä–∏—Ç–µ –ª–æ–≥–∏ –≤ –¢–µ—Ä–º–∏–Ω–∞–ª–µ 1
```
