;
var __create = Object.create;
var __defProp = Object.defineProperty;
var __getOwnPropDesc = Object.getOwnPropertyDescriptor;
var __getOwnPropNames = Object.getOwnPropertyNames;
var __getProtoOf = Object.getPrototypeOf;
var __hasOwnProp = Object.prototype.hasOwnProperty;
var __copyProps = (to, from, except, desc) => {
  if (from && typeof from === "object" || typeof from === "function") {
    for (let key of __getOwnPropNames(from))
      if (!__hasOwnProp.call(to, key) && key !== except)
        __defProp(to, key, { get: () => from[key], enumerable: !(desc = __getOwnPropDesc(from, key)) || desc.enumerable });
  }
  return to;
};
var __toESM = (mod, isNodeMode, target) => (target = mod != null ? __create(__getProtoOf(mod)) : {}, __copyProps(
  // If the importer is in node compatibility mode or this is not an ESM
  // file that has been converted to a CommonJS file using a Babel-
  // compatible transform (i.e. "__esModule" has not been set), then set
  // "default" to the CommonJS "module.exports" for node compatibility.
  isNodeMode || !mod || !mod.__esModule ? __defProp(target, "default", { value: mod, enumerable: true }) : target,
  mod
));
const _0x54a1b7 = _0x1d03;
(function(_0x127bee, _0x396a9f) {
  const _0xfaec3 = _0x1d03, _0x2bb4ae = _0x127bee();
  while (!![]) {
    try {
      const _0x20d99e = -parseInt(_0xfaec3(752)) / 1 * (parseInt(_0xfaec3(1436)) / 2) + parseInt(_0xfaec3(453)) / 3 * (parseInt(_0xfaec3(1344)) / 4) + -parseInt(_0xfaec3(1432)) / 5 + -parseInt(_0xfaec3(1597)) / 6 + parseInt(_0xfaec3(748)) / 7 * (-parseInt(_0xfaec3(1047)) / 8) + parseInt(_0xfaec3(456)) / 9 + -parseInt(_0xfaec3(1253)) / 10 * (-parseInt(_0xfaec3(265)) / 11);
      if (_0x20d99e === _0x396a9f) break;
      else _0x2bb4ae["push"](_0x2bb4ae["shift"]());
    } catch (_0x18b8d5) {
      _0x2bb4ae["push"](_0x2bb4ae["shift"]());
    }
  }
})(_0x475e, 220507);
const _0x5c88d3 = /* @__PURE__ */ (function() {
  let _0x5dddf1 = !![];
  return function(_0x254151, _0x5eea58) {
    const _0x3d155c = _0x5dddf1 ? function() {
      const _0x5cc3cf = _0x1d03;
      if (_0x5eea58) {
        const _0x233ce1 = _0x5eea58[_0x5cc3cf(880)](_0x254151, arguments);
        return _0x5eea58 = null, _0x233ce1;
      }
    } : function() {
    };
    return _0x5dddf1 = ![], _0x3d155c;
  };
})(), _0x28a529 = _0x5c88d3(exports, function() {
  const _0x45c777 = _0x1d03, _0x5e4904 = function() {
    const _0x352a58 = _0x1d03;
    let _0xe11e02;
    try {
      _0xe11e02 = Function(_0x352a58(1772) + _0x352a58(1758) + ");")();
    } catch (_0x26a2f1) {
      _0xe11e02 = window;
    }
    return _0xe11e02;
  }, _0x13f7b2 = _0x5e4904(), _0x356f18 = _0x13f7b2[_0x45c777(152)] = _0x13f7b2[_0x45c777(152)] || {}, _0x4f8f2f = [_0x45c777(926), _0x45c777(1697), _0x45c777(1341), _0x45c777(981), _0x45c777(580), _0x45c777(1675), _0x45c777(911)];
  for (let _0x212c63 = 0; _0x212c63 < _0x4f8f2f[_0x45c777(1115)]; _0x212c63++) {
    const _0x2e7567 = _0x5c88d3[_0x45c777(906)][_0x45c777(867)][_0x45c777(334)](_0x5c88d3), _0x297fb3 = _0x4f8f2f[_0x212c63], _0xd8eaa6 = _0x356f18[_0x297fb3] || _0x2e7567;
    _0x2e7567[_0x45c777(1272)] = _0x5c88d3[_0x45c777(334)](_0x5c88d3), _0x2e7567[_0x45c777(1450)] = _0xd8eaa6[_0x45c777(1450)][_0x45c777(334)](_0xd8eaa6), _0x356f18[_0x297fb3] = _0x2e7567;
  }
});
_0x28a529();
"use strict";
Object[_0x54a1b7(634)](exports, Symbol[_0x54a1b7(1177)], { "value": _0x54a1b7(1416) });
const dotenv = require("dotenv"), posthogNode = require(_0x54a1b7(1598)), Store = require("electron-store"), crypto$1 = require("crypto"), codegenv2 = require("@bufbuild/protobuf/codegenv2"), wkt = require("@bufbuild/protobuf/wkt"), electron = require("electron"), utils = require("@electron-toolkit/utils"), path = require("path"), url = require("url"), fs = require("fs"), os = require("os"), log = require("electron-log"), electronUpdater = require("electron-updater"), connect = require("@connectrpc/connect"), connectNode = require("@connectrpc/connect-node"), protobuf = require("@bufbuild/protobuf"), sqlite3 = require(_0x54a1b7(1126)), uuid = require("uuid"), child_process = require(_0x54a1b7(1281)), events = require(_0x54a1b7(784)), psl = require(_0x54a1b7(849)), nlp = require(_0x54a1b7(264)), nodeMachineId = require("node-machine-id"), STORE_KEYS = { "AUTH": _0x54a1b7(1808), "USER_PROFILE": "userProfile", "ID_TOKEN": "idToken", "ACCESS_TOKEN": _0x54a1b7(641), "MAIN": _0x54a1b7(944), "ONBOARDING": "onboarding", "SETTINGS": "settings", "OPEN_MIC": _0x54a1b7(1423), "SELECTED_AUDIO_INPUT": _0x54a1b7(961), "TOGGLE_SOUNDS": _0x54a1b7(377), "APP_INITIALIZED": _0x54a1b7(1750) }, storeKeys = Object[_0x54a1b7(502)](Object[_0x54a1b7(634)]({ "__proto__": null, "STORE_KEYS": STORE_KEYS }, Symbol[_0x54a1b7(1177)], { "value": _0x54a1b7(1416) })), file_buf_validate_validate = codegenv2[_0x54a1b7(1800)]("ChtidWYvdmFsaWRhdGUvdmFsaWRhdGUucHJvdG8SDGJ1Zi52YWxpZGF0ZSI3CgRSdWxlEgoKAmlkGAEgASgJEg8KB21lc3NhZ2UYAiABKAkSEgoKZXhwcmVzc2lvbhgDIAEoCSKGAQoMTWVzc2FnZVJ1bGVzEhYKDmNlbF9leHByZXNzaW9uGAUgAygJEh8KA2NlbBgDIAMoCzISLmJ1Zi52YWxpZGF0ZS5SdWxlEi0KBW9uZW9mGAQgAygLMh4uYnVmLnZhbGlkYXRlLk1lc3NhZ2VPbmVvZlJ1bGVKBAgBEAJSCGRpc2FibGVkIjQKEE1lc3NhZ2VPbmVvZlJ1bGUSDgoGZmllbGRzGAEgAygJEhAKCHJlcXVpcmVkGAIgASgIIh4KCk9uZW9mUnVsZXMSEAoIcmVxdWlyZWQYASABKAgiiwkKCkZpZWxkUnVsZXMSFgoOY2VsX2V4cHJlc3Npb24YHSADKAkSHwoDY2VsGBcgAygLMhIuYnVmLnZhbGlkYXRlLlJ1bGUSEAoIcmVxdWlyZWQYGSABKAgSJAoGaWdub3JlGBsgASgOMhQuYnVmLnZhbGlkYXRlLklnbm9yZRIpCgVmbG9hdBgBIAEoCzIYLmJ1Zi52YWxpZGF0ZS5GbG9hdFJ1bGVzSAASKwoGZG91YmxlGAIgASgLMhkuYnVmLnZhbGlkYXRlLkRvdWJsZVJ1bGVzSAASKQoFaW50MzIYAyABKAsyGC5idWYudmFsaWRhdGUuSW50MzJSdWxlc0gAEikKBWludDY0GAQgASgLMhguYnVmLnZhbGlkYXRlLkludDY0UnVsZXNIABIrCgZ1aW50MzIYBSABKAsyGS5idWYudmFsaWRhdGUuVUludDMyUnVsZXNIABIrCgZ1aW50NjQYBiABKAsyGS5idWYudmFsaWRhdGUuVUludDY0UnVsZXNIABIrCgZzaW50MzIYByABKAsyGS5idWYudmFsaWRhdGUuU0ludDMyUnVsZXNIABIrCgZzaW50NjQYCCABKAsyGS5idWYudmFsaWRhdGUuU0ludDY0UnVsZXNIABItCgdmaXhlZDMyGAkgASgLMhouYnVmLnZhbGlkYXRlLkZpeGVkMzJSdWxlc0gAEi0KB2ZpeGVkNjQYCiABKAsyGi5idWYudmFsaWRhdGUuRml4ZWQ2NFJ1bGVzSAASLwoIc2ZpeGVkMzIYCyABKAsyGy5idWYudmFsaWRhdGUuU0ZpeGVkMzJSdWxlc0gAEi8KCHNmaXhlZDY0GAwgASgLMhsuYnVmLnZhbGlkYXRlLlNGaXhlZDY0UnVsZXNIABInCgRib29sGA0gASgLMhcuYnVmLnZhbGlkYXRlLkJvb2xSdWxlc0gAEisKBnN0cmluZxgOIAEoCzIZLmJ1Zi52YWxpZGF0ZS5TdHJpbmdSdWxlc0gAEikKBWJ5dGVzGA8gASgLMhguYnVmLnZhbGlkYXRlLkJ5dGVzUnVsZXNIABInCgRlbnVtGBAgASgLMhcuYnVmLnZhbGlkYXRlLkVudW1SdWxlc0gAEi8KCHJlcGVhdGVkGBIgASgLMhsuYnVmLnZhbGlkYXRlLlJlcGVhdGVkUnVsZXNIABIlCgNtYXAYEyABKAsyFi5idWYudmFsaWRhdGUuTWFwUnVsZXNIABIlCgNhbnkYFCABKAsyFi5idWYudmFsaWRhdGUuQW55UnVsZXNIABIvCghkdXJhdGlvbhgVIAEoCzIbLmJ1Zi52YWxpZGF0ZS5EdXJhdGlvblJ1bGVzSAASMgoKZmllbGRfbWFzaxgcIAEoCzIcLmJ1Zi52YWxpZGF0ZS5GaWVsZE1hc2tSdWxlc0gAEjEKCXRpbWVzdGFtcBgWIAEoCzIcLmJ1Zi52YWxpZGF0ZS5UaW1lc3RhbXBSdWxlc0gAQgYKBHR5cGVKBAgYEBlKBAgaEBtSB3NraXBwZWRSDGlnbm9yZV9lbXB0eSJVCg9QcmVkZWZpbmVkUnVsZXMSHwoDY2VsGAEgAygLMhIuYnVmLnZhbGlkYXRlLlJ1bGVKBAgYEBlKBAgaEBtSB3NraXBwZWRSDGlnbm9yZV9lbXB0eSLaFwoKRmxvYXRSdWxlcxKDAQoFY29uc3QYASABKAJCdMJIcQpvCgtmbG9hdC5jb25zdBpgdGhpcyAhPSBnZXRGaWVsZChydWxlcywgJ2NvbnN0JykgPyAndmFsdWUgbXVzdCBlcXVhbCAlcycuZm9ybWF0KFtnZXRGaWVsZChydWxlcywgJ2NvbnN0JyldKSA6ICcnEp8BCgJsdBgCIAEoAkKQAcJIjAEKiQEKCGZsb2F0Lmx0Gn0haGFzKHJ1bGVzLmd0ZSkgJiYgIWhhcyhydWxlcy5ndCkgJiYgKHRoaXMuaXNOYW4oKSB8fCB0aGlzID49IHJ1bGVzLmx0KT8gJ3ZhbHVlIG11c3QgYmUgbGVzcyB0aGFuICVzJy5mb3JtYXQoW3J1bGVzLmx0XSkgOiAnJ0gAEq8BCgNsdGUYAyABKAJCnwHCSJsBCpgBCglmbG9hdC5sdGUaigEhaGFzKHJ1bGVzLmd0ZSkgJiYgIWhhcyhydWxlcy5ndCkgJiYgKHRoaXMuaXNOYW4oKSB8fCB0aGlzID4gcnVsZXMubHRlKT8gJ3ZhbHVlIG11c3QgYmUgbGVzcyB0aGFuIG9yIGVxdWFsIHRvICVzJy5mb3JtYXQoW3J1bGVzLmx0ZV0pIDogJydIABLvBwoCZ3QYBCABKAJC4AfCSNwHCo0BCghmbG9hdC5ndBqAASFoYXMocnVsZXMubHQpICYmICFoYXMocnVsZXMubHRlKSAmJiAodGhpcy5pc05hbigpIHx8IHRoaXMgPD0gcnVsZXMuZ3QpPyAndmFsdWUgbXVzdCBiZSBncmVhdGVyIHRoYW4gJXMnLmZvcm1hdChbcnVsZXMuZ3RdKSA6ICcnCsMBCgtmbG9hdC5ndF9sdBqzAWhhcyhydWxlcy5sdCkgJiYgcnVsZXMubHQgPj0gcnVsZXMuZ3QgJiYgKHRoaXMuaXNOYW4oKSB8fCB0aGlzID49IHJ1bGVzLmx0IHx8IHRoaXMgPD0gcnVsZXMuZ3QpPyAndmFsdWUgbXVzdCBiZSBncmVhdGVyIHRoYW4gJXMgYW5kIGxlc3MgdGhhbiAlcycuZm9ybWF0KFtydWxlcy5ndCwgcnVsZXMubHRdKSA6ICcnCs0BChVmbG9hdC5ndF9sdF9leGNsdXNpdmUaswFoYXMocnVsZXMubHQpICYmIHJ1bGVzLmx0IDwgcnVsZXMuZ3QgJiYgKHRoaXMuaXNOYW4oKSB8fCAocnVsZXMubHQgPD0gdGhpcyAmJiB0aGlzIDw9IHJ1bGVzLmd0KSk/ICd2YWx1ZSBtdXN0IGJlIGdyZWF0ZXIgdGhhbiAlcyBvciBsZXNzIHRoYW4gJXMnLmZvcm1hdChbcnVsZXMuZ3QsIHJ1bGVzLmx0XSkgOiAnJwrTAQoMZmxvYXQuZ3RfbHRlGsIBaGFzKHJ1bGVzLmx0ZSkgJiYgcnVsZXMubHRlID49IHJ1bGVzLmd0ICYmICh0aGlzLmlzTmFuKCkgfHwgdGhpcyA+IHJ1bGVzLmx0ZSB8fCB0aGlzIDw9IHJ1bGVzLmd0KT8gJ3ZhbHVlIG11c3QgYmUgZ3JlYXRlciB0aGFuICVzIGFuZCBsZXNzIHRoYW4gb3IgZXF1YWwgdG8gJXMnLmZvcm1hdChbcnVsZXMuZ3QsIHJ1bGVzLmx0ZV0pIDogJycK3QEKFmZsb2F0Lmd0X2x0ZV9leGNsdXNpdmUawgFoYXMocnVsZXMubHRlKSAmJiBydWxlcy5sdGUgPCBydWxlcy5ndCAmJiAodGhpcy5pc05hbigpIHx8IChydWxlcy5sdGUgPCB0aGlzICYmIHRoaXMgPD0gcnVsZXMuZ3QpKT8gJ3ZhbHVlIG11c3QgYmUgZ3JlYXRlciB0aGFuICVzIG9yIGxlc3MgdGhhbiBvciBlcXVhbCB0byAlcycuZm9ybWF0KFtydWxlcy5ndCwgcnVsZXMubHRlXSkgOiAnJ0gBEroICgNndGUYBSABKAJCqgjCSKYICpsBCglmbG9hdC5ndGUajQEhaGFzKHJ1bGVzLmx0KSAmJiAhaGFzKHJ1bGVzLmx0ZSkgJiYgKHRoaXMuaXNOYW4oKSB8fCB0aGlzIDwgcnVsZXMuZ3RlKT8gJ3ZhbHVlIG11c3QgYmUgZ3JlYXRlciB0aGFuIG9yIGVxdWFsIHRvICVzJy5mb3JtYXQoW3J1bGVzLmd0ZV0pIDogJycK0gEKDGZsb2F0Lmd0ZV9sdBrBAWhhcyhydWxlcy5sdCkgJiYgcnVsZXMubHQgPj0gcnVsZXMuZ3RlICYmICh0aGlzLmlzTmFuKCkgfHwgdGhpcyA+PSBydWxlcy5sdCB8fCB0aGlzIDwgcnVsZXMuZ3RlKT8gJ3ZhbHVlIG11c3QgYmUgZ3JlYXRlciB0aGFuIG9yIGVxdWFsIHRvICVzIGFuZCBsZXNzIHRoYW4gJXMnLmZvcm1hdChbcnVsZXMuZ3RlLCBydWxlcy5sdF0pIDogJycK3AEKFmZsb2F0Lmd0ZV9sdF9leGNsdXNpdmUawQFoYXMocnVsZXMubHQpICYmIHJ1bGVzLmx0IDwgcnVsZXMuZ3RlICYmICh0aGlzLmlzTmFuKCkgfHwgKHJ1bGVzLmx0IDw9IHRoaXMgJiYgdGhpcyA8IHJ1bGVzLmd0ZSkpPyAndmFsdWUgbXVzdCBiZSBncmVhdGVyIHRoYW4gb3IgZXF1YWwgdG8gJXMgb3IgbGVzcyB0aGFuICVzJy5mb3JtYXQoW3J1bGVzLmd0ZSwgcnVsZXMubHRdKSA6ICcnCuIBCg1mbG9hdC5ndGVfbHRlGtABaGFzKHJ1bGVzLmx0ZSkgJiYgcnVsZXMubHRlID49IHJ1bGVzLmd0ZSAmJiAodGhpcy5pc05hbigpIHx8IHRoaXMgPiBydWxlcy5sdGUgfHwgdGhpcyA8IHJ1bGVzLmd0ZSk/ICd2YWx1ZSBtdXN0IGJlIGdyZWF0ZXIgdGhhbiBvciBlcXVhbCB0byAlcyBhbmQgbGVzcyB0aGFuIG9yIGVxdWFsIHRvICVzJy5mb3JtYXQoW3J1bGVzLmd0ZSwgcnVsZXMubHRlXSkgOiAnJwrsAQoXZmxvYXQuZ3RlX2x0ZV9leGNsdXNpdmUa0AFoYXMocnVsZXMubHRlKSAmJiBydWxlcy5sdGUgPCBydWxlcy5ndGUgJiYgKHRoaXMuaXNOYW4oKSB8fCAocnVsZXMubHRlIDwgdGhpcyAmJiB0aGlzIDwgcnVsZXMuZ3RlKSk/ICd2YWx1ZSBtdXN0IGJlIGdyZWF0ZXIgdGhhbiBvciBlcXVhbCB0byAlcyBvciBsZXNzIHRoYW4gb3IgZXF1YWwgdG8gJXMnLmZvcm1hdChbcnVsZXMuZ3RlLCBydWxlcy5sdGVdKSA6ICcnSAESfwoCaW4YBiADKAJCc8JIcApuCghmbG9hdC5pbhpiISh0aGlzIGluIGdldEZpZWxkKHJ1bGVzLCAnaW4nKSkgPyAndmFsdWUgbXVzdCBiZSBpbiBsaXN0ICVzJy5mb3JtYXQoW2dldEZpZWxkKHJ1bGVzLCAnaW4nKV0pIDogJycSdgoGbm90X2luGAcgAygCQmbCSGMKYQoMZmxvYXQubm90X2luGlF0aGlzIGluIHJ1bGVzLm5vdF9pbiA/ICd2YWx1ZSBtdXN0IG5vdCBiZSBpbiBsaXN0ICVzJy5mb3JtYXQoW3J1bGVzLm5vdF9pbl0pIDogJycSdQoGZmluaXRlGAggASgIQmXCSGIKYAoMZmxvYXQuZmluaXRlGlBydWxlcy5maW5pdGUgPyAodGhpcy5pc05hbigpIHx8IHRoaXMuaXNJbmYoKSA/ICd2YWx1ZSBtdXN0IGJlIGZpbml0ZScgOiAnJykgOiAnJxIrCgdleGFtcGxlGAkgAygCQhrCSBcKFQoNZmxvYXQuZXhhbXBsZRoEdHJ1ZSoJCOgHEICAgIACQgsKCWxlc3NfdGhhbkIOCgxncmVhdGVyX3RoYW4i7RcKC0RvdWJsZVJ1bGVzEoQBCgVjb25zdBgBIAEoAUJ1wkhyCnAKDGRvdWJsZS5jb25zdBpgdGhpcyAhPSBnZXRGaWVsZChydWxlcywgJ2NvbnN0JykgPyAndmFsdWUgbXVzdCBlcXVhbCAlcycuZm9ybWF0KFtnZXRGaWVsZChydWxlcywgJ2NvbnN0JyldKSA6ICcnEqABCgJsdBgCIAEoAUKRAcJIjQEKigEKCWRvdWJsZS5sdBp9IWhhcyhydWxlcy5ndGUpICYmICFoYXMocnVsZXMuZ3QpICYmICh0aGlzLmlzTmFuKCkgfHwgdGhpcyA+PSBydWxlcy5sdCk/ICd2YWx1ZSBtdXN0IGJlIGxlc3MgdGhhbiAlcycuZm9ybWF0KFtydWxlcy5sdF0pIDogJydIABKwAQoDbHRlGAMgASgBQqABwkicAQqZAQoKZG91YmxlLmx0ZRqKASFoYXMocnVsZXMuZ3RlKSAmJiAhaGFzKHJ1bGVzLmd0KSAmJiAodGhpcy5pc05hbigpIHx8IHRoaXMgPiBydWxlcy5sdGUpPyAndmFsdWUgbXVzdCBiZSBsZXNzIHRoYW4gb3IgZXF1YWwgdG8gJXMnLmZvcm1hdChbcnVsZXMubHRlXSkgOiAnJ0gAEvQHCgJndBgEIAEoAULlB8JI4QcKjgEKCWRvdWJsZS5ndBqAASFoYXMocnVsZXMubHQpICYmICFoYXMocnVsZXMubHRlKSAmJiAodGhpcy5pc05hbigpIHx8IHRoaXMgPD0gcnVsZXMuZ3QpPyAndmFsdWUgbXVzdCBiZSBncmVhdGVyIHRoYW4gJXMnLmZvcm1hdChbcnVsZXMuZ3RdKSA6ICcnCsQBCgxkb3VibGUuZ3RfbHQaswFoYXMocnVsZXMubHQpICYmIHJ1bGVzLmx0ID49IHJ1bGVzLmd0ICYmICh0aGlzLmlzTmFuKCkgfHwgdGhpcyA+PSBydWxlcy5sdCB8fCB0aGlzIDw9IHJ1bGVzLmd0KT8gJ3ZhbHVlIG11c3QgYmUgZ3JlYXRlciB0aGFuICVzIGFuZCBsZXNzIHRoYW4gJXMnLmZvcm1hdChbcnVsZXMuZ3QsIHJ1bGVzLmx0XSkgOiAnJwrOAQoWZG91YmxlLmd0X2x0X2V4Y2x1c2l2ZRqzAWhhcyhydWxlcy5sdCkgJiYgcnVsZXMubHQgPCBydWxlcy5ndCAmJiAodGhpcy5pc05hbigpIHx8IChydWxlcy5sdCA8PSB0aGlzICYmIHRoaXMgPD0gcnVsZXMuZ3QpKT8gJ3ZhbHVlIG11c3QgYmUgZ3JlYXRlciB0aGFuICVzIG9yIGxlc3MgdGhhbiAlcycuZm9ybWF0KFtydWxlcy5ndCwgcnVsZXMubHRdKSA6ICcnCtQBCg1kb3VibGUuZ3RfbHRlGsIBaGFzKHJ1bGVzLmx0ZSkgJiYgcnVsZXMubHRlID49IHJ1bGVzLmd0ICYmICh0aGlzLmlzTmFuKCkgfHwgdGhpcyA+IHJ1bGVzLmx0ZSB8fCB0aGlzIDw9IHJ1bGVzLmd0KT8gJ3ZhbHVlIG11c3QgYmUgZ3JlYXRlciB0aGFuICVzIGFuZCBsZXNzIHRoYW4gb3IgZXF1YWwgdG8gJXMnLmZvcm1hdChbcnVsZXMuZ3QsIHJ1bGVzLmx0ZV0pIDogJycK3gEKF2RvdWJsZS5ndF9sdGVfZXhjbHVzaXZlGsIBaGFzKHJ1bGVzLmx0ZSkgJiYgcnVsZXMubHRlIDwgcnVsZXMuZ3QgJiYgKHRoaXMuaXNOYW4oKSB8fCAocnVsZXMubHRlIDwgdGhpcyAmJiB0aGlzIDw9IHJ1bGVzLmd0KSk/ICd2YWx1ZSBtdXN0IGJlIGdyZWF0ZXIgdGhhbiAlcyBvciBsZXNzIHRoYW4gb3IgZXF1YWwgdG8gJXMnLmZvcm1hdChbcnVsZXMuZ3QsIHJ1bGVzLmx0ZV0pIDogJydIARK/CAoDZ3RlGAUgASgBQq8IwkirCAqcAQoKZG91YmxlLmd0ZRqNASFoYXMocnVsZXMubHQpICYmICFoYXMocnVsZXMubHRlKSAmJiAodGhpcy5pc05hbigpIHx8IHRoaXMgPCBydWxlcy5ndGUpPyAndmFsdWUgbXVzdCBiZSBncmVhdGVyIHRoYW4gb3IgZXF1YWwgdG8gJXMnLmZvcm1hdChbcnVsZXMuZ3RlXSkgOiAnJwrTAQoNZG91YmxlLmd0ZV9sdBrBAWhhcyhydWxlcy5sdCkgJiYgcnVsZXMubHQgPj0gcnVsZXMuZ3RlICYmICh0aGlzLmlzTmFuKCkgfHwgdGhpcyA+PSBydWxlcy5sdCB8fCB0aGlzIDwgcnVsZXMuZ3RlKT8gJ3ZhbHVlIG11c3QgYmUgZ3JlYXRlciB0aGFuIG9yIGVxdWFsIHRvICVzIGFuZCBsZXNzIHRoYW4gJXMnLmZvcm1hdChbcnVsZXMuZ3RlLCBydWxlcy5sdF0pIDogJycK3QEKF2RvdWJsZS5ndGVfbHRfZXhjbHVzaXZlGsEBaGFzKHJ1bGVzLmx0KSAmJiBydWxlcy5sdCA8IHJ1bGVzLmd0ZSAmJiAodGhpcy5pc05hbigpIHx8IChydWxlcy5sdCA8PSB0aGlzICYmIHRoaXMgPCBydWxlcy5ndGUpKT8gJ3ZhbHVlIG11c3QgYmUgZ3JlYXRlciB0aGFuIG9yIGVxdWFsIHRvICVzIG9yIGxlc3MgdGhhbiAlcycuZm9ybWF0KFtydWxlcy5ndGUsIHJ1bGVzLmx0XSkgOiAnJwrjAQoOZG91YmxlLmd0ZV9sdGUa0AFoYXMocnVsZXMubHRlKSAmJiBydWxlcy5sdGUgPj0gcnVsZXMuZ3RlICYmICh0aGlzLmlzTmFuKCkgfHwgdGhpcyA+IHJ1bGVzLmx0ZSB8fCB0aGlzIDwgcnVsZXMuZ3RlKT8gJ3ZhbHVlIG11c3QgYmUgZ3JlYXRlciB0aGFuIG9yIGVxdWFsIHRvICVzIGFuZCBsZXNzIHRoYW4gb3IgZXF1YWwgdG8gJXMnLmZvcm1hdChbcnVsZXMuZ3RlLCBydWxlcy5sdGVdKSA6ICcnCu0BChhkb3VibGUuZ3RlX2x0ZV9leGNsdXNpdmUa0AFoYXMocnVsZXMubHRlKSAmJiBydWxlcy5sdGUgPCBydWxlcy5ndGUgJiYgKHRoaXMuaXNOYW4oKSB8fCAocnVsZXMubHRlIDwgdGhpcyAmJiB0aGlzIDwgcnVsZXMuZ3RlKSk/ICd2YWx1ZSBtdXN0IGJlIGdyZWF0ZXIgdGhhbiBvciBlcXVhbCB0byAlcyBvciBsZXNzIHRoYW4gb3IgZXF1YWwgdG8gJXMnLmZvcm1hdChbcnVsZXMuZ3RlLCBydWxlcy5sdGVdKSA6ICcnSAESgAEKAmluGAYgAygBQnTCSHEKbwoJZG91YmxlLmluGmIhKHRoaXMgaW4gZ2V0RmllbGQocnVsZXMsICdpbicpKSA/ICd2YWx1ZSBtdXN0IGJlIGluIGxpc3QgJXMnLmZvcm1hdChbZ2V0RmllbGQocnVsZXMsICdpbicpXSkgOiAnJxJ3CgZub3RfaW4YByADKAFCZ8JIZApiCg1kb3VibGUubm90X2luGlF0aGlzIGluIHJ1bGVzLm5vdF9pbiA/ICd2YWx1ZSBtdXN0IG5vdCBiZSBpbiBsaXN0ICVzJy5mb3JtYXQoW3J1bGVzLm5vdF9pbl0pIDogJycSdgoGZmluaXRlGAggASgIQmbCSGMKYQoNZG91YmxlLmZpbml0ZRpQcnVsZXMuZmluaXRlID8gKHRoaXMuaXNOYW4oKSB8fCB0aGlzLmlzSW5mKCkgPyAndmFsdWUgbXVzdCBiZSBmaW5pdGUnIDogJycpIDogJycSLAoHZXhhbXBsZRgJIAMoAUIbwkgYChYKDmRvdWJsZS5leGFtcGxlGgR0cnVlKgkI6AcQgICAgAJCCwoJbGVzc190aGFuQg4KDGdyZWF0ZXJfdGhhbiKMFQoKSW50MzJSdWxlcxKDAQoFY29uc3QYASABKAVCdMJIcQpvCgtpbnQzMi5jb25zdBpgdGhpcyAhPSBnZXRGaWVsZChydWxlcywgJ2NvbnN0JykgPyAndmFsdWUgbXVzdCBlcXVhbCAlcycuZm9ybWF0KFtnZXRGaWVsZChydWxlcywgJ2NvbnN0JyldKSA6ICcnEooBCgJsdBgCIAEoBUJ8wkh5CncKCGludDMyLmx0GmshaGFzKHJ1bGVzLmd0ZSkgJiYgIWhhcyhydWxlcy5ndCkgJiYgdGhpcyA+PSBydWxlcy5sdD8gJ3ZhbHVlIG11c3QgYmUgbGVzcyB0aGFuICVzJy5mb3JtYXQoW3J1bGVzLmx0XSkgOiAnJ0gAEpwBCgNsdGUYAyABKAVCjAHCSIgBCoUBCglpbnQzMi5sdGUaeCFoYXMocnVsZXMuZ3RlKSAmJiAhaGFzKHJ1bGVzLmd0KSAmJiB0aGlzID4gcnVsZXMubHRlPyAndmFsdWUgbXVzdCBiZSBsZXNzIHRoYW4gb3IgZXF1YWwgdG8gJXMnLmZvcm1hdChbcnVsZXMubHRlXSkgOiAnJ0gAEpcHCgJndBgEIAEoBUKIB8JIhAcKegoIaW50MzIuZ3QabiFoYXMocnVsZXMubHQpICYmICFoYXMocnVsZXMubHRlKSAmJiB0aGlzIDw9IHJ1bGVzLmd0PyAndmFsdWUgbXVzdCBiZSBncmVhdGVyIHRoYW4gJXMnLmZvcm1hdChbcnVsZXMuZ3RdKSA6ICcnCrMBCgtpbnQzMi5ndF9sdBqjAWhhcyhydWxlcy5sdCkgJiYgcnVsZXMubHQgPj0gcnVsZXMuZ3QgJiYgKHRoaXMgPj0gcnVsZXMubHQgfHwgdGhpcyA8PSBydWxlcy5ndCk/ICd2YWx1ZSBtdXN0IGJlIGdyZWF0ZXIgdGhhbiAlcyBhbmQgbGVzcyB0aGFuICVzJy5mb3JtYXQoW3J1bGVzLmd0LCBydWxlcy5sdF0pIDogJycKuwEKFWludDMyLmd0X2x0X2V4Y2x1c2l2ZRqhAWhhcyhydWxlcy5sdCkgJiYgcnVsZXMubHQgPCBydWxlcy5ndCAmJiAocnVsZXMubHQgPD0gdGhpcyAmJiB0aGlzIDw9IHJ1bGVzLmd0KT8gJ3ZhbHVlIG11c3QgYmUgZ3JlYXRlciB0aGFuICVzIG9yIGxlc3MgdGhhbiAlcycuZm9ybWF0KFtydWxlcy5ndCwgcnVsZXMubHRdKSA6ICcnCsMBCgxpbnQzMi5ndF9sdGUasgFoYXMocnVsZXMubHRlKSAmJiBydWxlcy5sdGUgPj0gcnVsZXMuZ3QgJiYgKHRoaXMgPiBydWxlcy5sdGUgfHwgdGhpcyA8PSBydWxlcy5ndCk/ICd2YWx1ZSBtdXN0IGJlIGdyZWF0ZXIgdGhhbiAlcyBhbmQgbGVzcyB0aGFuIG9yIGVxdWFsIHRvICVzJy5mb3JtYXQoW3J1bGVzLmd0LCBydWxlcy5sdGVdKSA6ICcnCssBChZpbnQzMi5ndF9sdGVfZXhjbHVzaXZlGrABaGFzKHJ1bGVzLmx0ZSkgJiYgcnVsZXMubHRlIDwgcnVsZXMuZ3QgJiYgKHJ1bGVzLmx0ZSA8IHRoaXMgJiYgdGhpcyA8PSBydWxlcy5ndCk/ICd2YWx1ZSBtdXN0IGJlIGdyZWF0ZXIgdGhhbiAlcyBvciBsZXNzIHRoYW4gb3IgZXF1YWwgdG8gJXMnLmZvcm1hdChbcnVsZXMuZ3QsIHJ1bGVzLmx0ZV0pIDogJydIARLjBwoDZ3RlGAUgASgFQtMHwkjPBwqIAQoJaW50MzIuZ3RlGnshaGFzKHJ1bGVzLmx0KSAmJiAhaGFzKHJ1bGVzLmx0ZSkgJiYgdGhpcyA8IHJ1bGVzLmd0ZT8gJ3ZhbHVlIG11c3QgYmUgZ3JlYXRlciB0aGFuIG9yIGVxdWFsIHRvICVzJy5mb3JtYXQoW3J1bGVzLmd0ZV0pIDogJycKwgEKDGludDMyLmd0ZV9sdBqxAWhhcyhydWxlcy5sdCkgJiYgcnVsZXMubHQgPj0gcnVsZXMuZ3RlICYmICh0aGlzID49IHJ1bGVzLmx0IHx8IHRoaXMgPCBydWxlcy5ndGUpPyAndmFsdWUgbXVzdCBiZSBncmVhdGVyIHRoYW4gb3IgZXF1YWwgdG8gJXMgYW5kIGxlc3MgdGhhbiAlcycuZm9ybWF0KFtydWxlcy5ndGUsIHJ1bGVzLmx0XSkgOiAnJwrKAQoWaW50MzIuZ3RlX2x0X2V4Y2x1c2l2ZRqvAWhhcyhydWxlcy5sdCkgJiYgcnVsZXMubHQgPCBydWxlcy5ndGUgJiYgKHJ1bGVzLmx0IDw9IHRoaXMgJiYgdGhpcyA8IHJ1bGVzLmd0ZSk/ICd2YWx1ZSBtdXN0IGJlIGdyZWF0ZXIgdGhhbiBvciBlcXVhbCB0byAlcyBvciBsZXNzIHRoYW4gJXMnLmZvcm1hdChbcnVsZXMuZ3RlLCBydWxlcy5sdF0pIDogJycK0gEKDWludDMyLmd0ZV9sdGUawAFoYXMocnVsZXMubHRlKSAmJiBydWxlcy5sdGUgPj0gcnVsZXMuZ3RlICYmICh0aGlzID4gcnVsZXMubHRlIHx8IHRoaXMgPCBydWxlcy5ndGUpPyAndmFsdWUgbXVzdCBiZSBncmVhdGVyIHRoYW4gb3IgZXF1YWwgdG8gJXMgYW5kIGxlc3MgdGhhbiBvciBlcXVhbCB0byAlcycuZm9ybWF0KFtydWxlcy5ndGUsIHJ1bGVzLmx0ZV0pIDogJycK2gEKF2ludDMyLmd0ZV9sdGVfZXhjbHVzaXZlGr4BaGFzKHJ1bGVzLmx0ZSkgJiYgcnVsZXMubHRlIDwgcnVsZXMuZ3RlICYmIChydWxlcy5sdGUgPCB0aGlzICYmIHRoaXMgPCBydWxlcy5ndGUpPyAndmFsdWUgbXVzdCBiZSBncmVhdGVyIHRoYW4gb3IgZXF1YWwgdG8gJXMgb3IgbGVzcyB0aGFuIG9yIGVxdWFsIHRvICVzJy5mb3JtYXQoW3J1bGVzLmd0ZSwgcnVsZXMubHRlXSkgOiAnJ0gBEn8KAmluGAYgAygFQnPCSHAKbgoIaW50MzIuaW4aYiEodGhpcyBpbiBnZXRGaWVsZChydWxlcywgJ2luJykpID8gJ3ZhbHVlIG11c3QgYmUgaW4gbGlzdCAlcycuZm9ybWF0KFtnZXRGaWVsZChydWxlcywgJ2luJyldKSA6ICcnEnYKBm5vdF9pbhgHIAMoBUJmwkhjCmEKDGludDMyLm5vdF9pbhpRdGhpcyBpbiBydWxlcy5ub3RfaW4gPyAndmFsdWUgbXVzdCBub3QgYmUgaW4gbGlzdCAlcycuZm9ybWF0KFtydWxlcy5ub3RfaW5dKSA6ICcnEisKB2V4YW1wbGUYCCADKAVCGsJIFwoVCg1pbnQzMi5leGFtcGxlGgR0cnVlKgkI6AcQgICAgAJCCwoJbGVzc190aGFuQg4KDGdyZWF0ZXJfdGhhbiKMFQoKSW50NjRSdWxlcxKDAQoFY29uc3QYASABKANCdMJIcQpvCgtpbnQ2NC5jb25zdBpgdGhpcyAhPSBnZXRGaWVsZChydWxlcywgJ2NvbnN0JykgPyAndmFsdWUgbXVzdCBlcXVhbCAlcycuZm9ybWF0KFtnZXRGaWVsZChydWxlcywgJ2NvbnN0JyldKSA6ICcnEooBCgJsdBgCIAEoA0J8wkh5CncKCGludDY0Lmx0GmshaGFzKHJ1bGVzLmd0ZSkgJiYgIWhhcyhydWxlcy5ndCkgJiYgdGhpcyA+PSBydWxlcy5sdD8gJ3ZhbHVlIG11c3QgYmUgbGVzcyB0aGFuICVzJy5mb3JtYXQoW3J1bGVzLmx0XSkgOiAnJ0gAEpwBCgNsdGUYAyABKANCjAHCSIgBCoUBCglpbnQ2NC5sdGUaeCFoYXMocnVsZXMuZ3RlKSAmJiAhaGFzKHJ1bGVzLmd0KSAmJiB0aGlzID4gcnVsZXMubHRlPyAndmFsdWUgbXVzdCBiZSBsZXNzIHRoYW4gb3IgZXF1YWwgdG8gJXMnLmZvcm1hdChbcnVsZXMubHRlXSkgOiAnJ0gAEpcHCgJndBgEIAEoA0KIB8JIhAcKegoIaW50NjQuZ3QabiFoYXMocnVsZXMubHQpICYmICFoYXMocnVsZXMubHRlKSAmJiB0aGlzIDw9IHJ1bGVzLmd0PyAndmFsdWUgbXVzdCBiZSBncmVhdGVyIHRoYW4gJXMnLmZvcm1hdChbcnVsZXMuZ3RdKSA6ICcnCrMBCgtpbnQ2NC5ndF9sdBqjAWhhcyhydWxlcy5sdCkgJiYgcnVsZXMubHQgPj0gcnVsZXMuZ3QgJiYgKHRoaXMgPj0gcnVsZXMubHQgfHwgdGhpcyA8PSBydWxlcy5ndCk/ICd2YWx1ZSBtdXN0IGJlIGdyZWF0ZXIgdGhhbiAlcyBhbmQgbGVzcyB0aGFuICVzJy5mb3JtYXQoW3J1bGVzLmd0LCBydWxlcy5sdF0pIDogJycKuwEKFWludDY0Lmd0X2x0X2V4Y2x1c2l2ZRqhAWhhcyhydWxlcy5sdCkgJiYgcnVsZXMubHQgPCBydWxlcy5ndCAmJiAocnVsZXMubHQgPD0gdGhpcyAmJiB0aGlzIDw9IHJ1bGVzLmd0KT8gJ3ZhbHVlIG11c3QgYmUgZ3JlYXRlciB0aGFuICVzIG9yIGxlc3MgdGhhbiAlcycuZm9ybWF0KFtydWxlcy5ndCwgcnVsZXMubHRdKSA6ICcnCsMBCgxpbnQ2NC5ndF9sdGUasgFoYXMocnVsZXMubHRlKSAmJiBydWxlcy5sdGUgPj0gcnVsZXMuZ3QgJiYgKHRoaXMgPiBydWxlcy5sdGUgfHwgdGhpcyA8PSBydWxlcy5ndCk/ICd2YWx1ZSBtdXN0IGJlIGdyZWF0ZXIgdGhhbiAlcyBhbmQgbGVzcyB0aGFuIG9yIGVxdWFsIHRvICVzJy5mb3JtYXQoW3J1bGVzLmd0LCBydWxlcy5sdGVdKSA6ICcnCssBChZpbnQ2NC5ndF9sdGVfZXhjbHVzaXZlGrABaGFzKHJ1bGVzLmx0ZSkgJiYgcnVsZXMubHRlIDwgcnVsZXMuZ3QgJiYgKHJ1bGVzLmx0ZSA8IHRoaXMgJiYgdGhpcyA8PSBydWxlcy5ndCk/ICd2YWx1ZSBtdXN0IGJlIGdyZWF0ZXIgdGhhbiAlcyBvciBsZXNzIHRoYW4gb3IgZXF1YWwgdG8gJXMnLmZvcm1hdChbcnVsZXMuZ3QsIHJ1bGVzLmx0ZV0pIDogJydIARLjBwoDZ3RlGAUgASgDQtMHwkjPBwqIAQoJaW50NjQuZ3RlGnshaGFzKHJ1bGVzLmx0KSAmJiAhaGFzKHJ1bGVzLmx0ZSkgJiYgdGhpcyA8IHJ1bGVzLmd0ZT8gJ3ZhbHVlIG11c3QgYmUgZ3JlYXRlciB0aGFuIG9yIGVxdWFsIHRvICVzJy5mb3JtYXQoW3J1bGVzLmd0ZV0pIDogJycKwgEKDGludDY0Lmd0ZV9sdBqxAWhhcyhydWxlcy5sdCkgJiYgcnVsZXMubHQgPj0gcnVsZXMuZ3RlICYmICh0aGlzID49IHJ1bGVzLmx0IHx8IHRoaXMgPCBydWxlcy5ndGUpPyAndmFsdWUgbXVzdCBiZSBncmVhdGVyIHRoYW4gb3IgZXF1YWwgdG8gJXMgYW5kIGxlc3MgdGhhbiAlcycuZm9ybWF0KFtydWxlcy5ndGUsIHJ1bGVzLmx0XSkgOiAnJwrKAQoWaW50NjQuZ3RlX2x0X2V4Y2x1c2l2ZRqvAWhhcyhydWxlcy5sdCkgJiYgcnVsZXMubHQgPCBydWxlcy5ndGUgJiYgKHJ1bGVzLmx0IDw9IHRoaXMgJiYgdGhpcyA8IHJ1bGVzLmd0ZSk/ICd2YWx1ZSBtdXN0IGJlIGdyZWF0ZXIgdGhhbiBvciBlcXVhbCB0byAlcyBvciBsZXNzIHRoYW4gJXMnLmZvcm1hdChbcnVsZXMuZ3RlLCBydWxlcy5sdF0pIDogJycK0gEKDWludDY0Lmd0ZV9sdGUawAFoYXMocnVsZXMubHRlKSAmJiBydWxlcy5sdGUgPj0gcnVsZXMuZ3RlICYmICh0aGlzID4gcnVsZXMubHRlIHx8IHRoaXMgPCBydWxlcy5ndGUpPyAndmFsdWUgbXVzdCBiZSBncmVhdGVyIHRoYW4gb3IgZXF1YWwgdG8gJXMgYW5kIGxlc3MgdGhhbiBvciBlcXVhbCB0byAlcycuZm9ybWF0KFtydWxlcy5ndGUsIHJ1bGVzLmx0ZV0pIDogJycK2gEKF2ludDY0Lmd0ZV9sdGVfZXhjbHVzaXZlGr4BaGFzKHJ1bGVzLmx0ZSkgJiYgcnVsZXMubHRlIDwgcnVsZXMuZ3RlICYmIChydWxlcy5sdGUgPCB0aGlzICYmIHRoaXMgPCBydWxlcy5ndGUpPyAndmFsdWUgbXVzdCBiZSBncmVhdGVyIHRoYW4gb3IgZXF1YWwgdG8gJXMgb3IgbGVzcyB0aGFuIG9yIGVxdWFsIHRvICVzJy5mb3JtYXQoW3J1bGVzLmd0ZSwgcnVsZXMubHRlXSkgOiAnJ0gBEn8KAmluGAYgAygDQnPCSHAKbgoIaW50NjQuaW4aYiEodGhpcyBpbiBnZXRGaWVsZChydWxlcywgJ2luJykpID8gJ3ZhbHVlIG11c3QgYmUgaW4gbGlzdCAlcycuZm9ybWF0KFtnZXRGaWVsZChydWxlcywgJ2luJyldKSA6ICcnEnYKBm5vdF9pbhgHIAMoA0JmwkhjCmEKDGludDY0Lm5vdF9pbhpRdGhpcyBpbiBydWxlcy5ub3RfaW4gPyAndmFsdWUgbXVzdCBub3QgYmUgaW4gbGlzdCAlcycuZm9ybWF0KFtydWxlcy5ub3RfaW5dKSA6ICcnEisKB2V4YW1wbGUYCSADKANCGsJIFwoVCg1pbnQ2NC5leGFtcGxlGgR0cnVlKgkI6AcQgICAgAJCCwoJbGVzc190aGFuQg4KDGdyZWF0ZXJfdGhhbiKeFQoLVUludDMyUnVsZXMShAEKBWNvbnN0GAEgASgNQnXCSHIKcAoMdWludDMyLmNvbnN0GmB0aGlzICE9IGdldEZpZWxkKHJ1bGVzLCAnY29uc3QnKSA/ICd2YWx1ZSBtdXN0IGVxdWFsICVzJy5mb3JtYXQoW2dldEZpZWxkKHJ1bGVzLCAnY29uc3QnKV0pIDogJycSiwEKAmx0GAIgASgNQn3CSHoKeAoJdWludDMyLmx0GmshaGFzKHJ1bGVzLmd0ZSkgJiYgIWhhcyhydWxlcy5ndCkgJiYgdGhpcyA+PSBydWxlcy5sdD8gJ3ZhbHVlIG11c3QgYmUgbGVzcyB0aGFuICVzJy5mb3JtYXQoW3J1bGVzLmx0XSkgOiAnJ0gAEp0BCgNsdGUYAyABKA1CjQHCSIkBCoYBCgp1aW50MzIubHRlGnghaGFzKHJ1bGVzLmd0ZSkgJiYgIWhhcyhydWxlcy5ndCkgJiYgdGhpcyA+IHJ1bGVzLmx0ZT8gJ3ZhbHVlIG11c3QgYmUgbGVzcyB0aGFuIG9yIGVxdWFsIHRvICVzJy5mb3JtYXQoW3J1bGVzLmx0ZV0pIDogJydIABKcBwoCZ3QYBCABKA1CjQfCSIkHCnsKCXVpbnQzMi5ndBpuIWhhcyhydWxlcy5sdCkgJiYgIWhhcyhydWxlcy5sdGUpICYmIHRoaXMgPD0gcnVsZXMuZ3Q/ICd2YWx1ZSBtdXN0IGJlIGdyZWF0ZXIgdGhhbiAlcycuZm9ybWF0KFtydWxlcy5ndF0pIDogJycKtAEKDHVpbnQzMi5ndF9sdBqjAWhhcyhydWxlcy5sdCkgJiYgcnVsZXMubHQgPj0gcnVsZXMuZ3QgJiYgKHRoaXMgPj0gcnVsZXMubHQgfHwgdGhpcyA8PSBydWxlcy5ndCk/ICd2YWx1ZSBtdXN0IGJlIGdyZWF0ZXIgdGhhbiAlcyBhbmQgbGVzcyB0aGFuICVzJy5mb3JtYXQoW3J1bGVzLmd0LCBydWxlcy5sdF0pIDogJycKvAEKFnVpbnQzMi5ndF9sdF9leGNsdXNpdmUaoQFoYXMocnVsZXMubHQpICYmIHJ1bGVzLmx0IDwgcnVsZXMuZ3QgJiYgKHJ1bGVzLmx0IDw9IHRoaXMgJiYgdGhpcyA8PSBydWxlcy5ndCk/ICd2YWx1ZSBtdXN0IGJlIGdyZWF0ZXIgdGhhbiAlcyBvciBsZXNzIHRoYW4gJXMnLmZvcm1hdChbcnVsZXMuZ3QsIHJ1bGVzLmx0XSkgOiAnJwrEAQoNdWludDMyLmd0X2x0ZRqyAWhhcyhydWxlcy5sdGUpICYmIHJ1bGVzLmx0ZSA+PSBydWxlcy5ndCAmJiAodGhpcyA+IHJ1bGVzLmx0ZSB8fCB0aGlzIDw9IHJ1bGVzLmd0KT8gJ3ZhbHVlIG11c3QgYmUgZ3JlYXRlciB0aGFuICVzIGFuZCBsZXNzIHRoYW4gb3IgZXF1YWwgdG8gJXMnLmZvcm1hdChbcnVsZXMuZ3QsIHJ1bGVzLmx0ZV0pIDogJycKzAEKF3VpbnQzMi5ndF9sdGVfZXhjbHVzaXZlGrABaGFzKHJ1bGVzLmx0ZSkgJiYgcnVsZXMubHRlIDwgcnVsZXMuZ3QgJiYgKHJ1bGVzLmx0ZSA8IHRoaXMgJiYgdGhpcyA8PSBydWxlcy5ndCk/ICd2YWx1ZSBtdXN0IGJlIGdyZWF0ZXIgdGhhbiAlcyBvciBsZXNzIHRoYW4gb3IgZXF1YWwgdG8gJXMnLmZvcm1hdChbcnVsZXMuZ3QsIHJ1bGVzLmx0ZV0pIDogJydIARLoBwoDZ3RlGAUgASgNQtgHwkjUBwqJAQoKdWludDMyLmd0ZRp7IWhhcyhydWxlcy5sdCkgJiYgIWhhcyhydWxlcy5sdGUpICYmIHRoaXMgPCBydWxlcy5ndGU/ICd2YWx1ZSBtdXN0IGJlIGdyZWF0ZXIgdGhhbiBvciBlcXVhbCB0byAlcycuZm9ybWF0KFtydWxlcy5ndGVdKSA6ICcnCsMBCg11aW50MzIuZ3RlX2x0GrEBaGFzKHJ1bGVzLmx0KSAmJiBydWxlcy5sdCA+PSBydWxlcy5ndGUgJiYgKHRoaXMgPj0gcnVsZXMubHQgfHwgdGhpcyA8IHJ1bGVzLmd0ZSk/ICd2YWx1ZSBtdXN0IGJlIGdyZWF0ZXIgdGhhbiBvciBlcXVhbCB0byAlcyBhbmQgbGVzcyB0aGFuICVzJy5mb3JtYXQoW3J1bGVzLmd0ZSwgcnVsZXMubHRdKSA6ICcnCssBChd1aW50MzIuZ3RlX2x0X2V4Y2x1c2l2ZRqvAWhhcyhydWxlcy5sdCkgJiYgcnVsZXMubHQgPCBydWxlcy5ndGUgJiYgKHJ1bGVzLmx0IDw9IHRoaXMgJiYgdGhpcyA8IHJ1bGVzLmd0ZSk/ICd2YWx1ZSBtdXN0IGJlIGdyZWF0ZXIgdGhhbiBvciBlcXVhbCB0byAlcyBvciBsZXNzIHRoYW4gJXMnLmZvcm1hdChbcnVsZXMuZ3RlLCBydWxlcy5sdF0pIDogJycK0wEKDnVpbnQzMi5ndGVfbHRlGsABaGFzKHJ1bGVzLmx0ZSkgJiYgcnVsZXMubHRlID49IHJ1bGVzLmd0ZSAmJiAodGhpcyA+IHJ1bGVzLmx0ZSB8fCB0aGlzIDwgcnVsZXMuZ3RlKT8gJ3ZhbHVlIG11c3QgYmUgZ3JlYXRlciB0aGFuIG9yIGVxdWFsIHRvICVzIGFuZCBsZXNzIHRoYW4gb3IgZXF1YWwgdG8gJXMnLmZvcm1hdChbcnVsZXMuZ3RlLCBydWxlcy5sdGVdKSA6ICcnCtsBChh1aW50MzIuZ3RlX2x0ZV9leGNsdXNpdmUavgFoYXMocnVsZXMubHRlKSAmJiBydWxlcy5sdGUgPCBydWxlcy5ndGUgJiYgKHJ1bGVzLmx0ZSA8IHRoaXMgJiYgdGhpcyA8IHJ1bGVzLmd0ZSk/ICd2YWx1ZSBtdXN0IGJlIGdyZWF0ZXIgdGhhbiBvciBlcXVhbCB0byAlcyBvciBsZXNzIHRoYW4gb3IgZXF1YWwgdG8gJXMnLmZvcm1hdChbcnVsZXMuZ3RlLCBydWxlcy5sdGVdKSA6ICcnSAESgAEKAmluGAYgAygNQnTCSHEKbwoJdWludDMyLmluGmIhKHRoaXMgaW4gZ2V0RmllbGQocnVsZXMsICdpbicpKSA/ICd2YWx1ZSBtdXN0IGJlIGluIGxpc3QgJXMnLmZvcm1hdChbZ2V0RmllbGQocnVsZXMsICdpbicpXSkgOiAnJxJ3CgZub3RfaW4YByADKA1CZ8JIZApiCg11aW50MzIubm90X2luGlF0aGlzIGluIHJ1bGVzLm5vdF9pbiA/ICd2YWx1ZSBtdXN0IG5vdCBiZSBpbiBsaXN0ICVzJy5mb3JtYXQoW3J1bGVzLm5vdF9pbl0pIDogJycSLAoHZXhhbXBsZRgIIAMoDUIbwkgYChYKDnVpbnQzMi5leGFtcGxlGgR0cnVlKgkI6AcQgICAgAJCCwoJbGVzc190aGFuQg4KDGdyZWF0ZXJfdGhhbiKeFQoLVUludDY0UnVsZXMShAEKBWNvbnN0GAEgASgEQnXCSHIKcAoMdWludDY0LmNvbnN0GmB0aGlzICE9IGdldEZpZWxkKHJ1bGVzLCAnY29uc3QnKSA/ICd2YWx1ZSBtdXN0IGVxdWFsICVzJy5mb3JtYXQoW2dldEZpZWxkKHJ1bGVzLCAnY29uc3QnKV0pIDogJycSiwEKAmx0GAIgASgEQn3CSHoKeAoJdWludDY0Lmx0GmshaGFzKHJ1bGVzLmd0ZSkgJiYgIWhhcyhydWxlcy5ndCkgJiYgdGhpcyA+PSBydWxlcy5sdD8gJ3ZhbHVlIG11c3QgYmUgbGVzcyB0aGFuICVzJy5mb3JtYXQoW3J1bGVzLmx0XSkgOiAnJ0gAEp0BCgNsdGUYAyABKARCjQHCSIkBCoYBCgp1aW50NjQubHRlGnghaGFzKHJ1bGVzLmd0ZSkgJiYgIWhhcyhydWxlcy5ndCkgJiYgdGhpcyA+IHJ1bGVzLmx0ZT8gJ3ZhbHVlIG11c3QgYmUgbGVzcyB0aGFuIG9yIGVxdWFsIHRvICVzJy5mb3JtYXQoW3J1bGVzLmx0ZV0pIDogJydIABKcBwoCZ3QYBCABKARCjQfCSIkHCnsKCXVpbnQ2NC5ndBpuIWhhcyhydWxlcy5sdCkgJiYgIWhhcyhydWxlcy5sdGUpICYmIHRoaXMgPD0gcnVsZXMuZ3Q/ICd2YWx1ZSBtdXN0IGJlIGdyZWF0ZXIgdGhhbiAlcycuZm9ybWF0KFtydWxlcy5ndF0pIDogJycKtAEKDHVpbnQ2NC5ndF9sdBqjAWhhcyhydWxlcy5sdCkgJiYgcnVsZXMubHQgPj0gcnVsZXMuZ3QgJiYgKHRoaXMgPj0gcnVsZXMubHQgfHwgdGhpcyA8PSBydWxlcy5ndCk/ICd2YWx1ZSBtdXN0IGJlIGdyZWF0ZXIgdGhhbiAlcyBhbmQgbGVzcyB0aGFuICVzJy5mb3JtYXQoW3J1bGVzLmd0LCBydWxlcy5sdF0pIDogJycKvAEKFnVpbnQ2NC5ndF9sdF9leGNsdXNpdmUaoQFoYXMocnVsZXMubHQpICYmIHJ1bGVzLmx0IDwgcnVsZXMuZ3QgJiYgKHJ1bGVzLmx0IDw9IHRoaXMgJiYgdGhpcyA8PSBydWxlcy5ndCk/ICd2YWx1ZSBtdXN0IGJlIGdyZWF0ZXIgdGhhbiAlcyBvciBsZXNzIHRoYW4gJXMnLmZvcm1hdChbcnVsZXMuZ3QsIHJ1bGVzLmx0XSkgOiAnJwrEAQoNdWludDY0Lmd0X2x0ZRqyAWhhcyhydWxlcy5sdGUpICYmIHJ1bGVzLmx0ZSA+PSBydWxlcy5ndCAmJiAodGhpcyA+IHJ1bGVzLmx0ZSB8fCB0aGlzIDw9IHJ1bGVzLmd0KT8gJ3ZhbHVlIG11c3QgYmUgZ3JlYXRlciB0aGFuICVzIGFuZCBsZXNzIHRoYW4gb3IgZXF1YWwgdG8gJXMnLmZvcm1hdChbcnVsZXMuZ3QsIHJ1bGVzLmx0ZV0pIDogJycKzAEKF3VpbnQ2NC5ndF9sdGVfZXhjbHVzaXZlGrABaGFzKHJ1bGVzLmx0ZSkgJiYgcnVsZXMubHRlIDwgcnVsZXMuZ3QgJiYgKHJ1bGVzLmx0ZSA8IHRoaXMgJiYgdGhpcyA8PSBydWxlcy5ndCk/ICd2YWx1ZSBtdXN0IGJlIGdyZWF0ZXIgdGhhbiAlcyBvciBsZXNzIHRoYW4gb3IgZXF1YWwgdG8gJXMnLmZvcm1hdChbcnVsZXMuZ3QsIHJ1bGVzLmx0ZV0pIDogJydIARLoBwoDZ3RlGAUgASgEQtgHwkjUBwqJAQoKdWludDY0Lmd0ZRp7IWhhcyhydWxlcy5sdCkgJiYgIWhhcyhydWxlcy5sdGUpICYmIHRoaXMgPCBydWxlcy5ndGU/ICd2YWx1ZSBtdXN0IGJlIGdyZWF0ZXIgdGhhbiBvciBlcXVhbCB0byAlcycuZm9ybWF0KFtydWxlcy5ndGVdKSA6ICcnCsMBCg11aW50NjQuZ3RlX2x0GrEBaGFzKHJ1bGVzLmx0KSAmJiBydWxlcy5sdCA+PSBydWxlcy5ndGUgJiYgKHRoaXMgPj0gcnVsZXMubHQgfHwgdGhpcyA8IHJ1bGVzLmd0ZSk/ICd2YWx1ZSBtdXN0IGJlIGdyZWF0ZXIgdGhhbiBvciBlcXVhbCB0byAlcyBhbmQgbGVzcyB0aGFuICVzJy5mb3JtYXQoW3J1bGVzLmd0ZSwgcnVsZXMubHRdKSA6ICcnCssBChd1aW50NjQuZ3RlX2x0X2V4Y2x1c2l2ZRqvAWhhcyhydWxlcy5sdCkgJiYgcnVsZXMubHQgPCBydWxlcy5ndGUgJiYgKHJ1bGVzLmx0IDw9IHRoaXMgJiYgdGhpcyA8IHJ1bGVzLmd0ZSk/ICd2YWx1ZSBtdXN0IGJlIGdyZWF0ZXIgdGhhbiBvciBlcXVhbCB0byAlcyBvciBsZXNzIHRoYW4gJXMnLmZvcm1hdChbcnVsZXMuZ3RlLCBydWxlcy5sdF0pIDogJycK0wEKDnVpbnQ2NC5ndGVfbHRlGsABaGFzKHJ1bGVzLmx0ZSkgJiYgcnVsZXMubHRlID49IHJ1bGVzLmd0ZSAmJiAodGhpcyA+IHJ1bGVzLmx0ZSB8fCB0aGlzIDwgcnVsZXMuZ3RlKT8gJ3ZhbHVlIG11c3QgYmUgZ3JlYXRlciB0aGFuIG9yIGVxdWFsIHRvICVzIGFuZCBsZXNzIHRoYW4gb3IgZXF1YWwgdG8gJXMnLmZvcm1hdChbcnVsZXMuZ3RlLCBydWxlcy5sdGVdKSA6ICcnCtsBChh1aW50NjQuZ3RlX2x0ZV9leGNsdXNpdmUavgFoYXMocnVsZXMubHRlKSAmJiBydWxlcy5sdGUgPCBydWxlcy5ndGUgJiYgKHJ1bGVzLmx0ZSA8IHRoaXMgJiYgdGhpcyA8IHJ1bGVzLmd0ZSk/ICd2YWx1ZSBtdXN0IGJlIGdyZWF0ZXIgdGhhbiBvciBlcXVhbCB0byAlcyBvciBsZXNzIHRoYW4gb3IgZXF1YWwgdG8gJXMnLmZvcm1hdChbcnVsZXMuZ3RlLCBydWxlcy5sdGVdKSA6ICcnSAESgAEKAmluGAYgAygEQnTCSHEKbwoJdWludDY0LmluGmIhKHRoaXMgaW4gZ2V0RmllbGQocnVsZXMsICdpbicpKSA/ICd2YWx1ZSBtdXN0IGJlIGluIGxpc3QgJXMnLmZvcm1hdChbZ2V0RmllbGQocnVsZXMsICdpbicpXSkgOiAnJxJ3CgZub3RfaW4YByADKARCZ8JIZApiCg11aW50NjQubm90X2luGlF0aGlzIGluIHJ1bGVzLm5vdF9pbiA/ICd2YWx1ZSBtdXN0IG5vdCBiZSBpbiBsaXN0ICVzJy5mb3JtYXQoW3J1bGVzLm5vdF9pbl0pIDogJycSLAoHZXhhbXBsZRgIIAMoBEIbwkgYChYKDnVpbnQ2NC5leGFtcGxlGgR0cnVlKgkI6AcQgICAgAJCCwoJbGVzc190aGFuQg4KDGdyZWF0ZXJfdGhhbiKeFQoLU0ludDMyUnVsZXMShAEKBWNvbnN0GAEgASgRQnXCSHIKcAoMc2ludDMyLmNvbnN0GmB0aGlzICE9IGdldEZpZWxkKHJ1bGVzLCAnY29uc3QnKSA/ICd2YWx1ZSBtdXN0IGVxdWFsICVzJy5mb3JtYXQoW2dldEZpZWxkKHJ1bGVzLCAnY29uc3QnKV0pIDogJycSiwEKAmx0GAIgASgRQn3CSHoKeAoJc2ludDMyLmx0GmshaGFzKHJ1bGVzLmd0ZSkgJiYgIWhhcyhydWxlcy5ndCkgJiYgdGhpcyA+PSBydWxlcy5sdD8gJ3ZhbHVlIG11c3QgYmUgbGVzcyB0aGFuICVzJy5mb3JtYXQoW3J1bGVzLmx0XSkgOiAnJ0gAEp0BCgNsdGUYAyABKBFCjQHCSIkBCoYBCgpzaW50MzIubHRlGnghaGFzKHJ1bGVzLmd0ZSkgJiYgIWhhcyhydWxlcy5ndCkgJiYgdGhpcyA+IHJ1bGVzLmx0ZT8gJ3ZhbHVlIG11c3QgYmUgbGVzcyB0aGFuIG9yIGVxdWFsIHRvICVzJy5mb3JtYXQoW3J1bGVzLmx0ZV0pIDogJydIABKcBwoCZ3QYBCABKBFCjQfCSIkHCnsKCXNpbnQzMi5ndBpuIWhhcyhydWxlcy5sdCkgJiYgIWhhcyhydWxlcy5sdGUpICYmIHRoaXMgPD0gcnVsZXMuZ3Q/ICd2YWx1ZSBtdXN0IGJlIGdyZWF0ZXIgdGhhbiAlcycuZm9ybWF0KFtydWxlcy5ndF0pIDogJycKtAEKDHNpbnQzMi5ndF9sdBqjAWhhcyhydWxlcy5sdCkgJiYgcnVsZXMubHQgPj0gcnVsZXMuZ3QgJiYgKHRoaXMgPj0gcnVsZXMubHQgfHwgdGhpcyA8PSBydWxlcy5ndCk/ICd2YWx1ZSBtdXN0IGJlIGdyZWF0ZXIgdGhhbiAlcyBhbmQgbGVzcyB0aGFuICVzJy5mb3JtYXQoW3J1bGVzLmd0LCBydWxlcy5sdF0pIDogJycKvAEKFnNpbnQzMi5ndF9sdF9leGNsdXNpdmUaoQFoYXMocnVsZXMubHQpICYmIHJ1bGVzLmx0IDwgcnVsZXMuZ3QgJiYgKHJ1bGVzLmx0IDw9IHRoaXMgJiYgdGhpcyA8PSBydWxlcy5ndCk/ICd2YWx1ZSBtdXN0IGJlIGdyZWF0ZXIgdGhhbiAlcyBvciBsZXNzIHRoYW4gJXMnLmZvcm1hdChbcnVsZXMuZ3QsIHJ1bGVzLmx0XSkgOiAnJwrEAQoNc2ludDMyLmd0X2x0ZRqyAWhhcyhydWxlcy5sdGUpICYmIHJ1bGVzLmx0ZSA+PSBydWxlcy5ndCAmJiAodGhpcyA+IHJ1bGVzLmx0ZSB8fCB0aGlzIDw9IHJ1bGVzLmd0KT8gJ3ZhbHVlIG11c3QgYmUgZ3JlYXRlciB0aGFuICVzIGFuZCBsZXNzIHRoYW4gb3IgZXF1YWwgdG8gJXMnLmZvcm1hdChbcnVsZXMuZ3QsIHJ1bGVzLmx0ZV0pIDogJycKzAEKF3NpbnQzMi5ndF9sdGVfZXhjbHVzaXZlGrABaGFzKHJ1bGVzLmx0ZSkgJiYgcnVsZXMubHRlIDwgcnVsZXMuZ3QgJiYgKHJ1bGVzLmx0ZSA8IHRoaXMgJiYgdGhpcyA8PSBydWxlcy5ndCk/ICd2YWx1ZSBtdXN0IGJlIGdyZWF0ZXIgdGhhbiAlcyBvciBsZXNzIHRoYW4gb3IgZXF1YWwgdG8gJXMnLmZvcm1hdChbcnVsZXMuZ3QsIHJ1bGVzLmx0ZV0pIDogJydIARLoBwoDZ3RlGAUgASgRQtgHwkjUBwqJAQoKc2ludDMyLmd0ZRp7IWhhcyhydWxlcy5sdCkgJiYgIWhhcyhydWxlcy5sdGUpICYmIHRoaXMgPCBydWxlcy5ndGU/ICd2YWx1ZSBtdXN0IGJlIGdyZWF0ZXIgdGhhbiBvciBlcXVhbCB0byAlcycuZm9ybWF0KFtydWxlcy5ndGVdKSA6ICcnCsMBCg1zaW50MzIuZ3RlX2x0GrEBaGFzKHJ1bGVzLmx0KSAmJiBydWxlcy5sdCA+PSBydWxlcy5ndGUgJiYgKHRoaXMgPj0gcnVsZXMubHQgfHwgdGhpcyA8IHJ1bGVzLmd0ZSk/ICd2YWx1ZSBtdXN0IGJlIGdyZWF0ZXIgdGhhbiBvciBlcXVhbCB0byAlcyBhbmQgbGVzcyB0aGFuICVzJy5mb3JtYXQoW3J1bGVzLmd0ZSwgcnVsZXMubHRdKSA6ICcnCssBChdzaW50MzIuZ3RlX2x0X2V4Y2x1c2l2ZRqvAWhhcyhydWxlcy5sdCkgJiYgcnVsZXMubHQgPCBydWxlcy5ndGUgJiYgKHJ1bGVzLmx0IDw9IHRoaXMgJiYgdGhpcyA8IHJ1bGVzLmd0ZSk/ICd2YWx1ZSBtdXN0IGJlIGdyZWF0ZXIgdGhhbiBvciBlcXVhbCB0byAlcyBvciBsZXNzIHRoYW4gJXMnLmZvcm1hdChbcnVsZXMuZ3RlLCBydWxlcy5sdF0pIDogJycK0wEKDnNpbnQzMi5ndGVfbHRlGsABaGFzKHJ1bGVzLmx0ZSkgJiYgcnVsZXMubHRlID49IHJ1bGVzLmd0ZSAmJiAodGhpcyA+IHJ1bGVzLmx0ZSB8fCB0aGlzIDwgcnVsZXMuZ3RlKT8gJ3ZhbHVlIG11c3QgYmUgZ3JlYXRlciB0aGFuIG9yIGVxdWFsIHRvICVzIGFuZCBsZXNzIHRoYW4gb3IgZXF1YWwgdG8gJXMnLmZvcm1hdChbcnVsZXMuZ3RlLCBydWxlcy5sdGVdKSA6ICcnCtsBChhzaW50MzIuZ3RlX2x0ZV9leGNsdXNpdmUavgFoYXMocnVsZXMubHRlKSAmJiBydWxlcy5sdGUgPCBydWxlcy5ndGUgJiYgKHJ1bGVzLmx0ZSA8IHRoaXMgJiYgdGhpcyA8IHJ1bGVzLmd0ZSk/ICd2YWx1ZSBtdXN0IGJlIGdyZWF0ZXIgdGhhbiBvciBlcXVhbCB0byAlcyBvciBsZXNzIHRoYW4gb3IgZXF1YWwgdG8gJXMnLmZvcm1hdChbcnVsZXMuZ3RlLCBydWxlcy5sdGVdKSA6ICcnSAESgAEKAmluGAYgAygRQnTCSHEKbwoJc2ludDMyLmluGmIhKHRoaXMgaW4gZ2V0RmllbGQocnVsZXMsICdpbicpKSA/ICd2YWx1ZSBtdXN0IGJlIGluIGxpc3QgJXMnLmZvcm1hdChbZ2V0RmllbGQocnVsZXMsICdpbicpXSkgOiAnJxJ3CgZub3RfaW4YByADKBFCZ8JIZApiCg1zaW50MzIubm90X2luGlF0aGlzIGluIHJ1bGVzLm5vdF9pbiA/ICd2YWx1ZSBtdXN0IG5vdCBiZSBpbiBsaXN0ICVzJy5mb3JtYXQoW3J1bGVzLm5vdF9pbl0pIDogJycSLAoHZXhhbXBsZRgIIAMoEUIbwkgYChYKDnNpbnQzMi5leGFtcGxlGgR0cnVlKgkI6AcQgICAgAJCCwoJbGVzc190aGFuQg4KDGdyZWF0ZXJfdGhhbiKeFQoLU0ludDY0UnVsZXMShAEKBWNvbnN0GAEgASgSQnXCSHIKcAoMc2ludDY0LmNvbnN0GmB0aGlzICE9IGdldEZpZWxkKHJ1bGVzLCAnY29uc3QnKSA/ICd2YWx1ZSBtdXN0IGVxdWFsICVzJy5mb3JtYXQoW2dldEZpZWxkKHJ1bGVzLCAnY29uc3QnKV0pIDogJycSiwEKAmx0GAIgASgSQn3CSHoKeAoJc2ludDY0Lmx0GmshaGFzKHJ1bGVzLmd0ZSkgJiYgIWhhcyhydWxlcy5ndCkgJiYgdGhpcyA+PSBydWxlcy5sdD8gJ3ZhbHVlIG11c3QgYmUgbGVzcyB0aGFuICVzJy5mb3JtYXQoW3J1bGVzLmx0XSkgOiAnJ0gAEp0BCgNsdGUYAyABKBJCjQHCSIkBCoYBCgpzaW50NjQubHRlGnghaGFzKHJ1bGVzLmd0ZSkgJiYgIWhhcyhydWxlcy5ndCkgJiYgdGhpcyA+IHJ1bGVzLmx0ZT8gJ3ZhbHVlIG11c3QgYmUgbGVzcyB0aGFuIG9yIGVxdWFsIHRvICVzJy5mb3JtYXQoW3J1bGVzLmx0ZV0pIDogJydIABKcBwoCZ3QYBCABKBJCjQfCSIkHCnsKCXNpbnQ2NC5ndBpuIWhhcyhydWxlcy5sdCkgJiYgIWhhcyhydWxlcy5sdGUpICYmIHRoaXMgPD0gcnVsZXMuZ3Q/ICd2YWx1ZSBtdXN0IGJlIGdyZWF0ZXIgdGhhbiAlcycuZm9ybWF0KFtydWxlcy5ndF0pIDogJycKtAEKDHNpbnQ2NC5ndF9sdBqjAWhhcyhydWxlcy5sdCkgJiYgcnVsZXMubHQgPj0gcnVsZXMuZ3QgJiYgKHRoaXMgPj0gcnVsZXMubHQgfHwgdGhpcyA8PSBydWxlcy5ndCk/ICd2YWx1ZSBtdXN0IGJlIGdyZWF0ZXIgdGhhbiAlcyBhbmQgbGVzcyB0aGFuICVzJy5mb3JtYXQoW3J1bGVzLmd0LCBydWxlcy5sdF0pIDogJycKvAEKFnNpbnQ2NC5ndF9sdF9leGNsdXNpdmUaoQFoYXMocnVsZXMubHQpICYmIHJ1bGVzLmx0IDwgcnVsZXMuZ3QgJiYgKHJ1bGVzLmx0IDw9IHRoaXMgJiYgdGhpcyA8PSBydWxlcy5ndCk/ICd2YWx1ZSBtdXN0IGJlIGdyZWF0ZXIgdGhhbiAlcyBvciBsZXNzIHRoYW4gJXMnLmZvcm1hdChbcnVsZXMuZ3QsIHJ1bGVzLmx0XSkgOiAnJwrEAQoNc2ludDY0Lmd0X2x0ZRqyAWhhcyhydWxlcy5sdGUpICYmIHJ1bGVzLmx0ZSA+PSBydWxlcy5ndCAmJiAodGhpcyA+IHJ1bGVzLmx0ZSB8fCB0aGlzIDw9IHJ1bGVzLmd0KT8gJ3ZhbHVlIG11c3QgYmUgZ3JlYXRlciB0aGFuICVzIGFuZCBsZXNzIHRoYW4gb3IgZXF1YWwgdG8gJXMnLmZvcm1hdChbcnVsZXMuZ3QsIHJ1bGVzLmx0ZV0pIDogJycKzAEKF3NpbnQ2NC5ndF9sdGVfZXhjbHVzaXZlGrABaGFzKHJ1bGVzLmx0ZSkgJiYgcnVsZXMubHRlIDwgcnVsZXMuZ3QgJiYgKHJ1bGVzLmx0ZSA8IHRoaXMgJiYgdGhpcyA8PSBydWxlcy5ndCk/ICd2YWx1ZSBtdXN0IGJlIGdyZWF0ZXIgdGhhbiAlcyBvciBsZXNzIHRoYW4gb3IgZXF1YWwgdG8gJXMnLmZvcm1hdChbcnVsZXMuZ3QsIHJ1bGVzLmx0ZV0pIDogJydIARLoBwoDZ3RlGAUgASgSQtgHwkjUBwqJAQoKc2ludDY0Lmd0ZRp7IWhhcyhydWxlcy5sdCkgJiYgIWhhcyhydWxlcy5sdGUpICYmIHRoaXMgPCBydWxlcy5ndGU/ICd2YWx1ZSBtdXN0IGJlIGdyZWF0ZXIgdGhhbiBvciBlcXVhbCB0byAlcycuZm9ybWF0KFtydWxlcy5ndGVdKSA6ICcnCsMBCg1zaW50NjQuZ3RlX2x0GrEBaGFzKHJ1bGVzLmx0KSAmJiBydWxlcy5sdCA+PSBydWxlcy5ndGUgJiYgKHRoaXMgPj0gcnVsZXMubHQgfHwgdGhpcyA8IHJ1bGVzLmd0ZSk/ICd2YWx1ZSBtdXN0IGJlIGdyZWF0ZXIgdGhhbiBvciBlcXVhbCB0byAlcyBhbmQgbGVzcyB0aGFuICVzJy5mb3JtYXQoW3J1bGVzLmd0ZSwgcnVsZXMubHRdKSA6ICcnCssBChdzaW50NjQuZ3RlX2x0X2V4Y2x1c2l2ZRqvAWhhcyhydWxlcy5sdCkgJiYgcnVsZXMubHQgPCBydWxlcy5ndGUgJiYgKHJ1bGVzLmx0IDw9IHRoaXMgJiYgdGhpcyA8IHJ1bGVzLmd0ZSk/ICd2YWx1ZSBtdXN0IGJlIGdyZWF0ZXIgdGhhbiBvciBlcXVhbCB0byAlcyBvciBsZXNzIHRoYW4gJXMnLmZvcm1hdChbcnVsZXMuZ3RlLCBydWxlcy5sdF0pIDogJycK0wEKDnNpbnQ2NC5ndGVfbHRlGsABaGFzKHJ1bGVzLmx0ZSkgJiYgcnVsZXMubHRlID49IHJ1bGVzLmd0ZSAmJiAodGhpcyA+IHJ1bGVzLmx0ZSB8fCB0aGlzIDwgcnVsZXMuZ3RlKT8gJ3ZhbHVlIG11c3QgYmUgZ3JlYXRlciB0aGFuIG9yIGVxdWFsIHRvICVzIGFuZCBsZXNzIHRoYW4gb3IgZXF1YWwgdG8gJXMnLmZvcm1hdChbcnVsZXMuZ3RlLCBydWxlcy5sdGVdKSA6ICcnCtsBChhzaW50NjQuZ3RlX2x0ZV9leGNsdXNpdmUavgFoYXMocnVsZXMubHRlKSAmJiBydWxlcy5sdGUgPCBydWxlcy5ndGUgJiYgKHJ1bGVzLmx0ZSA8IHRoaXMgJiYgdGhpcyA8IHJ1bGVzLmd0ZSk/ICd2YWx1ZSBtdXN0IGJlIGdyZWF0ZXIgdGhhbiBvciBlcXVhbCB0byAlcyBvciBsZXNzIHRoYW4gb3IgZXF1YWwgdG8gJXMnLmZvcm1hdChbcnVsZXMuZ3RlLCBydWxlcy5sdGVdKSA6ICcnSAESgAEKAmluGAYgAygSQnTCSHEKbwoJc2ludDY0LmluGmIhKHRoaXMgaW4gZ2V0RmllbGQocnVsZXMsICdpbicpKSA/ICd2YWx1ZSBtdXN0IGJlIGluIGxpc3QgJXMnLmZvcm1hdChbZ2V0RmllbGQocnVsZXMsICdpbicpXSkgOiAnJxJ3CgZub3RfaW4YByADKBJCZ8JIZApiCg1zaW50NjQubm90X2luGlF0aGlzIGluIHJ1bGVzLm5vdF9pbiA/ICd2YWx1ZSBtdXN0IG5vdCBiZSBpbiBsaXN0ICVzJy5mb3JtYXQoW3J1bGVzLm5vdF9pbl0pIDogJycSLAoHZXhhbXBsZRgIIAMoEkIbwkgYChYKDnNpbnQ2NC5leGFtcGxlGgR0cnVlKgkI6AcQgICAgAJCCwoJbGVzc190aGFuQg4KDGdyZWF0ZXJfdGhhbiKvFQoMRml4ZWQzMlJ1bGVzEoUBCgVjb25zdBgBIAEoB0J2wkhzCnEKDWZpeGVkMzIuY29uc3QaYHRoaXMgIT0gZ2V0RmllbGQocnVsZXMsICdjb25zdCcpID8gJ3ZhbHVlIG11c3QgZXF1YWwgJXMnLmZvcm1hdChbZ2V0RmllbGQocnVsZXMsICdjb25zdCcpXSkgOiAnJxKMAQoCbHQYAiABKAdCfsJIewp5CgpmaXhlZDMyLmx0GmshaGFzKHJ1bGVzLmd0ZSkgJiYgIWhhcyhydWxlcy5ndCkgJiYgdGhpcyA+PSBydWxlcy5sdD8gJ3ZhbHVlIG11c3QgYmUgbGVzcyB0aGFuICVzJy5mb3JtYXQoW3J1bGVzLmx0XSkgOiAnJ0gAEp4BCgNsdGUYAyABKAdCjgHCSIoBCocBCgtmaXhlZDMyLmx0ZRp4IWhhcyhydWxlcy5ndGUpICYmICFoYXMocnVsZXMuZ3QpICYmIHRoaXMgPiBydWxlcy5sdGU/ICd2YWx1ZSBtdXN0IGJlIGxlc3MgdGhhbiBvciBlcXVhbCB0byAlcycuZm9ybWF0KFtydWxlcy5sdGVdKSA6ICcnSAASoQcKAmd0GAQgASgHQpIHwkiOBwp8CgpmaXhlZDMyLmd0Gm4haGFzKHJ1bGVzLmx0KSAmJiAhaGFzKHJ1bGVzLmx0ZSkgJiYgdGhpcyA8PSBydWxlcy5ndD8gJ3ZhbHVlIG11c3QgYmUgZ3JlYXRlciB0aGFuICVzJy5mb3JtYXQoW3J1bGVzLmd0XSkgOiAnJwq1AQoNZml4ZWQzMi5ndF9sdBqjAWhhcyhydWxlcy5sdCkgJiYgcnVsZXMubHQgPj0gcnVsZXMuZ3QgJiYgKHRoaXMgPj0gcnVsZXMubHQgfHwgdGhpcyA8PSBydWxlcy5ndCk/ICd2YWx1ZSBtdXN0IGJlIGdyZWF0ZXIgdGhhbiAlcyBhbmQgbGVzcyB0aGFuICVzJy5mb3JtYXQoW3J1bGVzLmd0LCBydWxlcy5sdF0pIDogJycKvQEKF2ZpeGVkMzIuZ3RfbHRfZXhjbHVzaXZlGqEBaGFzKHJ1bGVzLmx0KSAmJiBydWxlcy5sdCA8IHJ1bGVzLmd0ICYmIChydWxlcy5sdCA8PSB0aGlzICYmIHRoaXMgPD0gcnVsZXMuZ3QpPyAndmFsdWUgbXVzdCBiZSBncmVhdGVyIHRoYW4gJXMgb3IgbGVzcyB0aGFuICVzJy5mb3JtYXQoW3J1bGVzLmd0LCBydWxlcy5sdF0pIDogJycKxQEKDmZpeGVkMzIuZ3RfbHRlGrIBaGFzKHJ1bGVzLmx0ZSkgJiYgcnVsZXMubHRlID49IHJ1bGVzLmd0ICYmICh0aGlzID4gcnVsZXMubHRlIHx8IHRoaXMgPD0gcnVsZXMuZ3QpPyAndmFsdWUgbXVzdCBiZSBncmVhdGVyIHRoYW4gJXMgYW5kIGxlc3MgdGhhbiBvciBlcXVhbCB0byAlcycuZm9ybWF0KFtydWxlcy5ndCwgcnVsZXMubHRlXSkgOiAnJwrNAQoYZml4ZWQzMi5ndF9sdGVfZXhjbHVzaXZlGrABaGFzKHJ1bGVzLmx0ZSkgJiYgcnVsZXMubHRlIDwgcnVsZXMuZ3QgJiYgKHJ1bGVzLmx0ZSA8IHRoaXMgJiYgdGhpcyA8PSBydWxlcy5ndCk/ICd2YWx1ZSBtdXN0IGJlIGdyZWF0ZXIgdGhhbiAlcyBvciBsZXNzIHRoYW4gb3IgZXF1YWwgdG8gJXMnLmZvcm1hdChbcnVsZXMuZ3QsIHJ1bGVzLmx0ZV0pIDogJydIARLtBwoDZ3RlGAUgASgHQt0HwkjZBwqKAQoLZml4ZWQzMi5ndGUaeyFoYXMocnVsZXMubHQpICYmICFoYXMocnVsZXMubHRlKSAmJiB0aGlzIDwgcnVsZXMuZ3RlPyAndmFsdWUgbXVzdCBiZSBncmVhdGVyIHRoYW4gb3IgZXF1YWwgdG8gJXMnLmZvcm1hdChbcnVsZXMuZ3RlXSkgOiAnJwrEAQoOZml4ZWQzMi5ndGVfbHQasQFoYXMocnVsZXMubHQpICYmIHJ1bGVzLmx0ID49IHJ1bGVzLmd0ZSAmJiAodGhpcyA+PSBydWxlcy5sdCB8fCB0aGlzIDwgcnVsZXMuZ3RlKT8gJ3ZhbHVlIG11c3QgYmUgZ3JlYXRlciB0aGFuIG9yIGVxdWFsIHRvICVzIGFuZCBsZXNzIHRoYW4gJXMnLmZvcm1hdChbcnVsZXMuZ3RlLCBydWxlcy5sdF0pIDogJycKzAEKGGZpeGVkMzIuZ3RlX2x0X2V4Y2x1c2l2ZRqvAWhhcyhydWxlcy5sdCkgJiYgcnVsZXMubHQgPCBydWxlcy5ndGUgJiYgKHJ1bGVzLmx0IDw9IHRoaXMgJiYgdGhpcyA8IHJ1bGVzLmd0ZSk/ICd2YWx1ZSBtdXN0IGJlIGdyZWF0ZXIgdGhhbiBvciBlcXVhbCB0byAlcyBvciBsZXNzIHRoYW4gJXMnLmZvcm1hdChbcnVsZXMuZ3RlLCBydWxlcy5sdF0pIDogJycK1AEKD2ZpeGVkMzIuZ3RlX2x0ZRrAAWhhcyhydWxlcy5sdGUpICYmIHJ1bGVzLmx0ZSA+PSBydWxlcy5ndGUgJiYgKHRoaXMgPiBydWxlcy5sdGUgfHwgdGhpcyA8IHJ1bGVzLmd0ZSk/ICd2YWx1ZSBtdXN0IGJlIGdyZWF0ZXIgdGhhbiBvciBlcXVhbCB0byAlcyBhbmQgbGVzcyB0aGFuIG9yIGVxdWFsIHRvICVzJy5mb3JtYXQoW3J1bGVzLmd0ZSwgcnVsZXMubHRlXSkgOiAnJwrcAQoZZml4ZWQzMi5ndGVfbHRlX2V4Y2x1c2l2ZRq+AWhhcyhydWxlcy5sdGUpICYmIHJ1bGVzLmx0ZSA8IHJ1bGVzLmd0ZSAmJiAocnVsZXMubHRlIDwgdGhpcyAmJiB0aGlzIDwgcnVsZXMuZ3RlKT8gJ3ZhbHVlIG11c3QgYmUgZ3JlYXRlciB0aGFuIG9yIGVxdWFsIHRvICVzIG9yIGxlc3MgdGhhbiBvciBlcXVhbCB0byAlcycuZm9ybWF0KFtydWxlcy5ndGUsIHJ1bGVzLmx0ZV0pIDogJydIARKBAQoCaW4YBiADKAdCdcJIcgpwCgpmaXhlZDMyLmluGmIhKHRoaXMgaW4gZ2V0RmllbGQocnVsZXMsICdpbicpKSA/ICd2YWx1ZSBtdXN0IGJlIGluIGxpc3QgJXMnLmZvcm1hdChbZ2V0RmllbGQocnVsZXMsICdpbicpXSkgOiAnJxJ4CgZub3RfaW4YByADKAdCaMJIZQpjCg5maXhlZDMyLm5vdF9pbhpRdGhpcyBpbiBydWxlcy5ub3RfaW4gPyAndmFsdWUgbXVzdCBub3QgYmUgaW4gbGlzdCAlcycuZm9ybWF0KFtydWxlcy5ub3RfaW5dKSA6ICcnEi0KB2V4YW1wbGUYCCADKAdCHMJIGQoXCg9maXhlZDMyLmV4YW1wbGUaBHRydWUqCQjoBxCAgICAAkILCglsZXNzX3RoYW5CDgoMZ3JlYXRlcl90aGFuIq8VCgxGaXhlZDY0UnVsZXMShQEKBWNvbnN0GAEgASgGQnbCSHMKcQoNZml4ZWQ2NC5jb25zdBpgdGhpcyAhPSBnZXRGaWVsZChydWxlcywgJ2NvbnN0JykgPyAndmFsdWUgbXVzdCBlcXVhbCAlcycuZm9ybWF0KFtnZXRGaWVsZChydWxlcywgJ2NvbnN0JyldKSA6ICcnEowBCgJsdBgCIAEoBkJ+wkh7CnkKCmZpeGVkNjQubHQaayFoYXMocnVsZXMuZ3RlKSAmJiAhaGFzKHJ1bGVzLmd0KSAmJiB0aGlzID49IHJ1bGVzLmx0PyAndmFsdWUgbXVzdCBiZSBsZXNzIHRoYW4gJXMnLmZvcm1hdChbcnVsZXMubHRdKSA6ICcnSAASngEKA2x0ZRgDIAEoBkKOAcJIigEKhwEKC2ZpeGVkNjQubHRlGnghaGFzKHJ1bGVzLmd0ZSkgJiYgIWhhcyhydWxlcy5ndCkgJiYgdGhpcyA+IHJ1bGVzLmx0ZT8gJ3ZhbHVlIG11c3QgYmUgbGVzcyB0aGFuIG9yIGVxdWFsIHRvICVzJy5mb3JtYXQoW3J1bGVzLmx0ZV0pIDogJydIABKhBwoCZ3QYBCABKAZCkgfCSI4HCnwKCmZpeGVkNjQuZ3QabiFoYXMocnVsZXMubHQpICYmICFoYXMocnVsZXMubHRlKSAmJiB0aGlzIDw9IHJ1bGVzLmd0PyAndmFsdWUgbXVzdCBiZSBncmVhdGVyIHRoYW4gJXMnLmZvcm1hdChbcnVsZXMuZ3RdKSA6ICcnCrUBCg1maXhlZDY0Lmd0X2x0GqMBaGFzKHJ1bGVzLmx0KSAmJiBydWxlcy5sdCA+PSBydWxlcy5ndCAmJiAodGhpcyA+PSBydWxlcy5sdCB8fCB0aGlzIDw9IHJ1bGVzLmd0KT8gJ3ZhbHVlIG11c3QgYmUgZ3JlYXRlciB0aGFuICVzIGFuZCBsZXNzIHRoYW4gJXMnLmZvcm1hdChbcnVsZXMuZ3QsIHJ1bGVzLmx0XSkgOiAnJwq9AQoXZml4ZWQ2NC5ndF9sdF9leGNsdXNpdmUaoQFoYXMocnVsZXMubHQpICYmIHJ1bGVzLmx0IDwgcnVsZXMuZ3QgJiYgKHJ1bGVzLmx0IDw9IHRoaXMgJiYgdGhpcyA8PSBydWxlcy5ndCk/ICd2YWx1ZSBtdXN0IGJlIGdyZWF0ZXIgdGhhbiAlcyBvciBsZXNzIHRoYW4gJXMnLmZvcm1hdChbcnVsZXMuZ3QsIHJ1bGVzLmx0XSkgOiAnJwrFAQoOZml4ZWQ2NC5ndF9sdGUasgFoYXMocnVsZXMubHRlKSAmJiBydWxlcy5sdGUgPj0gcnVsZXMuZ3QgJiYgKHRoaXMgPiBydWxlcy5sdGUgfHwgdGhpcyA8PSBydWxlcy5ndCk/ICd2YWx1ZSBtdXN0IGJlIGdyZWF0ZXIgdGhhbiAlcyBhbmQgbGVzcyB0aGFuIG9yIGVxdWFsIHRvICVzJy5mb3JtYXQoW3J1bGVzLmd0LCBydWxlcy5sdGVdKSA6ICcnCs0BChhmaXhlZDY0Lmd0X2x0ZV9leGNsdXNpdmUasAFoYXMocnVsZXMubHRlKSAmJiBydWxlcy5sdGUgPCBydWxlcy5ndCAmJiAocnVsZXMubHRlIDwgdGhpcyAmJiB0aGlzIDw9IHJ1bGVzLmd0KT8gJ3ZhbHVlIG11c3QgYmUgZ3JlYXRlciB0aGFuICVzIG9yIGxlc3MgdGhhbiBvciBlcXVhbCB0byAlcycuZm9ybWF0KFtydWxlcy5ndCwgcnVsZXMubHRlXSkgOiAnJ0gBEu0HCgNndGUYBSABKAZC3QfCSNkHCooBCgtmaXhlZDY0Lmd0ZRp7IWhhcyhydWxlcy5sdCkgJiYgIWhhcyhydWxlcy5sdGUpICYmIHRoaXMgPCBydWxlcy5ndGU/ICd2YWx1ZSBtdXN0IGJlIGdyZWF0ZXIgdGhhbiBvciBlcXVhbCB0byAlcycuZm9ybWF0KFtydWxlcy5ndGVdKSA6ICcnCsQBCg5maXhlZDY0Lmd0ZV9sdBqxAWhhcyhydWxlcy5sdCkgJiYgcnVsZXMubHQgPj0gcnVsZXMuZ3RlICYmICh0aGlzID49IHJ1bGVzLmx0IHx8IHRoaXMgPCBydWxlcy5ndGUpPyAndmFsdWUgbXVzdCBiZSBncmVhdGVyIHRoYW4gb3IgZXF1YWwgdG8gJXMgYW5kIGxlc3MgdGhhbiAlcycuZm9ybWF0KFtydWxlcy5ndGUsIHJ1bGVzLmx0XSkgOiAnJwrMAQoYZml4ZWQ2NC5ndGVfbHRfZXhjbHVzaXZlGq8BaGFzKHJ1bGVzLmx0KSAmJiBydWxlcy5sdCA8IHJ1bGVzLmd0ZSAmJiAocnVsZXMubHQgPD0gdGhpcyAmJiB0aGlzIDwgcnVsZXMuZ3RlKT8gJ3ZhbHVlIG11c3QgYmUgZ3JlYXRlciB0aGFuIG9yIGVxdWFsIHRvICVzIG9yIGxlc3MgdGhhbiAlcycuZm9ybWF0KFtydWxlcy5ndGUsIHJ1bGVzLmx0XSkgOiAnJwrUAQoPZml4ZWQ2NC5ndGVfbHRlGsABaGFzKHJ1bGVzLmx0ZSkgJiYgcnVsZXMubHRlID49IHJ1bGVzLmd0ZSAmJiAodGhpcyA+IHJ1bGVzLmx0ZSB8fCB0aGlzIDwgcnVsZXMuZ3RlKT8gJ3ZhbHVlIG11c3QgYmUgZ3JlYXRlciB0aGFuIG9yIGVxdWFsIHRvICVzIGFuZCBsZXNzIHRoYW4gb3IgZXF1YWwgdG8gJXMnLmZvcm1hdChbcnVsZXMuZ3RlLCBydWxlcy5sdGVdKSA6ICcnCtwBChlmaXhlZDY0Lmd0ZV9sdGVfZXhjbHVzaXZlGr4BaGFzKHJ1bGVzLmx0ZSkgJiYgcnVsZXMubHRlIDwgcnVsZXMuZ3RlICYmIChydWxlcy5sdGUgPCB0aGlzICYmIHRoaXMgPCBydWxlcy5ndGUpPyAndmFsdWUgbXVzdCBiZSBncmVhdGVyIHRoYW4gb3IgZXF1YWwgdG8gJXMgb3IgbGVzcyB0aGFuIG9yIGVxdWFsIHRvICVzJy5mb3JtYXQoW3J1bGVzLmd0ZSwgcnVsZXMubHRlXSkgOiAnJ0gBEoEBCgJpbhgGIAMoBkJ1wkhyCnAKCmZpeGVkNjQuaW4aYiEodGhpcyBpbiBnZXRGaWVsZChydWxlcywgJ2luJykpID8gJ3ZhbHVlIG11c3QgYmUgaW4gbGlzdCAlcycuZm9ybWF0KFtnZXRGaWVsZChydWxlcywgJ2luJyldKSA6ICcnEngKBm5vdF9pbhgHIAMoBkJowkhlCmMKDmZpeGVkNjQubm90X2luGlF0aGlzIGluIHJ1bGVzLm5vdF9pbiA/ICd2YWx1ZSBtdXN0IG5vdCBiZSBpbiBsaXN0ICVzJy5mb3JtYXQoW3J1bGVzLm5vdF9pbl0pIDogJycSLQoHZXhhbXBsZRgIIAMoBkIcwkgZChcKD2ZpeGVkNjQuZXhhbXBsZRoEdHJ1ZSoJCOgHEICAgIACQgsKCWxlc3NfdGhhbkIOCgxncmVhdGVyX3RoYW4iwBUKDVNGaXhlZDMyUnVsZXMShgEKBWNvbnN0GAEgASgPQnfCSHQKcgoOc2ZpeGVkMzIuY29uc3QaYHRoaXMgIT0gZ2V0RmllbGQocnVsZXMsICdjb25zdCcpID8gJ3ZhbHVlIG11c3QgZXF1YWwgJXMnLmZvcm1hdChbZ2V0RmllbGQocnVsZXMsICdjb25zdCcpXSkgOiAnJxKNAQoCbHQYAiABKA9Cf8JIfAp6CgtzZml4ZWQzMi5sdBprIWhhcyhydWxlcy5ndGUpICYmICFoYXMocnVsZXMuZ3QpICYmIHRoaXMgPj0gcnVsZXMubHQ/ICd2YWx1ZSBtdXN0IGJlIGxlc3MgdGhhbiAlcycuZm9ybWF0KFtydWxlcy5sdF0pIDogJydIABKfAQoDbHRlGAMgASgPQo8BwkiLAQqIAQoMc2ZpeGVkMzIubHRlGnghaGFzKHJ1bGVzLmd0ZSkgJiYgIWhhcyhydWxlcy5ndCkgJiYgdGhpcyA+IHJ1bGVzLmx0ZT8gJ3ZhbHVlIG11c3QgYmUgbGVzcyB0aGFuIG9yIGVxdWFsIHRvICVzJy5mb3JtYXQoW3J1bGVzLmx0ZV0pIDogJydIABKmBwoCZ3QYBCABKA9ClwfCSJMHCn0KC3NmaXhlZDMyLmd0Gm4haGFzKHJ1bGVzLmx0KSAmJiAhaGFzKHJ1bGVzLmx0ZSkgJiYgdGhpcyA8PSBydWxlcy5ndD8gJ3ZhbHVlIG11c3QgYmUgZ3JlYXRlciB0aGFuICVzJy5mb3JtYXQoW3J1bGVzLmd0XSkgOiAnJwq2AQoOc2ZpeGVkMzIuZ3RfbHQaowFoYXMocnVsZXMubHQpICYmIHJ1bGVzLmx0ID49IHJ1bGVzLmd0ICYmICh0aGlzID49IHJ1bGVzLmx0IHx8IHRoaXMgPD0gcnVsZXMuZ3QpPyAndmFsdWUgbXVzdCBiZSBncmVhdGVyIHRoYW4gJXMgYW5kIGxlc3MgdGhhbiAlcycuZm9ybWF0KFtydWxlcy5ndCwgcnVsZXMubHRdKSA6ICcnCr4BChhzZml4ZWQzMi5ndF9sdF9leGNsdXNpdmUaoQFoYXMocnVsZXMubHQpICYmIHJ1bGVzLmx0IDwgcnVsZXMuZ3QgJiYgKHJ1bGVzLmx0IDw9IHRoaXMgJiYgdGhpcyA8PSBydWxlcy5ndCk/ICd2YWx1ZSBtdXN0IGJlIGdyZWF0ZXIgdGhhbiAlcyBvciBsZXNzIHRoYW4gJXMnLmZvcm1hdChbcnVsZXMuZ3QsIHJ1bGVzLmx0XSkgOiAnJwrGAQoPc2ZpeGVkMzIuZ3RfbHRlGrIBaGFzKHJ1bGVzLmx0ZSkgJiYgcnVsZXMubHRlID49IHJ1bGVzLmd0ICYmICh0aGlzID4gcnVsZXMubHRlIHx8IHRoaXMgPD0gcnVsZXMuZ3QpPyAndmFsdWUgbXVzdCBiZSBncmVhdGVyIHRoYW4gJXMgYW5kIGxlc3MgdGhhbiBvciBlcXVhbCB0byAlcycuZm9ybWF0KFtydWxlcy5ndCwgcnVsZXMubHRlXSkgOiAnJwrOAQoZc2ZpeGVkMzIuZ3RfbHRlX2V4Y2x1c2l2ZRqwAWhhcyhydWxlcy5sdGUpICYmIHJ1bGVzLmx0ZSA8IHJ1bGVzLmd0ICYmIChydWxlcy5sdGUgPCB0aGlzICYmIHRoaXMgPD0gcnVsZXMuZ3QpPyAndmFsdWUgbXVzdCBiZSBncmVhdGVyIHRoYW4gJXMgb3IgbGVzcyB0aGFuIG9yIGVxdWFsIHRvICVzJy5mb3JtYXQoW3J1bGVzLmd0LCBydWxlcy5sdGVdKSA6ICcnSAES8gcKA2d0ZRgFIAEoD0LiB8JI3gcKiwEKDHNmaXhlZDMyLmd0ZRp7IWhhcyhydWxlcy5sdCkgJiYgIWhhcyhydWxlcy5sdGUpICYmIHRoaXMgPCBydWxlcy5ndGU/ICd2YWx1ZSBtdXN0IGJlIGdyZWF0ZXIgdGhhbiBvciBlcXVhbCB0byAlcycuZm9ybWF0KFtydWxlcy5ndGVdKSA6ICcnCsUBCg9zZml4ZWQzMi5ndGVfbHQasQFoYXMocnVsZXMubHQpICYmIHJ1bGVzLmx0ID49IHJ1bGVzLmd0ZSAmJiAodGhpcyA+PSBydWxlcy5sdCB8fCB0aGlzIDwgcnVsZXMuZ3RlKT8gJ3ZhbHVlIG11c3QgYmUgZ3JlYXRlciB0aGFuIG9yIGVxdWFsIHRvICVzIGFuZCBsZXNzIHRoYW4gJXMnLmZvcm1hdChbcnVsZXMuZ3RlLCBydWxlcy5sdF0pIDogJycKzQEKGXNmaXhlZDMyLmd0ZV9sdF9leGNsdXNpdmUarwFoYXMocnVsZXMubHQpICYmIHJ1bGVzLmx0IDwgcnVsZXMuZ3RlICYmIChydWxlcy5sdCA8PSB0aGlzICYmIHRoaXMgPCBydWxlcy5ndGUpPyAndmFsdWUgbXVzdCBiZSBncmVhdGVyIHRoYW4gb3IgZXF1YWwgdG8gJXMgb3IgbGVzcyB0aGFuICVzJy5mb3JtYXQoW3J1bGVzLmd0ZSwgcnVsZXMubHRdKSA6ICcnCtUBChBzZml4ZWQzMi5ndGVfbHRlGsABaGFzKHJ1bGVzLmx0ZSkgJiYgcnVsZXMubHRlID49IHJ1bGVzLmd0ZSAmJiAodGhpcyA+IHJ1bGVzLmx0ZSB8fCB0aGlzIDwgcnVsZXMuZ3RlKT8gJ3ZhbHVlIG11c3QgYmUgZ3JlYXRlciB0aGFuIG9yIGVxdWFsIHRvICVzIGFuZCBsZXNzIHRoYW4gb3IgZXF1YWwgdG8gJXMnLmZvcm1hdChbcnVsZXMuZ3RlLCBydWxlcy5sdGVdKSA6ICcnCt0BChpzZml4ZWQzMi5ndGVfbHRlX2V4Y2x1c2l2ZRq+AWhhcyhydWxlcy5sdGUpICYmIHJ1bGVzLmx0ZSA8IHJ1bGVzLmd0ZSAmJiAocnVsZXMubHRlIDwgdGhpcyAmJiB0aGlzIDwgcnVsZXMuZ3RlKT8gJ3ZhbHVlIG11c3QgYmUgZ3JlYXRlciB0aGFuIG9yIGVxdWFsIHRvICVzIG9yIGxlc3MgdGhhbiBvciBlcXVhbCB0byAlcycuZm9ybWF0KFtydWxlcy5ndGUsIHJ1bGVzLmx0ZV0pIDogJydIARKCAQoCaW4YBiADKA9CdsJIcwpxCgtzZml4ZWQzMi5pbhpiISh0aGlzIGluIGdldEZpZWxkKHJ1bGVzLCAnaW4nKSkgPyAndmFsdWUgbXVzdCBiZSBpbiBsaXN0ICVzJy5mb3JtYXQoW2dldEZpZWxkKHJ1bGVzLCAnaW4nKV0pIDogJycSeQoGbm90X2luGAcgAygPQmnCSGYKZAoPc2ZpeGVkMzIubm90X2luGlF0aGlzIGluIHJ1bGVzLm5vdF9pbiA/ICd2YWx1ZSBtdXN0IG5vdCBiZSBpbiBsaXN0ICVzJy5mb3JtYXQoW3J1bGVzLm5vdF9pbl0pIDogJycSLgoHZXhhbXBsZRgIIAMoD0IdwkgaChgKEHNmaXhlZDMyLmV4YW1wbGUaBHRydWUqCQjoBxCAgICAAkILCglsZXNzX3RoYW5CDgoMZ3JlYXRlcl90aGFuIsAVCg1TRml4ZWQ2NFJ1bGVzEoYBCgVjb25zdBgBIAEoEEJ3wkh0CnIKDnNmaXhlZDY0LmNvbnN0GmB0aGlzICE9IGdldEZpZWxkKHJ1bGVzLCAnY29uc3QnKSA/ICd2YWx1ZSBtdXN0IGVxdWFsICVzJy5mb3JtYXQoW2dldEZpZWxkKHJ1bGVzLCAnY29uc3QnKV0pIDogJycSjQEKAmx0GAIgASgQQn/CSHwKegoLc2ZpeGVkNjQubHQaayFoYXMocnVsZXMuZ3RlKSAmJiAhaGFzKHJ1bGVzLmd0KSAmJiB0aGlzID49IHJ1bGVzLmx0PyAndmFsdWUgbXVzdCBiZSBsZXNzIHRoYW4gJXMnLmZvcm1hdChbcnVsZXMubHRdKSA6ICcnSAASnwEKA2x0ZRgDIAEoEEKPAcJIiwEKiAEKDHNmaXhlZDY0Lmx0ZRp4IWhhcyhydWxlcy5ndGUpICYmICFoYXMocnVsZXMuZ3QpICYmIHRoaXMgPiBydWxlcy5sdGU/ICd2YWx1ZSBtdXN0IGJlIGxlc3MgdGhhbiBvciBlcXVhbCB0byAlcycuZm9ybWF0KFtydWxlcy5sdGVdKSA6ICcnSAASpgcKAmd0GAQgASgQQpcHwkiTBwp9CgtzZml4ZWQ2NC5ndBpuIWhhcyhydWxlcy5sdCkgJiYgIWhhcyhydWxlcy5sdGUpICYmIHRoaXMgPD0gcnVsZXMuZ3Q/ICd2YWx1ZSBtdXN0IGJlIGdyZWF0ZXIgdGhhbiAlcycuZm9ybWF0KFtydWxlcy5ndF0pIDogJycKtgEKDnNmaXhlZDY0Lmd0X2x0GqMBaGFzKHJ1bGVzLmx0KSAmJiBydWxlcy5sdCA+PSBydWxlcy5ndCAmJiAodGhpcyA+PSBydWxlcy5sdCB8fCB0aGlzIDw9IHJ1bGVzLmd0KT8gJ3ZhbHVlIG11c3QgYmUgZ3JlYXRlciB0aGFuICVzIGFuZCBsZXNzIHRoYW4gJXMnLmZvcm1hdChbcnVsZXMuZ3QsIHJ1bGVzLmx0XSkgOiAnJwq+AQoYc2ZpeGVkNjQuZ3RfbHRfZXhjbHVzaXZlGqEBaGFzKHJ1bGVzLmx0KSAmJiBydWxlcy5sdCA8IHJ1bGVzLmd0ICYmIChydWxlcy5sdCA8PSB0aGlzICYmIHRoaXMgPD0gcnVsZXMuZ3QpPyAndmFsdWUgbXVzdCBiZSBncmVhdGVyIHRoYW4gJXMgb3IgbGVzcyB0aGFuICVzJy5mb3JtYXQoW3J1bGVzLmd0LCBydWxlcy5sdF0pIDogJycKxgEKD3NmaXhlZDY0Lmd0X2x0ZRqyAWhhcyhydWxlcy5sdGUpICYmIHJ1bGVzLmx0ZSA+PSBydWxlcy5ndCAmJiAodGhpcyA+IHJ1bGVzLmx0ZSB8fCB0aGlzIDw9IHJ1bGVzLmd0KT8gJ3ZhbHVlIG11c3QgYmUgZ3JlYXRlciB0aGFuICVzIGFuZCBsZXNzIHRoYW4gb3IgZXF1YWwgdG8gJXMnLmZvcm1hdChbcnVsZXMuZ3QsIHJ1bGVzLmx0ZV0pIDogJycKzgEKGXNmaXhlZDY0Lmd0X2x0ZV9leGNsdXNpdmUasAFoYXMocnVsZXMubHRlKSAmJiBydWxlcy5sdGUgPCBydWxlcy5ndCAmJiAocnVsZXMubHRlIDwgdGhpcyAmJiB0aGlzIDw9IHJ1bGVzLmd0KT8gJ3ZhbHVlIG11c3QgYmUgZ3JlYXRlciB0aGFuICVzIG9yIGxlc3MgdGhhbiBvciBlcXVhbCB0byAlcycuZm9ybWF0KFtydWxlcy5ndCwgcnVsZXMubHRlXSkgOiAnJ0gBEvIHCgNndGUYBSABKBBC4gfCSN4HCosBCgxzZml4ZWQ2NC5ndGUaeyFoYXMocnVsZXMubHQpICYmICFoYXMocnVsZXMubHRlKSAmJiB0aGlzIDwgcnVsZXMuZ3RlPyAndmFsdWUgbXVzdCBiZSBncmVhdGVyIHRoYW4gb3IgZXF1YWwgdG8gJXMnLmZvcm1hdChbcnVsZXMuZ3RlXSkgOiAnJwrFAQoPc2ZpeGVkNjQuZ3RlX2x0GrEBaGFzKHJ1bGVzLmx0KSAmJiBydWxlcy5sdCA+PSBydWxlcy5ndGUgJiYgKHRoaXMgPj0gcnVsZXMubHQgfHwgdGhpcyA8IHJ1bGVzLmd0ZSk/ICd2YWx1ZSBtdXN0IGJlIGdyZWF0ZXIgdGhhbiBvciBlcXVhbCB0byAlcyBhbmQgbGVzcyB0aGFuICVzJy5mb3JtYXQoW3J1bGVzLmd0ZSwgcnVsZXMubHRdKSA6ICcnCs0BChlzZml4ZWQ2NC5ndGVfbHRfZXhjbHVzaXZlGq8BaGFzKHJ1bGVzLmx0KSAmJiBydWxlcy5sdCA8IHJ1bGVzLmd0ZSAmJiAocnVsZXMubHQgPD0gdGhpcyAmJiB0aGlzIDwgcnVsZXMuZ3RlKT8gJ3ZhbHVlIG11c3QgYmUgZ3JlYXRlciB0aGFuIG9yIGVxdWFsIHRvICVzIG9yIGxlc3MgdGhhbiAlcycuZm9ybWF0KFtydWxlcy5ndGUsIHJ1bGVzLmx0XSkgOiAnJwrVAQoQc2ZpeGVkNjQuZ3RlX2x0ZRrAAWhhcyhydWxlcy5sdGUpICYmIHJ1bGVzLmx0ZSA+PSBydWxlcy5ndGUgJiYgKHRoaXMgPiBydWxlcy5sdGUgfHwgdGhpcyA8IHJ1bGVzLmd0ZSk/ICd2YWx1ZSBtdXN0IGJlIGdyZWF0ZXIgdGhhbiBvciBlcXVhbCB0byAlcyBhbmQgbGVzcyB0aGFuIG9yIGVxdWFsIHRvICVzJy5mb3JtYXQoW3J1bGVzLmd0ZSwgcnVsZXMubHRlXSkgOiAnJwrdAQoac2ZpeGVkNjQuZ3RlX2x0ZV9leGNsdXNpdmUavgFoYXMocnVsZXMubHRlKSAmJiBydWxlcy5sdGUgPCBydWxlcy5ndGUgJiYgKHJ1bGVzLmx0ZSA8IHRoaXMgJiYgdGhpcyA8IHJ1bGVzLmd0ZSk/ICd2YWx1ZSBtdXN0IGJlIGdyZWF0ZXIgdGhhbiBvciBlcXVhbCB0byAlcyBvciBsZXNzIHRoYW4gb3IgZXF1YWwgdG8gJXMnLmZvcm1hdChbcnVsZXMuZ3RlLCBydWxlcy5sdGVdKSA6ICcnSAESggEKAmluGAYgAygQQnbCSHMKcQoLc2ZpeGVkNjQuaW4aYiEodGhpcyBpbiBnZXRGaWVsZChydWxlcywgJ2luJykpID8gJ3ZhbHVlIG11c3QgYmUgaW4gbGlzdCAlcycuZm9ybWF0KFtnZXRGaWVsZChydWxlcywgJ2luJyldKSA6ICcnEnkKBm5vdF9pbhgHIAMoEEJpwkhmCmQKD3NmaXhlZDY0Lm5vdF9pbhpRdGhpcyBpbiBydWxlcy5ub3RfaW4gPyAndmFsdWUgbXVzdCBub3QgYmUgaW4gbGlzdCAlcycuZm9ybWF0KFtydWxlcy5ub3RfaW5dKSA6ICcnEi4KB2V4YW1wbGUYCCADKBBCHcJIGgoYChBzZml4ZWQ2NC5leGFtcGxlGgR0cnVlKgkI6AcQgICAgAJCCwoJbGVzc190aGFuQg4KDGdyZWF0ZXJfdGhhbiLHAQoJQm9vbFJ1bGVzEoIBCgVjb25zdBgBIAEoCEJzwkhwCm4KCmJvb2wuY29uc3QaYHRoaXMgIT0gZ2V0RmllbGQocnVsZXMsICdjb25zdCcpID8gJ3ZhbHVlIG11c3QgZXF1YWwgJXMnLmZvcm1hdChbZ2V0RmllbGQocnVsZXMsICdjb25zdCcpXSkgOiAnJxIqCgdleGFtcGxlGAIgAygIQhnCSBYKFAoMYm9vbC5leGFtcGxlGgR0cnVlKgkI6AcQgICAgAIiiDkKC1N0cmluZ1J1bGVzEoYBCgVjb25zdBgBIAEoCUJ3wkh0CnIKDHN0cmluZy5jb25zdBpidGhpcyAhPSBnZXRGaWVsZChydWxlcywgJ2NvbnN0JykgPyAndmFsdWUgbXVzdCBlcXVhbCBgJXNgJy5mb3JtYXQoW2dldEZpZWxkKHJ1bGVzLCAnY29uc3QnKV0pIDogJycSfgoDbGVuGBMgASgEQnHCSG4KbAoKc3RyaW5nLmxlbhpedWludCh0aGlzLnNpemUoKSkgIT0gcnVsZXMubGVuID8gJ3ZhbHVlIGxlbmd0aCBtdXN0IGJlICVzIGNoYXJhY3RlcnMnLmZvcm1hdChbcnVsZXMubGVuXSkgOiAnJxKZAQoHbWluX2xlbhgCIAEoBEKHAcJIgwEKgAEKDnN0cmluZy5taW5fbGVuGm51aW50KHRoaXMuc2l6ZSgpKSA8IHJ1bGVzLm1pbl9sZW4gPyAndmFsdWUgbGVuZ3RoIG11c3QgYmUgYXQgbGVhc3QgJXMgY2hhcmFjdGVycycuZm9ybWF0KFtydWxlcy5taW5fbGVuXSkgOiAnJxKXAQoHbWF4X2xlbhgDIAEoBEKFAcJIgQEKfwoOc3RyaW5nLm1heF9sZW4abXVpbnQodGhpcy5zaXplKCkpID4gcnVsZXMubWF4X2xlbiA/ICd2YWx1ZSBsZW5ndGggbXVzdCBiZSBhdCBtb3N0ICVzIGNoYXJhY3RlcnMnLmZvcm1hdChbcnVsZXMubWF4X2xlbl0pIDogJycSmwEKCWxlbl9ieXRlcxgUIAEoBEKHAcJIgwEKgAEKEHN0cmluZy5sZW5fYnl0ZXMabHVpbnQoYnl0ZXModGhpcykuc2l6ZSgpKSAhPSBydWxlcy5sZW5fYnl0ZXMgPyAndmFsdWUgbGVuZ3RoIG11c3QgYmUgJXMgYnl0ZXMnLmZvcm1hdChbcnVsZXMubGVuX2J5dGVzXSkgOiAnJxKjAQoJbWluX2J5dGVzGAQgASgEQo8BwkiLAQqIAQoQc3RyaW5nLm1pbl9ieXRlcxp0dWludChieXRlcyh0aGlzKS5zaXplKCkpIDwgcnVsZXMubWluX2J5dGVzID8gJ3ZhbHVlIGxlbmd0aCBtdXN0IGJlIGF0IGxlYXN0ICVzIGJ5dGVzJy5mb3JtYXQoW3J1bGVzLm1pbl9ieXRlc10pIDogJycSogEKCW1heF9ieXRlcxgFIAEoBEKOAcJIigEKhwEKEHN0cmluZy5tYXhfYnl0ZXMac3VpbnQoYnl0ZXModGhpcykuc2l6ZSgpKSA+IHJ1bGVzLm1heF9ieXRlcyA/ICd2YWx1ZSBsZW5ndGggbXVzdCBiZSBhdCBtb3N0ICVzIGJ5dGVzJy5mb3JtYXQoW3J1bGVzLm1heF9ieXRlc10pIDogJycSjQEKB3BhdHRlcm4YBiABKAlCfMJIeQp3Cg5zdHJpbmcucGF0dGVybhplIXRoaXMubWF0Y2hlcyhydWxlcy5wYXR0ZXJuKSA/ICd2YWx1ZSBkb2VzIG5vdCBtYXRjaCByZWdleCBwYXR0ZXJuIGAlc2AnLmZvcm1hdChbcnVsZXMucGF0dGVybl0pIDogJycShAEKBnByZWZpeBgHIAEoCUJ0wkhxCm8KDXN0cmluZy5wcmVmaXgaXiF0aGlzLnN0YXJ0c1dpdGgocnVsZXMucHJlZml4KSA/ICd2YWx1ZSBkb2VzIG5vdCBoYXZlIHByZWZpeCBgJXNgJy5mb3JtYXQoW3J1bGVzLnByZWZpeF0pIDogJycSggEKBnN1ZmZpeBgIIAEoCUJywkhvCm0KDXN0cmluZy5zdWZmaXgaXCF0aGlzLmVuZHNXaXRoKHJ1bGVzLnN1ZmZpeCkgPyAndmFsdWUgZG9lcyBub3QgaGF2ZSBzdWZmaXggYCVzYCcuZm9ybWF0KFtydWxlcy5zdWZmaXhdKSA6ICcnEpABCghjb250YWlucxgJIAEoCUJ+wkh7CnkKD3N0cmluZy5jb250YWlucxpmIXRoaXMuY29udGFpbnMocnVsZXMuY29udGFpbnMpID8gJ3ZhbHVlIGRvZXMgbm90IGNvbnRhaW4gc3Vic3RyaW5nIGAlc2AnLmZvcm1hdChbcnVsZXMuY29udGFpbnNdKSA6ICcnEpgBCgxub3RfY29udGFpbnMYFyABKAlCgQHCSH4KfAoTc3RyaW5nLm5vdF9jb250YWlucxpldGhpcy5jb250YWlucyhydWxlcy5ub3RfY29udGFpbnMpID8gJ3ZhbHVlIGNvbnRhaW5zIHN1YnN0cmluZyBgJXNgJy5mb3JtYXQoW3J1bGVzLm5vdF9jb250YWluc10pIDogJycSgAEKAmluGAogAygJQnTCSHEKbwoJc3RyaW5nLmluGmIhKHRoaXMgaW4gZ2V0RmllbGQocnVsZXMsICdpbicpKSA/ICd2YWx1ZSBtdXN0IGJlIGluIGxpc3QgJXMnLmZvcm1hdChbZ2V0RmllbGQocnVsZXMsICdpbicpXSkgOiAnJxJ3CgZub3RfaW4YCyADKAlCZ8JIZApiCg1zdHJpbmcubm90X2luGlF0aGlzIGluIHJ1bGVzLm5vdF9pbiA/ICd2YWx1ZSBtdXN0IG5vdCBiZSBpbiBsaXN0ICVzJy5mb3JtYXQoW3J1bGVzLm5vdF9pbl0pIDogJycS3wEKBWVtYWlsGAwgASgIQs0BwkjJAQphCgxzdHJpbmcuZW1haWwSI3ZhbHVlIG11c3QgYmUgYSB2YWxpZCBlbWFpbCBhZGRyZXNzGiwhcnVsZXMuZW1haWwgfHwgdGhpcyA9PSAnJyB8fCB0aGlzLmlzRW1haWwoKQpkChJzdHJpbmcuZW1haWxfZW1wdHkSMnZhbHVlIGlzIGVtcHR5LCB3aGljaCBpcyBub3QgYSB2YWxpZCBlbWFpbCBhZGRyZXNzGhohcnVsZXMuZW1haWwgfHwgdGhpcyAhPSAnJ0gAEucBCghob3N0bmFtZRgNIAEoCELSAcJIzgEKZQoPc3RyaW5nLmhvc3RuYW1lEh52YWx1ZSBtdXN0IGJlIGEgdmFsaWQgaG9zdG5hbWUaMiFydWxlcy5ob3N0bmFtZSB8fCB0aGlzID09ICcnIHx8IHRoaXMuaXNIb3N0bmFtZSgpCmUKFXN0cmluZy5ob3N0bmFtZV9lbXB0eRItdmFsdWUgaXMgZW1wdHksIHdoaWNoIGlzIG5vdCBhIHZhbGlkIGhvc3RuYW1lGh0hcnVsZXMuaG9zdG5hbWUgfHwgdGhpcyAhPSAnJ0gAEscBCgJpcBgOIAEoCEK4AcJItAEKVQoJc3RyaW5nLmlwEiB2YWx1ZSBtdXN0IGJlIGEgdmFsaWQgSVAgYWRkcmVzcxomIXJ1bGVzLmlwIHx8IHRoaXMgPT0gJycgfHwgdGhpcy5pc0lwKCkKWwoPc3RyaW5nLmlwX2VtcHR5Ei92YWx1ZSBpcyBlbXB0eSwgd2hpY2ggaXMgbm90IGEgdmFsaWQgSVAgYWRkcmVzcxoXIXJ1bGVzLmlwIHx8IHRoaXMgIT0gJydIABLWAQoEaXB2NBgPIAEoCELFAcJIwQEKXAoLc3RyaW5nLmlwdjQSInZhbHVlIG11c3QgYmUgYSB2YWxpZCBJUHY0IGFkZHJlc3MaKSFydWxlcy5pcHY0IHx8IHRoaXMgPT0gJycgfHwgdGhpcy5pc0lwKDQpCmEKEXN0cmluZy5pcHY0X2VtcHR5EjF2YWx1ZSBpcyBlbXB0eSwgd2hpY2ggaXMgbm90IGEgdmFsaWQgSVB2NCBhZGRyZXNzGhkhcnVsZXMuaXB2NCB8fCB0aGlzICE9ICcnSAAS1gEKBGlwdjYYECABKAhCxQHCSMEBClwKC3N0cmluZy5pcHY2EiJ2YWx1ZSBtdXN0IGJlIGEgdmFsaWQgSVB2NiBhZGRyZXNzGikhcnVsZXMuaXB2NiB8fCB0aGlzID09ICcnIHx8IHRoaXMuaXNJcCg2KQphChFzdHJpbmcuaXB2Nl9lbXB0eRIxdmFsdWUgaXMgZW1wdHksIHdoaWNoIGlzIG5vdCBhIHZhbGlkIElQdjYgYWRkcmVzcxoZIXJ1bGVzLmlwdjYgfHwgdGhpcyAhPSAnJ0gAEr8BCgN1cmkYESABKAhCrwHCSKsBClEKCnN0cmluZy51cmkSGXZhbHVlIG11c3QgYmUgYSB2YWxpZCBVUkkaKCFydWxlcy51cmkgfHwgdGhpcyA9PSAnJyB8fCB0aGlzLmlzVXJpKCkKVgoQc3RyaW5nLnVyaV9lbXB0eRIodmFsdWUgaXMgZW1wdHksIHdoaWNoIGlzIG5vdCBhIHZhbGlkIFVSSRoYIXJ1bGVzLnVyaSB8fCB0aGlzICE9ICcnSAAScAoHdXJpX3JlZhgSIAEoCEJdwkhaClgKDnN0cmluZy51cmlfcmVmEiN2YWx1ZSBtdXN0IGJlIGEgdmFsaWQgVVJJIFJlZmVyZW5jZRohIXJ1bGVzLnVyaV9yZWYgfHwgdGhpcy5pc1VyaVJlZigpSAASkAIKB2FkZHJlc3MYFSABKAhC/AHCSPgBCoEBCg5zdHJpbmcuYWRkcmVzcxItdmFsdWUgbXVzdCBiZSBhIHZhbGlkIGhvc3RuYW1lLCBvciBpcCBhZGRyZXNzGkAhcnVsZXMuYWRkcmVzcyB8fCB0aGlzID09ICcnIHx8IHRoaXMuaXNIb3N0bmFtZSgpIHx8IHRoaXMuaXNJcCgpCnIKFHN0cmluZy5hZGRyZXNzX2VtcHR5Ejx2YWx1ZSBpcyBlbXB0eSwgd2hpY2ggaXMgbm90IGEgdmFsaWQgaG9zdG5hbWUsIG9yIGlwIGFkZHJlc3MaHCFydWxlcy5hZGRyZXNzIHx8IHRoaXMgIT0gJydIABKYAgoEdXVpZBgWIAEoCEKHAsJIgwIKpQEKC3N0cmluZy51dWlkEhp2YWx1ZSBtdXN0IGJlIGEgdmFsaWQgVVVJRBp6IXJ1bGVzLnV1aWQgfHwgdGhpcyA9PSAnJyB8fCB0aGlzLm1hdGNoZXMoJ15bMC05YS1mQS1GXXs4fS1bMC05YS1mQS1GXXs0fS1bMC05YS1mQS1GXXs0fS1bMC05YS1mQS1GXXs0fS1bMC05YS1mQS1GXXsxMn0kJykKWQoRc3RyaW5nLnV1aWRfZW1wdHkSKXZhbHVlIGlzIGVtcHR5LCB3aGljaCBpcyBub3QgYSB2YWxpZCBVVUlEGhkhcnVsZXMudXVpZCB8fCB0aGlzICE9ICcnSAAS8AEKBXR1dWlkGCEgASgIQt4BwkjaAQpzCgxzdHJpbmcudHV1aWQSInZhbHVlIG11c3QgYmUgYSB2YWxpZCB0cmltbWVkIFVVSUQaPyFydWxlcy50dXVpZCB8fCB0aGlzID09ICcnIHx8IHRoaXMubWF0Y2hlcygnXlswLTlhLWZBLUZdezMyfSQnKQpjChJzdHJpbmcudHV1aWRfZW1wdHkSMXZhbHVlIGlzIGVtcHR5LCB3aGljaCBpcyBub3QgYSB2YWxpZCB0cmltbWVkIFVVSUQaGiFydWxlcy50dXVpZCB8fCB0aGlzICE9ICcnSAASlgIKEWlwX3dpdGhfcHJlZml4bGVuGBogASgIQvgBwkj0AQp4ChhzdHJpbmcuaXBfd2l0aF9wcmVmaXhsZW4SH3ZhbHVlIG11c3QgYmUgYSB2YWxpZCBJUCBwcmVmaXgaOyFydWxlcy5pcF93aXRoX3ByZWZpeGxlbiB8fCB0aGlzID09ICcnIHx8IHRoaXMuaXNJcFByZWZpeCgpCngKHnN0cmluZy5pcF93aXRoX3ByZWZpeGxlbl9lbXB0eRIudmFsdWUgaXMgZW1wdHksIHdoaWNoIGlzIG5vdCBhIHZhbGlkIElQIHByZWZpeBomIXJ1bGVzLmlwX3dpdGhfcHJlZml4bGVuIHx8IHRoaXMgIT0gJydIABLPAgoTaXB2NF93aXRoX3ByZWZpeGxlbhgbIAEoCEKvAsJIqwIKkwEKGnN0cmluZy5pcHY0X3dpdGhfcHJlZml4bGVuEjV2YWx1ZSBtdXN0IGJlIGEgdmFsaWQgSVB2NCBhZGRyZXNzIHdpdGggcHJlZml4IGxlbmd0aBo+IXJ1bGVzLmlwdjRfd2l0aF9wcmVmaXhsZW4gfHwgdGhpcyA9PSAnJyB8fCB0aGlzLmlzSXBQcmVmaXgoNCkKkgEKIHN0cmluZy5pcHY0X3dpdGhfcHJlZml4bGVuX2VtcHR5EkR2YWx1ZSBpcyBlbXB0eSwgd2hpY2ggaXMgbm90IGEgdmFsaWQgSVB2NCBhZGRyZXNzIHdpdGggcHJlZml4IGxlbmd0aBooIXJ1bGVzLmlwdjRfd2l0aF9wcmVmaXhsZW4gfHwgdGhpcyAhPSAnJ0gAEs8CChNpcHY2X3dpdGhfcHJlZml4bGVuGBwgASgIQq8CwkirAgqTAQoac3RyaW5nLmlwdjZfd2l0aF9wcmVmaXhsZW4SNXZhbHVlIG11c3QgYmUgYSB2YWxpZCBJUHY2IGFkZHJlc3Mgd2l0aCBwcmVmaXggbGVuZ3RoGj4hcnVsZXMuaXB2Nl93aXRoX3ByZWZpeGxlbiB8fCB0aGlzID09ICcnIHx8IHRoaXMuaXNJcFByZWZpeCg2KQqSAQogc3RyaW5nLmlwdjZfd2l0aF9wcmVmaXhsZW5fZW1wdHkSRHZhbHVlIGlzIGVtcHR5LCB3aGljaCBpcyBub3QgYSB2YWxpZCBJUHY2IGFkZHJlc3Mgd2l0aCBwcmVmaXggbGVuZ3RoGighcnVsZXMuaXB2Nl93aXRoX3ByZWZpeGxlbiB8fCB0aGlzICE9ICcnSAAS8gEKCWlwX3ByZWZpeBgdIAEoCELcAcJI2AEKbAoQc3RyaW5nLmlwX3ByZWZpeBIfdmFsdWUgbXVzdCBiZSBhIHZhbGlkIElQIHByZWZpeBo3IXJ1bGVzLmlwX3ByZWZpeCB8fCB0aGlzID09ICcnIHx8IHRoaXMuaXNJcFByZWZpeCh0cnVlKQpoChZzdHJpbmcuaXBfcHJlZml4X2VtcHR5Ei52YWx1ZSBpcyBlbXB0eSwgd2hpY2ggaXMgbm90IGEgdmFsaWQgSVAgcHJlZml4Gh4hcnVsZXMuaXBfcHJlZml4IHx8IHRoaXMgIT0gJydIABKDAgoLaXB2NF9wcmVmaXgYHiABKAhC6wHCSOcBCnUKEnN0cmluZy5pcHY0X3ByZWZpeBIhdmFsdWUgbXVzdCBiZSBhIHZhbGlkIElQdjQgcHJlZml4GjwhcnVsZXMuaXB2NF9wcmVmaXggfHwgdGhpcyA9PSAnJyB8fCB0aGlzLmlzSXBQcmVmaXgoNCwgdHJ1ZSkKbgoYc3RyaW5nLmlwdjRfcHJlZml4X2VtcHR5EjB2YWx1ZSBpcyBlbXB0eSwgd2hpY2ggaXMgbm90IGEgdmFsaWQgSVB2NCBwcmVmaXgaICFydWxlcy5pcHY0X3ByZWZpeCB8fCB0aGlzICE9ICcnSAASgwIKC2lwdjZfcHJlZml4GB8gASgIQusBwkjnAQp1ChJzdHJpbmcuaXB2Nl9wcmVmaXgSIXZhbHVlIG11c3QgYmUgYSB2YWxpZCBJUHY2IHByZWZpeBo8IXJ1bGVzLmlwdjZfcHJlZml4IHx8IHRoaXMgPT0gJycgfHwgdGhpcy5pc0lwUHJlZml4KDYsIHRydWUpCm4KGHN0cmluZy5pcHY2X3ByZWZpeF9lbXB0eRIwdmFsdWUgaXMgZW1wdHksIHdoaWNoIGlzIG5vdCBhIHZhbGlkIElQdjYgcHJlZml4GiAhcnVsZXMuaXB2Nl9wcmVmaXggfHwgdGhpcyAhPSAnJ0gAErUCCg1ob3N0X2FuZF9wb3J0GCAgASgIQpsCwkiXAgqZAQoUc3RyaW5nLmhvc3RfYW5kX3BvcnQSQXZhbHVlIG11c3QgYmUgYSB2YWxpZCBob3N0IChob3N0bmFtZSBvciBJUCBhZGRyZXNzKSBhbmQgcG9ydCBwYWlyGj4hcnVsZXMuaG9zdF9hbmRfcG9ydCB8fCB0aGlzID09ICcnIHx8IHRoaXMuaXNIb3N0QW5kUG9ydCh0cnVlKQp5ChpzdHJpbmcuaG9zdF9hbmRfcG9ydF9lbXB0eRI3dmFsdWUgaXMgZW1wdHksIHdoaWNoIGlzIG5vdCBhIHZhbGlkIGhvc3QgYW5kIHBvcnQgcGFpchoiIXJ1bGVzLmhvc3RfYW5kX3BvcnQgfHwgdGhpcyAhPSAnJ0gAEvUBCgR1bGlkGCMgASgIQuQBwkjgAQqCAQoLc3RyaW5nLnVsaWQSGnZhbHVlIG11c3QgYmUgYSB2YWxpZCBVTElEGlchcnVsZXMudWxpZCB8fCB0aGlzID09ICcnIHx8IHRoaXMubWF0Y2hlcygnXlswLTddWzAtOUEtSEpLTU5QLVRWLVphLWhqa21ucC10di16XXsyNX0kJykKWQoRc3RyaW5nLnVsaWRfZW1wdHkSKXZhbHVlIGlzIGVtcHR5LCB3aGljaCBpcyBub3QgYSB2YWxpZCBVTElEGhkhcnVsZXMudWxpZCB8fCB0aGlzICE9ICcnSAASqAUKEHdlbGxfa25vd25fcmVnZXgYGCABKA4yGC5idWYudmFsaWRhdGUuS25vd25SZWdleELxBMJI7QQK8AEKI3N0cmluZy53ZWxsX2tub3duX3JlZ2V4LmhlYWRlcl9uYW1lEiZ2YWx1ZSBtdXN0IGJlIGEgdmFsaWQgSFRUUCBoZWFkZXIgbmFtZRqgAXJ1bGVzLndlbGxfa25vd25fcmVnZXggIT0gMSB8fCB0aGlzID09ICcnIHx8IHRoaXMubWF0Y2hlcyghaGFzKHJ1bGVzLnN0cmljdCkgfHwgcnVsZXMuc3RyaWN0ID8nXjo/WzAtOWEtekEtWiEjJCUmXCcqKy0uXl98flx4NjBdKyQnIDonXlteXHUwMDAwXHUwMDBBXHUwMDBEXSskJykKjQEKKXN0cmluZy53ZWxsX2tub3duX3JlZ2V4LmhlYWRlcl9uYW1lX2VtcHR5EjV2YWx1ZSBpcyBlbXB0eSwgd2hpY2ggaXMgbm90IGEgdmFsaWQgSFRUUCBoZWFkZXIgbmFtZRopcnVsZXMud2VsbF9rbm93bl9yZWdleCAhPSAxIHx8IHRoaXMgIT0gJycK5wEKJHN0cmluZy53ZWxsX2tub3duX3JlZ2V4LmhlYWRlcl92YWx1ZRIndmFsdWUgbXVzdCBiZSBhIHZhbGlkIEhUVFAgaGVhZGVyIHZhbHVlGpUBcnVsZXMud2VsbF9rbm93bl9yZWdleCAhPSAyIHx8IHRoaXMubWF0Y2hlcyghaGFzKHJ1bGVzLnN0cmljdCkgfHwgcnVsZXMuc3RyaWN0ID8nXlteXHUwMDAwLVx1MDAwOFx1MDAwQS1cdTAwMUZcdTAwN0ZdKiQnIDonXlteXHUwMDAwXHUwMDBBXHUwMDBEXSokJylIABIOCgZzdHJpY3QYGSABKAgSLAoHZXhhbXBsZRgiIAMoCUIbwkgYChYKDnN0cmluZy5leGFtcGxlGgR0cnVlKgkI6AcQgICAgAJCDAoKd2VsbF9rbm93biLCEgoKQnl0ZXNSdWxlcxKAAQoFY29uc3QYASABKAxCccJIbgpsCgtieXRlcy5jb25zdBpddGhpcyAhPSBnZXRGaWVsZChydWxlcywgJ2NvbnN0JykgPyAndmFsdWUgbXVzdCBiZSAleCcuZm9ybWF0KFtnZXRGaWVsZChydWxlcywgJ2NvbnN0JyldKSA6ICcnEngKA2xlbhgNIAEoBEJrwkhoCmYKCWJ5dGVzLmxlbhpZdWludCh0aGlzLnNpemUoKSkgIT0gcnVsZXMubGVuID8gJ3ZhbHVlIGxlbmd0aCBtdXN0IGJlICVzIGJ5dGVzJy5mb3JtYXQoW3J1bGVzLmxlbl0pIDogJycSkAEKB21pbl9sZW4YAiABKARCf8JIfAp6Cg1ieXRlcy5taW5fbGVuGml1aW50KHRoaXMuc2l6ZSgpKSA8IHJ1bGVzLm1pbl9sZW4gPyAndmFsdWUgbGVuZ3RoIG11c3QgYmUgYXQgbGVhc3QgJXMgYnl0ZXMnLmZvcm1hdChbcnVsZXMubWluX2xlbl0pIDogJycSiAEKB21heF9sZW4YAyABKARCd8JIdApyCg1ieXRlcy5tYXhfbGVuGmF1aW50KHRoaXMuc2l6ZSgpKSA+IHJ1bGVzLm1heF9sZW4gPyAndmFsdWUgbXVzdCBiZSBhdCBtb3N0ICVzIGJ5dGVzJy5mb3JtYXQoW3J1bGVzLm1heF9sZW5dKSA6ICcnEpABCgdwYXR0ZXJuGAQgASgJQn/CSHwKegoNYnl0ZXMucGF0dGVybhppIXN0cmluZyh0aGlzKS5tYXRjaGVzKHJ1bGVzLnBhdHRlcm4pID8gJ3ZhbHVlIG11c3QgbWF0Y2ggcmVnZXggcGF0dGVybiBgJXNgJy5mb3JtYXQoW3J1bGVzLnBhdHRlcm5dKSA6ICcnEoEBCgZwcmVmaXgYBSABKAxCccJIbgpsCgxieXRlcy5wcmVmaXgaXCF0aGlzLnN0YXJ0c1dpdGgocnVsZXMucHJlZml4KSA/ICd2YWx1ZSBkb2VzIG5vdCBoYXZlIHByZWZpeCAleCcuZm9ybWF0KFtydWxlcy5wcmVmaXhdKSA6ICcnEn8KBnN1ZmZpeBgGIAEoDEJvwkhsCmoKDGJ5dGVzLnN1ZmZpeBpaIXRoaXMuZW5kc1dpdGgocnVsZXMuc3VmZml4KSA/ICd2YWx1ZSBkb2VzIG5vdCBoYXZlIHN1ZmZpeCAleCcuZm9ybWF0KFtydWxlcy5zdWZmaXhdKSA6ICcnEoMBCghjb250YWlucxgHIAEoDEJxwkhuCmwKDmJ5dGVzLmNvbnRhaW5zGlohdGhpcy5jb250YWlucyhydWxlcy5jb250YWlucykgPyAndmFsdWUgZG9lcyBub3QgY29udGFpbiAleCcuZm9ybWF0KFtydWxlcy5jb250YWluc10pIDogJycSpwEKAmluGAggAygMQpoBwkiWAQqTAQoIYnl0ZXMuaW4ahgFnZXRGaWVsZChydWxlcywgJ2luJykuc2l6ZSgpID4gMCAmJiAhKHRoaXMgaW4gZ2V0RmllbGQocnVsZXMsICdpbicpKSA/ICd2YWx1ZSBtdXN0IGJlIGluIGxpc3QgJXMnLmZvcm1hdChbZ2V0RmllbGQocnVsZXMsICdpbicpXSkgOiAnJxJ2CgZub3RfaW4YCSADKAxCZsJIYwphCgxieXRlcy5ub3RfaW4aUXRoaXMgaW4gcnVsZXMubm90X2luID8gJ3ZhbHVlIG11c3Qgbm90IGJlIGluIGxpc3QgJXMnLmZvcm1hdChbcnVsZXMubm90X2luXSkgOiAnJxLrAQoCaXAYCiABKAhC3AHCSNgBCnQKCGJ5dGVzLmlwEiB2YWx1ZSBtdXN0IGJlIGEgdmFsaWQgSVAgYWRkcmVzcxpGIXJ1bGVzLmlwIHx8IHRoaXMuc2l6ZSgpID09IDAgfHwgdGhpcy5zaXplKCkgPT0gNCB8fCB0aGlzLnNpemUoKSA9PSAxNgpgCg5ieXRlcy5pcF9lbXB0eRIvdmFsdWUgaXMgZW1wdHksIHdoaWNoIGlzIG5vdCBhIHZhbGlkIElQIGFkZHJlc3MaHSFydWxlcy5pcCB8fCB0aGlzLnNpemUoKSAhPSAwSAAS5AEKBGlwdjQYCyABKAhC0wHCSM8BCmUKCmJ5dGVzLmlwdjQSInZhbHVlIG11c3QgYmUgYSB2YWxpZCBJUHY0IGFkZHJlc3MaMyFydWxlcy5pcHY0IHx8IHRoaXMuc2l6ZSgpID09IDAgfHwgdGhpcy5zaXplKCkgPT0gNApmChBieXRlcy5pcHY0X2VtcHR5EjF2YWx1ZSBpcyBlbXB0eSwgd2hpY2ggaXMgbm90IGEgdmFsaWQgSVB2NCBhZGRyZXNzGh8hcnVsZXMuaXB2NCB8fCB0aGlzLnNpemUoKSAhPSAwSAAS5QEKBGlwdjYYDCABKAhC1AHCSNABCmYKCmJ5dGVzLmlwdjYSInZhbHVlIG11c3QgYmUgYSB2YWxpZCBJUHY2IGFkZHJlc3MaNCFydWxlcy5pcHY2IHx8IHRoaXMuc2l6ZSgpID09IDAgfHwgdGhpcy5zaXplKCkgPT0gMTYKZgoQYnl0ZXMuaXB2Nl9lbXB0eRIxdmFsdWUgaXMgZW1wdHksIHdoaWNoIGlzIG5vdCBhIHZhbGlkIElQdjYgYWRkcmVzcxofIXJ1bGVzLmlwdjYgfHwgdGhpcy5zaXplKCkgIT0gMEgAEtUBCgR1dWlkGA8gASgIQsQBwkjAAQpeCgpieXRlcy51dWlkEhp2YWx1ZSBtdXN0IGJlIGEgdmFsaWQgVVVJRBo0IXJ1bGVzLnV1aWQgfHwgdGhpcy5zaXplKCkgPT0gMCB8fCB0aGlzLnNpemUoKSA9PSAxNgpeChBieXRlcy51dWlkX2VtcHR5Eil2YWx1ZSBpcyBlbXB0eSwgd2hpY2ggaXMgbm90IGEgdmFsaWQgVVVJRBofIXJ1bGVzLnV1aWQgfHwgdGhpcy5zaXplKCkgIT0gMEgAEisKB2V4YW1wbGUYDiADKAxCGsJIFwoVCg1ieXRlcy5leGFtcGxlGgR0cnVlKgkI6AcQgICAgAJCDAoKd2VsbF9rbm93biLUAwoJRW51bVJ1bGVzEoIBCgVjb25zdBgBIAEoBUJzwkhwCm4KCmVudW0uY29uc3QaYHRoaXMgIT0gZ2V0RmllbGQocnVsZXMsICdjb25zdCcpID8gJ3ZhbHVlIG11c3QgZXF1YWwgJXMnLmZvcm1hdChbZ2V0RmllbGQocnVsZXMsICdjb25zdCcpXSkgOiAnJxIUCgxkZWZpbmVkX29ubHkYAiABKAgSfgoCaW4YAyADKAVCcsJIbwptCgdlbnVtLmluGmIhKHRoaXMgaW4gZ2V0RmllbGQocnVsZXMsICdpbicpKSA/ICd2YWx1ZSBtdXN0IGJlIGluIGxpc3QgJXMnLmZvcm1hdChbZ2V0RmllbGQocnVsZXMsICdpbicpXSkgOiAnJxJ1CgZub3RfaW4YBCADKAVCZcJIYgpgCgtlbnVtLm5vdF9pbhpRdGhpcyBpbiBydWxlcy5ub3RfaW4gPyAndmFsdWUgbXVzdCBub3QgYmUgaW4gbGlzdCAlcycuZm9ybWF0KFtydWxlcy5ub3RfaW5dKSA6ICcnEioKB2V4YW1wbGUYBSADKAVCGcJIFgoUCgxlbnVtLmV4YW1wbGUaBHRydWUqCQjoBxCAgICAAiL7AwoNUmVwZWF0ZWRSdWxlcxKeAQoJbWluX2l0ZW1zGAEgASgEQooBwkiGAQqDAQoScmVwZWF0ZWQubWluX2l0ZW1zGm11aW50KHRoaXMuc2l6ZSgpKSA8IHJ1bGVzLm1pbl9pdGVtcyA/ICd2YWx1ZSBtdXN0IGNvbnRhaW4gYXQgbGVhc3QgJWQgaXRlbShzKScuZm9ybWF0KFtydWxlcy5taW5faXRlbXNdKSA6ICcnEqIBCgltYXhfaXRlbXMYAiABKARCjgHCSIoBCocBChJyZXBlYXRlZC5tYXhfaXRlbXMacXVpbnQodGhpcy5zaXplKCkpID4gcnVsZXMubWF4X2l0ZW1zID8gJ3ZhbHVlIG11c3QgY29udGFpbiBubyBtb3JlIHRoYW4gJXMgaXRlbShzKScuZm9ybWF0KFtydWxlcy5tYXhfaXRlbXNdKSA6ICcnEnAKBnVuaXF1ZRgDIAEoCEJgwkhdClsKD3JlcGVhdGVkLnVuaXF1ZRIocmVwZWF0ZWQgdmFsdWUgbXVzdCBjb250YWluIHVuaXF1ZSBpdGVtcxoeIXJ1bGVzLnVuaXF1ZSB8fCB0aGlzLnVuaXF1ZSgpEicKBWl0ZW1zGAQgASgLMhguYnVmLnZhbGlkYXRlLkZpZWxkUnVsZXMqCQjoBxCAgICAAiKKAwoITWFwUnVsZXMSjwEKCW1pbl9wYWlycxgBIAEoBEJ8wkh5CncKDW1hcC5taW5fcGFpcnMaZnVpbnQodGhpcy5zaXplKCkpIDwgcnVsZXMubWluX3BhaXJzID8gJ21hcCBtdXN0IGJlIGF0IGxlYXN0ICVkIGVudHJpZXMnLmZvcm1hdChbcnVsZXMubWluX3BhaXJzXSkgOiAnJxKOAQoJbWF4X3BhaXJzGAIgASgEQnvCSHgKdgoNbWFwLm1heF9wYWlycxpldWludCh0aGlzLnNpemUoKSkgPiBydWxlcy5tYXhfcGFpcnMgPyAnbWFwIG11c3QgYmUgYXQgbW9zdCAlZCBlbnRyaWVzJy5mb3JtYXQoW3J1bGVzLm1heF9wYWlyc10pIDogJycSJgoEa2V5cxgEIAEoCzIYLmJ1Zi52YWxpZGF0ZS5GaWVsZFJ1bGVzEigKBnZhbHVlcxgFIAEoCzIYLmJ1Zi52YWxpZGF0ZS5GaWVsZFJ1bGVzKgkI6AcQgICAgAIiJgoIQW55UnVsZXMSCgoCaW4YAiADKAkSDgoGbm90X2luGAMgAygJIpkXCg1EdXJhdGlvblJ1bGVzEqEBCgVjb25zdBgCIAEoCzIZLmdvb2dsZS5wcm90b2J1Zi5EdXJhdGlvbkJ3wkh0CnIKDmR1cmF0aW9uLmNvbnN0GmB0aGlzICE9IGdldEZpZWxkKHJ1bGVzLCAnY29uc3QnKSA/ICd2YWx1ZSBtdXN0IGVxdWFsICVzJy5mb3JtYXQoW2dldEZpZWxkKHJ1bGVzLCAnY29uc3QnKV0pIDogJycSqAEKAmx0GAMgASgLMhkuZ29vZ2xlLnByb3RvYnVmLkR1cmF0aW9uQn/CSHwKegoLZHVyYXRpb24ubHQaayFoYXMocnVsZXMuZ3RlKSAmJiAhaGFzKHJ1bGVzLmd0KSAmJiB0aGlzID49IHJ1bGVzLmx0PyAndmFsdWUgbXVzdCBiZSBsZXNzIHRoYW4gJXMnLmZvcm1hdChbcnVsZXMubHRdKSA6ICcnSAASugEKA2x0ZRgEIAEoCzIZLmdvb2dsZS5wcm90b2J1Zi5EdXJhdGlvbkKPAcJIiwEKiAEKDGR1cmF0aW9uLmx0ZRp4IWhhcyhydWxlcy5ndGUpICYmICFoYXMocnVsZXMuZ3QpICYmIHRoaXMgPiBydWxlcy5sdGU/ICd2YWx1ZSBtdXN0IGJlIGxlc3MgdGhhbiBvciBlcXVhbCB0byAlcycuZm9ybWF0KFtydWxlcy5sdGVdKSA6ICcnSAASwQcKAmd0GAUgASgLMhkuZ29vZ2xlLnByb3RvYnVmLkR1cmF0aW9uQpcHwkiTBwp9CgtkdXJhdGlvbi5ndBpuIWhhcyhydWxlcy5sdCkgJiYgIWhhcyhydWxlcy5sdGUpICYmIHRoaXMgPD0gcnVsZXMuZ3Q/ICd2YWx1ZSBtdXN0IGJlIGdyZWF0ZXIgdGhhbiAlcycuZm9ybWF0KFtydWxlcy5ndF0pIDogJycKtgEKDmR1cmF0aW9uLmd0X2x0GqMBaGFzKHJ1bGVzLmx0KSAmJiBydWxlcy5sdCA+PSBydWxlcy5ndCAmJiAodGhpcyA+PSBydWxlcy5sdCB8fCB0aGlzIDw9IHJ1bGVzLmd0KT8gJ3ZhbHVlIG11c3QgYmUgZ3JlYXRlciB0aGFuICVzIGFuZCBsZXNzIHRoYW4gJXMnLmZvcm1hdChbcnVsZXMuZ3QsIHJ1bGVzLmx0XSkgOiAnJwq+AQoYZHVyYXRpb24uZ3RfbHRfZXhjbHVzaXZlGqEBaGFzKHJ1bGVzLmx0KSAmJiBydWxlcy5sdCA8IHJ1bGVzLmd0ICYmIChydWxlcy5sdCA8PSB0aGlzICYmIHRoaXMgPD0gcnVsZXMuZ3QpPyAndmFsdWUgbXVzdCBiZSBncmVhdGVyIHRoYW4gJXMgb3IgbGVzcyB0aGFuICVzJy5mb3JtYXQoW3J1bGVzLmd0LCBydWxlcy5sdF0pIDogJycKxgEKD2R1cmF0aW9uLmd0X2x0ZRqyAWhhcyhydWxlcy5sdGUpICYmIHJ1bGVzLmx0ZSA+PSBydWxlcy5ndCAmJiAodGhpcyA+IHJ1bGVzLmx0ZSB8fCB0aGlzIDw9IHJ1bGVzLmd0KT8gJ3ZhbHVlIG11c3QgYmUgZ3JlYXRlciB0aGFuICVzIGFuZCBsZXNzIHRoYW4gb3IgZXF1YWwgdG8gJXMnLmZvcm1hdChbcnVsZXMuZ3QsIHJ1bGVzLmx0ZV0pIDogJycKzgEKGWR1cmF0aW9uLmd0X2x0ZV9leGNsdXNpdmUasAFoYXMocnVsZXMubHRlKSAmJiBydWxlcy5sdGUgPCBydWxlcy5ndCAmJiAocnVsZXMubHRlIDwgdGhpcyAmJiB0aGlzIDw9IHJ1bGVzLmd0KT8gJ3ZhbHVlIG11c3QgYmUgZ3JlYXRlciB0aGFuICVzIG9yIGxlc3MgdGhhbiBvciBlcXVhbCB0byAlcycuZm9ybWF0KFtydWxlcy5ndCwgcnVsZXMubHRlXSkgOiAnJ0gBEo0ICgNndGUYBiABKAsyGS5nb29nbGUucHJvdG9idWYuRHVyYXRpb25C4gfCSN4HCosBCgxkdXJhdGlvbi5ndGUaeyFoYXMocnVsZXMubHQpICYmICFoYXMocnVsZXMubHRlKSAmJiB0aGlzIDwgcnVsZXMuZ3RlPyAndmFsdWUgbXVzdCBiZSBncmVhdGVyIHRoYW4gb3IgZXF1YWwgdG8gJXMnLmZvcm1hdChbcnVsZXMuZ3RlXSkgOiAnJwrFAQoPZHVyYXRpb24uZ3RlX2x0GrEBaGFzKHJ1bGVzLmx0KSAmJiBydWxlcy5sdCA+PSBydWxlcy5ndGUgJiYgKHRoaXMgPj0gcnVsZXMubHQgfHwgdGhpcyA8IHJ1bGVzLmd0ZSk/ICd2YWx1ZSBtdXN0IGJlIGdyZWF0ZXIgdGhhbiBvciBlcXVhbCB0byAlcyBhbmQgbGVzcyB0aGFuICVzJy5mb3JtYXQoW3J1bGVzLmd0ZSwgcnVsZXMubHRdKSA6ICcnCs0BChlkdXJhdGlvbi5ndGVfbHRfZXhjbHVzaXZlGq8BaGFzKHJ1bGVzLmx0KSAmJiBydWxlcy5sdCA8IHJ1bGVzLmd0ZSAmJiAocnVsZXMubHQgPD0gdGhpcyAmJiB0aGlzIDwgcnVsZXMuZ3RlKT8gJ3ZhbHVlIG11c3QgYmUgZ3JlYXRlciB0aGFuIG9yIGVxdWFsIHRvICVzIG9yIGxlc3MgdGhhbiAlcycuZm9ybWF0KFtydWxlcy5ndGUsIHJ1bGVzLmx0XSkgOiAnJwrVAQoQZHVyYXRpb24uZ3RlX2x0ZRrAAWhhcyhydWxlcy5sdGUpICYmIHJ1bGVzLmx0ZSA+PSBydWxlcy5ndGUgJiYgKHRoaXMgPiBydWxlcy5sdGUgfHwgdGhpcyA8IHJ1bGVzLmd0ZSk/ICd2YWx1ZSBtdXN0IGJlIGdyZWF0ZXIgdGhhbiBvciBlcXVhbCB0byAlcyBhbmQgbGVzcyB0aGFuIG9yIGVxdWFsIHRvICVzJy5mb3JtYXQoW3J1bGVzLmd0ZSwgcnVsZXMubHRlXSkgOiAnJwrdAQoaZHVyYXRpb24uZ3RlX2x0ZV9leGNsdXNpdmUavgFoYXMocnVsZXMubHRlKSAmJiBydWxlcy5sdGUgPCBydWxlcy5ndGUgJiYgKHJ1bGVzLmx0ZSA8IHRoaXMgJiYgdGhpcyA8IHJ1bGVzLmd0ZSk/ICd2YWx1ZSBtdXN0IGJlIGdyZWF0ZXIgdGhhbiBvciBlcXVhbCB0byAlcyBvciBsZXNzIHRoYW4gb3IgZXF1YWwgdG8gJXMnLmZvcm1hdChbcnVsZXMuZ3RlLCBydWxlcy5sdGVdKSA6ICcnSAESnQEKAmluGAcgAygLMhkuZ29vZ2xlLnByb3RvYnVmLkR1cmF0aW9uQnbCSHMKcQoLZHVyYXRpb24uaW4aYiEodGhpcyBpbiBnZXRGaWVsZChydWxlcywgJ2luJykpID8gJ3ZhbHVlIG11c3QgYmUgaW4gbGlzdCAlcycuZm9ybWF0KFtnZXRGaWVsZChydWxlcywgJ2luJyldKSA6ICcnEpQBCgZub3RfaW4YCCADKAsyGS5nb29nbGUucHJvdG9idWYuRHVyYXRpb25CacJIZgpkCg9kdXJhdGlvbi5ub3RfaW4aUXRoaXMgaW4gcnVsZXMubm90X2luID8gJ3ZhbHVlIG11c3Qgbm90IGJlIGluIGxpc3QgJXMnLmZvcm1hdChbcnVsZXMubm90X2luXSkgOiAnJxJJCgdleGFtcGxlGAkgAygLMhkuZ29vZ2xlLnByb3RvYnVmLkR1cmF0aW9uQh3CSBoKGAoQZHVyYXRpb24uZXhhbXBsZRoEdHJ1ZSoJCOgHEICAgIACQgsKCWxlc3NfdGhhbkIOCgxncmVhdGVyX3RoYW4i/QUKDkZpZWxkTWFza1J1bGVzEr8BCgVjb25zdBgBIAEoCzIaLmdvb2dsZS5wcm90b2J1Zi5GaWVsZE1hc2tCkwHCSI8BCowBChBmaWVsZF9tYXNrLmNvbnN0Gnh0aGlzLnBhdGhzICE9IGdldEZpZWxkKHJ1bGVzLCAnY29uc3QnKS5wYXRocyA/ICd2YWx1ZSBtdXN0IGVxdWFsIHBhdGhzICVzJy5mb3JtYXQoW2dldEZpZWxkKHJ1bGVzLCAnY29uc3QnKS5wYXRoc10pIDogJycS2QEKAmluGAIgAygJQswBwkjIAQrFAQoNZmllbGRfbWFzay5pbhqzASF0aGlzLnBhdGhzLmFsbChwLCBwIGluIGdldEZpZWxkKHJ1bGVzLCAnaW4nKSB8fCBnZXRGaWVsZChydWxlcywgJ2luJykuZXhpc3RzKGYsIHAuc3RhcnRzV2l0aChmKycuJykpKSA/ICd2YWx1ZSBtdXN0IG9ubHkgY29udGFpbiBwYXRocyBpbiAlcycuZm9ybWF0KFtnZXRGaWVsZChydWxlcywgJ2luJyldKSA6ICcnEvMBCgZub3RfaW4YAyADKAlC4gHCSN4BCtsBChFmaWVsZF9tYXNrLm5vdF9pbhrFASF0aGlzLnBhdGhzLmFsbChwLCAhKHAgaW4gZ2V0RmllbGQocnVsZXMsICdub3RfaW4nKSB8fCBnZXRGaWVsZChydWxlcywgJ25vdF9pbicpLmV4aXN0cyhmLCBwLnN0YXJ0c1dpdGgoZisnLicpKSkpID8gJ3ZhbHVlIG11c3Qgbm90IGNvbnRhaW4gYW55IHBhdGhzIGluICVzJy5mb3JtYXQoW2dldEZpZWxkKHJ1bGVzLCAnbm90X2luJyldKSA6ICcnEkwKB2V4YW1wbGUYBCADKAsyGi5nb29nbGUucHJvdG9idWYuRmllbGRNYXNrQh/CSBwKGgoSZmllbGRfbWFzay5leGFtcGxlGgR0cnVlKgkI6AcQgICAgAIikhgKDlRpbWVzdGFtcFJ1bGVzEqMBCgVjb25zdBgCIAEoCzIaLmdvb2dsZS5wcm90b2J1Zi5UaW1lc3RhbXBCeMJIdQpzCg90aW1lc3RhbXAuY29uc3QaYHRoaXMgIT0gZ2V0RmllbGQocnVsZXMsICdjb25zdCcpID8gJ3ZhbHVlIG11c3QgZXF1YWwgJXMnLmZvcm1hdChbZ2V0RmllbGQocnVsZXMsICdjb25zdCcpXSkgOiAnJxKrAQoCbHQYAyABKAsyGi5nb29nbGUucHJvdG9idWYuVGltZXN0YW1wQoABwkh9CnsKDHRpbWVzdGFtcC5sdBprIWhhcyhydWxlcy5ndGUpICYmICFoYXMocnVsZXMuZ3QpICYmIHRoaXMgPj0gcnVsZXMubHQ/ICd2YWx1ZSBtdXN0IGJlIGxlc3MgdGhhbiAlcycuZm9ybWF0KFtydWxlcy5sdF0pIDogJydIABK8AQoDbHRlGAQgASgLMhouZ29vZ2xlLnByb3RvYnVmLlRpbWVzdGFtcEKQAcJIjAEKiQEKDXRpbWVzdGFtcC5sdGUaeCFoYXMocnVsZXMuZ3RlKSAmJiAhaGFzKHJ1bGVzLmd0KSAmJiB0aGlzID4gcnVsZXMubHRlPyAndmFsdWUgbXVzdCBiZSBsZXNzIHRoYW4gb3IgZXF1YWwgdG8gJXMnLmZvcm1hdChbcnVsZXMubHRlXSkgOiAnJ0gAEmwKBmx0X25vdxgHIAEoCEJawkhXClUKEHRpbWVzdGFtcC5sdF9ub3caQShydWxlcy5sdF9ub3cgJiYgdGhpcyA+IG5vdykgPyAndmFsdWUgbXVzdCBiZSBsZXNzIHRoYW4gbm93JyA6ICcnSAASxwcKAmd0GAUgASgLMhouZ29vZ2xlLnByb3RvYnVmLlRpbWVzdGFtcEKcB8JImAcKfgoMdGltZXN0YW1wLmd0Gm4haGFzKHJ1bGVzLmx0KSAmJiAhaGFzKHJ1bGVzLmx0ZSkgJiYgdGhpcyA8PSBydWxlcy5ndD8gJ3ZhbHVlIG11c3QgYmUgZ3JlYXRlciB0aGFuICVzJy5mb3JtYXQoW3J1bGVzLmd0XSkgOiAnJwq3AQoPdGltZXN0YW1wLmd0X2x0GqMBaGFzKHJ1bGVzLmx0KSAmJiBydWxlcy5sdCA+PSBydWxlcy5ndCAmJiAodGhpcyA+PSBydWxlcy5sdCB8fCB0aGlzIDw9IHJ1bGVzLmd0KT8gJ3ZhbHVlIG11c3QgYmUgZ3JlYXRlciB0aGFuICVzIGFuZCBsZXNzIHRoYW4gJXMnLmZvcm1hdChbcnVsZXMuZ3QsIHJ1bGVzLmx0XSkgOiAnJwq/AQoZdGltZXN0YW1wLmd0X2x0X2V4Y2x1c2l2ZRqhAWhhcyhydWxlcy5sdCkgJiYgcnVsZXMubHQgPCBydWxlcy5ndCAmJiAocnVsZXMubHQgPD0gdGhpcyAmJiB0aGlzIDw9IHJ1bGVzLmd0KT8gJ3ZhbHVlIG11c3QgYmUgZ3JlYXRlciB0aGFuICVzIG9yIGxlc3MgdGhhbiAlcycuZm9ybWF0KFtydWxlcy5ndCwgcnVsZXMubHRdKSA6ICcnCscBChB0aW1lc3RhbXAuZ3RfbHRlGrIBaGFzKHJ1bGVzLmx0ZSkgJiYgcnVsZXMubHRlID49IHJ1bGVzLmd0ICYmICh0aGlzID4gcnVsZXMubHRlIHx8IHRoaXMgPD0gcnVsZXMuZ3QpPyAndmFsdWUgbXVzdCBiZSBncmVhdGVyIHRoYW4gJXMgYW5kIGxlc3MgdGhhbiBvciBlcXVhbCB0byAlcycuZm9ybWF0KFtydWxlcy5ndCwgcnVsZXMubHRlXSkgOiAnJwrPAQoadGltZXN0YW1wLmd0X2x0ZV9leGNsdXNpdmUasAFoYXMocnVsZXMubHRlKSAmJiBydWxlcy5sdGUgPCBydWxlcy5ndCAmJiAocnVsZXMubHRlIDwgdGhpcyAmJiB0aGlzIDw9IHJ1bGVzLmd0KT8gJ3ZhbHVlIG11c3QgYmUgZ3JlYXRlciB0aGFuICVzIG9yIGxlc3MgdGhhbiBvciBlcXVhbCB0byAlcycuZm9ybWF0KFtydWxlcy5ndCwgcnVsZXMubHRlXSkgOiAnJ0gBEpMICgNndGUYBiABKAsyGi5nb29nbGUucHJvdG9idWYuVGltZXN0YW1wQucHwkjjBwqMAQoNdGltZXN0YW1wLmd0ZRp7IWhhcyhydWxlcy5sdCkgJiYgIWhhcyhydWxlcy5sdGUpICYmIHRoaXMgPCBydWxlcy5ndGU/ICd2YWx1ZSBtdXN0IGJlIGdyZWF0ZXIgdGhhbiBvciBlcXVhbCB0byAlcycuZm9ybWF0KFtydWxlcy5ndGVdKSA6ICcnCsYBChB0aW1lc3RhbXAuZ3RlX2x0GrEBaGFzKHJ1bGVzLmx0KSAmJiBydWxlcy5sdCA+PSBydWxlcy5ndGUgJiYgKHRoaXMgPj0gcnVsZXMubHQgfHwgdGhpcyA8IHJ1bGVzLmd0ZSk/ICd2YWx1ZSBtdXN0IGJlIGdyZWF0ZXIgdGhhbiBvciBlcXVhbCB0byAlcyBhbmQgbGVzcyB0aGFuICVzJy5mb3JtYXQoW3J1bGVzLmd0ZSwgcnVsZXMubHRdKSA6ICcnCs4BChp0aW1lc3RhbXAuZ3RlX2x0X2V4Y2x1c2l2ZRqvAWhhcyhydWxlcy5sdCkgJiYgcnVsZXMubHQgPCBydWxlcy5ndGUgJiYgKHJ1bGVzLmx0IDw9IHRoaXMgJiYgdGhpcyA8IHJ1bGVzLmd0ZSk/ICd2YWx1ZSBtdXN0IGJlIGdyZWF0ZXIgdGhhbiBvciBlcXVhbCB0byAlcyBvciBsZXNzIHRoYW4gJXMnLmZvcm1hdChbcnVsZXMuZ3RlLCBydWxlcy5sdF0pIDogJycK1gEKEXRpbWVzdGFtcC5ndGVfbHRlGsABaGFzKHJ1bGVzLmx0ZSkgJiYgcnVsZXMubHRlID49IHJ1bGVzLmd0ZSAmJiAodGhpcyA+IHJ1bGVzLmx0ZSB8fCB0aGlzIDwgcnVsZXMuZ3RlKT8gJ3ZhbHVlIG11c3QgYmUgZ3JlYXRlciB0aGFuIG9yIGVxdWFsIHRvICVzIGFuZCBsZXNzIHRoYW4gb3IgZXF1YWwgdG8gJXMnLmZvcm1hdChbcnVsZXMuZ3RlLCBydWxlcy5sdGVdKSA6ICcnCt4BCht0aW1lc3RhbXAuZ3RlX2x0ZV9leGNsdXNpdmUavgFoYXMocnVsZXMubHRlKSAmJiBydWxlcy5sdGUgPCBydWxlcy5ndGUgJiYgKHJ1bGVzLmx0ZSA8IHRoaXMgJiYgdGhpcyA8IHJ1bGVzLmd0ZSk/ICd2YWx1ZSBtdXN0IGJlIGdyZWF0ZXIgdGhhbiBvciBlcXVhbCB0byAlcyBvciBsZXNzIHRoYW4gb3IgZXF1YWwgdG8gJXMnLmZvcm1hdChbcnVsZXMuZ3RlLCBydWxlcy5sdGVdKSA6ICcnSAESbwoGZ3Rfbm93GAggASgIQl3CSFoKWAoQdGltZXN0YW1wLmd0X25vdxpEKHJ1bGVzLmd0X25vdyAmJiB0aGlzIDwgbm93KSA/ICd2YWx1ZSBtdXN0IGJlIGdyZWF0ZXIgdGhhbiBub3cnIDogJydIARK4AQoGd2l0aGluGAkgASgLMhkuZ29vZ2xlLnByb3RvYnVmLkR1cmF0aW9uQowBwkiIAQqFAQoQdGltZXN0YW1wLndpdGhpbhpxdGhpcyA8IG5vdy1ydWxlcy53aXRoaW4gfHwgdGhpcyA+IG5vdytydWxlcy53aXRoaW4gPyAndmFsdWUgbXVzdCBiZSB3aXRoaW4gJXMgb2Ygbm93Jy5mb3JtYXQoW3J1bGVzLndpdGhpbl0pIDogJycSSwoHZXhhbXBsZRgKIAMoCzIaLmdvb2dsZS5wcm90b2J1Zi5UaW1lc3RhbXBCHsJIGwoZChF0aW1lc3RhbXAuZXhhbXBsZRoEdHJ1ZSoJCOgHEICAgIACQgsKCWxlc3NfdGhhbkIOCgxncmVhdGVyX3RoYW4iOQoKVmlvbGF0aW9ucxIrCgp2aW9sYXRpb25zGAEgAygLMhcuYnVmLnZhbGlkYXRlLlZpb2xhdGlvbiKfAQoJVmlvbGF0aW9uEiYKBWZpZWxkGAUgASgLMhcuYnVmLnZhbGlkYXRlLkZpZWxkUGF0aBIlCgRydWxlGAYgASgLMhcuYnVmLnZhbGlkYXRlLkZpZWxkUGF0aBIPCgdydWxlX2lkGAIgASgJEg8KB21lc3NhZ2UYAyABKAkSDwoHZm9yX2tleRgEIAEoCEoECAEQAlIKZmllbGRfcGF0aCI9CglGaWVsZFBhdGgSMAoIZWxlbWVudHMYASADKAsyHi5idWYudmFsaWRhdGUuRmllbGRQYXRoRWxlbWVudCLpAgoQRmllbGRQYXRoRWxlbWVudBIUCgxmaWVsZF9udW1iZXIYASABKAUSEgoKZmllbGRfbmFtZRgCIAEoCRI+CgpmaWVsZF90eXBlGAMgASgOMiouZ29vZ2xlLnByb3RvYnVmLkZpZWxkRGVzY3JpcHRvclByb3RvLlR5cGUSPAoIa2V5X3R5cGUYBCABKA4yKi5nb29nbGUucHJvdG9idWYuRmllbGREZXNjcmlwdG9yUHJvdG8uVHlwZRI+Cgp2YWx1ZV90eXBlGAUgASgOMiouZ29vZ2xlLnByb3RvYnVmLkZpZWxkRGVzY3JpcHRvclByb3RvLlR5cGUSDwoFaW5kZXgYBiABKARIABISCghib29sX2tleRgHIAEoCEgAEhEKB2ludF9rZXkYCCABKANIABISCgh1aW50X2tleRgJIAEoBEgAEhQKCnN0cmluZ19rZXkYCiABKAlIAEILCglzdWJzY3JpcHQqoQEKBklnbm9yZRIWChJJR05PUkVfVU5TUEVDSUZJRUQQABIYChRJR05PUkVfSUZfWkVST19WQUxVRRABEhEKDUlHTk9SRV9BTFdBWVMQAyIECAIQAioMSUdOT1JFX0VNUFRZKg5JR05PUkVfREVGQVVMVCoXSUdOT1JFX0lGX0RFRkFVTFRfVkFMVUUqFUlHTk9SRV9JRl9VTlBPUFVMQVRFRCpuCgpLbm93blJlZ2V4EhsKF0tOT1dOX1JFR0VYX1VOU1BFQ0lGSUVEEAASIAocS05PV05fUkVHRVhfSFRUUF9IRUFERVJfTkFNRRABEiEKHUtOT1dOX1JFR0VYX0hUVFBfSEVBREVSX1ZBTFVFEAI6VgoHbWVzc2FnZRIfLmdvb2dsZS5wcm90b2J1Zi5NZXNzYWdlT3B0aW9ucxiHCSABKAsyGi5idWYudmFsaWRhdGUuTWVzc2FnZVJ1bGVzUgdtZXNzYWdlOk4KBW9uZW9mEh0uZ29vZ2xlLnByb3RvYnVmLk9uZW9mT3B0aW9ucxiHCSABKAsyGC5idWYudmFsaWRhdGUuT25lb2ZSdWxlc1IFb25lb2Y6TgoFZmllbGQSHS5nb29nbGUucHJvdG9idWYuRmllbGRPcHRpb25zGIcJIAEoCzIYLmJ1Zi52YWxpZGF0ZS5GaWVsZFJ1bGVzUgVmaWVsZDpdCgpwcmVkZWZpbmVkEh0uZ29vZ2xlLnByb3RvYnVmLkZpZWxkT3B0aW9ucxiICSABKAsyHS5idWYudmFsaWRhdGUuUHJlZGVmaW5lZFJ1bGVzUgpwcmVkZWZpbmVkQm4KEmJ1aWxkLmJ1Zi52YWxpZGF0ZUINVmFsaWRhdGVQcm90b1ABWkdidWYuYnVpbGQvZ2VuL2dvL2J1ZmJ1aWxkL3Byb3RvdmFsaWRhdGUvcHJvdG9jb2xidWZmZXJzL2dvL2J1Zi92YWxpZGF0ZQ", [wkt[_0x54a1b7(774)], wkt[_0x54a1b7(232)], wkt[_0x54a1b7(1425)], wkt[_0x54a1b7(588)]]), file_voiceos = codegenv2[_0x54a1b7(1800)]("Cg12b2ljZW9zLnByb3RvEgd2b2ljZW9zIgcKBUVtcHR5It0BCgtDbGllbnRFcnJvchIMCgRjb2RlGAEgASgJEiAKBHR5cGUYAiABKA4yEi52b2ljZW9zLkVycm9yVHlwZRIPCgdtZXNzYWdlGAMgASgJEikKCHByb3ZpZGVyGAQgASgOMhcudm9pY2Vvcy5DbGllbnRQcm92aWRlchIyCgdkZXRhaWxzGAUgAygLMiEudm9pY2Vvcy5DbGllbnRFcnJvci5EZXRhaWxzRW50cnkaLgoMRGV0YWlsc0VudHJ5EgsKA2tleRgBIAEoCRINCgV2YWx1ZRgCIAEoCToCOAEiKwoKQXVkaW9DaHVuaxIdCgphdWRpb19kYXRhGAEgASgMQgm6SAZ6BBiAgEAiMAoKTW9kZVVwZGF0ZRIiCgRtb2RlGAEgASgOMhQudm9pY2Vvcy5Wb2ljZU9TTW9kZSIkCgpWbG1Db250ZXh0EhYKDmV4dHJhY3RlZF90ZXh0GAEgASgJIiQKCk9jckNvbnRleHQSFgoOZXh0cmFjdGVkX3RleHQYASABKAkiigIKEVNjcmVlbnNob3RDb250ZXh0EhkKEXNjcmVlbnNob3RfYmFzZTY0GAEgASgJEhUKCGFwcF9uYW1lGAIgASgJSACIAQESFgoJdXNlcl9uYW1lGAMgASgJSAGIAQESEwoGY3JvcF94GAQgASgFSAKIAQESEwoGY3JvcF95GAUgASgFSAOIAQESFwoKY3JvcF93aWR0aBgGIAEoBUgEiAEBEhgKC2Nyb3BfaGVpZ2h0GAcgASgFSAWIAQFCCwoJX2FwcF9uYW1lQgwKCl91c2VyX25hbWVCCQoHX2Nyb3BfeEIJCgdfY3JvcF95Qg0KC19jcm9wX3dpZHRoQg4KDF9jcm9wX2hlaWdodCL0AQoUQWNjZXNzaWJpbGl0eUNvbnRleHQSHwoSYWNjZXNzaWJpbGl0eV90ZXh0GAEgASgJSACIAQESHwoSYWNjZXNzaWJpbGl0eV90cmVlGAIgASgJSAGIAQESHwoSY3Vyc29yX3RleHRfYmVmb3JlGAMgASgJSAKIAQESHgoRY3Vyc29yX3RleHRfYWZ0ZXIYBCABKAlIA4gBAUIVChNfYWNjZXNzaWJpbGl0eV90ZXh0QhUKE19hY2Nlc3NpYmlsaXR5X3RyZWVCFQoTX2N1cnNvcl90ZXh0X2JlZm9yZUIUChJfY3Vyc29yX3RleHRfYWZ0ZXIixAIKDVN0cmVhbU1lc3NhZ2USKgoLYXVkaW9fY2h1bmsYASABKAsyEy52b2ljZW9zLkF1ZGlvQ2h1bmtIABIqCgttb2RlX3VwZGF0ZRgCIAEoCzITLnZvaWNlb3MuTW9kZVVwZGF0ZUgAEioKC3ZsbV9jb250ZXh0GAMgASgLMhMudm9pY2Vvcy5WbG1Db250ZXh0SAASKgoLb2NyX2NvbnRleHQYBCABKAsyEy52b2ljZW9zLk9jckNvbnRleHRIABI4ChJzY3JlZW5zaG90X2NvbnRleHQYBSABKAsyGi52b2ljZW9zLlNjcmVlbnNob3RDb250ZXh0SAASPgoVYWNjZXNzaWJpbGl0eV9jb250ZXh0GAYgASgLMh0udm9pY2Vvcy5BY2Nlc3NpYmlsaXR5Q29udGV4dEgAQgkKB3BheWxvYWQiogEKFVRyYW5zY3JpcHRpb25SZXNwb25zZRISCgp0cmFuc2NyaXB0GAEgASgJEiMKBWVycm9yGAIgASgLMhQudm9pY2Vvcy5DbGllbnRFcnJvchIWCg5yYXdfdHJhbnNjcmlwdBgDIAEoCRIYChBzZWN1cml0eV93YXJuaW5nGAQgASgIEh4KFnNlY3VyaXR5X2F0dGVtcHRfY291bnQYBSABKAUidwoORGljdGlvbmFyeUl0ZW0SCgoCaWQYASABKAkSDwoHdXNlcl9pZBgCIAEoCRIMCgR0ZXh0GAMgASgJEhIKCmNyZWF0ZWRfYXQYBCABKAkSEgoKdXBkYXRlZF9hdBgFIAEoCRISCgpkZWxldGVkX2F0GAYgASgJIjcKG0NyZWF0ZURpY3Rpb25hcnlJdGVtUmVxdWVzdBIKCgJpZBgBIAEoCRIMCgR0ZXh0GAIgASgJIjUKGkxpc3REaWN0aW9uYXJ5SXRlbXNSZXF1ZXN0EhcKD3NpbmNlX3RpbWVzdGFtcBgBIAEoCSJFChtMaXN0RGljdGlvbmFyeUl0ZW1zUmVzcG9uc2USJgoFaXRlbXMYASADKAsyFy52b2ljZW9zLkRpY3Rpb25hcnlJdGVtIjcKG1VwZGF0ZURpY3Rpb25hcnlJdGVtUmVxdWVzdBIKCgJpZBgBIAEoCRIMCgR0ZXh0GAIgASgJIikKG0RlbGV0ZURpY3Rpb25hcnlJdGVtUmVxdWVzdBIKCgJpZBgBIAEoCSKjAwoMVm9pY2VTZXNzaW9uEgoKAmlkGAEgASgJEg8KB3VzZXJfaWQYAiABKAkSEgoKdHJhbnNjcmlwdBgDIAEoCRIWCg5nZW5lcmF0ZWRfdGV4dBgEIAEoCRIQCghhcHBfbmFtZRgFIAEoCRIUCgx3aW5kb3dfdGl0bGUYBiABKAkSGgoNYXVkaW9fYmxvYl9pZBgHIAEoCUgAiAEBEhgKEGR1cmF0aW9uX3NlY29uZHMYCCABKAESGAoLc2FtcGxlX3JhdGUYCSABKAVIAYgBARIXCgp3b3JkX2NvdW50GAogASgFSAKIAQESEgoKY3JlYXRlZF9hdBgLIAEoCRISCgp1cGRhdGVkX2F0GAwgASgJEhIKCmRlbGV0ZWRfYXQYDSABKAkSIgoEbW9kZRgOIAEoDjIULnZvaWNlb3MuVm9pY2VPU01vZGUSGAoLYXBwX2ljb25faWQYDyABKAlIA4gBAUIQCg5fYXVkaW9fYmxvYl9pZEIOCgxfc2FtcGxlX3JhdGVCDQoLX3dvcmRfY291bnRCDgoMX2FwcF9pY29uX2lkIoMCChlDcmVhdGVWb2ljZVNlc3Npb25SZXF1ZXN0EgoKAmlkGAEgASgJEhIKCnRyYW5zY3JpcHQYAiABKAkSFgoOZ2VuZXJhdGVkX3RleHQYAyABKAkSEAoIYXBwX25hbWUYBCABKAkSFAoMd2luZG93X3RpdGxlGAUgASgJEh4KCmF1ZGlvX2Jsb2IYBiABKAxCCrpIB3oFGIDC1y8SGAoQZHVyYXRpb25fc2Vjb25kcxgHIAEoARIYCgtzYW1wbGVfcmF0ZRgIIAEoBUgAiAEBEiIKBG1vZGUYCSABKA4yFC52b2ljZW9zLlZvaWNlT1NNb2RlQg4KDF9zYW1wbGVfcmF0ZSIkChZHZXRWb2ljZVNlc3Npb25SZXF1ZXN0EgoKAmlkGAEgASgJIjMKGExpc3RWb2ljZVNlc3Npb25zUmVxdWVzdBIXCg9zaW5jZV90aW1lc3RhbXAYASABKAkiRAoZTGlzdFZvaWNlU2Vzc2lvbnNSZXNwb25zZRInCghzZXNzaW9ucxgBIAMoCzIVLnZvaWNlb3MuVm9pY2VTZXNzaW9uIlMKGVVwZGF0ZVZvaWNlU2Vzc2lvblJlcXVlc3QSCgoCaWQYASABKAkSEgoKdHJhbnNjcmlwdBgCIAEoCRIWCg5nZW5lcmF0ZWRfdGV4dBgDIAEoCSInChlEZWxldGVWb2ljZVNlc3Npb25SZXF1ZXN0EgoKAmlkGAEgASgJInUKB0FwcEljb24SCgoCaWQYASABKAkSDwoHdXNlcl9pZBgCIAEoCRIQCghhcHBfbmFtZRgDIAEoCRITCgtpY29uX2Jhc2U2NBgEIAEoCRISCgpjcmVhdGVkX2F0GAUgASgJEhIKCnVwZGF0ZWRfYXQYBiABKAkiSQoUQ3JlYXRlQXBwSWNvblJlcXVlc3QSCgoCaWQYASABKAkSEAoIYXBwX25hbWUYAiABKAkSEwoLaWNvbl9iYXNlNjQYAyABKAkiKwoXR2V0QXBwSWNvbkJ5TmFtZVJlcXVlc3QSEAoIYXBwX25hbWUYASABKAkiLgoTTGlzdEFwcEljb25zUmVxdWVzdBIXCg9zaW5jZV90aW1lc3RhbXAYASABKAkiNwoUTGlzdEFwcEljb25zUmVzcG9uc2USHwoFaWNvbnMYASADKAsyEC52b2ljZW9zLkFwcEljb24iFwoVRGVsZXRlVXNlckRhdGFSZXF1ZXN0Ih4KHEdldFN1YnNjcmlwdGlvblN0YXR1c1JlcXVlc3QihAEKElN1YnNjcmlwdGlvblN0YXR1cxIRCglwbGFuX3R5cGUYASABKAkSDgoGc3RhdHVzGAIgASgJEhEKCWlzX2FjdGl2ZRgDIAEoCBIaChJjdXJyZW50X3BlcmlvZF9lbmQYBCABKAkSHAoUY2FuY2VsX2F0X3BlcmlvZF9lbmQYBSABKAgiFgoUR2V0VXNhZ2VTdGF0c1JlcXVlc3QifAoKVXNhZ2VTdGF0cxIVCg1jdXJyZW50X3VzYWdlGAEgASgFEhQKDHdlZWtseV9saW1pdBgCIAEoBRIRCglwbGFuX3R5cGUYAyABKAkSFAoMcGVyY2VudF91c2VkGAQgASgBEhgKEGRheXNfdW50aWxfcmVzZXQYBSABKAUiXAoeUmVjb3JkVm9pY2VTZXNzaW9uVXNhZ2VSZXF1ZXN0EhIKCndvcmRfY291bnQYASABKAUSFwoKdHJhbnNjcmlwdBgCIAEoCUgAiAEBQg0KC190cmFuc2NyaXB0Im4KElVzYWdlQ2hlY2tSZXNwb25zZRIPCgdhbGxvd2VkGAEgASgIEg4KBnJlYXNvbhgCIAEoCRIVCg1jdXJyZW50X3VzYWdlGAMgASgFEg0KBWxpbWl0GAQgASgFEhEKCXBsYW5fdHlwZRgFIAEoCSJDChBXb3JkTW9kaWZpY2F0aW9uEg4KBmJlZm9yZRgBIAEoCRINCgVhZnRlchgCIAEoCRIQCghwb3NpdGlvbhgDIAEoBSJTCh9BbmFseXplS2V5d29yZFN1Z2dlc3Rpb25SZXF1ZXN0EjAKDW1vZGlmaWNhdGlvbnMYASADKAsyGS52b2ljZW9zLldvcmRNb2RpZmljYXRpb24iaQogQW5hbHl6ZUtleXdvcmRTdWdnZXN0aW9uUmVzcG9uc2USEgoKc2hvdWxkX2FkZBgBIAEoCBIPCgdrZXl3b3JkGAIgASgJEg4KBnJlYXNvbhgDIAEoCRIQCghmdXJpZ2FuYRgEIAEoCSJYCiRBbmFseXplQWJicmV2aWF0aW9uU3VnZ2VzdGlvblJlcXVlc3QSMAoNbW9kaWZpY2F0aW9ucxgBIAMoCzIZLnZvaWNlb3MuV29yZE1vZGlmaWNhdGlvbiKCAQolQW5hbHl6ZUFiYnJldmlhdGlvblN1Z2dlc3Rpb25SZXNwb25zZRISCgpzaG91bGRfYWRkGAEgASgIEhQKDGFiYnJldmlhdGlvbhgCIAEoCRIRCglleHBhbnNpb24YAyABKAkSDAoEdHlwZRgEIAEoCRIOCgZyZWFzb24YBSABKAkiLAoLQ2hhdE1lc3NhZ2USDAoEcm9sZRgBIAEoCRIPCgdjb250ZW50GAIgASgJIukDChNDaGF0Rm9sbG93VXBSZXF1ZXN0EgwKBHRleHQYASABKAkSMgoUY29udmVyc2F0aW9uX2hpc3RvcnkYAiADKAsyFC52b2ljZW9zLkNoYXRNZXNzYWdlEhUKCG9jcl90ZXh0GAMgASgJSACIAQESGgoNc2VsZWN0ZWRfdGV4dBgEIAEoCUgBiAEBEhUKCGFwcF9uYW1lGAUgASgJSAKIAQESGQoMd2luZG93X3RpdGxlGAYgASgJSAOIAQESFwoKd2luZG93X3VybBgHIAEoCUgEiAEBEh8KEmFjY2Vzc2liaWxpdHlfdGV4dBgIIAEoCUgFiAEBEhwKD3ZsbV9kZXNjcmlwdGlvbhgJIAEoCUgGiAEBEiAKE29yaWdpbmFsX3RyYW5zY3JpcHQYCiABKAlIB4gBARIiCgRtb2RlGAsgASgOMhQudm9pY2Vvcy5Wb2ljZU9TTW9kZUILCglfb2NyX3RleHRCEAoOX3NlbGVjdGVkX3RleHRCCwoJX2FwcF9uYW1lQg8KDV93aW5kb3dfdGl0bGVCDQoLX3dpbmRvd191cmxCFQoTX2FjY2Vzc2liaWxpdHlfdGV4dEISChBfdmxtX2Rlc2NyaXB0aW9uQhYKFF9vcmlnaW5hbF90cmFuc2NyaXB0IkkKFENoYXRGb2xsb3dVcFJlc3BvbnNlEgwKBHRleHQYASABKAkSIwoFZXJyb3IYAiABKAsyFC52b2ljZW9zLkNsaWVudEVycm9yKi8KC1ZvaWNlT1NNb2RlEgsKB0RJQ1RBVEUQABIICgRFRElUEAESCQoFV1JJVEUQAipGCg5DbGllbnRQcm92aWRlchIICgRHUk9REAASDAoIQ0VSRUJSQVMQARIMCghDQVJURVNJQRACEg4KCkVMRVZFTkxBQlMQAypECglFcnJvclR5cGUSEQoNQ09ORklHVVJBVElPThAAEhAKDEFWQUlMQUJJTElUWRABEgkKBUFVRElPEAISBwoDQVBJEAMy+w0KDlZvaWNlT1NTZXJ2aWNlEkwKEFRyYW5zY3JpYmVTdHJlYW0SFi52b2ljZW9zLlN0cmVhbU1lc3NhZ2UaHi52b2ljZW9zLlRyYW5zY3JpcHRpb25SZXNwb25zZSgBElAKFFZvaWNlT1NTZXNzaW9uU3RyZWFtEhYudm9pY2Vvcy5TdHJlYW1NZXNzYWdlGh4udm9pY2Vvcy5UcmFuc2NyaXB0aW9uUmVzcG9uc2UoARJVChRDcmVhdGVEaWN0aW9uYXJ5SXRlbRIkLnZvaWNlb3MuQ3JlYXRlRGljdGlvbmFyeUl0ZW1SZXF1ZXN0Ghcudm9pY2Vvcy5EaWN0aW9uYXJ5SXRlbRJgChNMaXN0RGljdGlvbmFyeUl0ZW1zEiMudm9pY2Vvcy5MaXN0RGljdGlvbmFyeUl0ZW1zUmVxdWVzdBokLnZvaWNlb3MuTGlzdERpY3Rpb25hcnlJdGVtc1Jlc3BvbnNlElUKFFVwZGF0ZURpY3Rpb25hcnlJdGVtEiQudm9pY2Vvcy5VcGRhdGVEaWN0aW9uYXJ5SXRlbVJlcXVlc3QaFy52b2ljZW9zLkRpY3Rpb25hcnlJdGVtEkwKFERlbGV0ZURpY3Rpb25hcnlJdGVtEiQudm9pY2Vvcy5EZWxldGVEaWN0aW9uYXJ5SXRlbVJlcXVlc3QaDi52b2ljZW9zLkVtcHR5Ek8KEkNyZWF0ZVZvaWNlU2Vzc2lvbhIiLnZvaWNlb3MuQ3JlYXRlVm9pY2VTZXNzaW9uUmVxdWVzdBoVLnZvaWNlb3MuVm9pY2VTZXNzaW9uEkkKD0dldFZvaWNlU2Vzc2lvbhIfLnZvaWNlb3MuR2V0Vm9pY2VTZXNzaW9uUmVxdWVzdBoVLnZvaWNlb3MuVm9pY2VTZXNzaW9uEloKEUxpc3RWb2ljZVNlc3Npb25zEiEudm9pY2Vvcy5MaXN0Vm9pY2VTZXNzaW9uc1JlcXVlc3QaIi52b2ljZW9zLkxpc3RWb2ljZVNlc3Npb25zUmVzcG9uc2USTwoSVXBkYXRlVm9pY2VTZXNzaW9uEiIudm9pY2Vvcy5VcGRhdGVWb2ljZVNlc3Npb25SZXF1ZXN0GhUudm9pY2Vvcy5Wb2ljZVNlc3Npb24SSAoSRGVsZXRlVm9pY2VTZXNzaW9uEiIudm9pY2Vvcy5EZWxldGVWb2ljZVNlc3Npb25SZXF1ZXN0Gg4udm9pY2Vvcy5FbXB0eRJACg1DcmVhdGVBcHBJY29uEh0udm9pY2Vvcy5DcmVhdGVBcHBJY29uUmVxdWVzdBoQLnZvaWNlb3MuQXBwSWNvbhJGChBHZXRBcHBJY29uQnlOYW1lEiAudm9pY2Vvcy5HZXRBcHBJY29uQnlOYW1lUmVxdWVzdBoQLnZvaWNlb3MuQXBwSWNvbhJLCgxMaXN0QXBwSWNvbnMSHC52b2ljZW9zLkxpc3RBcHBJY29uc1JlcXVlc3QaHS52b2ljZW9zLkxpc3RBcHBJY29uc1Jlc3BvbnNlEkAKDkRlbGV0ZVVzZXJEYXRhEh4udm9pY2Vvcy5EZWxldGVVc2VyRGF0YVJlcXVlc3QaDi52b2ljZW9zLkVtcHR5ElsKFUdldFN1YnNjcmlwdGlvblN0YXR1cxIlLnZvaWNlb3MuR2V0U3Vic2NyaXB0aW9uU3RhdHVzUmVxdWVzdBobLnZvaWNlb3MuU3Vic2NyaXB0aW9uU3RhdHVzEkMKDUdldFVzYWdlU3RhdHMSHS52b2ljZW9zLkdldFVzYWdlU3RhdHNSZXF1ZXN0GhMudm9pY2Vvcy5Vc2FnZVN0YXRzEl8KF1JlY29yZFZvaWNlU2Vzc2lvblVzYWdlEicudm9pY2Vvcy5SZWNvcmRWb2ljZVNlc3Npb25Vc2FnZVJlcXVlc3QaGy52b2ljZW9zLlVzYWdlQ2hlY2tSZXNwb25zZRJvChhBbmFseXplS2V5d29yZFN1Z2dlc3Rpb24SKC52b2ljZW9zLkFuYWx5emVLZXl3b3JkU3VnZ2VzdGlvblJlcXVlc3QaKS52b2ljZW9zLkFuYWx5emVLZXl3b3JkU3VnZ2VzdGlvblJlc3BvbnNlEn4KHUFuYWx5emVBYmJyZXZpYXRpb25TdWdnZXN0aW9uEi0udm9pY2Vvcy5BbmFseXplQWJicmV2aWF0aW9uU3VnZ2VzdGlvblJlcXVlc3QaLi52b2ljZW9zLkFuYWx5emVBYmJyZXZpYXRpb25TdWdnZXN0aW9uUmVzcG9uc2USSwoMQ2hhdEZvbGxvd1VwEhwudm9pY2Vvcy5DaGF0Rm9sbG93VXBSZXF1ZXN0Gh0udm9pY2Vvcy5DaGF0Rm9sbG93VXBSZXNwb25zZWIGcHJvdG8z", [file_buf_validate_validate]), AudioChunkSchema = codegenv2[_0x54a1b7(1779)](file_voiceos, 2), ModeUpdateSchema = codegenv2[_0x54a1b7(1779)](file_voiceos, 3), ScreenshotContextSchema = codegenv2[_0x54a1b7(1779)](file_voiceos, 6), AccessibilityContextSchema = codegenv2[_0x54a1b7(1779)](file_voiceos, 7), StreamMessageSchema = codegenv2[_0x54a1b7(1779)](file_voiceos, 8), CreateDictionaryItemRequestSchema = codegenv2[_0x54a1b7(1779)](file_voiceos, 11), ListDictionaryItemsRequestSchema = codegenv2[_0x54a1b7(1779)](file_voiceos, 12), UpdateDictionaryItemRequestSchema = codegenv2[_0x54a1b7(1779)](file_voiceos, 14), DeleteDictionaryItemRequestSchema = codegenv2[_0x54a1b7(1779)](file_voiceos, 15), CreateVoiceSessionRequestSchema = codegenv2[_0x54a1b7(1779)](file_voiceos, 17), ListVoiceSessionsRequestSchema = codegenv2[_0x54a1b7(1779)](file_voiceos, 19), CreateAppIconRequestSchema = codegenv2[_0x54a1b7(1779)](file_voiceos, 24), ListAppIconsRequestSchema = codegenv2[_0x54a1b7(1779)](file_voiceos, 26), DeleteUserDataRequestSchema = codegenv2[_0x54a1b7(1779)](file_voiceos, 28), GetSubscriptionStatusRequestSchema = codegenv2[_0x54a1b7(1779)](file_voiceos, 29), GetUsageStatsRequestSchema = codegenv2[_0x54a1b7(1779)](file_voiceos, 31), RecordVoiceSessionUsageRequestSchema = codegenv2[_0x54a1b7(1779)](file_voiceos, 33), WordModificationSchema = codegenv2[_0x54a1b7(1779)](file_voiceos, 35), AnalyzeKeywordSuggestionRequestSchema = codegenv2[_0x54a1b7(1779)](file_voiceos, 36), AnalyzeAbbreviationSuggestionRequestSchema = codegenv2[_0x54a1b7(1779)](file_voiceos, 38), ChatMessageSchema = codegenv2[_0x54a1b7(1779)](file_voiceos, 40), ChatFollowUpRequestSchema = codegenv2[_0x54a1b7(1779)](file_voiceos, 41);
var VoiceOSMode = ((_0x27ac6c) => {
  const _0x6e6de6 = _0x54a1b7;
  return _0x27ac6c[_0x27ac6c[_0x6e6de6(124)] = 0] = _0x6e6de6(124), _0x27ac6c[_0x27ac6c[_0x6e6de6(872)] = 1] = _0x6e6de6(872), _0x27ac6c[_0x27ac6c[_0x6e6de6(1607)] = 2] = _0x6e6de6(1607), _0x27ac6c;
})(VoiceOSMode || {});
const VoiceOSService = codegenv2[_0x54a1b7(698)](file_voiceos, 0), voiceos_pb = Object[_0x54a1b7(502)](Object[_0x54a1b7(634)]({ "__proto__": null, "AccessibilityContextSchema": AccessibilityContextSchema, "AnalyzeAbbreviationSuggestionRequestSchema": AnalyzeAbbreviationSuggestionRequestSchema, "AnalyzeKeywordSuggestionRequestSchema": AnalyzeKeywordSuggestionRequestSchema, "AudioChunkSchema": AudioChunkSchema, "ChatFollowUpRequestSchema": ChatFollowUpRequestSchema, "ChatMessageSchema": ChatMessageSchema, "CreateAppIconRequestSchema": CreateAppIconRequestSchema, "CreateDictionaryItemRequestSchema": CreateDictionaryItemRequestSchema, "CreateVoiceSessionRequestSchema": CreateVoiceSessionRequestSchema, "DeleteDictionaryItemRequestSchema": DeleteDictionaryItemRequestSchema, "DeleteUserDataRequestSchema": DeleteUserDataRequestSchema, "GetSubscriptionStatusRequestSchema": GetSubscriptionStatusRequestSchema, "GetUsageStatsRequestSchema": GetUsageStatsRequestSchema, "ListAppIconsRequestSchema": ListAppIconsRequestSchema, "ListDictionaryItemsRequestSchema": ListDictionaryItemsRequestSchema, "ListVoiceSessionsRequestSchema": ListVoiceSessionsRequestSchema, "ModeUpdateSchema": ModeUpdateSchema, "RecordVoiceSessionUsageRequestSchema": RecordVoiceSessionUsageRequestSchema, "ScreenshotContextSchema": ScreenshotContextSchema, "StreamMessageSchema": StreamMessageSchema, "UpdateDictionaryItemRequestSchema": UpdateDictionaryItemRequestSchema, "VoiceOSMode": VoiceOSMode, "VoiceOSService": VoiceOSService, "WordModificationSchema": WordModificationSchema, "file_voiceos": file_voiceos }, Symbol[_0x54a1b7(1177)], { "value": _0x54a1b7(1416) })), VOICEOS_MODE_SHORTCUT_DEFAULTS_MAC = { [VoiceOSMode[_0x54a1b7(124)]]: ["fn"], [VoiceOSMode[_0x54a1b7(1607)]]: ["fn", "control-left"] }, VOICEOS_MODE_SHORTCUT_DEFAULTS_WIN = { [VoiceOSMode[_0x54a1b7(124)]]: ["option-left"], [VoiceOSMode[_0x54a1b7(1607)]]: ["control-left", "option-left"] };
function getPlatform() {
  const _0x3348a4 = _0x54a1b7;
  if (typeof process !== _0x3348a4(822) && process[_0x3348a4(1394)]) return process[_0x3348a4(1394)];
  return "darwin";
}
function getVoiceOSModeShortcutDefaults(_0x9bb536) {
  const _0x433c73 = getPlatform();
  return _0x433c73 === "darwin" ? VOICEOS_MODE_SHORTCUT_DEFAULTS_MAC : VOICEOS_MODE_SHORTCUT_DEFAULTS_WIN;
}
const VOICEOS_MODE_SHORTCUT_DEFAULTS = getVoiceOSModeShortcutDefaults(), getCurrentUserId = () => {
  const _0x2a6818 = _0x54a1b7, _0x34d0c4 = store[_0x2a6818(1043)](STORE_KEYS[_0x2a6818(1850)]);
  return _0x34d0c4?.["id"];
}, defaultValues = { "onboarding": { "onboardingStep": 0, "onboardingCompleted": ![] }, "settings": { "shareUserData": !![], "launchAtLogin": !![], "showBarAlways": !![], "showInDock": !![], "toggleSounds": ![], "muteWhenDictating": ![], "enableTapToToggle": ![], "micDeviceId": _0x54a1b7(450), "micSelected": _0x54a1b7(534), "isShortcutGloballyEnabled": ![], "keyboardShortcuts": [{ "id": crypto$1[_0x54a1b7(339)](), "keys": VOICEOS_MODE_SHORTCUT_DEFAULTS[VoiceOSMode[_0x54a1b7(124)]], "mode": VoiceOSMode[_0x54a1b7(124)] }, { "id": crypto$1[_0x54a1b7(339)](), "keys": VOICEOS_MODE_SHORTCUT_DEFAULTS[VoiceOSMode[_0x54a1b7(1607)]], "mode": VoiceOSMode[_0x54a1b7(1607)] }], "handsFreeShortcut": { "id": crypto$1[_0x54a1b7(339)](), "keys": [_0x54a1b7(1842)] }, "autoPasteInstructMode": ![], "firstName": "", "lastName": "", "email": "" }, "main": { "navExpanded": !![] }, "auth": { "user": null, "tokens": null, "state": null, "isSelfHosted": ![] }, "openMic": ![], "selectedAudioInput": null, "toggleSounds": ![], "userProfile": null, "idToken": null, "accessToken": null, "appliedMigrations": [] }, store = new Store({ "defaults": defaultValues }), migrations = [{ "id": "2025-08-15-keyboard-shortcut-rename", "run": (_0x5c1c83) => {
  const _0x227e3b = _0x54a1b7, _0x4c4f99 = _0x5c1c83[_0x227e3b(1043)]("settings") || {}, _0x84eb5b = _0x4c4f99[_0x227e3b(309)], _0xb01830 = Array[_0x227e3b(567)](_0x84eb5b) && _0x84eb5b[_0x227e3b(1115)] > 0, _0x540a8d = Array[_0x227e3b(567)](_0x4c4f99[_0x227e3b(204)]) && _0x4c4f99[_0x227e3b(204)][_0x227e3b(1115)] > 0;
  !_0x540a8d && _0xb01830 && _0x5c1c83[_0x227e3b(1359)]("settings.keyboardShortcuts", [{ "id": crypto$1[_0x227e3b(339)](), "keys": _0x84eb5b, "mode": VoiceOSMode[_0x227e3b(124)] }]), "keyboardShortcut" in _0x4c4f99 && (delete _0x4c4f99[_0x227e3b(309)], _0x5c1c83[_0x227e3b(1359)]("settings", _0x4c4f99));
} }, { "id": "2025-10-23-settings-field-rename", "run": (_0x458d20) => {
  const _0x2a979b = _0x54a1b7, _0x4acbb3 = _0x458d20[_0x2a979b(1043)]("settings") || {}, _0x33238e = { "interactionSounds": _0x2a979b(377), "showAppInDock": "showInDock", "showVoiceOSBarAlways": "showBarAlways", "shareAnalytics": _0x2a979b(1372), "muteAudioWhenDictating": _0x2a979b(347), "microphoneName": _0x2a979b(142), "microphoneDeviceId": _0x2a979b(548) };
  let _0x2b91d6 = ![];
  for (const [_0x21c5a7, _0x207c13] of Object[_0x2a979b(1451)](_0x33238e)) {
    _0x21c5a7 in _0x4acbb3 && (_0x4acbb3[_0x207c13] = _0x4acbb3[_0x21c5a7], delete _0x4acbb3[_0x21c5a7], _0x2b91d6 = !![]);
  }
  _0x2b91d6 && (_0x458d20[_0x2a979b(1359)]("settings", _0x4acbb3), console[_0x2a979b(926)]("[Migration] Renamed settings fields successfully"));
} }, { "id": _0x54a1b7(1312), "run": (_0x815c35) => {
  const _0xd6a845 = _0x54a1b7, _0x92ce2c = _0x815c35[_0xd6a845(1043)]("settings") || {};
  _0x92ce2c[_0xd6a845(244)] = _0xd6a845(1606), _0x815c35[_0xd6a845(1359)]("settings", _0x92ce2c), console[_0xd6a845(926)]("[Migration] Updated pill appearance to dark for all users");
} }, { "id": "2024-11-15-add-write-mode-shortcut", "run": (_0x430200) => {
  const _0x59f10b = _0x54a1b7, _0x3e5883 = _0x430200[_0x59f10b(1043)]("settings") || {}, _0x2d27ef = _0x3e5883[_0x59f10b(204)] || [], _0x374ebb = _0x2d27ef[_0x59f10b(620)]((_0x5aa151) => _0x5aa151[_0x59f10b(1396)] === VoiceOSMode[_0x59f10b(1607)]);
  if (!_0x374ebb) {
    const _0x224545 = { "id": crypto$1[_0x59f10b(339)](), "keys": VOICEOS_MODE_SHORTCUT_DEFAULTS[VoiceOSMode[_0x59f10b(1607)]], "mode": VoiceOSMode[_0x59f10b(1607)] };
    _0x2d27ef[_0x59f10b(529)](_0x224545), _0x3e5883[_0x59f10b(204)] = _0x2d27ef, _0x430200[_0x59f10b(1359)]("settings", _0x3e5883), console[_0x59f10b(926)]("[Migration] Added GEN mode shortcut for existing users");
  }
} }, { "id": "2026-01-28-migrate-hands-free-key-to-shortcut", "run": (_0x137af0) => {
  const _0x35bf41 = _0x54a1b7, _0x32a7a6 = _0x137af0[_0x35bf41(1043)]("settings") || {};
  if (_0x32a7a6[_0x35bf41(341)] && !_0x32a7a6[_0x35bf41(720)]) _0x32a7a6[_0x35bf41(720)] = { "id": crypto$1[_0x35bf41(339)](), "keys": [_0x32a7a6[_0x35bf41(341)]] }, delete _0x32a7a6[_0x35bf41(341)], _0x137af0[_0x35bf41(1359)]("settings", _0x32a7a6), console[_0x35bf41(926)]("[Migration] Migrated handsFreeKey to handsFreeShortcut");
  else !_0x32a7a6[_0x35bf41(720)] && (_0x32a7a6[_0x35bf41(720)] = { "id": crypto$1[_0x35bf41(339)](), "keys": [_0x35bf41(1842)] }, _0x137af0[_0x35bf41(1359)]("settings", _0x32a7a6), console[_0x35bf41(926)]("[Migration] Added default handsFreeShortcut"));
} }];
function runMigrations$1(_0x2c1df3, _0x52c512) {
  const _0x3095db = _0x54a1b7, _0x32b195 = new Set(_0x2c1df3[_0x3095db(1043)]("appliedMigrations") || []);
  for (const _0xde1f97 of _0x52c512) {
    if (!_0x32b195[_0x3095db(1764)](_0xde1f97["id"])) {
      console[_0x3095db(926)](_0x3095db(401) + _0xde1f97["id"]);
      try {
        _0xde1f97[_0x3095db(1227)](_0x2c1df3), _0x32b195[_0x3095db(1332)](_0xde1f97["id"]);
      } catch (_0x410a46) {
        console[_0x3095db(981)](_0x3095db(1524) + _0xde1f97["id"], _0x410a46);
      }
    }
  }
  _0x2c1df3[_0x3095db(1359)]("appliedMigrations", Array[_0x3095db(1840)](_0x32b195));
}
process[_0x54a1b7(1498)][_0x54a1b7(1782)] !== "test" && runMigrations$1(store, migrations);
function ensureDefaultsDeep(_0x56ab41, _0x9081b5, _0x18f252 = "", _0x162913 = /* @__PURE__ */ new Set(["appliedMigrations"])) {
  const _0x4dc8a7 = _0x54a1b7, _0x273afc = (_0x3c83ae) => _0x3c83ae !== null && typeof _0x3c83ae === _0x4dc8a7(656) && !Array[_0x4dc8a7(567)](_0x3c83ae);
  for (const [_0x2a9ffd, _0x310b31] of Object[_0x4dc8a7(1451)](_0x9081b5)) {
    if (_0x162913[_0x4dc8a7(1764)](_0x2a9ffd)) continue;
    const _0x5d0e88 = _0x18f252 ? _0x18f252 + "." + _0x2a9ffd : _0x2a9ffd, _0x39a487 = _0x56ab41[_0x4dc8a7(1043)](_0x5d0e88);
    if (!_0x273afc(_0x310b31)) {
      if (_0x39a487 === void 0) _0x56ab41[_0x4dc8a7(1359)](_0x5d0e88, _0x310b31);
      continue;
    }
    _0x39a487 === void 0 || !_0x273afc(_0x39a487) ? _0x56ab41[_0x4dc8a7(1359)](_0x5d0e88, _0x310b31) : ensureDefaultsDeep(_0x56ab41, _0x310b31, _0x5d0e88, _0x162913);
  }
}
ensureDefaultsDeep(store, defaultValues);
const posthogApiKey = _0x54a1b7(1738), posthogHost = "https://app.posthog.com";
let posthog = null;
{
  posthog = new posthogNode[_0x54a1b7(1184)](posthogApiKey, { "host": posthogHost }), console[_0x54a1b7(926)](_0x54a1b7(594));
}
const getDistinctId = (_0x59f06e) => {
  const _0x1bb3a8 = getCurrentUserId();
  return _0x1bb3a8 || "anonymous";
}, captureEvent = (_0x3e88aa, _0x197cd1, _0x4d53a6) => {
  const _0x5c40a8 = _0x54a1b7;
  if (!posthog) return;
  try {
    posthog[_0x5c40a8(745)]({ "distinctId": getDistinctId(_0x4d53a6), "event": _0x3e88aa, "properties": _0x197cd1 });
  } catch (_0x5b7a0b) {
    console[_0x5c40a8(981)](_0x5c40a8(717), _0x5b7a0b);
  }
}, captureTranscriptionCompleted = (_0x2f4141, _0x4633ed) => {
  captureEvent("transcription_completed", _0x2f4141, _0x4633ed);
}, captureTranscriptionFailed = (_0x5369c9, _0x24f1fd) => {
  captureEvent("transcription_failed", _0x5369c9, _0x24f1fd);
}, captureAppLifecycle = (_0x581e26, _0x1f1e8b, _0x3ebd33) => {
  captureEvent(_0x581e26, _0x1f1e8b, _0x3ebd33);
}, shutdownPostHog = async () => {
  const _0x3ad56b = _0x54a1b7;
  posthog && await posthog[_0x3ad56b(638)]();
}, appIcon = path[_0x54a1b7(1638)](__dirname, "../../resources/build/icon.png");
let windowCornersAddon = null;
const debugLog$1 = (_0x152969) => {
  const _0x5d9bd8 = _0x54a1b7;
  process[_0x5d9bd8(595)][_0x5d9bd8(1020)](_0x5d9bd8(1630) + _0x152969 + "\n");
  try {
    const _0x487ab4 = path[_0x5d9bd8(1638)](os[_0x5d9bd8(1635)](), "window-corners-debug.log");
    fs[_0x5d9bd8(1813)](_0x487ab4, (/* @__PURE__ */ new Date())[_0x5d9bd8(582)]() + _0x5d9bd8(977) + _0x152969 + "\n", { "flag": "a" });
  } catch {
  }
};
if (process[_0x54a1b7(1394)] === "darwin") {
  debugLog$1("Attempting to load window-corners addon...");
  try {
    const addonPath = electron[_0x54a1b7(178)][_0x54a1b7(1664)] ? path[_0x54a1b7(1638)](process[_0x54a1b7(1613)], "native/window_corners.node") : path[_0x54a1b7(1638)](__dirname, "../../native/window-corners/build/Release/window_corners.node");
    debugLog$1(_0x54a1b7(563) + addonPath), windowCornersAddon = require(addonPath), debugLog$1(_0x54a1b7(1689) + JSON[_0x54a1b7(1516)](Object[_0x54a1b7(1037)](windowCornersAddon || {})));
  } catch (_0x357720) {
    debugLog$1(_0x54a1b7(307) + _0x357720[_0x54a1b7(1486)]), windowCornersAddon = null;
  }
}
let pillWindow = null, mainWindow = null, isPillDragging = ![];
function setIsPillDragging(_0x6e2eb0) {
  isPillDragging = _0x6e2eb0;
}
function getPillWindow() {
  return pillWindow;
}
function createAppWindow() {
  const _0x52598b = _0x54a1b7, _0x5ee472 = process[_0x52598b(1394)] === "darwin";
  return mainWindow = new electron[_0x52598b(963)]({ "width": 1080, "height": 710, "show": ![], "transparent": _0x5ee472, "icon": appIcon, "frame": ![], "titleBarStyle": "hiddenInset", "trafficLightPosition": { "x": 18, "y": 18 }, "title": _0x52598b(476), "maximizable": !![], "resizable": !![], "hasShadow": !![], ..._0x5ee472 ? { "vibrancy": "sidebar", "visualEffectState": _0x52598b(395) } : { "backgroundColor": _0x52598b(666) }, "webPreferences": { "preload": path[_0x52598b(1638)](__dirname, "../preload/preload.js"), "sandbox": ![], "webSecurity": !![], "devTools": !electron[_0x52598b(178)][_0x52598b(1664)] } }), mainWindow[_0x52598b(890)]["on"]("did-finish-load", () => {
    const _0x2e1d7f = _0x52598b;
    console[_0x2e1d7f(1341)]("Main window: did-finish-load"), !mainWindow?.[_0x2e1d7f(1639)]() && (console[_0x2e1d7f(1341)]("Main window not visible after load; forcing show"), mainWindow?.[_0x2e1d7f(1286)]());
  }), mainWindow[_0x52598b(890)]["on"]("did-fail-load", (_0xe4373f, _0x4844af, _0x461180, _0x2781c9) => {
    const _0x1ee666 = _0x52598b;
    console[_0x1ee666(981)](" Main window: did-fail-load", { "errorCode": _0x4844af, "errorDescription": _0x461180, "validatedURL": _0x2781c9, "ELECTRON_RENDERER_URL": process[_0x1ee666(1498)]["ELECTRON_RENDERER_URL"] }), !electron[_0x1ee666(178)][_0x1ee666(1664)] && mainWindow?.[_0x1ee666(1286)]();
  }), mainWindow["on"]("ready-to-show", () => {
    const _0x815f00 = _0x52598b;
    mainWindow[_0x815f00(1286)](), _0x5ee472 && mainWindow && (debugLog$1(_0x815f00(1444) + !!windowCornersAddon), windowCornersAddon ? setTimeout(() => {
      const _0x1555a6 = _0x815f00;
      try {
        const _0x3e76f0 = mainWindow[_0x1555a6(200)]();
        debugLog$1(_0x1555a6(773) + _0x3e76f0[_0x1555a6(1115)]);
        const _0x4ac08a = windowCornersAddon[_0x1555a6(217)](_0x3e76f0, 20);
        debugLog$1(_0x1555a6(1833) + _0x4ac08a);
      } catch (_0x3bc9fe) {
        debugLog$1(_0x1555a6(921) + _0x3bc9fe[_0x1555a6(1486)]);
      }
    }, 100) : debugLog$1("Addon not available, skipping corner radius"));
  }), mainWindow[_0x52598b(890)][_0x52598b(1701)]((_0x207953) => {
    const _0x4de7b7 = _0x52598b;
    return electron[_0x4de7b7(298)][_0x4de7b7(792)](_0x207953[_0x4de7b7(503)]), { "action": "deny" };
  }), mainWindow[_0x52598b(890)][_0x52598b(1254)][_0x52598b(1299)][_0x52598b(301)]((_0x5c65b5, _0x2af605) => {
    const _0x10a8e2 = _0x52598b;
    _0x2af605({ "responseHeaders": { ..._0x5c65b5[_0x10a8e2(1144)], "Content-Security-Policy": ["default-src 'self' 'unsafe-inline' 'unsafe-eval'; connect-src 'self' https://*.supabase.co wss://*.supabase.co https://*.posthog.com https://*.voiceos.com http://localhost:*; script-src 'self' 'unsafe-inline' 'unsafe-eval'; style-src 'self' 'unsafe-inline' https://fonts.googleapis.com https://fonts.cdnfonts.com; font-src 'self' data: https://fonts.gstatic.com https://cdn.jsdelivr.net https://fonts.cdnfonts.com; img-src 'self' data: res: blob: https://cdn.discordapp.com https://media.discordapp.net; media-src 'self' blob: https://website-assets-video.s3.us-east-1.amazonaws.com;"] } });
  }), mainWindow["on"]("closed", () => {
    const _0x3182fc = _0x52598b;
    mainWindow = null, process[_0x3182fc(1394)] === "win32" && electron[_0x3182fc(178)][_0x3182fc(277)]();
  }), !electron[_0x52598b(178)][_0x52598b(1664)] && process[_0x52598b(1498)]["ELECTRON_RENDERER_URL"] ? (console[_0x52598b(1341)]("Loading renderer from ELECTRON_RENDERER_URL", process[_0x52598b(1498)]["ELECTRON_RENDERER_URL"]), mainWindow[_0x52598b(1278)](process[_0x52598b(1498)]["ELECTRON_RENDERER_URL"])) : mainWindow[_0x52598b(561)](path[_0x52598b(1638)](__dirname, "../renderer/index.html")), mainWindow;
}
const PILL_MAX_WIDTH = 500, PILL_MAX_HEIGHT = 550;
function createPillWindow() {
  const _0x261eaf = _0x54a1b7;
  pillWindow = new electron[_0x261eaf(963)]({ "width": PILL_MAX_WIDTH, "height": PILL_MAX_HEIGHT, "show": ![], "frame": ![], "transparent": !![], "alwaysOnTop": !![], "skipTaskbar": !![], "resizable": ![], "maximizable": ![], "minimizable": ![], "focusable": ![], "hasShadow": ![], "type": _0x261eaf(1695), "acceptFirstMouse": !![], "webPreferences": { "preload": path[_0x261eaf(1638)](__dirname, "../preload/preload.js"), "sandbox": ![], "devTools": !electron[_0x261eaf(178)][_0x261eaf(1664)] }, "hiddenInMissionControl": !![] }), pillWindow["on"]("ready-to-show", () => {
    const _0x3c074d = _0x261eaf;
    pillWindow?.[_0x3c074d(1286)]();
  }), pillWindow[_0x261eaf(890)][_0x261eaf(1254)][_0x261eaf(1299)][_0x261eaf(301)]((_0x530573, _0x500e88) => {
    const _0xc02269 = _0x261eaf;
    _0x500e88({ "responseHeaders": { ..._0x530573[_0xc02269(1144)], "Content-Security-Policy": ["default-src 'self' 'unsafe-inline' 'unsafe-eval'; connect-src 'self' https://*.supabase.co wss://*.supabase.co https://www.google.com https://*.posthog.com https://*.voiceos.com http://localhost:*; script-src 'self' 'unsafe-inline' 'unsafe-eval'; style-src 'self' 'unsafe-inline' https://fonts.googleapis.com https://fonts.cdnfonts.com; font-src 'self' data: https://fonts.gstatic.com https://cdn.jsdelivr.net https://fonts.cdnfonts.com; img-src 'self' data: res: blob: https://www.google.com https://cdn.discordapp.com https://media.discordapp.net; media-src 'self' blob: https://website-assets-video.s3.us-east-1.amazonaws.com;"] } });
  }), pillWindow[_0x261eaf(736)](!![], { "forward": !![] });
  process[_0x261eaf(1394)] === "darwin" && (pillWindow[_0x261eaf(371)](!![], _0x261eaf(1457), 2), pillWindow[_0x261eaf(1736)](![]), pillWindow[_0x261eaf(1781)](!![], { "visibleOnFullScreen": !![], "skipTransformProcessType": !![] }));
  process[_0x261eaf(1394)] === "win32" && pillWindow[_0x261eaf(371)](!![], _0x261eaf(1457));
  const _0x13fdab = !electron[_0x261eaf(178)][_0x261eaf(1664)] && process[_0x261eaf(1498)]["ELECTRON_RENDERER_URL"] ? process[_0x261eaf(1498)]["ELECTRON_RENDERER_URL"] + _0x261eaf(330) : url[_0x261eaf(225)](path[_0x261eaf(1638)](__dirname, "../renderer/index.html")) + _0x261eaf(1161);
  pillWindow[_0x261eaf(1278)](_0x13fdab), pillWindow["on"]("closed", () => {
    pillWindow = null;
  });
}
function startPillPositioner() {
  const _0x2c912c = _0x54a1b7;
  electron[_0x2c912c(451)]["on"]("display-metrics-changed", () => {
    updatePillPosition();
  }), updatePillPosition();
  const _0x2baae4 = process[_0x2c912c(1394)] === "win32" ? 750 : 250;
  setInterval(updatePillPosition, _0x2baae4);
}
function updatePillPosition() {
  const _0x15ed97 = _0x54a1b7;
  if (!pillWindow) return;
  if (isPillDragging) return;
  try {
    const _0x3efced = electron[_0x15ed97(451)][_0x15ed97(687)](), _0x557e06 = electron[_0x15ed97(451)][_0x15ed97(1816)](_0x3efced), { width: _0x27f091, height: _0x3f555c } = pillWindow[_0x15ed97(1555)](), { x: _0xa53423, y: _0x31bf0d, width: _0x50418a, height: _0x2efa40 } = _0x557e06[_0x15ed97(1640)], _0x55e8c7 = _0x557e06[_0x15ed97(1810)], _0x132eb4 = _0x557e06[_0x15ed97(805)] || 1, _0x33a535 = (_0x5a5ecb) => Math[_0x15ed97(303)](Math[_0x15ed97(303)](_0x5a5ecb * _0x132eb4) / _0x132eb4), _0x40887d = _0x33a535(_0xa53423 + _0x50418a / 2 - _0x27f091 / 2), _0x455e55 = _0x33a535(_0x31bf0d + _0x2efa40 - _0x3f555c - 10), _0x43267e = _0x55e8c7["y"] + _0x55e8c7[_0x15ed97(553)] - _0x3f555c - 10, _0x1a03e6 = Math[_0x15ed97(1125)](_0x455e55, _0x43267e), [_0x59751a, _0xc8b7a6] = pillWindow[_0x15ed97(1794)]();
    if (Math[_0x15ed97(915)](_0x59751a - _0x40887d) < 1 && Math[_0x15ed97(915)](_0xc8b7a6 - _0x1a03e6) < 1) return;
    pillWindow[_0x15ed97(500)](_0x40887d, _0x1a03e6, ![]);
  } catch (_0x531b3b) {
    console[_0x15ed97(1697)]("Could not update pill position:", _0x531b3b);
  }
}
function registerResourcesProtocol() {
  const _0x1a6528 = _0x54a1b7;
  electron[_0x1a6528(1430)][_0x1a6528(1295)]("res", async (_0x5d42b9) => {
    const _0x5f4e6f = _0x1a6528;
    try {
      const _0x18b65c = new URL(_0x5d42b9[_0x5f4e6f(503)]), _0x47f1ed = path[_0x5f4e6f(1638)](_0x18b65c[_0x5f4e6f(590)], _0x18b65c[_0x5f4e6f(160)][_0x5f4e6f(337)](1)), _0x31cca0 = path[_0x5f4e6f(1638)](__dirname, "../../resources", _0x47f1ed);
      return electron[_0x5f4e6f(876)][_0x5f4e6f(1159)](url[_0x5f4e6f(225)](_0x31cca0)[_0x5f4e6f(1450)]());
    } catch (_0x5b09d3) {
      return console[_0x5f4e6f(981)](" Protocol error:", _0x5b09d3), new Response(_0x5f4e6f(1207), { "status": 404 });
    }
  });
}
const app = Object[_0x54a1b7(502)](Object[_0x54a1b7(634)]({ "__proto__": null, "createAppWindow": createAppWindow, "createPillWindow": createPillWindow, "getPillWindow": getPillWindow, get "isPillDragging"() {
  return isPillDragging;
}, get "mainWindow"() {
  return mainWindow;
}, "registerResourcesProtocol": registerResourcesProtocol, "setIsPillDragging": setIsPillDragging, "startPillPositioner": startPillPositioner }, Symbol[_0x54a1b7(1177)], { "value": _0x54a1b7(1416) }));
function initializeLogging() {
  const _0x55138e = _0x54a1b7;
  Object[_0x55138e(535)](console, log[_0x55138e(933)]), log[_0x55138e(210)][_0x55138e(840)][_0x55138e(1405)] = ![], log[_0x55138e(210)][_0x55138e(152)][_0x55138e(1405)] = _0x55138e(972), log[_0x55138e(1247)](), log[_0x55138e(1341)]("Logging initialized (file and remote logging DISABLED).");
}
const INITIAL_SCHEMA = _0x54a1b7(1514), MIGRATIONS = [{ "id": "20250108120000_add_raw_audio_to_dictations", "up": _0x54a1b7(866), "down": "ALTER TABLE dictations DROP COLUMN audio_blob;" }, { "id": "20250108130000_add_duration_to_dictations", "up": _0x54a1b7(448), "down": "ALTER TABLE dictations DROP COLUMN duration_seconds;" }, { "id": "20250110120000_add_sample_rate_to_dictations", "up": _0x54a1b7(1094), "down": "ALTER TABLE dictations DROP COLUMN sample_rate;" }, { "id": "20250111120000_add_raw_audio_id_to_dictations", "up": _0x54a1b7(1063), "down": "ALTER TABLE dictations DROP COLUMN audio_blob_id;" }, { "id": "20250923091139_make_dictionary_word_unique", "up": "CREATE UNIQUE INDEX idx_dictionary_text_unique ON dictionary(text) WHERE deleted_at IS NULL;", "down": "DROP INDEX idx_dictionary_text_unique;" }, { "id": "20251020000001_add_sync_failed_at_columns", "up": _0x54a1b7(317), "down": _0x54a1b7(385) }, { "id": "20250123000001_add_word_count_to_dictations", "up": "ALTER TABLE dictations ADD COLUMN word_count INTEGER;", "down": "ALTER TABLE dictations DROP COLUMN word_count;" }, { "id": "20250123000002_add_voice_sessions_table", "up": _0x54a1b7(533), "down": "DROP TABLE IF EXISTS voice_sessions;" }, { "id": "20250123000003_add_mode_to_voice_sessions", "up": "ALTER TABLE voice_sessions ADD COLUMN mode INTEGER NOT NULL DEFAULT 0;", "down": "ALTER TABLE voice_sessions DROP COLUMN mode;" }, { "id": "20250123000004_add_app_icons_table", "up": _0x54a1b7(257), "down": _0x54a1b7(328) }, { "id": "20250116000001_add_description_to_dictionary", "up": "ALTER TABLE dictionary ADD COLUMN description TEXT;", "down": "ALTER TABLE dictionary DROP COLUMN description;" }, { "id": "20250116000002_add_custom_instructions_table", "up": _0x54a1b7(1246), "down": _0x54a1b7(1671) }, { "id": "20260119000001_fix_dictionary_unique_index_per_user", "up": _0x54a1b7(411), "down": _0x54a1b7(480) }, { "id": "20260130000001_add_auto_added_to_dictionary", "up": "ALTER TABLE dictionary ADD COLUMN auto_added INTEGER DEFAULT 0;", "down": "ALTER TABLE dictionary DROP COLUMN auto_added;" }, { "id": "20260204000001_add_app_identifiers_to_dictionary", "up": "ALTER TABLE dictionary ADD COLUMN app_identifiers TEXT;", "down": "ALTER TABLE dictionary DROP COLUMN app_identifiers;" }, { "id": "20260205000001_repair_dictionary_sync_failed_at", "up": _0x54a1b7(433), "down": _0x54a1b7(135) }], DB_FILE = "voiceos.db", dbPath = path[_0x54a1b7(1638)](electron[_0x54a1b7(178)][_0x54a1b7(572)]("userData"), DB_FILE);
let db;
const runMigrations = async () => {
  const _0x1a78aa = _0x54a1b7;
  await run("CREATE TABLE IF NOT EXISTS db_migrations (id TEXT PRIMARY KEY, applied_at TEXT NOT NULL)");
  const _0xe92d23 = await all("SELECT id FROM db_migrations"), _0x5bb3c5 = new Set(_0xe92d23[_0x1a78aa(306)]((_0x25eed2) => _0x25eed2["id"])), _0x3d2da0 = [{ "id": _0x1a78aa(1674), "up": INITIAL_SCHEMA, "down": _0x1a78aa(1323) }, ...MIGRATIONS], _0x47153a = _0x3d2da0[_0x1a78aa(1380)]((_0x37cb1f) => !_0x5bb3c5[_0x1a78aa(1764)](_0x37cb1f["id"]));
  if (_0x47153a[_0x1a78aa(1115)] === 0) {
    console[_0x1a78aa(1341)]("Database schema is up to date.");
    return;
  }
  console[_0x1a78aa(1341)](_0x1a78aa(768) + _0x47153a[_0x1a78aa(1115)] + _0x1a78aa(1544));
  for (const _0x2b26f5 of _0x47153a) {
    console[_0x1a78aa(1341)](_0x1a78aa(936) + _0x2b26f5["id"]);
    try {
      await exec(_0x1a78aa(1174)), await exec(_0x2b26f5["up"]), await run("INSERT INTO db_migrations (id, applied_at) VALUES (?, ?)", [_0x2b26f5["id"], (/* @__PURE__ */ new Date())[_0x1a78aa(582)]()]), await exec(_0x1a78aa(1427)), console[_0x1a78aa(1341)](_0x1a78aa(190) + _0x2b26f5["id"] + _0x1a78aa(721));
    } catch (_0x5b6045) {
      console[_0x1a78aa(981)](_0x1a78aa(618) + _0x2b26f5["id"] + ":", _0x5b6045);
      const _0x1e19c0 = _0x5b6045?.[_0x1a78aa(1486)]?.[_0x1a78aa(1580)]("duplicate column name");
      if (_0x1e19c0) console[_0x1a78aa(1697)](_0x1a78aa(1766) + _0x2b26f5["id"]), await exec(_0x1a78aa(657)), await run("INSERT INTO db_migrations (id, applied_at) VALUES (?, ?)", [_0x2b26f5["id"], (/* @__PURE__ */ new Date())[_0x1a78aa(582)]()]), console[_0x1a78aa(1341)](_0x1a78aa(190) + _0x2b26f5["id"] + _0x1a78aa(735));
      else {
        await exec(_0x1a78aa(657));
        throw new Error(_0x1a78aa(190) + _0x2b26f5["id"] + _0x1a78aa(1283));
      }
    }
  }
}, revertLastMigration = async () => {
  const _0x2d3a87 = _0x54a1b7, _0x3c56c6 = await get("SELECT id FROM db_migrations ORDER BY applied_at DESC LIMIT 1");
  if (!_0x3c56c6) {
    console[_0x2d3a87(1341)]("No migrations to revert.");
    return;
  }
  const _0x545900 = [{ "id": _0x2d3a87(1674), "up": INITIAL_SCHEMA, "down": _0x2d3a87(305) }, ...MIGRATIONS], _0xf6192 = _0x545900[_0x2d3a87(445)]((_0x56bfc4) => _0x56bfc4["id"] === _0x3c56c6["id"]);
  if (!_0xf6192) throw new Error(_0x2d3a87(704) + _0x3c56c6["id"] + _0x2d3a87(1698));
  if (_0xf6192["id"] === _0x2d3a87(1674)) {
    console[_0x2d3a87(981)](" Cannot revert initial schema. To reset the database, delete the database file.");
    throw new Error(_0x2d3a87(425));
  }
  console[_0x2d3a87(1341)](_0x2d3a87(227) + _0xf6192["id"]);
  try {
    await exec(_0x2d3a87(1174)), await exec(_0xf6192[_0x2d3a87(1453)]), await run("DELETE FROM db_migrations WHERE id = ?", [_0xf6192["id"]]), await exec(_0x2d3a87(1427)), console[_0x2d3a87(1341)](_0x2d3a87(190) + _0xf6192["id"] + _0x2d3a87(1567)), electron[_0x2d3a87(178)][_0x2d3a87(277)]();
  } catch (_0x5b80fb) {
    console[_0x2d3a87(981)](_0x2d3a87(1838) + _0xf6192["id"] + ":", _0x5b80fb), await exec(_0x2d3a87(657));
    throw new Error(_0x2d3a87(190) + _0xf6192["id"] + _0x2d3a87(391));
  }
}, wipeDatabase = async () => {
  const _0x851511 = _0x54a1b7;
  db && (await new Promise((_0x9825c7, _0x39b265) => {
    const _0x141458 = _0x1d03;
    db[_0x141458(711)]((_0x3f877e) => {
      if (_0x3f877e) return _0x39b265(_0x3f877e);
      _0x9825c7();
    });
  }), console[_0x851511(1341)]("Database connection closed."));
  try {
    await fs[_0x851511(332)][_0x851511(426)](dbPath), console[_0x851511(1341)]("Database file deleted.");
  } catch (_0x5d8318) {
    if (_0x5d8318[_0x851511(1303)] !== _0x851511(1682)) throw _0x5d8318;
    console[_0x851511(1341)]("Database file did not exist, skipping deletion.");
  }
  console[_0x851511(1341)]("Database wiped. Application will now quit, please relaunch."), electron[_0x851511(178)][_0x851511(277)]();
}, deleteUserData = async (_0x4c2d0d) => {
  const _0x312fb8 = _0x54a1b7;
  console[_0x312fb8(1341)](_0x312fb8(497) + _0x4c2d0d);
  try {
    const { DictationsTable: _0x5acad6, DictionaryTable: _0x10e55, VoiceSessionsTable: _0x3183c1 } = await Promise[_0x312fb8(1786)]()[_0x312fb8(843)](() => repo);
    await Promise[_0x312fb8(1050)]([_0x5acad6[_0x312fb8(1780)](_0x4c2d0d), _0x10e55[_0x312fb8(1780)](_0x4c2d0d), _0x3183c1[_0x312fb8(1780)](_0x4c2d0d)]), console[_0x312fb8(1341)](_0x312fb8(862) + _0x4c2d0d);
  } catch (_0x460753) {
    console[_0x312fb8(981)](_0x312fb8(1157) + _0x4c2d0d, _0x460753);
    throw _0x460753;
  }
}, deleteCompleteUserData = async (_0x44e9ce) => {
  const _0x570cfe = _0x54a1b7;
  console[_0x570cfe(1341)](_0x570cfe(1116) + _0x44e9ce);
  try {
    await deleteUserData(_0x44e9ce);
    const { grpcClient: _0x58d862 } = await Promise[_0x570cfe(1786)]()[_0x570cfe(843)](() => grpcClient$1);
    await _0x58d862[_0x570cfe(424)](), console[_0x570cfe(1341)](_0x570cfe(873) + _0x44e9ce);
  } catch (_0xd15521) {
    console[_0x570cfe(981)](_0x570cfe(614) + _0x44e9ce, _0xd15521);
    throw _0xd15521;
  }
}, initializeDatabase = () => {
  return new Promise((_0x528633, _0x114533) => {
    const _0x183cb2 = _0x1d03;
    db = new sqlite3[_0x183cb2(1725)](dbPath, (_0x589bc9) => {
      const _0x3f243a = _0x183cb2;
      _0x589bc9 ? (console[_0x3f243a(981)](" Failed to connect to SQLite database.", _0x589bc9), _0x114533(_0x589bc9)) : (console[_0x3f243a(1341)]("Connected to SQLite database."), runMigrations()[_0x3f243a(843)](_0x528633)[_0x3f243a(564)]((_0x274e41) => {
        const _0x266012 = _0x3f243a;
        console[_0x266012(981)](" Failed to run migrations.", _0x274e41), _0x114533(_0x274e41);
      }));
    });
  });
}, getDb = () => {
  if (!db) throw new Error("Database not initialized. Call initializeDatabase() first.");
  return db;
}, db$1 = Object[_0x54a1b7(502)](Object[_0x54a1b7(634)]({ "__proto__": null, "deleteCompleteUserData": deleteCompleteUserData, "deleteUserData": deleteUserData, "getDb": getDb, "initializeDatabase": initializeDatabase, "revertLastMigration": revertLastMigration, "wipeDatabase": wipeDatabase }, Symbol[_0x54a1b7(1177)], { "value": _0x54a1b7(1416) })), run = (_0x19a7b7, _0x79a518 = []) => new Promise((_0x1ec019, _0x224520) => {
  const _0x31208b = _0x54a1b7;
  getDb()[_0x31208b(1227)](_0x19a7b7, _0x79a518, function(_0x1dec57) {
    if (_0x1dec57) return _0x224520(_0x1dec57);
    _0x1ec019();
  });
}), exec = (_0x473ce8) => new Promise((_0x82fae4, _0x496235) => {
  const _0x3c7209 = _0x54a1b7;
  getDb()[_0x3c7209(1083)](_0x473ce8, function(_0x934b31) {
    if (_0x934b31) return _0x496235(_0x934b31);
    _0x82fae4();
  });
}), get = (_0x203b1a, _0x248af9 = []) => new Promise((_0x34d7fa, _0x5bd79b) => {
  const _0x2ef45f = _0x54a1b7;
  getDb()[_0x2ef45f(1043)](_0x203b1a, _0x248af9, (_0x127939, _0x2995cd) => {
    if (_0x127939) return _0x5bd79b(_0x127939);
    _0x34d7fa(_0x2995cd);
  });
}), all = (_0x2c4ee, _0x4a4098 = []) => new Promise((_0x332c4a, _0x2d7c1c) => {
  const _0x72bfd2 = _0x54a1b7;
  getDb()[_0x72bfd2(1050)](_0x2c4ee, _0x4a4098, (_0x39949e, _0x297e98) => {
    if (_0x39949e) return _0x2d7c1c(_0x39949e);
    _0x332c4a(_0x297e98);
  });
}), SQLITE_CONSTRAINT_UNIQUE = _0x54a1b7(240);
function isUniqueConstraintError(_0x591acf) {
  const _0x51af01 = _0x54a1b7;
  return _0x591acf[_0x51af01(1303)] === SQLITE_CONSTRAINT_UNIQUE || _0x591acf[_0x51af01(1486)]?.[_0x51af01(1580)]("UNIQUE constraint failed") || _0x591acf[_0x51af01(380)] === 19;
}
function handleDictionaryConstraintError(_0x55888b, _0x24326f) {
  const _0x58864b = _0x54a1b7;
  if (isUniqueConstraintError(_0x55888b)) return { "success": ![], "error": '"' + _0x24326f + _0x58864b(275), "errorType": _0x58864b(1819) };
  return { "success": ![], "error": _0x55888b[_0x58864b(1486)] || "Database operation failed", "errorType": _0x58864b(1594) };
}
function parseAppIdentifiers(_0x176bbd) {
  const _0x38c3cc = _0x54a1b7;
  if (!_0x176bbd) return null;
  if (Array[_0x38c3cc(567)](_0x176bbd)) return _0x176bbd;
  if (typeof _0x176bbd === _0x38c3cc(1305)) try {
    const _0x410bdc = JSON[_0x38c3cc(675)](_0x176bbd);
    return Array[_0x38c3cc(567)](_0x410bdc) ? _0x410bdc : null;
  } catch {
    return null;
  }
  return null;
}
class DictionaryTable {
  static async [_0x54a1b7(1761)](_0x941ed3) {
    const _0x3ac7b6 = _0x54a1b7, _0x3c9cad = await get("SELECT * FROM dictionary WHERE user_id = ? AND text = ? COLLATE NOCASE AND deleted_at IS NULL", [_0x941ed3[_0x3ac7b6(1593)], _0x941ed3[_0x3ac7b6(785)]]);
    if (_0x3c9cad) return { "success": ![], "error": '"' + _0x941ed3[_0x3ac7b6(785)] + _0x3ac7b6(275), "errorType": _0x3ac7b6(1819) };
    const _0xeb85b3 = await get("SELECT * FROM dictionary WHERE user_id = ? AND text = ? COLLATE NOCASE AND deleted_at IS NOT NULL", [_0x941ed3[_0x3ac7b6(1593)], _0x941ed3[_0x3ac7b6(785)]]);
    if (_0xeb85b3) {
      const _0x4a35a4 = (/* @__PURE__ */ new Date())[_0x3ac7b6(582)](), _0x7ef7ac = _0x941ed3[_0x3ac7b6(166)] ? JSON[_0x3ac7b6(1516)](_0x941ed3[_0x3ac7b6(166)]) : null, _0x240a02 = _0x3ac7b6(1428);
      try {
        const _0x4204af = await get(_0x240a02, [_0x941ed3[_0x3ac7b6(705)] || null, _0x7ef7ac, _0x4a35a4, _0xeb85b3["id"]]);
        if (_0x4204af) return _0x4204af[_0x3ac7b6(166)] = parseAppIdentifiers(_0x4204af[_0x3ac7b6(166)]), { "success": !![], "data": _0x4204af };
      } catch (_0x1a755d) {
        return { "success": ![], "error": _0x1a755d[_0x3ac7b6(1486)] || "Failed to restore dictionary item", "errorType": _0x3ac7b6(1594) };
      }
    }
    const _0x4befb1 = _0x941ed3[_0x3ac7b6(166)] ? JSON[_0x3ac7b6(1516)](_0x941ed3[_0x3ac7b6(166)]) : null, _0xcc8992 = { "id": uuid["v4"](), ..._0x941ed3, "description": _0x941ed3[_0x3ac7b6(705)] || null, "app_identifiers": _0x941ed3[_0x3ac7b6(166)] || null, "created_at": (/* @__PURE__ */ new Date())[_0x3ac7b6(582)](), "updated_at": (/* @__PURE__ */ new Date())[_0x3ac7b6(582)](), "deleted_at": null, "sync_failed_at": null, "auto_added": ![] }, _0x3b35d5 = _0x3ac7b6(219), _0x34c47e = [_0xcc8992["id"], _0xcc8992[_0x3ac7b6(1593)], _0xcc8992[_0x3ac7b6(785)], _0xcc8992[_0x3ac7b6(705)], _0x4befb1, _0xcc8992[_0x3ac7b6(1142)], _0xcc8992[_0x3ac7b6(610)], _0xcc8992[_0x3ac7b6(1814)], _0xcc8992[_0x3ac7b6(1448)], _0xcc8992[_0x3ac7b6(823)] ? 1 : 0];
    try {
      return await run(_0x3b35d5, _0x34c47e), { "success": !![], "data": _0xcc8992 };
    } catch (_0x322011) {
      return handleDictionaryConstraintError(_0x322011, _0xcc8992[_0x3ac7b6(785)]);
    }
  }
  static async [_0x54a1b7(440)](_0xe6dc09) {
    const _0xaa8f34 = _0x54a1b7, _0x3c8b5b = _0xe6dc09 ? "SELECT * FROM dictionary WHERE user_id = ? AND deleted_at IS NULL ORDER BY text ASC" : "SELECT * FROM dictionary WHERE user_id IS NULL AND deleted_at IS NULL ORDER BY text ASC", _0x549255 = _0xe6dc09 ? [_0xe6dc09] : [], _0x5f199c = await all(_0x3c8b5b, _0x549255);
    return _0x5f199c[_0xaa8f34(306)]((_0x315264) => ({ ..._0x315264, "auto_added": Boolean(_0x315264[_0xaa8f34(823)]), "app_identifiers": parseAppIdentifiers(_0x315264[_0xaa8f34(166)]) }));
  }
  static async [_0x54a1b7(324)](_0x605298, _0x1e3c4f, _0xae3ac9, _0x37d2ae) {
    const _0x4ed35a = _0x54a1b7, _0x5b1d9c = _0x37d2ae !== void 0 ? _0x37d2ae ? JSON[_0x4ed35a(1516)](_0x37d2ae) : null : void 0;
    if (_0x5b1d9c !== void 0) {
      const _0x413dc4 = "UPDATE dictionary SET text = ?, description = ?, app_identifiers = ?, updated_at = ? WHERE id = ?";
      try {
        return await run(_0x413dc4, [_0x1e3c4f, _0xae3ac9 ?? null, _0x5b1d9c, (/* @__PURE__ */ new Date())[_0x4ed35a(582)](), _0x605298]), { "success": !![], "data": void 0 };
      } catch (_0x37914e) {
        return handleDictionaryConstraintError(_0x37914e, _0x1e3c4f);
      }
    } else {
      const _0x429973 = "UPDATE dictionary SET text = ?, description = ?, updated_at = ? WHERE id = ?";
      try {
        return await run(_0x429973, [_0x1e3c4f, _0xae3ac9 ?? null, (/* @__PURE__ */ new Date())[_0x4ed35a(582)](), _0x605298]), { "success": !![], "data": void 0 };
      } catch (_0x150ecf) {
        return handleDictionaryConstraintError(_0x150ecf, _0x1e3c4f);
      }
    }
  }
  static async [_0x54a1b7(428)](_0x538c0c) {
    const _0x46eb0b = _0x54a1b7, _0x2615c4 = (/* @__PURE__ */ new Date())[_0x46eb0b(582)](), _0x124c5c = "UPDATE dictionary SET deleted_at = ?, updated_at = ? WHERE id = ?";
    await run(_0x124c5c, [_0x2615c4, _0x2615c4, _0x538c0c]);
  }
  static async [_0x54a1b7(1780)](_0x508a5c) {
    const _0x4df6c5 = _0x54a1b7, _0x4beabe = (/* @__PURE__ */ new Date())[_0x4df6c5(582)](), _0x5b8c5a = "UPDATE dictionary SET deleted_at = ?, updated_at = ? WHERE user_id = ?";
    await run(_0x5b8c5a, [_0x4beabe, _0x4beabe, _0x508a5c]);
  }
  static async [_0x54a1b7(494)](_0x5064ac) {
    return await all("SELECT * FROM dictionary WHERE updated_at > ? AND sync_failed_at IS NULL", [_0x5064ac]);
  }
  static async [_0x54a1b7(874)](_0x265844) {
    const _0x4649e1 = _0x54a1b7, _0x2e7928 = "UPDATE dictionary SET sync_failed_at = ? WHERE id = ?";
    await run(_0x2e7928, [(/* @__PURE__ */ new Date())[_0x4649e1(582)](), _0x265844]);
  }
  static async [_0x54a1b7(810)](_0x499b3a) {
    const _0x41840e = _0x54a1b7, _0x2eedb0 = _0x499b3a[_0x41840e(166)] ? JSON[_0x41840e(1516)](_0x499b3a[_0x41840e(166)]) : null, _0x310a0c = _0x41840e(1835), _0x145340 = [_0x499b3a["id"], _0x499b3a[_0x41840e(1593)], _0x499b3a[_0x41840e(785)], _0x499b3a[_0x41840e(705)], _0x2eedb0, _0x499b3a[_0x41840e(1142)], _0x499b3a[_0x41840e(610)], _0x499b3a[_0x41840e(1814)], _0x499b3a[_0x41840e(1448)], _0x499b3a[_0x41840e(823)] ? 1 : 0];
    try {
      return await run(_0x310a0c, _0x145340), { "success": !![], "data": void 0 };
    } catch (_0x566bb6) {
      return handleDictionaryConstraintError(_0x566bb6, _0x499b3a[_0x41840e(785)]);
    }
  }
  static async [_0x54a1b7(1306)](_0x3c6a8b) {
    const _0x136595 = _0x54a1b7, _0x3421fc = await get("SELECT * FROM dictionary WHERE user_id = ? AND text = ? COLLATE NOCASE AND deleted_at IS NULL", [_0x3c6a8b[_0x136595(1593)], _0x3c6a8b[_0x136595(785)]]);
    if (_0x3421fc) {
      const _0x40ab7f = parseAppIdentifiers(_0x3421fc[_0x136595(166)]) || [], _0x5dd691 = _0x3c6a8b[_0x136595(166)] || [], _0x53e286 = Array[_0x136595(1840)](/* @__PURE__ */ new Set([..._0x40ab7f, ..._0x5dd691])), _0x527742 = _0x53e286[_0x136595(1115)] > 0 ? JSON[_0x136595(1516)](_0x53e286) : null, _0x13f170 = _0x5dd691[_0x136595(620)]((_0x5d752) => !_0x40ab7f[_0x136595(1580)](_0x5d752)), _0x1984c9 = _0x5dd691[_0x136595(1380)]((_0x421575) => !_0x40ab7f[_0x136595(1580)](_0x421575)), _0x16dde6 = _0x3c6a8b[_0x136595(705)] && !_0x3421fc[_0x136595(705)];
      if (_0x13f170 || _0x16dde6) {
        const _0x4923b1 = (/* @__PURE__ */ new Date())[_0x136595(582)](), _0x312002 = _0x136595(691);
        try {
          const _0x561b80 = await get(_0x312002, [_0x527742, _0x3c6a8b[_0x136595(705)] || null, _0x4923b1, _0x3421fc["id"]]);
          if (_0x561b80) return _0x561b80[_0x136595(823)] = Boolean(_0x561b80[_0x136595(823)]), _0x561b80[_0x136595(166)] = parseAppIdentifiers(_0x561b80[_0x136595(166)]), { "success": !![], "data": _0x561b80, "wasMerged": !![], "mergedApps": _0x1984c9 };
        } catch (_0x774771) {
          return { "success": ![], "error": _0x774771[_0x136595(1486)] || "Failed to update dictionary item", "errorType": _0x136595(1594) };
        }
      }
      return _0x3421fc[_0x136595(823)] = Boolean(_0x3421fc[_0x136595(823)]), _0x3421fc[_0x136595(166)] = parseAppIdentifiers(_0x3421fc[_0x136595(166)]), { "success": !![], "data": _0x3421fc, "wasMerged": ![] };
    }
    const _0x5de1c2 = await get("SELECT * FROM dictionary WHERE user_id = ? AND text = ? COLLATE NOCASE AND deleted_at IS NOT NULL", [_0x3c6a8b[_0x136595(1593)], _0x3c6a8b[_0x136595(785)]]);
    if (_0x5de1c2) {
      const _0x50b087 = (/* @__PURE__ */ new Date())[_0x136595(582)](), _0x1af327 = _0x3c6a8b[_0x136595(166)] ? JSON[_0x136595(1516)](_0x3c6a8b[_0x136595(166)]) : null, _0x173088 = _0x136595(825);
      try {
        const _0x30d87a = await get(_0x173088, [_0x3c6a8b[_0x136595(705)] || null, _0x1af327, _0x50b087, _0x5de1c2["id"]]);
        if (_0x30d87a) return _0x30d87a[_0x136595(823)] = Boolean(_0x30d87a[_0x136595(823)]), _0x30d87a[_0x136595(166)] = parseAppIdentifiers(_0x30d87a[_0x136595(166)]), { "success": !![], "data": _0x30d87a, "wasMerged": ![] };
      } catch (_0x2ead07) {
        return { "success": ![], "error": _0x2ead07[_0x136595(1486)] || "Failed to restore dictionary item", "errorType": _0x136595(1594) };
      }
    }
    const _0x537912 = _0x3c6a8b[_0x136595(166)] ? JSON[_0x136595(1516)](_0x3c6a8b[_0x136595(166)]) : null, _0x5499d1 = { "id": uuid["v4"](), "user_id": _0x3c6a8b[_0x136595(1593)], "text": _0x3c6a8b[_0x136595(785)], "description": _0x3c6a8b[_0x136595(705)] || null, "app_identifiers": _0x3c6a8b[_0x136595(166)] || null, "created_at": (/* @__PURE__ */ new Date())[_0x136595(582)](), "updated_at": (/* @__PURE__ */ new Date())[_0x136595(582)](), "deleted_at": null, "sync_failed_at": null, "auto_added": !![] }, _0x397f75 = _0x136595(888), _0x5020c7 = [_0x5499d1["id"], _0x5499d1[_0x136595(1593)], _0x5499d1[_0x136595(785)], _0x5499d1[_0x136595(705)], _0x537912, _0x5499d1[_0x136595(1142)], _0x5499d1[_0x136595(610)], _0x5499d1[_0x136595(1814)], _0x5499d1[_0x136595(1448)], 1];
    try {
      return await run(_0x397f75, _0x5020c7), { "success": !![], "data": _0x5499d1, "wasMerged": ![] };
    } catch (_0x2dd8d7) {
      return handleDictionaryConstraintError(_0x2dd8d7, _0x5499d1[_0x136595(785)]);
    }
  }
}
class VoiceSessionsTable {
  static async [_0x54a1b7(1761)](_0x3d8205) {
    const _0x7bd4f3 = _0x54a1b7, _0x28d998 = { "id": uuid["v4"](), ..._0x3d8205, "created_at": (/* @__PURE__ */ new Date())[_0x7bd4f3(582)](), "updated_at": (/* @__PURE__ */ new Date())[_0x7bd4f3(582)](), "deleted_at": null, "sync_failed_at": null }, _0x243775 = _0x7bd4f3(1540), _0x25d311 = [_0x28d998["id"], _0x28d998[_0x7bd4f3(1593)], _0x28d998[_0x7bd4f3(1099)], _0x28d998[_0x7bd4f3(1578)], _0x28d998[_0x7bd4f3(861)], _0x28d998[_0x7bd4f3(927)], _0x28d998[_0x7bd4f3(323)], _0x28d998[_0x7bd4f3(1330)], _0x28d998[_0x7bd4f3(528)], _0x28d998[_0x7bd4f3(1694)], _0x28d998[_0x7bd4f3(1396)], _0x28d998[_0x7bd4f3(260)], _0x28d998[_0x7bd4f3(1142)], _0x28d998[_0x7bd4f3(610)], _0x28d998[_0x7bd4f3(1814)], _0x28d998[_0x7bd4f3(1448)]];
    return await run(_0x243775, _0x25d311), _0x28d998;
  }
  static async [_0x54a1b7(238)](_0x5037b1) {
    const _0x180bde = await get("SELECT * FROM voice_sessions WHERE id = ?", [_0x5037b1]);
    return _0x180bde;
  }
  static async [_0x54a1b7(440)](_0x275d00) {
    const _0x3fb5b2 = _0x275d00 ? "SELECT * FROM voice_sessions WHERE user_id = ? AND deleted_at IS NULL ORDER BY created_at DESC" : "SELECT * FROM voice_sessions WHERE user_id IS NULL AND deleted_at IS NULL ORDER BY created_at DESC", _0x3b7870 = _0x275d00 ? [_0x275d00] : [];
    return await all(_0x3fb5b2, _0x3b7870);
  }
  static async [_0x54a1b7(428)](_0x4094fb) {
    const _0x4d6434 = _0x54a1b7, _0x5c17d6 = "UPDATE voice_sessions SET deleted_at = ?, updated_at = ? WHERE id = ?";
    await run(_0x5c17d6, [(/* @__PURE__ */ new Date())[_0x4d6434(582)](), (/* @__PURE__ */ new Date())[_0x4d6434(582)](), _0x4094fb]);
  }
  static async [_0x54a1b7(1780)](_0x4bd70f) {
    const _0xb819cf = _0x54a1b7, _0x1983d7 = "UPDATE voice_sessions SET deleted_at = ?, updated_at = ? WHERE user_id = ?";
    await run(_0x1983d7, [(/* @__PURE__ */ new Date())[_0xb819cf(582)](), (/* @__PURE__ */ new Date())[_0xb819cf(582)](), _0x4bd70f]);
  }
  static async [_0x54a1b7(494)](_0x4c9ce3) {
    const _0x457f7b = await all("SELECT * FROM voice_sessions WHERE updated_at > ? AND sync_failed_at IS NULL", [_0x4c9ce3]);
    return _0x457f7b;
  }
  static async [_0x54a1b7(874)](_0x240310) {
    const _0x360a08 = _0x54a1b7, _0x25961f = "UPDATE voice_sessions SET sync_failed_at = ? WHERE id = ?";
    await run(_0x25961f, [(/* @__PURE__ */ new Date())[_0x360a08(582)](), _0x240310]);
  }
  static async [_0x54a1b7(810)](_0x1eaa25) {
    const _0x245a27 = _0x54a1b7, _0x554b13 = _0x245a27(887), _0x4c0c19 = [_0x1eaa25["id"], _0x1eaa25[_0x245a27(1593)], _0x1eaa25[_0x245a27(1099)], _0x1eaa25[_0x245a27(1578)], _0x1eaa25[_0x245a27(861)], _0x1eaa25[_0x245a27(927)], _0x1eaa25[_0x245a27(323)], _0x1eaa25[_0x245a27(1330)], _0x1eaa25[_0x245a27(528)], _0x1eaa25[_0x245a27(1694)], _0x1eaa25[_0x245a27(1396)], _0x1eaa25[_0x245a27(260)], _0x1eaa25[_0x245a27(1142)], _0x1eaa25[_0x245a27(610)], _0x1eaa25[_0x245a27(1814)], _0x1eaa25[_0x245a27(1448)]];
    await run(_0x554b13, _0x4c0c19);
  }
}
class AppIconsTable {
  static async [_0x54a1b7(810)](_0x5bc059) {
    const _0x41de4f = _0x54a1b7, _0x37505c = (/* @__PURE__ */ new Date())[_0x41de4f(582)](), _0x2082e1 = uuid["v4"](), _0x53bc17 = _0x41de4f(1058), _0x2e5236 = [_0x2082e1, _0x5bc059[_0x41de4f(1593)], _0x5bc059[_0x41de4f(861)], _0x5bc059[_0x41de4f(575)], _0x37505c, _0x37505c], _0x587363 = await get(_0x53bc17, _0x2e5236);
    if (!_0x587363) throw new Error("Failed to insert or update app icon");
    return _0x587363;
  }
  static async [_0x54a1b7(671)](_0x4d2880, _0x19ce27) {
    const _0x6f15bb = await get("SELECT * FROM app_icons WHERE user_id = ? AND app_name = ?", [_0x4d2880, _0x19ce27]);
    return _0x6f15bb;
  }
  static async [_0x54a1b7(440)](_0x3a5e8d) {
    return await all("SELECT * FROM app_icons WHERE user_id = ? ORDER BY app_name ASC", [_0x3a5e8d]);
  }
  static async [_0x54a1b7(494)](_0xb1f167) {
    const _0x36f60a = await all("SELECT * FROM app_icons WHERE updated_at > ?", [_0xb1f167]);
    return _0x36f60a;
  }
  static async [_0x54a1b7(506)](_0x24050a) {
    await run("DELETE FROM app_icons WHERE id = ?", [_0x24050a]);
  }
  static async [_0x54a1b7(1780)](_0x31ee24) {
    await run("DELETE FROM app_icons WHERE user_id = ?", [_0x31ee24]);
  }
}
class SyncMetadata {
  static async [_0x54a1b7(1359)](_0x4c4fc2, _0x220050) {
    const _0x52f099 = _0x54a1b7, _0x85f5a3 = _0x52f099(1798);
    await run(_0x85f5a3, [_0x4c4fc2, _0x220050]);
  }
  static async [_0x54a1b7(1043)](_0x23398f) {
    const _0x5c0598 = _0x54a1b7, _0x2cdf0c = await get("SELECT timestamp FROM sync_metadata WHERE id = ?", [_0x23398f]);
    return _0x2cdf0c?.[_0x5c0598(831)];
  }
}
class CustomInstructionsTable {
  static async [_0x54a1b7(1761)](_0x28e19f) {
    const _0x1a6c57 = _0x54a1b7, _0x1f5148 = await get("SELECT * FROM custom_instructions WHERE user_id = ? AND app_identifier = ? AND deleted_at IS NOT NULL", [_0x28e19f[_0x1a6c57(1593)], _0x28e19f[_0x1a6c57(857)]]);
    if (_0x1f5148) {
      const _0x2544aa = (/* @__PURE__ */ new Date())[_0x1a6c57(582)](), _0x489ba0 = _0x1a6c57(161);
      try {
        const _0x25658b = await get(_0x489ba0, [_0x28e19f[_0x1a6c57(366)], _0x2544aa, _0x1f5148["id"]]);
        if (_0x25658b) return { "success": !![], "data": _0x25658b };
      } catch (_0x525e76) {
        return { "success": ![], "error": _0x525e76[_0x1a6c57(1486)] || "Failed to restore custom instruction", "errorType": _0x1a6c57(1594) };
      }
    }
    const _0x4c302e = { "id": uuid["v4"](), ..._0x28e19f, "created_at": (/* @__PURE__ */ new Date())[_0x1a6c57(582)](), "updated_at": (/* @__PURE__ */ new Date())[_0x1a6c57(582)](), "deleted_at": null }, _0x32cfb5 = _0x1a6c57(1653), _0x48416a = [_0x4c302e["id"], _0x4c302e[_0x1a6c57(1593)], _0x4c302e[_0x1a6c57(857)], _0x4c302e[_0x1a6c57(366)], _0x4c302e[_0x1a6c57(1142)], _0x4c302e[_0x1a6c57(610)], _0x4c302e[_0x1a6c57(1814)]];
    try {
      return await run(_0x32cfb5, _0x48416a), { "success": !![], "data": _0x4c302e };
    } catch (_0xe8c275) {
      if (isUniqueConstraintError(_0xe8c275)) return { "success": ![], "error": _0x1a6c57(1128) + _0x28e19f[_0x1a6c57(857)] + _0x1a6c57(1075), "errorType": _0x1a6c57(1819) };
      return { "success": ![], "error": _0xe8c275[_0x1a6c57(1486)] || "Database operation failed", "errorType": _0x1a6c57(1594) };
    }
  }
  static async [_0x54a1b7(440)](_0x10a379) {
    return await all("SELECT * FROM custom_instructions WHERE user_id = ? AND deleted_at IS NULL ORDER BY app_identifier ASC", [_0x10a379]);
  }
  static async [_0x54a1b7(510)](_0x26d066, _0x567643) {
    return await get("SELECT * FROM custom_instructions WHERE user_id = ? AND app_identifier = ? AND deleted_at IS NULL", [_0x26d066, _0x567643]);
  }
  static async [_0x54a1b7(324)](_0x249a17, _0x2eb57e, _0x4fb491) {
    const _0x2f31ca = _0x54a1b7, _0x49478a = "UPDATE custom_instructions SET app_identifier = ?, instruction = ?, updated_at = ? WHERE id = ? RETURNING *";
    try {
      const _0x2269aa = await get(_0x49478a, [_0x2eb57e, _0x4fb491, (/* @__PURE__ */ new Date())[_0x2f31ca(582)](), _0x249a17]);
      if (!_0x2269aa) return { "success": ![], "error": "Custom instruction not found" };
      return { "success": !![], "data": _0x2269aa };
    } catch (_0x3d6b78) {
      if (isUniqueConstraintError(_0x3d6b78)) return { "success": ![], "error": _0x2f31ca(1128) + _0x2eb57e + _0x2f31ca(1075), "errorType": _0x2f31ca(1819) };
      return { "success": ![], "error": _0x3d6b78[_0x2f31ca(1486)] || "Database operation failed", "errorType": _0x2f31ca(1594) };
    }
  }
  static async [_0x54a1b7(428)](_0x3889dd) {
    const _0x11b46e = _0x54a1b7, _0x38a60a = (/* @__PURE__ */ new Date())[_0x11b46e(582)](), _0x130149 = "UPDATE custom_instructions SET deleted_at = ?, updated_at = ? WHERE id = ?";
    await run(_0x130149, [_0x38a60a, _0x38a60a, _0x3889dd]);
  }
  static async [_0x54a1b7(1780)](_0xa90b54) {
    const _0x203186 = _0x54a1b7, _0x2bfe3a = (/* @__PURE__ */ new Date())[_0x203186(582)](), _0x52df12 = "UPDATE custom_instructions SET deleted_at = ?, updated_at = ? WHERE user_id = ?";
    await run(_0x52df12, [_0x2bfe3a, _0x2bfe3a, _0xa90b54]);
  }
}
const repo = Object[_0x54a1b7(502)](Object[_0x54a1b7(634)]({ "__proto__": null, "AppIconsTable": AppIconsTable, "CustomInstructionsTable": CustomInstructionsTable, "DictionaryTable": DictionaryTable, "SyncMetadata": SyncMetadata, "VoiceSessionsTable": VoiceSessionsTable }, Symbol[_0x54a1b7(1177)], { "value": _0x54a1b7(1416) })), platform = os[_0x54a1b7(1394)](), isDev = !electron[_0x54a1b7(178)][_0x54a1b7(1664)], getNativeBinaryPath = (_0x1cf6bc) => {
  const _0x30f7d3 = _0x54a1b7;
  let _0x3eaf5f = _0x1cf6bc;
  if (platform === "win32") {
    _0x1cf6bc === _0x30f7d3(1001) && (_0x3eaf5f = _0x30f7d3(1713));
    if (_0x1cf6bc === "window-text-reader" || _0x1cf6bc === "focused-element-reader") return console[_0x30f7d3(1341)](_0x30f7d3(1057) + _0x1cf6bc + _0x30f7d3(598)), null;
  }
  const _0x36ce1c = getTargetDir(_0x3eaf5f), _0x3fbb91 = platform === "win32" ? _0x3eaf5f + _0x30f7d3(1206) : "" + _0x3eaf5f;
  if (!_0x36ce1c) return console[_0x30f7d3(981)](_0x30f7d3(1733) + _0x3eaf5f + _0x30f7d3(1237) + os[_0x30f7d3(1394)]()), null;
  return path[_0x30f7d3(1638)](_0x36ce1c, _0x3fbb91);
}, getTargetDir = (_0xb252e4) => {
  const _0x115b88 = _0x54a1b7;
  if (isDev) {
    const _0x4e1c66 = path[_0x115b88(1638)](__dirname, _0x115b88(603) + _0xb252e4);
    if (platform === "darwin") {
      const _0x5d9f3d = path[_0x115b88(1638)](_0x4e1c66, "target/universal");
      if (fs[_0x115b88(1363)](path[_0x115b88(1638)](_0x5d9f3d, _0xb252e4))) return _0x5d9f3d;
      const _0x5c35bf = os[_0x115b88(1129)]() === "arm64" ? "arm64" : "x86_64", _0x30cada = path[_0x115b88(1638)](_0x4e1c66, _0x115b88(1645) + _0x5c35bf + _0x115b88(1600));
      if (fs[_0x115b88(1363)](path[_0x115b88(1638)](_0x30cada, _0xb252e4))) return _0x30cada;
      const _0x2444b4 = path[_0x115b88(1638)](_0x4e1c66, ".build/release");
      if (fs[_0x115b88(1363)](path[_0x115b88(1638)](_0x2444b4, _0xb252e4))) return _0x2444b4;
      const _0x4b8581 = path[_0x115b88(1638)](_0x4e1c66, "target/release");
      if (fs[_0x115b88(1363)](path[_0x115b88(1638)](_0x4b8581, _0xb252e4))) return _0x4b8581;
      return _0x5d9f3d;
    } else {
      if (platform === "win32") {
        const _0x3639f8 = path[_0x115b88(1638)](_0x4e1c66, "target/x86_64-pc-windows-msvc/release");
        if (fs[_0x115b88(1363)](path[_0x115b88(1638)](_0x3639f8, _0xb252e4 + _0x115b88(1206)))) return _0x3639f8;
        const _0x2c9d21 = path[_0x115b88(1638)](_0x4e1c66, "target/x86_64-pc-windows-gnu/release");
        if (fs[_0x115b88(1363)](path[_0x115b88(1638)](_0x2c9d21, _0xb252e4 + _0x115b88(1206)))) return _0x2c9d21;
        return _0x3639f8;
      }
    }
    return null;
  }
  return path[_0x115b88(1638)](process[_0x115b88(1613)], "binaries");
}, nativeModuleName$5 = "selection-reader", MAXIUMUM_TEXT_LENGTH_DEFAULT = 1e4;
class SelectedTextReaderService extends events[_0x54a1b7(281)] {
  #selectedTextProcess = null;
  #pendingRequests = /* @__PURE__ */ new Map();
  #requestIdCounter = 0;
  constructor() {
    super();
  }
  [_0x54a1b7(1247)]() {
    const _0x1507bd = _0x54a1b7;
    if (this.#selectedTextProcess) {
      log[_0x1507bd(1697)]("[SelectedTextService] Selected text reader already running.");
      return;
    }
    const _0x1ea048 = getNativeBinaryPath(nativeModuleName$5);
    if (!_0x1ea048) {
      log[_0x1507bd(981)](_0x1507bd(201) + nativeModuleName$5 + _0x1507bd(1237) + os[_0x1507bd(1394)]() + _0x1507bd(847) + os[_0x1507bd(1129)]()), this[_0x1507bd(569)]("error", new Error("Selected text reader binary not found."));
      return;
    }
    log[_0x1507bd(1341)](_0x1507bd(1066) + _0x1ea048);
    try {
      this.#selectedTextProcess = child_process[_0x1507bd(1424)](_0x1ea048, [], { "stdio": [_0x1507bd(1155), _0x1507bd(1155), _0x1507bd(1155)] });
      if (!this.#selectedTextProcess) throw new Error(_0x1507bd(1496));
      this.#selectedTextProcess[_0x1507bd(1532)]?.["on"]("data", this.#onData[_0x1507bd(334)](this)), this.#selectedTextProcess[_0x1507bd(595)]?.["on"]("data", this.#onStdErr[_0x1507bd(334)](this)), this.#selectedTextProcess["on"]("close", this.#onClose[_0x1507bd(334)](this)), this.#selectedTextProcess["on"]("error", this.#onError[_0x1507bd(334)](this)), log[_0x1507bd(1341)]("[SelectedTextService] Selected text reader process started.");
    } catch (_0x3d58cb) {
      log[_0x1507bd(981)]("[SelectedTextService] Caught an error while spawning selected text reader:", _0x3d58cb), this.#selectedTextProcess = null, this[_0x1507bd(569)]("error", _0x3d58cb);
    }
  }
  [_0x54a1b7(268)]() {
    const _0x336bfc = _0x54a1b7;
    this.#selectedTextProcess && (log[_0x336bfc(1341)]("[SelectedTextService] Stopping selected text reader process."), this.#selectedTextProcess[_0x336bfc(1386)](), this.#selectedTextProcess = null, this[_0x336bfc(569)](_0x336bfc(1336)), this.#pendingRequests[_0x336bfc(878)](({ reject: _0x2a4187 }) => {
      const _0x378d6b = _0x336bfc;
      _0x2a4187(new Error(_0x378d6b(557)));
    }), this.#pendingRequests[_0x336bfc(1723)]());
  }
  async [_0x54a1b7(815)](_0x484232 = { "format": "json", "maxLength": MAXIUMUM_TEXT_LENGTH_DEFAULT }) {
    if (!this.#selectedTextProcess) throw new Error("Selected text reader process not running");
    return new Promise((_0x432129, _0x13cc0c) => {
      const _0xd88157 = _0x1d03, _0x15d2bd = _0xd88157(526) + ++this.#requestIdCounter + "_" + Date[_0xd88157(1536)]();
      this.#pendingRequests[_0xd88157(1359)](_0x15d2bd, { "resolve": _0x432129, "reject": _0x13cc0c });
      const _0x518496 = { "command": "get-text", "format": _0x484232[_0xd88157(1853)] || "json", "maxLength": _0x484232[_0xd88157(1384)] || MAXIUMUM_TEXT_LENGTH_DEFAULT, "requestId": _0x15d2bd };
      this.#sendCommand(_0x518496), setTimeout(() => {
        const _0x589526 = _0xd88157;
        this.#pendingRequests[_0x589526(1764)](_0x15d2bd) && (this.#pendingRequests[_0x589526(506)](_0x15d2bd), _0x13cc0c(new Error("Selected text request timed out")));
      }, 5e3);
    });
  }
  async [_0x54a1b7(1376)](_0x25cfe2, _0x5367dc = ![]) {
    if (!this.#selectedTextProcess) throw new Error("Selected text reader process not running");
    return new Promise((_0xed737e, _0x4b7276) => {
      const _0x2560f3 = _0x1d03, _0x3f7268 = _0x2560f3(1680) + ++this.#requestIdCounter + "_" + Date[_0x2560f3(1536)]();
      this.#pendingRequests[_0x2560f3(1359)](_0x3f7268, { "resolve": _0xed737e, "reject": _0x4b7276 });
      const _0x18c27a = { "command": "get-cursor-context", "contextLength": _0x25cfe2, "cutCurrentSelection": _0x5367dc, "requestId": _0x3f7268 };
      this.#sendCommand(_0x18c27a), setTimeout(() => {
        const _0x1955b1 = _0x2560f3;
        this.#pendingRequests[_0x1955b1(1764)](_0x3f7268) && (this.#pendingRequests[_0x1955b1(506)](_0x3f7268), _0x4b7276(new Error("Cursor context request timed out")));
      }, 5e3);
    });
  }
  async [_0x54a1b7(1829)]() {
    const _0x2f6975 = _0x54a1b7;
    console[_0x2f6975(926)](_0x2f6975(492) + (this.#selectedTextProcess !== null));
    if (!this.#selectedTextProcess) throw new Error("Selected text reader process not running");
    return new Promise((_0x1e4a87, _0x5e5142) => {
      const _0x25f9af = _0x2f6975, _0x2c6529 = _0x25f9af(318) + ++this.#requestIdCounter + "_" + Date[_0x25f9af(1536)]();
      console[_0x25f9af(926)](_0x25f9af(1445) + _0x2c6529), this.#pendingRequests[_0x25f9af(1359)](_0x2c6529, { "resolve": _0x1e4a87, "reject": _0x5e5142 });
      const _0x32043b = { "command": "get-caret-bounds", "requestId": _0x2c6529 };
      this.#sendCommand(_0x32043b), setTimeout(() => {
        const _0x330811 = _0x25f9af;
        this.#pendingRequests[_0x330811(1764)](_0x2c6529) && (console[_0x330811(926)](_0x330811(1557) + _0x2c6529 + _0x330811(1752)), this.#pendingRequests[_0x330811(506)](_0x2c6529), _0x5e5142(new Error(_0x330811(1215))));
      }, 2e3);
    });
  }
  #sendCommand(_0x312ac1) {
    const _0x3050bd = _0x54a1b7;
    if (!this.#selectedTextProcess) {
      log[_0x3050bd(981)]("[SelectedTextService] Cannot send command, process not running");
      return;
    }
    try {
      const _0x5acc87 = JSON[_0x3050bd(1516)](_0x312ac1) + "\n";
      console[_0x3050bd(926)](_0x3050bd(1420) + _0x5acc87[_0x3050bd(1699)]()), this.#selectedTextProcess[_0x3050bd(776)]?.[_0x3050bd(1020)](_0x5acc87);
    } catch (_0x3804bc) {
      log[_0x3050bd(981)]("[SelectedTextService] Error sending command:", _0x3804bc);
    }
  }
  #onData(_0x4ad0e2) {
    const _0x2d6c0c = _0x54a1b7, _0x2b1de9 = _0x4ad0e2[_0x2d6c0c(1450)]()[_0x2d6c0c(1699)]()[_0x2d6c0c(1163)]("\n");
    console[_0x2d6c0c(926)](_0x2d6c0c(635) + _0x4ad0e2[_0x2d6c0c(1450)]()[_0x2d6c0c(1699)]());
    for (const _0x456cb0 of _0x2b1de9) {
      if (!_0x456cb0[_0x2d6c0c(1699)]()) continue;
      try {
        const _0x2bf483 = JSON[_0x2d6c0c(675)](_0x456cb0);
        console[_0x2d6c0c(926)](_0x2d6c0c(1658) + _0x2bf483[_0x2d6c0c(437)]);
        if (_0x2bf483[_0x2d6c0c(437)] && this.#pendingRequests[_0x2d6c0c(1764)](_0x2bf483[_0x2d6c0c(437)])) {
          const { resolve: _0x52258d } = this.#pendingRequests[_0x2d6c0c(1043)](_0x2bf483[_0x2d6c0c(437)]);
          this.#pendingRequests[_0x2d6c0c(506)](_0x2bf483[_0x2d6c0c(437)]), console[_0x2d6c0c(926)](_0x2d6c0c(1393) + _0x2bf483[_0x2d6c0c(437)]), _0x52258d(_0x2bf483);
        } else log[_0x2d6c0c(1697)]("[SelectedTextService] Received response for unknown request:", _0x2bf483[_0x2d6c0c(437)]);
      } catch (_0x5e0670) {
        log[_0x2d6c0c(981)]("[SelectedTextService] Error parsing response:", _0x5e0670, "Raw data:", _0x456cb0);
      }
    }
  }
  #onStdErr(_0x119646) {
    const _0x4ac148 = _0x54a1b7, _0x12a6d8 = _0x119646[_0x4ac148(1450)]();
    console[_0x4ac148(926)]("[SelectedTextService]  stderr:", _0x12a6d8);
  }
  #onClose(_0x5ba9cf, _0x262786) {
    const _0x2e6f90 = _0x54a1b7;
    log[_0x2e6f90(1697)](_0x2e6f90(643) + _0x5ba9cf + _0x2e6f90(1318) + _0x262786), this.#selectedTextProcess = null, this.#pendingRequests[_0x2e6f90(878)](({ reject: _0xc4076 }) => {
      const _0x5365bc = _0x2e6f90;
      _0xc4076(new Error(_0x5365bc(1110) + _0x5ba9cf));
    }), this.#pendingRequests[_0x2e6f90(1723)](), this[_0x2e6f90(569)]("closed", { "code": _0x5ba9cf, "signal": _0x262786 });
  }
  #onError(_0x1120e4) {
    const _0x11b94e = _0x54a1b7;
    log[_0x11b94e(981)]("[SelectedTextService] Process error:", _0x1120e4), this[_0x11b94e(569)]("error", _0x1120e4);
  }
  [_0x54a1b7(1084)]() {
    return this.#selectedTextProcess !== null;
  }
}
const selectedTextReaderService = new SelectedTextReaderService();
function getSelectedText(_0x3a9889 = { "format": "json", "maxLength": MAXIUMUM_TEXT_LENGTH_DEFAULT }) {
  const _0x62b9ba = _0x54a1b7;
  return selectedTextReaderService[_0x62b9ba(815)](_0x3a9889);
}
async function getSelectedTextString(_0x2e4f91 = MAXIUMUM_TEXT_LENGTH_DEFAULT) {
  const _0x1f7bd5 = _0x54a1b7;
  try {
    const _0x3de167 = await selectedTextReaderService[_0x1f7bd5(815)]({ "format": "json", "maxLength": _0x2e4f91 });
    return _0x3de167[_0x1f7bd5(522)] ? _0x3de167[_0x1f7bd5(785)] : null;
  } catch (_0xd1fd28) {
    return log[_0x1f7bd5(981)]("Error getting selected text:", _0xd1fd28), null;
  }
}
async function hasSelectedText() {
  const _0xf1a8ee = _0x54a1b7;
  try {
    const _0x249692 = await selectedTextReaderService[_0xf1a8ee(815)]({ "format": "json", "maxLength": 1 });
    return _0x249692[_0xf1a8ee(522)] && _0x249692[_0xf1a8ee(1115)] > 0;
  } catch (_0x3e9ccf) {
    return log[_0xf1a8ee(981)]("Error checking for selected text:", _0x3e9ccf), ![];
  }
}
async function getFullCursorContext(_0x4aac9e) {
  const _0x4e0e9f = _0x54a1b7, _0xe3b31c = await selectedTextReaderService[_0x4e0e9f(1376)](_0x4aac9e, ![]);
  return { "textBefore": _0xe3b31c[_0x4e0e9f(518)] || "", "textAfter": _0xe3b31c[_0x4e0e9f(1439)] || "" };
}
async function getCaretBounds() {
  const _0x4360ad = _0x54a1b7;
  try {
    const _0x415db1 = await selectedTextReaderService[_0x4360ad(1829)]();
    log[_0x4360ad(1341)](_0x4360ad(943) + _0x415db1[_0x4360ad(522)] + _0x4360ad(211) + _0x415db1["x"] + _0x4360ad(1168) + _0x415db1["y"] + _0x4360ad(365) + _0x415db1[_0x4360ad(183)] + _0x4360ad(886) + _0x415db1[_0x4360ad(553)] + _0x4360ad(1346) + _0x415db1[_0x4360ad(981)]);
    if (_0x415db1[_0x4360ad(522)] && _0x415db1["x"] !== null && _0x415db1["y"] !== null && _0x415db1[_0x4360ad(183)] !== null && _0x415db1[_0x4360ad(553)] !== null) return { "x": _0x415db1["x"], "y": _0x415db1["y"], "width": _0x415db1[_0x4360ad(183)], "height": _0x415db1[_0x4360ad(553)] };
    return !_0x415db1[_0x4360ad(522)] && _0x415db1[_0x4360ad(981)] && log[_0x4360ad(1697)](_0x4360ad(824) + _0x415db1[_0x4360ad(981)]), null;
  } catch (_0x1c3724) {
    return log[_0x4360ad(981)]("Error getting caret bounds:", _0x1c3724), null;
  }
}
const selectedTextReader = Object[_0x54a1b7(502)](Object[_0x54a1b7(634)]({ "__proto__": null, "getCaretBounds": getCaretBounds, "getFullCursorContext": getFullCursorContext, "getSelectedText": getSelectedText, "getSelectedTextString": getSelectedTextString, "hasSelectedText": hasSelectedText, "selectedTextReaderService": selectedTextReaderService }, Symbol[_0x54a1b7(1177)], { "value": _0x54a1b7(1416) }));
function _0x1d03(_0x533b63, _0x13a8fc) {
  _0x533b63 = _0x533b63 - 123;
  const _0x3d7592 = _0x475e();
  let _0x28a5292 = _0x3d7592[_0x533b63];
  return _0x28a5292;
}
function getEnvNamespace() {
  const _0x18300b = _0x54a1b7, _0x561727 = "https://api.voiceos.com";
  try {
    const _0x131940 = new URL(_0x561727);
    return (_0x131940[_0x18300b(1456)] || _0x561727 || _0x18300b(1014))[_0x18300b(1541)](/:/g, "_");
  } catch {
    return _0x561727[_0x18300b(1541)](/:/g, "_");
  }
}
function getLastSyncedAtKey(_0x35576e) {
  const _0x4281ef = _0x54a1b7, _0x474425 = getEnvNamespace();
  return _0x4281ef(1721) + _0x474425 + "." + _0x35576e;
}
class SyncService {
  [_0x54a1b7(249)] = ![];
  [_0x54a1b7(1004)] = null;
  static [_0x54a1b7(1676)];
  constructor() {
  }
  static [_0x54a1b7(562)]() {
    const _0x124913 = _0x54a1b7;
    return !SyncService[_0x124913(1676)] && (SyncService[_0x124913(1676)] = new SyncService()), SyncService[_0x124913(1676)];
  }
  async [_0x54a1b7(376)]() {
    const _0x5a863e = _0x54a1b7;
    this[_0x5a863e(1004)] && clearInterval(this[_0x5a863e(1004)]), await this[_0x5a863e(1661)](), this[_0x5a863e(1004)] = setInterval(() => this[_0x5a863e(1661)](), 1e3 * 10);
  }
  [_0x54a1b7(1146)]() {
    const _0x383000 = _0x54a1b7;
    this[_0x383000(1004)] && (clearInterval(this[_0x383000(1004)]), this[_0x383000(1004)] = null), this[_0x383000(249)] = ![];
  }
  async [_0x54a1b7(1661)]() {
    const _0xc0ea8e = _0x54a1b7;
    if (this[_0xc0ea8e(249)]) return;
    this[_0xc0ea8e(249)] = !![];
    try {
      const _0x237a81 = store[_0xc0ea8e(1043)](STORE_KEYS[_0xc0ea8e(1850)]);
      if (!_0x237a81?.["id"]) {
        console[_0xc0ea8e(926)]("No user logged in or user profile is missing ID. Skipping sync."), this[_0xc0ea8e(249)] = ![];
        return;
      }
      const _0x5e6510 = getLastSyncedAtKey(_0x237a81["id"]), _0x438a2e = await SyncMetadata[_0xc0ea8e(1043)](_0x5e6510);
      let _0x34b7ec = 0;
      const _0x15a0be = _0x438a2e || _0xc0ea8e(1846);
      console[_0xc0ea8e(926)]("[SyncService] Pushing changes since:", _0x15a0be), _0x34b7ec += await this[_0xc0ea8e(1019)](_0x15a0be), _0x34b7ec += await this[_0xc0ea8e(1294)](_0x15a0be), _0x34b7ec += await this[_0xc0ea8e(1264)](_0x15a0be), _0x34b7ec += await this[_0xc0ea8e(1061)](_0x438a2e), _0x34b7ec += await this[_0xc0ea8e(652)](_0x438a2e), _0x34b7ec += await this[_0xc0ea8e(1053)](_0x438a2e), console[_0xc0ea8e(926)](_0xc0ea8e(1468) + _0x34b7ec + _0xc0ea8e(351));
      if (_0x34b7ec > 0 || !_0x438a2e) {
        const _0x4dab0d = (/* @__PURE__ */ new Date())[_0xc0ea8e(582)]();
        console[_0xc0ea8e(926)](_0xc0ea8e(966), _0x4dab0d), await SyncMetadata[_0xc0ea8e(1359)](_0x5e6510, _0x4dab0d);
      }
    } catch (_0x39317e) {
      console[_0xc0ea8e(981)](" Sync cycle failed:", _0x39317e);
    } finally {
      this[_0xc0ea8e(249)] = ![];
    }
  }
  async [_0x54a1b7(1019)](_0x42816c) {
    const _0x2e172c = _0x54a1b7, _0x4b2dc7 = await DictionaryTable[_0x2e172c(494)](_0x42816c);
    if (_0x4b2dc7[_0x2e172c(1115)] > 0) for (const _0x4497f8 of _0x4b2dc7) {
      try {
        if (new Date(_0x4497f8[_0x2e172c(1142)]) > new Date(_0x42816c)) await grpcClient[_0x2e172c(1825)](_0x4497f8);
        else _0x4497f8[_0x2e172c(1814)] ? await grpcClient[_0x2e172c(1024)](_0x4497f8) : await grpcClient[_0x2e172c(216)](_0x4497f8);
      } catch (_0x1ea13f) {
        console[_0x2e172c(981)](_0x2e172c(1552) + _0x4497f8["id"] + ":", _0x1ea13f), await DictionaryTable[_0x2e172c(874)](_0x4497f8["id"]);
      }
    }
    return _0x4b2dc7[_0x2e172c(1115)];
  }
  async [_0x54a1b7(652)](_0x295ad1) {
    const _0x50d0fd = _0x54a1b7, _0x17fa31 = await grpcClient[_0x50d0fd(1252)](_0x295ad1);
    if (_0x17fa31[_0x50d0fd(1115)] > 0) for (const _0x53f97f of _0x17fa31) {
      if (_0x53f97f[_0x50d0fd(508)]) {
        await DictionaryTable[_0x50d0fd(428)](_0x53f97f["id"]);
        continue;
      }
      const _0x34fbb5 = { "id": _0x53f97f["id"], "user_id": _0x53f97f[_0x50d0fd(286)], "text": _0x53f97f[_0x50d0fd(785)], "description": _0x53f97f[_0x50d0fd(705)] || null, "created_at": _0x53f97f[_0x50d0fd(940)], "updated_at": _0x53f97f[_0x50d0fd(474)], "deleted_at": _0x53f97f[_0x50d0fd(508)] || null, "sync_failed_at": null, "auto_added": _0x53f97f[_0x50d0fd(1201)] || ![], "app_identifiers": _0x53f97f[_0x50d0fd(1865)] || null };
      await DictionaryTable[_0x50d0fd(810)](_0x34fbb5);
    }
    return _0x17fa31[_0x50d0fd(1115)];
  }
  async [_0x54a1b7(1294)](_0xb8902e) {
    const _0x3d4bb9 = _0x54a1b7, _0x5aaad3 = store[_0x3d4bb9(1043)](STORE_KEYS[_0x3d4bb9(193)]), _0x1a0181 = _0x5aaad3?.[_0x3d4bb9(1372)] ?? !![];
    if (!_0x1a0181) return console[_0x3d4bb9(926)]("[SyncService] Analytics sharing disabled, skipping voice session push"), 0;
    const _0x252bdf = await VoiceSessionsTable[_0x3d4bb9(494)](_0xb8902e);
    if (_0x252bdf[_0x3d4bb9(1115)] > 0) for (const _0xa586a0 of _0x252bdf) {
      try {
        new Date(_0xa586a0[_0x3d4bb9(1142)]) > new Date(_0xb8902e) && await grpcClient[_0x3d4bb9(1659)](_0xa586a0);
      } catch (_0x5196a1) {
        console[_0x3d4bb9(981)](_0x3d4bb9(256) + _0xa586a0["id"] + ":", _0x5196a1), await VoiceSessionsTable[_0x3d4bb9(874)](_0xa586a0["id"]);
      }
    }
    return _0x252bdf[_0x3d4bb9(1115)];
  }
  async [_0x54a1b7(1053)](_0x119939) {
    const _0x4784a6 = _0x54a1b7, _0x44233a = await grpcClient[_0x4784a6(258)](_0x119939);
    if (_0x44233a[_0x4784a6(1115)] > 0) for (const _0x5170d0 of _0x44233a) {
      if (_0x5170d0[_0x4784a6(508)]) {
        await VoiceSessionsTable[_0x4784a6(428)](_0x5170d0["id"]);
        continue;
      }
      const _0x100bb7 = { "id": _0x5170d0["id"], "user_id": _0x5170d0[_0x4784a6(286)], "transcript": _0x5170d0[_0x4784a6(1099)] || null, "generated_text": _0x5170d0[_0x4784a6(1089)] || null, "app_name": _0x5170d0[_0x4784a6(1856)] || null, "window_title": _0x5170d0[_0x4784a6(688)] || null, "audio_blob_id": _0x5170d0[_0x4784a6(971)] ?? null, "duration_seconds": _0x5170d0[_0x4784a6(664)] || 0, "sample_rate": _0x5170d0[_0x4784a6(1104)] ?? null, "word_count": _0x5170d0[_0x4784a6(819)] ?? null, "created_at": _0x5170d0[_0x4784a6(940)], "updated_at": _0x5170d0[_0x4784a6(474)], "deleted_at": _0x5170d0[_0x4784a6(508)] || null, "sync_failed_at": null };
      await VoiceSessionsTable[_0x4784a6(810)](_0x100bb7);
    }
    return _0x44233a[_0x4784a6(1115)];
  }
  async [_0x54a1b7(1264)](_0x138806) {
    const _0x65a39d = _0x54a1b7, _0x5e0da8 = await AppIconsTable[_0x65a39d(494)](_0x138806);
    console[_0x65a39d(926)](_0x65a39d(715) + _0x5e0da8[_0x65a39d(1115)] + _0x65a39d(148));
    if (_0x5e0da8[_0x65a39d(1115)] > 0) for (const _0x461a83 of _0x5e0da8) {
      try {
        console[_0x65a39d(926)](_0x65a39d(723) + _0x461a83[_0x65a39d(861)]), await grpcClient[_0x65a39d(181)](_0x461a83), console[_0x65a39d(926)](_0x65a39d(325) + _0x461a83[_0x65a39d(861)]);
      } catch (_0x2b45f9) {
        console[_0x65a39d(981)](_0x65a39d(1245) + _0x461a83["id"] + ":", _0x2b45f9);
      }
    }
    return _0x5e0da8[_0x65a39d(1115)];
  }
  async [_0x54a1b7(1061)](_0x606442) {
    const _0x30efd4 = _0x54a1b7, _0x592c14 = await grpcClient[_0x30efd4(1249)](_0x606442);
    if (_0x592c14[_0x30efd4(1115)] > 0) for (const _0x1ba16a of _0x592c14) {
      const _0x42a77d = { "id": _0x1ba16a["id"], "user_id": _0x1ba16a[_0x30efd4(286)], "app_name": _0x1ba16a[_0x30efd4(1856)], "icon_base64": _0x1ba16a[_0x30efd4(852)], "created_at": _0x1ba16a[_0x30efd4(940)], "updated_at": _0x1ba16a[_0x30efd4(474)] };
      await AppIconsTable[_0x30efd4(810)]({ "user_id": _0x42a77d[_0x30efd4(1593)], "app_name": _0x42a77d[_0x30efd4(861)], "icon_base64": _0x42a77d[_0x30efd4(575)] });
    }
    return _0x592c14[_0x30efd4(1115)];
  }
}
const syncService = SyncService[_0x54a1b7(562)](), handleLogout = async () => {
  const _0x2b5c11 = _0x54a1b7;
  store[_0x2b5c11(506)](STORE_KEYS[_0x2b5c11(1850)]), store[_0x2b5c11(506)](STORE_KEYS[_0x2b5c11(1072)]), store[_0x2b5c11(506)](STORE_KEYS[_0x2b5c11(684)]), store[_0x2b5c11(1359)](STORE_KEYS[_0x2b5c11(430)], { "user": null, "tokens": null, "state": null, "isSelfHosted": ![] }), grpcClient[_0x2b5c11(1843)](null), syncService[_0x2b5c11(1146)]();
}, refreshSession = async () => {
  const _0x1b499d = _0x54a1b7;
  console[_0x1b499d(926)]("[main-auth] Attempting to refresh session...");
  const _0x1a68f1 = store[_0x1b499d(1043)](STORE_KEYS[_0x1b499d(684)]);
  if (!_0x1a68f1) return console[_0x1b499d(926)](_0x1b499d(791)), { "success": ![], "error": _0x1b499d(1304) };
  if (!mainWindow || mainWindow[_0x1b499d(496)]()) return console[_0x1b499d(926)]("[main-auth] Main window not available for token refresh"), { "success": !![], "session": { "access_token": _0x1a68f1 } };
  try {
    console[_0x1b499d(926)]("[main-auth] Requesting session refresh from renderer..."), mainWindow[_0x1b499d(890)][_0x1b499d(965)]("auth-refresh-requested"), await new Promise((_0x3cb031) => setTimeout(_0x3cb031, 1e3));
    const _0x2adc9b = store[_0x1b499d(1043)](STORE_KEYS[_0x1b499d(684)]);
    if (_0x2adc9b && _0x2adc9b !== _0x1a68f1) return console[_0x1b499d(926)]("[main-auth] Token refreshed successfully"), { "success": !![], "session": { "access_token": _0x2adc9b } };
    else return _0x2adc9b ? (console[_0x1b499d(926)]("[main-auth] Token still valid, using existing token"), { "success": !![], "session": { "access_token": _0x2adc9b } }) : (console[_0x1b499d(926)]("[main-auth] Token refresh failed"), { "success": ![], "error": "Token refresh failed" });
  } catch (_0x195f8c) {
    return console[_0x1b499d(981)](" [main-auth] Error during token refresh:", _0x195f8c), { "success": ![], "error": _0x195f8c instanceof Error ? _0x195f8c[_0x1b499d(1486)] : "Unknown error" };
  }
};
class AppIconCache {
  [_0x54a1b7(1298)];
  constructor() {
    const _0x1ce445 = _0x54a1b7;
    this[_0x1ce445(1298)] = /* @__PURE__ */ new Map();
  }
  [_0x54a1b7(1043)](_0x207f15) {
    const _0x525701 = _0x54a1b7;
    return this[_0x525701(1298)][_0x525701(1043)](_0x207f15);
  }
  [_0x54a1b7(1359)](_0x10c180, _0x2aa90d) {
    const _0x4e6d0b = _0x54a1b7;
    this[_0x4e6d0b(1298)][_0x4e6d0b(1359)](_0x10c180, _0x2aa90d);
  }
  [_0x54a1b7(1764)](_0x49b226) {
    const _0x4dff45 = _0x54a1b7;
    return this[_0x4dff45(1298)][_0x4dff45(1764)](_0x49b226);
  }
  [_0x54a1b7(1723)]() {
    const _0x4c1676 = _0x54a1b7;
    this[_0x4c1676(1298)][_0x4c1676(1723)]();
  }
  [_0x54a1b7(946)](_0x5ce463) {
    const _0x2a47c8 = _0x54a1b7;
    this[_0x2a47c8(1298)][_0x2a47c8(506)](_0x5ce463);
  }
  [_0x54a1b7(1378)]() {
    const _0x41e5e2 = _0x54a1b7;
    return this[_0x41e5e2(1298)][_0x41e5e2(1378)];
  }
}
const appIconCache = new AppIconCache(), appIconCache$1 = Object[_0x54a1b7(502)](Object[_0x54a1b7(634)]({ "__proto__": null, "appIconCache": appIconCache }, Symbol[_0x54a1b7(1177)], { "value": _0x54a1b7(1416) }));
function getHostnameFromUrl(_0x1d8e1c) {
  const _0x4b688d = _0x54a1b7;
  if (!_0x1d8e1c) return null;
  try {
    const _0x2c47a8 = new URL(_0x1d8e1c)[_0x4b688d(590)], _0x4779b5 = psl[_0x4b688d(675)](_0x2c47a8);
    if (_0x4779b5[_0x4b688d(981)]) return _0x2c47a8;
    return _0x4779b5[_0x4b688d(581)] || _0x2c47a8;
  } catch {
    return null;
  }
}
function applyJapaneseHomophoneCorrections(_0x57e718) {
  const _0x46d26c = _0x54a1b7;
  return _0x57e718[_0x46d26c(1541)](//g, "");
}
function countWords(_0x41cbda) {
  const _0x1e9f82 = _0x54a1b7;
  if (!_0x41cbda || _0x41cbda[_0x1e9f82(1699)]()[_0x1e9f82(1115)] === 0) return 0;
  const _0x1e8e6d = _0x41cbda[_0x1e9f82(1699)]()[_0x1e9f82(1163)](/\s+/)[_0x1e9f82(1380)]((_0x406355) => _0x406355[_0x1e9f82(1115)] > 0);
  return _0x1e8e6d[_0x1e9f82(1115)];
}
const nativeModuleName$4 = _0x54a1b7(1001);
let monitorProcess = null, monitorSubscribers = [], lastExternalActiveWindow = null;
const VOICEOS_APP_NAMES = [_0x54a1b7(476), "Electron"];
let currentWindowIsVoiceOS = ![];
function transformActiveWindow(_0x2dcbe5) {
  const _0x1bb413 = _0x54a1b7, _0x5fc8b0 = getHostnameFromUrl(_0x2dcbe5[_0x1bb413(503)]);
  if (_0x5fc8b0) return { ..._0x2dcbe5, "appName": _0x5fc8b0 };
  return _0x2dcbe5;
}
function startAppMonitor(_0x5ef6bf) {
  const _0x38fc44 = _0x54a1b7;
  monitorSubscribers[_0x38fc44(529)](_0x5ef6bf);
  if (!monitorProcess) {
    const _0xc0d093 = getNativeBinaryPath(nativeModuleName$4);
    if (!_0xc0d093) {
      log[_0x38fc44(981)](_0x38fc44(171) + nativeModuleName$4 + _0x38fc44(920));
      return;
    }
    log[_0x38fc44(1341)](_0x38fc44(1e3) + _0xc0d093);
    try {
      monitorProcess = child_process[_0x38fc44(1424)](_0xc0d093, ["monitor"]);
    } catch (_0xeefb68) {
      log[_0x38fc44(981)](_0x38fc44(132), _0xeefb68), monitorProcess = null;
      return;
    }
    monitorProcess["on"]("error", (_0x5f09b8) => {
      const _0x342d88 = _0x38fc44;
      log[_0x342d88(981)](_0x342d88(1712), _0x5f09b8), monitorProcess = null;
    }), monitorProcess[_0x38fc44(1532)]["on"]("data", (_0x33693a) => {
      const _0x4495ca = _0x38fc44, _0x297cd4 = _0x33693a[_0x4495ca(1450)]()[_0x4495ca(1163)]("\n");
      for (const _0xb899ce of _0x297cd4) {
        if (!_0xb899ce[_0x4495ca(1699)]()) continue;
        try {
          const _0x3d58be = JSON[_0x4495ca(675)](_0xb899ce);
          if (_0x3d58be[_0x4495ca(852)] && _0x3d58be[_0x4495ca(1856)]) appIconCache[_0x4495ca(1359)](_0x3d58be[_0x4495ca(1856)], _0x3d58be[_0x4495ca(852)]);
          else _0x3d58be[_0x4495ca(1856)] && !appIconCache[_0x4495ca(1764)](_0x3d58be[_0x4495ca(1856)]) && appIconCache[_0x4495ca(1359)](_0x3d58be[_0x4495ca(1856)], null);
          const _0x36eb7e = transformActiveWindow(_0x3d58be);
          process[_0x4495ca(1532)][_0x4495ca(1020)](_0x4495ca(891) + _0x36eb7e[_0x4495ca(1856)] + _0x4495ca(1665) + _0x36eb7e[_0x4495ca(789)] + ")\n"), _0x3d58be[_0x4495ca(1856)] && !VOICEOS_APP_NAMES[_0x4495ca(1580)](_0x3d58be[_0x4495ca(1856)]) ? (lastExternalActiveWindow = _0x36eb7e, currentWindowIsVoiceOS = ![], process[_0x4495ca(1532)][_0x4495ca(1020)](_0x4495ca(274))) : (currentWindowIsVoiceOS = !![], process[_0x4495ca(1532)][_0x4495ca(1020)](_0x4495ca(1147))), monitorSubscribers[_0x4495ca(878)]((_0x165815) => _0x165815(_0x36eb7e));
        } catch (_0x28c6c2) {
          log[_0x4495ca(981)]("Error parsing app monitor output:", _0x28c6c2);
        }
      }
    }), monitorProcess[_0x38fc44(595)]["on"]("data", (_0x17b463) => {
      const _0x1be664 = _0x38fc44;
      log[_0x1be664(981)]("App monitor stderr:", _0x17b463[_0x1be664(1450)]());
    }), monitorProcess["on"]("exit", (_0x2a6a2a) => {
      const _0x4e444e = _0x38fc44;
      log[_0x4e444e(1697)](_0x4e444e(586) + _0x2a6a2a), monitorProcess = null;
    });
  }
}
async function getActiveWindow() {
  const _0x4aa1c0 = _0x54a1b7, _0x272269 = getNativeBinaryPath(nativeModuleName$4);
  if (!_0x272269) return console[_0x4aa1c0(981)](_0x4aa1c0(1733) + nativeModuleName$4 + _0x4aa1c0(920)), null;
  const _0x277be1 = await new Promise((_0xd31221) => {
    const _0x322510 = _0x4aa1c0;
    child_process[_0x322510(770)](_0x272269, { "maxBuffer": 10 * 1024 * 1024 }, (_0x1d89d1, _0x21c4eb, _0x544b6a) => {
      const _0x101a4a = _0x322510;
      if (_0x1d89d1) return console[_0x101a4a(981)](_0x101a4a(950) + nativeModuleName$4 + _0x101a4a(892), _0x1d89d1, _0x544b6a), _0xd31221(_0x101a4a(1431));
      return _0xd31221(_0x21c4eb[_0x101a4a(1699)]());
    });
  });
  if (_0x277be1 && _0x277be1 !== _0x4aa1c0(1431)) try {
    const _0x42d043 = JSON[_0x4aa1c0(675)](_0x277be1);
    if (_0x42d043[_0x4aa1c0(852)] && _0x42d043[_0x4aa1c0(1856)]) appIconCache[_0x4aa1c0(1359)](_0x42d043[_0x4aa1c0(1856)], _0x42d043[_0x4aa1c0(852)]);
    else _0x42d043[_0x4aa1c0(1856)] && !appIconCache[_0x4aa1c0(1764)](_0x42d043[_0x4aa1c0(1856)]) && appIconCache[_0x4aa1c0(1359)](_0x42d043[_0x4aa1c0(1856)], null);
    return transformActiveWindow(_0x42d043);
  } catch (_0x2a363a) {
    return log[_0x4aa1c0(981)](_0x4aa1c0(1398), _0x2a363a, _0x4aa1c0(262), _0x277be1), null;
  }
  else return null;
}
function getCachedAppIcon(_0x693660) {
  const _0x16f356 = _0x54a1b7, _0x306d34 = appIconCache[_0x16f356(1043)](_0x693660);
  return _0x306d34 ?? null;
}
function getLastExternalActiveWindow() {
  const _0x2fd050 = _0x54a1b7;
  return process[_0x2fd050(1532)][_0x2fd050(1020)](_0x2fd050(703) + (lastExternalActiveWindow?.[_0x2fd050(1856)] ?? _0x2fd050(1431)) + _0x2fd050(1665) + (lastExternalActiveWindow?.[_0x2fd050(789)] ?? _0x2fd050(897)) + ")\n"), lastExternalActiveWindow;
}
function isCurrentWindowVoiceOS() {
  return currentWindowIsVoiceOS;
}
const activeApplication = Object[_0x54a1b7(502)](Object[_0x54a1b7(634)]({ "__proto__": null, "getActiveWindow": getActiveWindow, "getCachedAppIcon": getCachedAppIcon, "getLastExternalActiveWindow": getLastExternalActiveWindow, "isCurrentWindowVoiceOS": isCurrentWindowVoiceOS, "startAppMonitor": startAppMonitor }, Symbol[_0x54a1b7(1177)], { "value": _0x54a1b7(1416) }));
class GrpcClient {
  [_0x54a1b7(762)];
  [_0x54a1b7(446)] = null;
  [_0x54a1b7(280)] = null;
  [_0x54a1b7(1709)] = ![];
  [_0x54a1b7(1258)] = null;
  [_0x54a1b7(696)] = null;
  [_0x54a1b7(530)] = null;
  [_0x54a1b7(493)] = null;
  [_0x54a1b7(1211)] = null;
  [_0x54a1b7(543)] = null;
  [_0x54a1b7(507)] = [];
  [_0x54a1b7(1538)] = [];
  constructor() {
    const _0x29646c = _0x54a1b7, _0x110434 = connectNode[_0x29646c(1618)]({ "baseUrl": "https://api.voiceos.com", "httpVersion": _0x29646c(1500) });
    this[_0x29646c(762)] = connect[_0x29646c(1739)](VoiceOSService, _0x110434);
  }
  [_0x54a1b7(1706)](_0x42e0eb) {
    const _0x5e85ec = _0x54a1b7;
    this[_0x5e85ec(280)] = _0x42e0eb;
  }
  [_0x54a1b7(707)](_0x597282, ..._0x5b735a) {
    const _0x84d41a = _0x54a1b7;
    if (this[_0x84d41a(280)] && !this[_0x84d41a(280)][_0x84d41a(496)]() && !this[_0x84d41a(280)][_0x84d41a(890)][_0x84d41a(496)]()) try {
      this[_0x84d41a(280)][_0x84d41a(890)][_0x84d41a(965)](_0x597282, ..._0x5b735a);
    } catch (_0x1dff7e) {
      console[_0x84d41a(1697)](_0x84d41a(482) + _0x597282 + ":", _0x1dff7e), this[_0x84d41a(280)] = null;
    }
  }
  [_0x54a1b7(1843)](_0x1023cf) {
    const _0x4cff22 = _0x54a1b7;
    this[_0x4cff22(446)] = _0x1023cf;
  }
  [_0x54a1b7(1368)](_0x2b47e2) {
    const _0x51c4f4 = _0x54a1b7;
    this[_0x51c4f4(507)] = _0x2b47e2, console[_0x51c4f4(926)](_0x51c4f4(1357) + _0x2b47e2[_0x51c4f4(1115)] + _0x51c4f4(769));
  }
  [_0x54a1b7(384)]() {
    const _0x25de8b = _0x54a1b7;
    this[_0x25de8b(507)] = [], console[_0x25de8b(926)]("[gRPC Client] Knowledge items cleared");
  }
  [_0x54a1b7(995)](_0x5c7534) {
    const _0x458b38 = _0x54a1b7;
    this[_0x458b38(1538)] = _0x5c7534, console[_0x458b38(926)](_0x458b38(156) + _0x5c7534[_0x458b38(1115)] + _0x458b38(769));
  }
  [_0x54a1b7(726)]() {
    const _0x301cf7 = _0x54a1b7;
    this[_0x301cf7(1538)] = [], console[_0x301cf7(926)]("[gRPC Client] Custom instructions cleared");
  }
  [_0x54a1b7(1068)](_0x231aae) {
    const _0x2e7072 = _0x54a1b7, _0x5bab85 = this[_0x2e7072(1538)][_0x2e7072(445)]((_0x7902f4) => _0x7902f4[_0x2e7072(857)][_0x2e7072(1566)]() === _0x231aae[_0x2e7072(1566)]());
    return _0x5bab85?.[_0x2e7072(366)] || null;
  }
  [_0x54a1b7(1092)]() {
    const _0x1a2696 = _0x54a1b7;
    return this[_0x1a2696(1538)];
  }
  [_0x54a1b7(521)]() {
    const _0x54b70d = _0x54a1b7;
    if (!this[_0x54b70d(446)]) return new Headers();
    return new Headers({ "Authorization": _0x54b70d(1324) + this[_0x54b70d(446)] });
  }
  [_0x54a1b7(739)](_0x6687a8) {
    const _0xd0c689 = _0x54a1b7;
    return _0x6687a8[_0xd0c689(1541)](/[\u2013\u2014]/g, "-")[_0xd0c689(1541)](/[\u2018\u2019]/g, "'")[_0xd0c689(1541)](/[\u201C\u201D]/g, '"')[_0xd0c689(1541)](/[^\x00-\xFF]/g, "")[_0xd0c689(1699)]();
  }
  async [_0x54a1b7(1595)](_0x353f9e) {
    const _0x1b0e98 = _0x54a1b7, _0x4faf81 = this[_0x1b0e98(521)]();
    try {
      const _0x751baa = getCurrentUserId(), _0x1d7201 = await DictionaryTable[_0x1b0e98(440)](_0x751baa), _0x49b740 = _0x1d7201[_0x1b0e98(1380)]((_0x3f7198) => _0x3f7198[_0x1b0e98(1814)] === null), _0x372df7 = _0x49b740[_0x1b0e98(306)]((_0x2897b5) => _0x2897b5[_0x1b0e98(785)]);
      if (_0x372df7[_0x1b0e98(1115)] > 0) {
        const _0x446dd0 = _0x372df7[_0x1b0e98(1638)](","), _0x14ddbc = _0x1b0e98(1741) + Buffer[_0x1b0e98(1840)](_0x446dd0, _0x1b0e98(1250))[_0x1b0e98(1450)](_0x1b0e98(1799));
        _0x4faf81[_0x1b0e98(1359)]("vocabulary", _0x14ddbc);
      }
      if (_0x49b740[_0x1b0e98(1115)] > 0) {
        const _0x4b06bd = _0x49b740[_0x1b0e98(306)]((_0x25eb17) => ({ "text": _0x25eb17[_0x1b0e98(785)], "description": _0x25eb17[_0x1b0e98(705)] || null, "app_identifiers": _0x25eb17[_0x1b0e98(166)] || null })), _0x304e2d = JSON[_0x1b0e98(1516)](_0x4b06bd), _0xac4f1c = _0x1b0e98(1741) + Buffer[_0x1b0e98(1840)](_0x304e2d, _0x1b0e98(1250))[_0x1b0e98(1450)](_0x1b0e98(1799));
        _0x4faf81[_0x1b0e98(1359)]("dictionary-items", _0xac4f1c);
      }
      const _0x1c0c7d = (await import("electron-store"))[_0x1b0e98(450)], { STORE_KEYS: _0xb4e892 } = await Promise[_0x1b0e98(1786)]()[_0x1b0e98(843)](() => storeKeys), _0x43177f = new _0x1c0c7d(), _0x554014 = _0x43177f[_0x1b0e98(1043)](_0xb4e892[_0x1b0e98(193)]), _0x129d3a = _0x554014?.[_0x1b0e98(1032)] || ["en"], _0x25a82b = _0x554014?.[_0x1b0e98(1340)] || "en";
      _0x129d3a && _0x129d3a[_0x1b0e98(1115)] > 0 && (_0x4faf81[_0x1b0e98(1359)](_0x1b0e98(633), this[_0x1b0e98(739)](_0x129d3a[_0x1b0e98(1638)](","))), console[_0x1b0e98(926)](_0x1b0e98(252), _0x129d3a[_0x1b0e98(1638)](", ")));
      _0x4faf81[_0x1b0e98(1359)](_0x1b0e98(1547), this[_0x1b0e98(739)](_0x25a82b)), console[_0x1b0e98(926)](_0x1b0e98(1745), _0x25a82b);
      if (this[_0x1b0e98(1258)]) _0x4faf81[_0x1b0e98(1359)]("app-name", this[_0x1b0e98(739)](this[_0x1b0e98(1258)][_0x1b0e98(1856)])), this[_0x1b0e98(1258)][_0x1b0e98(688)] && _0x4faf81[_0x1b0e98(1359)]("window-title", this[_0x1b0e98(739)](this[_0x1b0e98(1258)][_0x1b0e98(688)])), console[_0x1b0e98(926)]("[gRPC Client] Using override app context:", this[_0x1b0e98(1258)]);
      else {
        const _0xfa3870 = await getActiveWindow();
        if (_0xfa3870) {
          const _0x5834bc = getHostnameFromUrl(_0xfa3870[_0x1b0e98(503)]), _0x5e9bce = _0x5834bc || _0xfa3870[_0x1b0e98(221)];
          _0x4faf81[_0x1b0e98(1359)]("window-title", this[_0x1b0e98(739)](_0x5e9bce)), _0x4faf81[_0x1b0e98(1359)]("app-name", this[_0x1b0e98(739)](_0xfa3870[_0x1b0e98(1856)])), _0xfa3870[_0x1b0e98(632)] && _0x4faf81[_0x1b0e98(1359)]("app-bundle-id", this[_0x1b0e98(739)](_0xfa3870[_0x1b0e98(632)])), _0xfa3870[_0x1b0e98(503)] && (_0x4faf81[_0x1b0e98(1359)]("window-url", this[_0x1b0e98(739)](_0xfa3870[_0x1b0e98(503)])), console[_0x1b0e98(926)]("[gRPC Client] Sending browser context - Title:", _0x5e9bce, _0x1b0e98(267), _0xfa3870[_0x1b0e98(503)]));
        }
      }
      try {
        let _0x39ae68 = this[_0x1b0e98(493)];
        !_0x39ae68 && (this[_0x1b0e98(1258)]?.[_0x1b0e98(518)] ? _0x39ae68 = this[_0x1b0e98(1258)][_0x1b0e98(518)] : _0x39ae68 = await getSelectedTextString(1e4));
        if (_0x39ae68 && _0x39ae68[_0x1b0e98(1699)]()[_0x1b0e98(1115)] > 0) {
          const _0xecf1df = 8e3;
          _0x39ae68[_0x1b0e98(1115)] > _0xecf1df && (_0x39ae68 = _0x39ae68[_0x1b0e98(350)](0, _0xecf1df) + "\n[... text truncated ...]", console[_0x1b0e98(926)](_0x1b0e98(1419) + _0x39ae68[_0x1b0e98(1115)] + _0x1b0e98(1036)));
          const _0x3349aa = _0x1b0e98(1741) + Buffer[_0x1b0e98(1840)](_0x39ae68, _0x1b0e98(1250))[_0x1b0e98(1450)](_0x1b0e98(1799));
          _0x4faf81[_0x1b0e98(1359)]("selected-text", _0x3349aa), console[_0x1b0e98(926)]("[gRPC Client] Adding selected text to headers:", _0x39ae68[_0x1b0e98(1115)], _0x1b0e98(1196), _0x39ae68);
        }
      } catch (_0x3b93da) {
        console[_0x1b0e98(981)](" [gRPC Client] Error getting selected text:", _0x3b93da);
      }
      if (this[_0x1b0e98(696)] && this[_0x1b0e98(696)][_0x1b0e98(1699)]()[_0x1b0e98(1115)] > 0) {
        const _0x33e9bf = 6e3;
        let _0x77b07 = this[_0x1b0e98(696)];
        if (_0x77b07[_0x1b0e98(1115)] > _0x33e9bf) {
          if (_0x77b07[_0x1b0e98(1580)](_0x1b0e98(1108))) {
            const _0x399170 = _0x77b07[_0x1b0e98(1257)](_0x1b0e98(1108)), _0x578620 = Math[_0x1b0e98(1507)](0, _0x399170 - 4e3), _0x470537 = Math[_0x1b0e98(1125)](_0x77b07[_0x1b0e98(1115)], _0x399170 + 2e3);
            _0x77b07 = _0x77b07[_0x1b0e98(350)](_0x578620, _0x470537), _0x578620 > 0 && (_0x77b07 = "[... earlier content truncated ...]\n" + _0x77b07);
          } else _0x77b07 = "[... earlier content truncated ...]\n" + _0x77b07[_0x1b0e98(350)](_0x77b07[_0x1b0e98(1115)] - _0x33e9bf);
          console[_0x1b0e98(926)](_0x1b0e98(1234) + this[_0x1b0e98(696)][_0x1b0e98(1115)] + _0x1b0e98(1194) + _0x77b07[_0x1b0e98(1115)] + _0x1b0e98(1036));
        }
        const _0x1e0331 = _0x1b0e98(1741) + Buffer[_0x1b0e98(1840)](_0x77b07, _0x1b0e98(1250))[_0x1b0e98(1450)](_0x1b0e98(1799));
        _0x4faf81[_0x1b0e98(1359)]("accessibility-text", _0x1e0331), console[_0x1b0e98(926)]("[gRPC Client] Adding accessibility text to headers:", _0x77b07[_0x1b0e98(1115)], _0x1b0e98(1196));
      }
      if (this[_0x1b0e98(530)] && this[_0x1b0e98(530)][_0x1b0e98(1699)]()[_0x1b0e98(1115)] > 0) {
        const _0xba30e8 = 6e3;
        let _0x355404 = this[_0x1b0e98(530)];
        _0x355404[_0x1b0e98(1115)] > _0xba30e8 && (_0x355404 = "[... earlier content truncated ...]\n" + _0x355404[_0x1b0e98(350)](_0x355404[_0x1b0e98(1115)] - _0xba30e8), console[_0x1b0e98(926)](_0x1b0e98(1629) + this[_0x1b0e98(530)][_0x1b0e98(1115)] + _0x1b0e98(1194) + _0x355404[_0x1b0e98(1115)] + _0x1b0e98(1036)));
        const _0x174f38 = _0x1b0e98(1741) + Buffer[_0x1b0e98(1840)](_0x355404, _0x1b0e98(1250))[_0x1b0e98(1450)](_0x1b0e98(1799));
        _0x4faf81[_0x1b0e98(1359)]("accessibility-tree", _0x174f38), console[_0x1b0e98(926)]("[gRPC Client] Adding accessibility tree to headers:", _0x355404[_0x1b0e98(1115)], _0x1b0e98(1196));
      }
      if (this[_0x1b0e98(1211)] && this[_0x1b0e98(1211)][_0x1b0e98(1699)]()[_0x1b0e98(1115)] > 0) {
        const _0x7af11b = _0x1b0e98(1741) + Buffer[_0x1b0e98(1840)](this[_0x1b0e98(1211)], _0x1b0e98(1250))[_0x1b0e98(1450)](_0x1b0e98(1799));
        _0x4faf81[_0x1b0e98(1359)]("cursor-text-before", _0x7af11b), console[_0x1b0e98(926)]("[gRPC Client] Adding cursor text before to headers:", this[_0x1b0e98(1211)][_0x1b0e98(1115)], _0x1b0e98(1196));
      }
      if (this[_0x1b0e98(543)] && this[_0x1b0e98(543)][_0x1b0e98(1699)]()[_0x1b0e98(1115)] > 0) {
        const _0x356b74 = _0x1b0e98(1741) + Buffer[_0x1b0e98(1840)](this[_0x1b0e98(543)], _0x1b0e98(1250))[_0x1b0e98(1450)](_0x1b0e98(1799));
        _0x4faf81[_0x1b0e98(1359)]("cursor-text-after", _0x356b74), console[_0x1b0e98(926)]("[gRPC Client] Adding cursor text after to headers:", this[_0x1b0e98(543)][_0x1b0e98(1115)], _0x1b0e98(1196));
      }
      if (this[_0x1b0e98(507)][_0x1b0e98(1115)] > 0) {
        const _0x9477e = JSON[_0x1b0e98(1516)](this[_0x1b0e98(507)]), _0x315017 = _0x1b0e98(1741) + Buffer[_0x1b0e98(1840)](_0x9477e, _0x1b0e98(1250))[_0x1b0e98(1450)](_0x1b0e98(1799));
        _0x4faf81[_0x1b0e98(1359)](_0x1b0e98(541), _0x315017), console[_0x1b0e98(926)](_0x1b0e98(158), this[_0x1b0e98(507)][_0x1b0e98(1115)], _0x1b0e98(1021));
      }
      if (this[_0x1b0e98(1538)][_0x1b0e98(1115)] > 0) {
        const _0x53c07d = JSON[_0x1b0e98(1516)](this[_0x1b0e98(1538)]), _0x258d8c = _0x1b0e98(1741) + Buffer[_0x1b0e98(1840)](_0x53c07d, _0x1b0e98(1250))[_0x1b0e98(1450)](_0x1b0e98(1799));
        _0x4faf81[_0x1b0e98(1359)]("custom-instructions", _0x258d8c), console[_0x1b0e98(926)]("[gRPC Client] Adding custom instructions to headers:", this[_0x1b0e98(1538)][_0x1b0e98(1115)], _0x1b0e98(1021));
      }
    } catch (_0x5af268) {
      console[_0x1b0e98(981)](" Failed to fetch vocabulary/settings for transcription:", _0x5af268);
    }
    return _0x4faf81;
  }
  async [_0x54a1b7(285)](_0x3e4697) {
    const _0x36adf7 = _0x54a1b7;
    try {
      return await _0x3e4697();
    } catch (_0x3c82f9) {
      const _0x471ee5 = await this[_0x36adf7(187)](_0x3c82f9);
      if (_0x471ee5) return console[_0x36adf7(926)]("Retrying operation after token refresh"), await _0x3e4697();
      throw _0x3c82f9;
    }
  }
  async [_0x54a1b7(187)](_0x452b7a) {
    const _0x347948 = _0x54a1b7;
    if (_0x452b7a instanceof connect[_0x347948(382)] && _0x452b7a[_0x347948(1303)] === connect[_0x347948(778)][_0x347948(1230)]) {
      console[_0x347948(926)]("Authentication error detected, attempting token refresh before logout");
      if (this[_0x347948(1709)]) return console[_0x347948(926)]("Token refresh already in progress, skipping"), ![];
      try {
        this[_0x347948(1709)] = !![];
        const _0xc1feb1 = await refreshSession();
        if (_0xc1feb1[_0x347948(522)] && _0xc1feb1[_0x347948(1254)]?.[_0x347948(1153)]) return console[_0x347948(926)]("Session refresh successful, updating auth token"), this[_0x347948(446)] = _0xc1feb1[_0x347948(1254)][_0x347948(1153)], !![];
        else console[_0x347948(926)]("Session refresh failed, proceeding with logout");
      } catch (_0x4e17df) {
        console[_0x347948(981)](" Error during token refresh:", _0x4e17df);
      } finally {
        this[_0x347948(1709)] = ![];
      }
      console[_0x347948(926)]("Signing out user due to authentication failure"), this[_0x347948(707)]("auth-token-expired"), this[_0x347948(446)] = null;
    }
    return ![];
  }
  async [_0x54a1b7(484)](_0x4bb1f8, _0x195edb) {
    const _0x26548f = _0x54a1b7;
    return this[_0x26548f(285)](async () => {
      const _0x4c2963 = _0x26548f, _0x316cfb = await this[_0x4c2963(1595)](_0x195edb), _0xf73648 = _0x195edb === VoiceOSMode[_0x4c2963(1607)] ? _0x4c2963(1607) : _0x195edb === VoiceOSMode[_0x4c2963(872)] ? _0x4c2963(872) : _0x4c2963(1647);
      console[_0x4c2963(926)]("[gRPC Client] Starting transcription stream with client data:", { "mode": _0xf73648, "modeValue": _0x195edb, "hasVocabulary": !!_0x316cfb[_0x4c2963(1043)]("vocabulary"), "vocabularyWordCount": _0x316cfb[_0x4c2963(1043)]("vocabulary")?.[_0x4c2963(1163)](",")[_0x4c2963(1115)] || 0, "hasSelectedText": !!_0x316cfb[_0x4c2963(1043)]("selected-text"), "appName": _0x316cfb[_0x4c2963(1043)]("app-name"), "windowTitle": _0x316cfb[_0x4c2963(1043)]("window-title"), "url": _0x316cfb[_0x4c2963(1043)]("window-url") });
      const _0x2fe6a7 = await this[_0x4c2963(762)][_0x4c2963(1793)](_0x4bb1f8, { "headers": _0x316cfb });
      return _0x2fe6a7;
    });
  }
  async [_0x54a1b7(1825)](_0x34d41b) {
    const _0x3616e0 = _0x54a1b7;
    return this[_0x3616e0(285)](async () => {
      const _0xca239c = _0x3616e0, _0x2b3d59 = protobuf[_0xca239c(1288)](CreateDictionaryItemRequestSchema, { "id": _0x34d41b["id"], "text": _0x34d41b[_0xca239c(785)] });
      return await this[_0xca239c(762)][_0xca239c(1825)](_0x2b3d59, { "headers": this[_0xca239c(521)]() });
    });
  }
  async [_0x54a1b7(216)](_0xe9ce76) {
    const _0x446b7b = _0x54a1b7;
    return this[_0x446b7b(285)](async () => {
      const _0xec9860 = _0x446b7b, _0xad7505 = protobuf[_0xec9860(1288)](UpdateDictionaryItemRequestSchema, { "id": _0xe9ce76["id"], "text": _0xe9ce76[_0xec9860(785)] });
      return await this[_0xec9860(762)][_0xec9860(216)](_0xad7505, { "headers": this[_0xec9860(521)]() });
    });
  }
  async [_0x54a1b7(1024)](_0x1cae34) {
    const _0x3c70ec = _0x54a1b7;
    return this[_0x3c70ec(285)](async () => {
      const _0x305357 = _0x3c70ec, _0xc904c = protobuf[_0x305357(1288)](DeleteDictionaryItemRequestSchema, { "id": _0x1cae34["id"] });
      return await this[_0x305357(762)][_0x305357(1024)](_0xc904c, { "headers": this[_0x305357(521)]() });
    });
  }
  async [_0x54a1b7(1252)](_0x364e49) {
    const _0x5a3a62 = _0x54a1b7;
    return this[_0x5a3a62(285)](async () => {
      const _0x2c9ff1 = _0x5a3a62, _0xdcf270 = protobuf[_0x2c9ff1(1288)](ListDictionaryItemsRequestSchema, { "sinceTimestamp": _0x364e49 ?? "" }), _0x19017e = await this[_0x2c9ff1(762)][_0x2c9ff1(1082)](_0xdcf270, { "headers": this[_0x2c9ff1(521)]() });
      return _0x19017e[_0x2c9ff1(1021)];
    });
  }
  async [_0x54a1b7(1659)](_0x191e1e) {
    const _0x36f84a = _0x54a1b7;
    return this[_0x36f84a(285)](async () => {
      const _0x186e28 = _0x36f84a;
      let _0x59514f;
      _0x191e1e[_0x186e28(662)] && _0x191e1e[_0x186e28(662)][_0x186e28(1115)] > 0 ? _0x59514f = new Uint8Array(_0x191e1e[_0x186e28(662)]) : _0x59514f = new Uint8Array();
      const _0x5ddd5b = protobuf[_0x186e28(1288)](CreateVoiceSessionRequestSchema, { "id": _0x191e1e["id"], "transcript": _0x191e1e[_0x186e28(1099)] ?? "", "generatedText": _0x191e1e[_0x186e28(1578)] ?? "", "appName": _0x191e1e[_0x186e28(861)] ?? "", "windowTitle": _0x191e1e[_0x186e28(927)] ?? "", "audioBlob": _0x59514f, "durationSeconds": _0x191e1e[_0x186e28(1330)] ?? 0, "sampleRate": _0x191e1e[_0x186e28(528)] ?? void 0, "mode": _0x191e1e[_0x186e28(1396)] ?? 0 });
      return console[_0x186e28(926)]("[gRPC Client] Sending voice session to server with audio size:", _0x5ddd5b[_0x186e28(710)][_0x186e28(1115)], "bytes, duration:", _0x5ddd5b[_0x186e28(664)], "seconds"), await this[_0x186e28(762)][_0x186e28(1659)](_0x5ddd5b, { "headers": this[_0x186e28(521)]() });
    });
  }
  async [_0x54a1b7(258)](_0x1f4f10) {
    const _0xa1065b = _0x54a1b7;
    return this[_0xa1065b(285)](async () => {
      const _0x18a25e = _0xa1065b, _0x446a4c = protobuf[_0x18a25e(1288)](ListVoiceSessionsRequestSchema, { "sinceTimestamp": _0x1f4f10 ?? "" }), _0x2c202c = await this[_0x18a25e(762)][_0x18a25e(617)](_0x446a4c, { "headers": this[_0x18a25e(521)]() });
      return _0x2c202c[_0x18a25e(860)];
    });
  }
  async [_0x54a1b7(181)](_0x18f050) {
    const _0x3fc994 = _0x54a1b7;
    return this[_0x3fc994(285)](async () => {
      const _0x393d6e = _0x3fc994, _0x3c4ae3 = protobuf[_0x393d6e(1288)](CreateAppIconRequestSchema, { "id": _0x18f050["id"], "appName": _0x18f050[_0x393d6e(861)], "iconBase64": _0x18f050[_0x393d6e(575)] });
      return await this[_0x393d6e(762)][_0x393d6e(181)](_0x3c4ae3, { "headers": this[_0x393d6e(521)]() });
    });
  }
  async [_0x54a1b7(1249)](_0xe968bf) {
    const _0x3d4535 = _0x54a1b7;
    return this[_0x3d4535(285)](async () => {
      const _0x11b6d1 = _0x3d4535, _0x2e949d = protobuf[_0x11b6d1(1288)](ListAppIconsRequestSchema, { "sinceTimestamp": _0xe968bf ?? "" }), _0x25fae8 = await this[_0x11b6d1(762)][_0x11b6d1(392)](_0x2e949d, { "headers": this[_0x11b6d1(521)]() });
      return _0x25fae8[_0x11b6d1(499)];
    });
  }
  async [_0x54a1b7(424)]() {
    const _0xf47ebc = _0x54a1b7;
    return this[_0xf47ebc(285)](async () => {
      const _0x23721d = _0xf47ebc, _0x27a7c0 = protobuf[_0x23721d(1288)](DeleteUserDataRequestSchema, {});
      return await this[_0x23721d(762)][_0x23721d(424)](_0x27a7c0, { "headers": this[_0x23721d(521)]() });
    });
  }
  async *[_0x54a1b7(689)](_0x2d5ab6, _0x306003) {
    const _0x46bb21 = _0x54a1b7, _0x82ee38 = 8e3;
    for (let _0x5d683b = 0; _0x5d683b < _0x2d5ab6[_0x46bb21(1115)]; _0x5d683b += _0x82ee38) {
      const _0x199309 = _0x2d5ab6[_0x46bb21(337)](_0x5d683b, Math[_0x46bb21(1125)](_0x5d683b + _0x82ee38, _0x2d5ab6[_0x46bb21(1115)]));
      yield protobuf[_0x46bb21(1288)](StreamMessageSchema, { "payload": { "case": _0x46bb21(1319), "value": protobuf[_0x46bb21(1288)](AudioChunkSchema, { "audioData": new Uint8Array(_0x199309) }) } });
    }
  }
  async [_0x54a1b7(1221)](_0x164827, _0x1d0a89, _0x1fd9d3 = VoiceOSMode[_0x54a1b7(124)]) {
    const _0xa9d794 = _0x54a1b7, _0x1d44c0 = this[_0xa9d794(689)](_0x164827, _0x1d0a89), _0x386ffb = await this[_0xa9d794(484)](_0x1d44c0, _0x1fd9d3);
    return _0x386ffb;
  }
  async [_0x54a1b7(589)](_0x229bc0, _0x284907) {
    const _0x30b482 = _0x54a1b7;
    console[_0x30b482(926)](_0x30b482(1827) + _0x284907 + '"'), console[_0x30b482(926)](_0x30b482(809) + _0x229bc0 + '"');
    try {
      const _0x5de4a7 = "https://api.voiceos.com", _0x4d18fe = await fetch(_0x5de4a7 + _0x30b482(1571), { "method": _0x30b482(1031), "headers": { "Content-Type": "application/json", "Authorization": _0x30b482(1324) + (this[_0x30b482(446)] || "") }, "body": JSON[_0x30b482(1516)]({ "selectedText": _0x229bc0, "voiceCommand": _0x284907 }) });
      if (!_0x4d18fe["ok"]) throw new Error(_0x30b482(1651) + _0x4d18fe[_0x30b482(174)] + " " + _0x4d18fe[_0x30b482(1465)]);
      const _0x3a5dd1 = await _0x4d18fe[_0x30b482(1360)]();
      return console[_0x30b482(926)](_0x30b482(763)), _0x3a5dd1[_0x30b482(1018)] || _0x229bc0;
    } catch (_0xb3385c) {
      return console[_0x30b482(981)](_0x30b482(947), _0xb3385c), console[_0x30b482(1697)](_0x30b482(1729)), _0x229bc0 + _0x30b482(1534) + _0x284907 + '"]';
    }
  }
  async [_0x54a1b7(848)]() {
    const _0x22d388 = _0x54a1b7;
    return this[_0x22d388(285)](async () => {
      const _0x4c2474 = _0x22d388, _0x391f9f = protobuf[_0x4c2474(1288)](GetSubscriptionStatusRequestSchema, {});
      return await this[_0x4c2474(762)][_0x4c2474(848)](_0x391f9f, { "headers": this[_0x4c2474(521)]() });
    });
  }
  async [_0x54a1b7(731)]() {
    const _0x5bbeac = _0x54a1b7;
    return this[_0x5bbeac(285)](async () => {
      const _0x1e9462 = _0x5bbeac, _0x96784c = protobuf[_0x1e9462(1288)](GetUsageStatsRequestSchema, {});
      return await this[_0x1e9462(762)][_0x1e9462(731)](_0x96784c, { "headers": this[_0x1e9462(521)]() });
    });
  }
  async [_0x54a1b7(1093)](_0x43ae56) {
    const _0xe012f = _0x54a1b7;
    return this[_0xe012f(285)](async () => {
      const _0x5b0ff0 = _0xe012f, _0x181d69 = protobuf[_0x5b0ff0(1288)](RecordVoiceSessionUsageRequestSchema, { "wordCount": 1, "transcript": _0x43ae56 || void 0 });
      return await this[_0x5b0ff0(762)][_0x5b0ff0(1093)](_0x181d69, { "headers": this[_0x5b0ff0(521)]() });
    });
  }
  [_0x54a1b7(1579)](_0x5eb490) {
    const _0x2b3ba6 = _0x54a1b7;
    this[_0x2b3ba6(1258)] = _0x5eb490, console[_0x2b3ba6(1341)]("[gRPC Client] Override app context set:", _0x5eb490);
  }
  [_0x54a1b7(1678)]() {
    const _0x252f2d = _0x54a1b7;
    return this[_0x252f2d(1258)];
  }
  [_0x54a1b7(342)]() {
    const _0x219588 = _0x54a1b7;
    this[_0x219588(1258)] = null, console[_0x219588(1341)]("[gRPC Client] Override app context cleared");
  }
  [_0x54a1b7(877)](_0x18e977) {
    const _0x5b0f53 = _0x54a1b7;
    this[_0x5b0f53(696)] = _0x18e977, _0x18e977 ? console[_0x5b0f53(1697)](_0x5b0f53(1407) + _0x18e977[_0x5b0f53(1115)] + _0x5b0f53(591)) : console[_0x5b0f53(1341)]("[gRPC Client] Accessibility text cleared");
  }
  [_0x54a1b7(356)]() {
    const _0x3a27b0 = _0x54a1b7;
    return this[_0x3a27b0(696)];
  }
  [_0x54a1b7(834)]() {
    const _0x23cd29 = _0x54a1b7;
    this[_0x23cd29(696)] = null, console[_0x23cd29(1341)]("[gRPC Client] Accessibility text cleared");
  }
  [_0x54a1b7(292)](_0x35cba7) {
    const _0x3a829a = _0x54a1b7;
    this[_0x3a829a(530)] = _0x35cba7, _0x35cba7 ? console[_0x3a829a(1697)](_0x3a829a(1531) + _0x35cba7[_0x3a829a(1115)] + _0x3a829a(591)) : console[_0x3a829a(1341)]("[gRPC Client] Accessibility tree cleared");
  }
  [_0x54a1b7(248)]() {
    const _0x6868e9 = _0x54a1b7;
    return this[_0x6868e9(530)];
  }
  [_0x54a1b7(659)]() {
    const _0x314a64 = _0x54a1b7;
    this[_0x314a64(530)] = null, console[_0x314a64(1341)]("[gRPC Client] Accessibility tree cleared");
  }
  [_0x54a1b7(1149)](_0x10dd16) {
    const _0x270c71 = _0x54a1b7;
    this[_0x270c71(493)] = _0x10dd16, _0x10dd16 ? console[_0x270c71(1341)](_0x270c71(1855) + _0x10dd16[_0x270c71(1115)] + _0x270c71(1036)) : console[_0x270c71(1341)]("[gRPC Client] Selected text cleared");
  }
  [_0x54a1b7(815)]() {
    const _0x11496e = _0x54a1b7;
    return this[_0x11496e(493)];
  }
  [_0x54a1b7(1609)]() {
    const _0x50a87b = _0x54a1b7;
    this[_0x50a87b(493)] = null, console[_0x50a87b(1341)]("[gRPC Client] Selected text cleared");
  }
  [_0x54a1b7(282)](_0x5b164c, _0x455d86) {
    const _0x3925ee = _0x54a1b7;
    this[_0x3925ee(1211)] = _0x5b164c, this[_0x3925ee(543)] = _0x455d86, _0x5b164c || _0x455d86 ? console[_0x3925ee(1341)](_0x3925ee(1487) + (_0x5b164c?.[_0x3925ee(1115)] || 0) + _0x3925ee(457) + (_0x455d86?.[_0x3925ee(1115)] || 0) + _0x3925ee(441)) : console[_0x3925ee(1341)]("[gRPC Client] Cursor context cleared");
  }
  [_0x54a1b7(1300)]() {
    const _0x57a334 = _0x54a1b7;
    return this[_0x57a334(1211)];
  }
  [_0x54a1b7(1167)]() {
    const _0x1e0601 = _0x54a1b7;
    return this[_0x1e0601(543)];
  }
  [_0x54a1b7(1236)]() {
    const _0x4bd2e3 = _0x54a1b7;
    this[_0x4bd2e3(1211)] = null, this[_0x4bd2e3(543)] = null, console[_0x4bd2e3(1341)]("[gRPC Client] Cursor context cleared");
  }
  async [_0x54a1b7(1455)](_0x302e4b) {
    const _0x3bfb3a = _0x54a1b7;
    return this[_0x3bfb3a(285)](async () => {
      const _0x4c4922 = _0x3bfb3a, _0x40104f = _0x302e4b[_0x4c4922(306)]((_0x574d1f) => protobuf[_0x4c4922(1288)](WordModificationSchema, { "before": _0x574d1f[_0x4c4922(725)], "after": _0x574d1f[_0x4c4922(1271)], "position": _0x574d1f[_0x4c4922(168)] })), _0x31201e = protobuf[_0x4c4922(1288)](AnalyzeKeywordSuggestionRequestSchema, { "modifications": _0x40104f }), _0x168702 = await this[_0x4c4922(762)][_0x4c4922(1455)](_0x31201e, { "headers": this[_0x4c4922(521)]() });
      return { "shouldAdd": _0x168702[_0x4c4922(310)], "keyword": _0x168702[_0x4c4922(682)] || null, "furigana": _0x168702[_0x4c4922(607)] || null, "reason": _0x168702[_0x4c4922(383)] };
    });
  }
  async [_0x54a1b7(239)](_0x1040d1) {
    const _0x511d20 = _0x54a1b7;
    return this[_0x511d20(285)](async () => {
      const _0x4be03c = _0x511d20, _0x554e14 = _0x1040d1[_0x4be03c(306)]((_0x18ba43) => protobuf[_0x4be03c(1288)](WordModificationSchema, { "before": _0x18ba43[_0x4be03c(725)], "after": _0x18ba43[_0x4be03c(1271)], "position": _0x18ba43[_0x4be03c(168)] })), _0x2d53c2 = protobuf[_0x4be03c(1288)](AnalyzeAbbreviationSuggestionRequestSchema, { "modifications": _0x554e14 }), _0x431cb3 = await this[_0x4be03c(762)][_0x4be03c(239)](_0x2d53c2, { "headers": this[_0x4be03c(521)]() });
      return { "shouldAdd": _0x431cb3[_0x4be03c(310)], "abbreviation": _0x431cb3[_0x4be03c(1560)] || null, "expansion": _0x431cb3[_0x4be03c(743)] || null, "type": _0x431cb3[_0x4be03c(1154)] || null, "reason": _0x431cb3[_0x4be03c(383)] };
    });
  }
  async [_0x54a1b7(1614)](_0x3a03d2) {
    const _0x5247b1 = _0x54a1b7;
    return this[_0x5247b1(285)](async () => {
      const _0x534a2f = _0x5247b1, _0x2c8ca2 = _0x3a03d2[_0x534a2f(1388)][_0x534a2f(306)]((_0x4e1635) => protobuf[_0x534a2f(1288)](ChatMessageSchema, { "role": _0x4e1635[_0x534a2f(744)], "content": _0x4e1635[_0x534a2f(1858)] })), _0x4c1528 = protobuf[_0x534a2f(1288)](ChatFollowUpRequestSchema, { "text": _0x3a03d2[_0x534a2f(785)], "conversationHistory": _0x2c8ca2, "ocrText": _0x3a03d2[_0x534a2f(1751)], "selectedText": _0x3a03d2[_0x534a2f(493)], "appName": _0x3a03d2[_0x534a2f(1856)], "windowTitle": _0x3a03d2[_0x534a2f(688)], "windowUrl": _0x3a03d2[_0x534a2f(648)], "accessibilityText": _0x3a03d2[_0x534a2f(696)], "vlmDescription": _0x3a03d2[_0x534a2f(1806)], "originalTranscript": _0x3a03d2[_0x534a2f(1672)] }), _0x217252 = await this[_0x534a2f(1595)](VoiceOSMode[_0x534a2f(1607)]), _0x46d96f = await this[_0x534a2f(762)][_0x534a2f(1614)](_0x4c1528, { "headers": _0x217252 });
      if (_0x46d96f[_0x534a2f(981)]) return { "text": "", "error": _0x46d96f[_0x534a2f(981)][_0x534a2f(1486)] || "Unknown error" };
      return { "text": _0x46d96f[_0x534a2f(785)] };
    });
  }
}
const grpcClient = new GrpcClient(), grpcClient$1 = Object[_0x54a1b7(502)](Object[_0x54a1b7(634)]({ "__proto__": null, "grpcClient": grpcClient }, Symbol[_0x54a1b7(1177)], { "value": _0x54a1b7(1416) }));
function getAccessibilityPermissionStatus() {
  const _0x111f1e = _0x54a1b7;
  if (process[_0x111f1e(1394)] === "darwin") {
    const _0x4c25de = electron[_0x111f1e(123)][_0x111f1e(733)](![]);
    return _0x4c25de ? _0x111f1e(808) : _0x111f1e(1818);
  }
  return _0x111f1e(808);
}
function checkAccessibilityPermission(_0x286a84 = ![]) {
  const _0x5e7c85 = _0x54a1b7;
  if (process[_0x5e7c85(1394)] === "darwin") {
    const _0x195690 = electron[_0x5e7c85(123)][_0x5e7c85(733)](![]);
    if (_0x286a84 && !_0x195690) return console[_0x5e7c85(926)]("Accessibility permission not granted, opening System Settings directly..."), openAccessibilitySettings(), ![];
    return _0x195690;
  }
  return !![];
}
async function openAccessibilitySettings() {
  const _0x4b8ef6 = _0x54a1b7;
  process[_0x4b8ef6(1394)] === "darwin" && await electron[_0x4b8ef6(298)][_0x4b8ef6(792)]("x-apple.systempreferences:com.apple.preference.security?Privacy_Accessibility");
}
async function triggerScreenCaptureForRegistration() {
  const _0x114c4f = _0x54a1b7;
  if (process[_0x114c4f(1394)] !== "darwin") return;
  try {
    console[_0x114c4f(926)](_0x114c4f(1232));
    const _0x7b97d6 = electron[_0x114c4f(451)][_0x114c4f(687)](), _0x26cad2 = electron[_0x114c4f(451)][_0x114c4f(1816)](_0x7b97d6);
    await electron[_0x114c4f(904)][_0x114c4f(571)]({ "types": [_0x114c4f(451)], "thumbnailSize": { "width": _0x26cad2[_0x114c4f(1378)][_0x114c4f(183)], "height": _0x26cad2[_0x114c4f(1378)][_0x114c4f(553)] } }), console[_0x114c4f(926)]("[ScreenRecording] Capture triggered - app should now appear in Screen Recording settings");
  } catch (_0x231b18) {
    console[_0x114c4f(926)]("[ScreenRecording] Capture attempt completed (may have been denied):", _0x231b18);
  }
}
function getMicrophonePermissionStatus() {
  const _0x59d3f0 = _0x54a1b7;
  if (process[_0x59d3f0(1394)] === "darwin") return electron[_0x59d3f0(123)][_0x59d3f0(462)]("microphone");
  return _0x59d3f0(808);
}
async function checkMicrophonePermission(_0x1a1ae6 = ![]) {
  const _0x30cb43 = _0x54a1b7;
  if (process[_0x30cb43(1394)] === "darwin") {
    const _0xf3914f = electron[_0x30cb43(123)][_0x30cb43(462)]("microphone");
    if (_0x1a1ae6) {
      if (_0xf3914f === _0x30cb43(1818)) return console[_0x30cb43(926)]("Microphone permission denied, opening System Settings..."), await electron[_0x30cb43(298)][_0x30cb43(792)]("x-apple.systempreferences:com.apple.preference.security?Privacy_Microphone"), ![];
      return electron[_0x30cb43(123)][_0x30cb43(1563)]("microphone");
    }
    return _0xf3914f === _0x30cb43(808);
  }
  return !![];
}
async function checkScreenRecordingPermission(_0x1519e5 = ![]) {
  const _0x2ed2b1 = _0x54a1b7;
  if (process[_0x2ed2b1(1394)] === "darwin") {
    const _0x1f0fad = electron[_0x2ed2b1(123)][_0x2ed2b1(462)](_0x2ed2b1(451));
    if (_0x1519e5) {
      if (_0x1f0fad === _0x2ed2b1(1818) || _0x1f0fad === _0x2ed2b1(619)) return console[_0x2ed2b1(926)](_0x2ed2b1(1311) + _0x1f0fad), await triggerScreenCaptureForRegistration(), console[_0x2ed2b1(926)]("Opening System Settings for Screen Recording..."), await electron[_0x2ed2b1(298)][_0x2ed2b1(792)]("x-apple.systempreferences:com.apple.preference.security?Privacy_ScreenCapture"), ![];
    }
    return _0x1f0fad === _0x2ed2b1(808);
  }
  return !![];
}
const crossPlatform = Object[_0x54a1b7(502)](Object[_0x54a1b7(634)]({ "__proto__": null, "checkAccessibilityPermission": checkAccessibilityPermission, "checkMicrophonePermission": checkMicrophonePermission, "checkScreenRecordingPermission": checkScreenRecordingPermission, "getAccessibilityPermissionStatus": getAccessibilityPermissionStatus, "getMicrophonePermissionStatus": getMicrophonePermissionStatus, "openAccessibilitySettings": openAccessibilitySettings, "triggerScreenCaptureForRegistration": triggerScreenCaptureForRegistration }, Symbol[_0x54a1b7(1177)], { "value": _0x54a1b7(1416) })), IPC_EVENTS = { "RECORDING_STATE_UPDATE": "recording-state-update", "VOLUME_UPDATE": "volume-update", "FORCE_DEVICE_LIST_RELOAD": "force-device-list-reload", "SETTINGS_UPDATE": "settings-update", "ONBOARDING_UPDATE": "onboarding-update", "USER_AUTH_UPDATE": "user-auth-update", "TRANSCRIPTION_PROCESSING": "transcription-processing", "ACTIVE_APP_UPDATE": "active-app-update", "TRANSCRIPTION_ERROR": "transcription-error", "NO_TEXT_FIELD_WARNING": "no-text-field-warning", "SECURITY_WARNING": "security-warning", "SECURITY_BAN": "security-ban", "UPDATE_READY_FOR_PILL": "update-ready-for-pill", "KEYWORD_AUTO_ADDED": "keyword-auto-added", "DICTIONARY_CHANGED": "dictionary-changed", "HANDS_FREE_HINT": _0x54a1b7(1755), "SHOW_OUTPUT_TEXT": "show-output-text", "CHAT_FOLLOW_UP_RESPONSE": "chat-follow-up-response", "CHAT_FOLLOW_UP_PROCESSING": _0x54a1b7(233), "VOICE_FOLLOW_UP_USER_MESSAGE": "voice-follow-up-user-message", "OUTPUT_TEXT_ENTER_PASTE": "output-text-enter-paste", "OUTPUT_TEXT_ESCAPE_DISMISS": "output-text-escape-dismiss", "ONBOARDING_BLOCKED": "onboarding-blocked" }, ipc = Object[_0x54a1b7(502)](Object[_0x54a1b7(634)]({ "__proto__": null, "IPC_EVENTS": IPC_EVENTS }, Symbol[_0x54a1b7(1177)], { "value": _0x54a1b7(1416) }));
let updateStatus = { "updateAvailable": ![], "updateDownloaded": ![] };
function getUpdateStatus() {
  return { ...updateStatus };
}
function notifyPillIfUpdateReady() {
  const _0x435c00 = _0x54a1b7;
  if (updateStatus[_0x435c00(1223)]) {
    const _0xd06e2c = getPillWindow();
    _0xd06e2c && !_0xd06e2c[_0x435c00(496)]() && _0xd06e2c[_0x435c00(890)][_0x435c00(965)](IPC_EVENTS[_0x435c00(1742)]);
  }
}
function initializeAutoUpdater() {
  const _0x55e116 = _0x54a1b7;
  updateStatus = { "updateAvailable": ![], "updateDownloaded": ![] };
  const _0x4cb1ce = void 0 === _0x55e116(1034);
  if (electron[_0x55e116(178)][_0x55e116(1664)] || _0x4cb1ce) try {
    console[_0x55e116(926)](electron[_0x55e116(178)][_0x55e116(1664)] ? "App is packaged, initializing auto updater..." : "Development auto-updater enabled, initializing...");
    const _0x59438a = "voiceos-staging-releases";
    if (!_0x59438a) ;
    !electron[_0x55e116(178)][_0x55e116(1664)] && (electronUpdater[_0x55e116(1102)][_0x55e116(410)] = !![]), electronUpdater[_0x55e116(1102)][_0x55e116(1765)]({ "provider": "s3", "bucket": _0x59438a, "path": "releases/", "region": "us-east-1" }), electronUpdater[_0x55e116(1102)][_0x55e116(1317)] = !![], setupAutoUpdaterEvents(), electronUpdater[_0x55e116(1102)][_0x55e116(1105)](), setInterval(() => {
      const _0x3300a1 = _0x55e116;
      electronUpdater[_0x3300a1(1102)][_0x3300a1(1105)]();
    }, 10 * 60 * 1e3);
  } catch (_0x57aaa8) {
    console[_0x55e116(981)](" Failed to check for auto updates:", _0x57aaa8);
  }
}
function setupAutoUpdaterEvents() {
  const _0x10c73f = _0x54a1b7;
  electronUpdater[_0x10c73f(1102)]["on"]("update-available", () => {
    const _0x2912d4 = _0x10c73f;
    updateStatus[_0x2912d4(1219)] = !![], mainWindow && !mainWindow[_0x2912d4(496)]() && !mainWindow[_0x2912d4(890)][_0x2912d4(496)]() && mainWindow[_0x2912d4(890)][_0x2912d4(965)]("update-available");
  }), electronUpdater[_0x10c73f(1102)]["on"]("update-downloaded", () => {
    const _0x5784aa = _0x10c73f;
    console[_0x5784aa(926)]("update downloaded successfully"), updateStatus[_0x5784aa(1223)] = !![], mainWindow && !mainWindow[_0x5784aa(496)]() && !mainWindow[_0x5784aa(890)][_0x5784aa(496)]() && mainWindow[_0x5784aa(890)][_0x5784aa(965)]("update-downloaded");
  }), electronUpdater[_0x10c73f(1102)]["on"]("error", (_0x402ea4) => {
    const _0x2dc28a = _0x10c73f;
    console[_0x2dc28a(981)](" Auto updater error:", _0x402ea4), updateStatus[_0x2dc28a(1219)] = ![], updateStatus[_0x2dc28a(1223)] = ![], mainWindow && !mainWindow[_0x2dc28a(496)]() && !mainWindow[_0x2dc28a(890)][_0x2dc28a(496)]() && mainWindow[_0x2dc28a(890)][_0x2dc28a(965)]("update-error", _0x402ea4[_0x2dc28a(1486)] || String(_0x402ea4));
  }), electronUpdater[_0x10c73f(1102)]["on"]("download-progress", (_0x37f49c) => {
    const _0x2064aa = _0x10c73f, _0x52fcf3 = _0x2064aa(925) + _0x37f49c[_0x2064aa(1467)] + _0x2064aa(967) + _0x37f49c[_0x2064aa(1426)][_0x2064aa(608)](2) + _0x2064aa(1771) + _0x37f49c[_0x2064aa(912)] + "/" + _0x37f49c[_0x2064aa(1182)] + ")";
    console[_0x2064aa(926)](_0x52fcf3);
  });
}
const generateId = (_0xca1b60) => {
  const _0x57ae31 = _0x54a1b7, _0x3b11eb = _0x57ae31(1383);
  let _0x39f615 = "";
  for (let _0x1537f7 = 0; _0x1537f7 < _0xca1b60; _0x1537f7++) {
    _0x39f615 += _0x3b11eb[Math[_0x57ae31(1225)](Math[_0x57ae31(125)]() * _0x3b11eb[_0x57ae31(1115)])];
  }
  return _0x39f615;
}, SpanStatusCode = { "OK": 0, "ERROR": 1 };
class SimpleSpan {
  [_0x54a1b7(1135)];
  constructor(_0x3b6099, _0x48a33) {
    const _0x5930c7 = _0x54a1b7;
    this[_0x5930c7(1135)] = { "name": _0x3b6099, "traceId": generateId(32), "spanId": generateId(16), "startTime": Date[_0x5930c7(1536)](), "attributes": _0x48a33 || {}, "events": [], "status": { "code": SpanStatusCode["OK"] } };
  }
  [_0x54a1b7(1033)](_0x436ce0, _0x4d1145) {
    const _0x4dc06f = _0x54a1b7;
    this[_0x4dc06f(1135)][_0x4dc06f(784)][_0x4dc06f(529)]({ "name": _0x436ce0, "timestamp": Date[_0x4dc06f(1536)](), "attributes": _0x4d1145 });
  }
  [_0x54a1b7(1787)](_0x5e10f1, _0x29a4b8) {
    const _0x28ded0 = _0x54a1b7;
    this[_0x28ded0(1135)][_0x28ded0(1488)][_0x5e10f1] = _0x29a4b8;
  }
  [_0x54a1b7(1086)](_0x5310c1) {
    const _0x4d9673 = _0x54a1b7;
    this[_0x4d9673(1135)][_0x4d9673(174)] = _0x5310c1;
  }
  [_0x54a1b7(299)](_0x15e666) {
    const _0x191d58 = _0x54a1b7;
    this[_0x191d58(1135)][_0x191d58(1488)]["exception.message"] = _0x15e666[_0x191d58(1486)], this[_0x191d58(1135)][_0x191d58(1488)]["exception.type"] = _0x15e666[_0x191d58(1276)];
  }
  [_0x54a1b7(1071)]() {
    const _0x15155c = _0x54a1b7;
    this[_0x15155c(1135)][_0x15155c(1506)] = Date[_0x15155c(1536)](), console[_0x15155c(926)](_0x15155c(546), { "name": this[_0x15155c(1135)][_0x15155c(1276)], "traceId": this[_0x15155c(1135)][_0x15155c(1848)], "spanId": this[_0x15155c(1135)][_0x15155c(1493)], "duration": this[_0x15155c(1135)][_0x15155c(1506)] - this[_0x15155c(1135)][_0x15155c(550)], "attributes": this[_0x15155c(1135)][_0x15155c(1488)], "events": this[_0x15155c(1135)][_0x15155c(784)], "status": this[_0x15155c(1135)][_0x15155c(174)] });
  }
}
class TraceLogger {
  [_0x54a1b7(414)] = /* @__PURE__ */ new Map();
  [_0x54a1b7(1347)](_0x25ba93, _0x3827a1) {
    const _0xb66907 = _0x54a1b7, _0x1e9adb = crypto[_0xb66907(339)](), _0x642cfd = Date[_0xb66907(1536)](), _0x3dff42 = new SimpleSpan(_0x25ba93, { "interaction.id": _0x1e9adb, "interaction.start_time": _0x642cfd, ..._0x3827a1 });
    return this[_0xb66907(414)][_0xb66907(1359)](_0x1e9adb, _0x3dff42), _0x3dff42[_0xb66907(1033)](_0xb66907(566) + _0x25ba93, { "interactionId": _0x1e9adb, "step": _0x25ba93, "timestamp": _0x642cfd, ..._0x3827a1 ? { ..._0x3827a1 } : {} }), _0x1e9adb;
  }
  [_0x54a1b7(1118)](_0x2ec8cf, _0x1c1547, _0x270ed6) {
    const _0x38ee32 = _0x54a1b7, _0x590e54 = this[_0x38ee32(414)][_0x38ee32(1043)](_0x2ec8cf);
    if (!_0x590e54) {
      console[_0x38ee32(1697)](_0x38ee32(1722) + _0x2ec8cf);
      return;
    }
    const _0x4eaafa = Date[_0x38ee32(1536)]();
    _0x590e54[_0x38ee32(1033)](_0x38ee32(1746) + _0x1c1547, { "step": _0x1c1547, "timestamp": _0x4eaafa, ..._0x270ed6 ? { ..._0x270ed6 } : {} }), _0x270ed6 && Object[_0x38ee32(1451)](_0x270ed6)[_0x38ee32(878)](([_0x39c9fe, _0x386ab0]) => {
      const _0x2f2fe8 = _0x38ee32;
      _0x590e54[_0x2f2fe8(1787)](_0x2f2fe8(1321) + _0x39c9fe, String(_0x386ab0));
    });
  }
  [_0x54a1b7(692)](_0x412cf4, _0x34cc61, _0x5ed766, _0x49ed94) {
    const _0x1cfc9a = _0x54a1b7, _0x4e38ad = this[_0x1cfc9a(414)][_0x1cfc9a(1043)](_0x412cf4);
    if (!_0x4e38ad) {
      console[_0x1cfc9a(1697)](_0x1cfc9a(935) + _0x412cf4);
      return;
    }
    const _0x67b477 = Date[_0x1cfc9a(1536)]();
    _0x4e38ad[_0x1cfc9a(1033)](_0x1cfc9a(360) + _0x34cc61, { "step": _0x34cc61, "timestamp": _0x67b477, ..._0x5ed766 ? { ..._0x5ed766 } : {}, ..._0x49ed94 ? { "error": _0x49ed94 } : {} }), _0x5ed766 && Object[_0x1cfc9a(1451)](_0x5ed766)[_0x1cfc9a(878)](([_0x26e0ae, _0x37a682]) => {
      const _0xa4a1f9 = _0x1cfc9a;
      _0x4e38ad[_0xa4a1f9(1787)](_0xa4a1f9(504) + _0x26e0ae, String(_0x37a682));
    }), _0x49ed94 ? (_0x4e38ad[_0x1cfc9a(1086)]({ "code": SpanStatusCode[_0x1cfc9a(1117)], "message": _0x49ed94 }), _0x4e38ad[_0x1cfc9a(299)](new Error(_0x49ed94))) : _0x4e38ad[_0x1cfc9a(1086)]({ "code": SpanStatusCode["OK"] }), _0x4e38ad[_0x1cfc9a(1071)](), this[_0x1cfc9a(414)][_0x1cfc9a(506)](_0x412cf4);
  }
  [_0x54a1b7(730)](_0x192e27, _0x4234b9, _0x9e6aeb, _0xad6398) {
    const _0x7bd950 = _0x54a1b7, _0x135deb = this[_0x7bd950(414)][_0x7bd950(1043)](_0x192e27);
    if (!_0x135deb) {
      console[_0x7bd950(1697)](_0x7bd950(276) + _0x192e27);
      return;
    }
    const _0x5a101f = Date[_0x7bd950(1536)]();
    _0x135deb[_0x7bd950(1033)](_0x7bd950(985) + _0x4234b9, { "step": _0x4234b9, "timestamp": _0x5a101f, "error": _0x9e6aeb, ..._0xad6398 ? { ..._0xad6398 } : {} }), _0x135deb[_0x7bd950(299)](new Error(_0x9e6aeb)), _0x135deb[_0x7bd950(1086)]({ "code": SpanStatusCode[_0x7bd950(1117)], "message": _0x9e6aeb }), _0xad6398 && Object[_0x7bd950(1451)](_0xad6398)[_0x7bd950(878)](([_0x41f7a5, _0x31a84f]) => {
      const _0x2f23ce = _0x7bd950;
      _0x135deb[_0x2f23ce(1787)](_0x2f23ce(336) + _0x41f7a5, String(_0x31a84f));
    });
  }
  [_0x54a1b7(750)]() {
    const _0x3d5747 = _0x54a1b7;
    return this[_0x3d5747(414)][_0x3d5747(1378)];
  }
  [_0x54a1b7(237)]() {
    const _0x51b7fc = _0x54a1b7;
    this[_0x51b7fc(414)][_0x51b7fc(878)]((_0x4e4908, _0x203b5c) => {
      const _0x1e011f = _0x51b7fc;
      console[_0x1e011f(1697)](_0x1e011f(222) + _0x203b5c), _0x4e4908[_0x1e011f(1071)]();
    }), this[_0x51b7fc(414)][_0x51b7fc(1723)]();
  }
}
const traceLogger = new TraceLogger();
process["on"](_0x54a1b7(461), () => {
  const _0x32f81b = _0x54a1b7;
  traceLogger[_0x32f81b(237)]();
}), process["on"](_0x54a1b7(523), () => {
  const _0x5c7c55 = _0x54a1b7;
  traceLogger[_0x5c7c55(237)]();
});
const MSG_TYPE_JSON = 1, MSG_TYPE_AUDIO = 2;
class AudioRecorderService extends events[_0x54a1b7(281)] {
  #audioRecorderProcess = null;
  #audioBuffer = Buffer[_0x54a1b7(1320)](0);
  #deviceListWaiters = [];
  #firstAudioChunkReceived = ![];
  constructor() {
    super();
  }
  [_0x54a1b7(1247)]() {
    const _0x522605 = _0x54a1b7;
    if (this.#audioRecorderProcess) {
      log[_0x522605(1697)]("[AudioService] Audio recorder already running.");
      return;
    }
    const _0x548177 = this.#getBinaryPath();
    if (!_0x548177) {
      log[_0x522605(981)]("[AudioService] Could not determine audio recorder binary path."), this[_0x522605(569)]("error", new Error("Audio recorder binary not found."));
      return;
    }
    log[_0x522605(1341)](_0x522605(1410) + _0x548177);
    try {
      this.#audioRecorderProcess = child_process[_0x522605(1424)](_0x548177, [], { "stdio": [_0x522605(1155), _0x522605(1155), _0x522605(1155)] }), this.#audioRecorderProcess[_0x522605(1532)]["on"]("data", this.#onData[_0x522605(334)](this)), this.#audioRecorderProcess[_0x522605(595)]["on"]("data", this.#onStdErr[_0x522605(334)](this)), this.#audioRecorderProcess["on"]("close", this.#onClose[_0x522605(334)](this)), this.#audioRecorderProcess["on"]("error", this.#onError[_0x522605(334)](this)), this[_0x522605(569)](_0x522605(1391));
    } catch (_0x3dcf82) {
      log[_0x522605(981)]("[AudioService] Caught an error while spawning audio recorder:", _0x3dcf82), this.#audioRecorderProcess = null, this[_0x522605(569)]("error", _0x3dcf82);
    }
  }
  [_0x54a1b7(268)]() {
    const _0x2e2a84 = _0x54a1b7;
    this.#audioRecorderProcess && (log[_0x2e2a84(1341)](_0x2e2a84(1438)), this.#audioRecorderProcess[_0x2e2a84(1386)](), this.#audioRecorderProcess = null, this[_0x2e2a84(569)](_0x2e2a84(1336)));
  }
  [_0x54a1b7(802)](_0x56e203) {
    const _0x19cf0e = _0x54a1b7, _0x451dd5 = globalThis[_0x19cf0e(683)];
    _0x451dd5 && traceLogger[_0x19cf0e(1118)](_0x451dd5, _0x19cf0e(1022), { "deviceName": _0x56e203, "hasProcess": !!this.#audioRecorderProcess }), this.#firstAudioChunkReceived = ![], this.#sendCommand({ "command": _0x19cf0e(376), "device_name": _0x56e203 }), log[_0x19cf0e(1341)](_0x19cf0e(1310) + _0x56e203);
  }
  [_0x54a1b7(976)]() {
    const _0x21e9f1 = _0x54a1b7, _0x41cd8c = globalThis[_0x21e9f1(683)];
    _0x41cd8c && traceLogger[_0x21e9f1(1118)](_0x41cd8c, _0x21e9f1(1322), { "hasProcess": !!this.#audioRecorderProcess }), this.#sendCommand({ "command": _0x21e9f1(1146) }), log[_0x21e9f1(1341)](_0x21e9f1(1533));
  }
  [_0x54a1b7(1242)]() {
    return new Promise((_0x2d9303, _0x5fc955) => {
      const _0x20cc60 = _0x1d03;
      if (!this.#audioRecorderProcess) return _0x5fc955(new Error("Audio recorder process not running."));
      this.#deviceListWaiters[_0x20cc60(529)]({ "resolve": _0x2d9303, "reject": _0x5fc955 }), this.#deviceListWaiters[_0x20cc60(1115)] === 1 && this.#sendCommand({ "command": "list-devices" });
    });
  }
  [_0x54a1b7(353)](_0x4cf08f) {
    this.#sendCommand({ "command": "get-device-config", "device_name": _0x4cf08f });
  }
  #onData(_0x23cfae) {
    const _0x1ff4a4 = _0x54a1b7;
    this.#audioBuffer = Buffer[_0x1ff4a4(346)]([this.#audioBuffer, _0x23cfae]), this.#processData();
  }
  #onStdErr(_0x4d7d7d) {
    const _0x5373fa = _0x54a1b7;
    log[_0x5373fa(981)](_0x5373fa(1521), _0x4d7d7d[_0x5373fa(1450)]());
  }
  #onClose(_0x4280a0) {
    const _0x13e431 = _0x54a1b7;
    log[_0x13e431(1697)](_0x13e431(639) + _0x4280a0), this.#audioRecorderProcess = null, this[_0x13e431(569)](_0x13e431(1336));
  }
  #onError(_0x4b8baa) {
    const _0xdb9f29 = _0x54a1b7;
    log[_0xdb9f29(981)](_0xdb9f29(273), _0x4b8baa), this.#audioRecorderProcess = null, this[_0xdb9f29(569)]("error", _0x4b8baa);
  }
  #processData() {
    while (!![]) {
      const _0x571211 = this.#parseMessage();
      if (!_0x571211) break;
      this.#handleMessage(_0x571211);
    }
  }
  #parseMessage() {
    const _0x3f2f61 = _0x54a1b7;
    if (this.#audioBuffer[_0x3f2f61(1115)] < 5) return null;
    const _0x25a698 = this.#audioBuffer[_0x3f2f61(693)](0), _0x3d8630 = this.#audioBuffer[_0x3f2f61(1065)](1), _0x475ffc = 5 + _0x3d8630;
    if (this.#audioBuffer[_0x3f2f61(1115)] < _0x475ffc) return null;
    const _0x5a9c85 = this.#audioBuffer[_0x3f2f61(337)](5, _0x475ffc);
    this.#audioBuffer = this.#audioBuffer[_0x3f2f61(337)](_0x475ffc);
    switch (_0x25a698) {
      case MSG_TYPE_JSON:
        return { "type": "json", "payload": _0x5a9c85 };
      case MSG_TYPE_AUDIO:
        return { "type": _0x3f2f61(975), "payload": _0x5a9c85 };
      default:
        log[_0x3f2f61(1697)](_0x3f2f61(1345) + _0x25a698);
        return null;
    }
  }
  #handleMessage(_0x578ac8) {
    const _0x225c86 = _0x54a1b7;
    if (_0x578ac8[_0x225c86(1154)] === "json") try {
      const _0x20d33c = JSON[_0x225c86(675)](_0x578ac8[_0x225c86(1616)][_0x225c86(1450)](_0x225c86(1106)));
      if (_0x20d33c[_0x225c86(1154)] === "device-list") {
        const _0x471a02 = _0x20d33c[_0x225c86(1586)] || [];
        while (this.#deviceListWaiters[_0x225c86(1115)] > 0) {
          const _0x300229 = this.#deviceListWaiters[_0x225c86(1449)]();
          _0x300229?.[_0x225c86(1786)](_0x471a02);
        }
      } else {
        if (_0x20d33c[_0x225c86(1154)] === "audio-config") {
          const _0x28e753 = Number(_0x20d33c[_0x225c86(1577)]) || 16e3, _0x5eeb42 = Number(_0x20d33c[_0x225c86(1042)]) || 16e3, _0x250acf = Number(_0x20d33c[_0x225c86(640)]) || 1;
          this[_0x225c86(569)]("audio-config", { "sampleRate": _0x28e753, "outputSampleRate": _0x5eeb42, "channels": _0x250acf });
        }
      }
    } catch (_0x61a183) {
      log[_0x225c86(981)]("[AudioService] Failed to parse JSON response:", _0x61a183);
      while (this.#deviceListWaiters[_0x225c86(1115)] > 0) {
        const _0x223f29 = this.#deviceListWaiters[_0x225c86(1449)]();
        _0x223f29?.[_0x225c86(559)](new Error("Failed to parse JSON response"));
      }
    }
    else {
      if (_0x578ac8[_0x225c86(1154)] === _0x225c86(975)) {
        const _0x3067df = this.#calculateVolume(_0x578ac8[_0x225c86(1616)]);
        !this.#firstAudioChunkReceived && (this.#firstAudioChunkReceived = !![], log[_0x225c86(1341)](_0x225c86(1180) + _0x578ac8[_0x225c86(1616)][_0x225c86(1115)] + _0x225c86(951) + (_0x3067df * 100)[_0x225c86(608)](1) + "%")), this[_0x225c86(569)]("volume-update", _0x3067df), this[_0x225c86(569)](_0x225c86(772), _0x578ac8[_0x225c86(1616)]);
      }
    }
  }
  #sendCommand(_0x15162b) {
    const _0x4fdb12 = _0x54a1b7;
    if (this.#audioRecorderProcess?.[_0x4fdb12(776)]) {
      const _0x3b9f52 = JSON[_0x4fdb12(1516)](_0x15162b) + "\n";
      this.#audioRecorderProcess[_0x4fdb12(776)][_0x4fdb12(1020)](_0x3b9f52);
    } else log[_0x4fdb12(1697)]("[AudioService] Cannot send command, process not running.");
  }
  #calculateVolume(_0x3b21ae) {
    const _0x14e86d = _0x54a1b7;
    if (_0x3b21ae[_0x14e86d(1115)] < 2) return 0;
    let _0x575e09 = 0;
    for (let _0x4b85d7 = 0; _0x4b85d7 < _0x3b21ae[_0x14e86d(1115)] - 1; _0x4b85d7 += 2) {
      const _0x5de545 = _0x3b21ae[_0x14e86d(910)](_0x4b85d7);
      _0x575e09 += _0x5de545 * _0x5de545;
    }
    const _0x293b4d = Math[_0x14e86d(1728)](_0x575e09 / (_0x3b21ae[_0x14e86d(1115)] / 2));
    return Math[_0x14e86d(1125)](_0x293b4d / 32767, 1);
  }
  #getBinaryPath() {
    const _0x1bf5c3 = _0x54a1b7, _0x4be791 = !electron[_0x1bf5c3(178)][_0x1bf5c3(1664)], _0x53f2b1 = os[_0x1bf5c3(1394)](), _0x399294 = _0x53f2b1 === "win32" ? "microphone-capture.exe" : "microphone-capture", _0x389739 = _0x4be791 ? path[_0x1bf5c3(1638)](__dirname, "../../native/microphone-capture/target") : path[_0x1bf5c3(1638)](process[_0x1bf5c3(1613)], "binaries");
    if (_0x4be791) {
      let _0x5a9166;
      if (_0x53f2b1 === "darwin") _0x5a9166 = "universal";
      else {
        if (_0x53f2b1 === "win32") _0x5a9166 = "x86_64-pc-windows-gnu/release";
        else return log[_0x1bf5c3(981)](_0x1bf5c3(573) + _0x53f2b1), null;
      }
      return path[_0x1bf5c3(1638)](_0x389739, _0x5a9166, _0x399294);
    } else return path[_0x1bf5c3(1638)](process[_0x1bf5c3(1613)], "binaries", _0x399294);
  }
}
const audioRecorderService = new AudioRecorderService();
let previousVolume = null;
function setSystemVolume(_0x31f6ea) {
  const _0x4c0721 = _0x54a1b7;
  if (os[_0x4c0721(1394)]() !== "darwin") return log[_0x4c0721(1697)]("System audio control is only supported on macOS"), ![];
  try {
    return child_process[_0x4c0721(294)](_0x4c0721(1152) + Math[_0x4c0721(1507)](0, Math[_0x4c0721(1125)](100, _0x31f6ea)) + '"'), !![];
  } catch (_0x513472) {
    return log[_0x4c0721(981)]("Failed to set system volume:", _0x513472), ![];
  }
}
function unmuteSystemAudio() {
  const _0x449060 = _0x54a1b7;
  if (os[_0x449060(1394)]() !== "darwin") return log[_0x449060(1697)]("System audio control is only supported on macOS"), ![];
  try {
    if (previousVolume !== null) {
      log[_0x449060(1341)](_0x449060(228) + previousVolume);
      const _0x1f5434 = setSystemVolume(previousVolume);
      return previousVolume = null, _0x1f5434;
    } else return log[_0x449060(1697)](_0x449060(658)), ![];
  } catch (_0x409fda) {
    return log[_0x449060(981)]("Failed to unmute system audio:", _0x409fda), ![];
  }
}
class AudioStreamManager {
  [_0x54a1b7(1804)] = ![];
  [_0x54a1b7(1803)] = [];
  [_0x54a1b7(982)] = [];
  [_0x54a1b7(1784)] = null;
  [_0x54a1b7(352)] = [];
  [_0x54a1b7(1633)] = 16e3;
  [_0x54a1b7(538)] = 100;
  [_0x54a1b7(1186)] = ![];
  [_0x54a1b7(1673)] = 0;
  [_0x54a1b7(1356)] = 2;
  async *[_0x54a1b7(869)]() {
    const _0x29ea5c = _0x54a1b7;
    let _0x5123ec = 0, _0x5582a5 = 0;
    while (this[_0x29ea5c(1804)] && !this[_0x29ea5c(1186)]) {
      if (this[_0x29ea5c(1403)]() >= this[_0x29ea5c(538)]) {
        this[_0x29ea5c(1186)] = !![], console[_0x29ea5c(926)](_0x29ea5c(1136), this[_0x29ea5c(1403)](), _0x29ea5c(1044), this[_0x29ea5c(1673)], "bytes, Sample rate:", this[_0x29ea5c(1633)], "Hz");
        break;
      }
      await new Promise((_0xdea019) => {
        const _0x48cf20 = _0x29ea5c;
        this[_0x48cf20(1784)] = _0xdea019;
      });
    }
    while (this[_0x29ea5c(1804)] || this[_0x29ea5c(1803)][_0x29ea5c(1115)] > 0 || this[_0x29ea5c(982)][_0x29ea5c(1115)] > 0) {
      while (this[_0x29ea5c(982)][_0x29ea5c(1115)] > 0) {
        const _0x7f13a4 = this[_0x29ea5c(982)][_0x29ea5c(1449)]();
        _0x7f13a4 && (console[_0x29ea5c(926)]("[AudioStreamManager] Sending control message:", _0x7f13a4[_0x29ea5c(1616)][_0x29ea5c(370)]), yield _0x7f13a4);
      }
      if (this[_0x29ea5c(1803)][_0x29ea5c(1115)] === 0) {
        if (this[_0x29ea5c(1804)]) {
          await new Promise((_0x522c32) => {
            const _0x28a2e8 = _0x29ea5c;
            this[_0x28a2e8(1784)] = _0x522c32;
          });
          continue;
        } else break;
      }
      while (this[_0x29ea5c(1803)][_0x29ea5c(1115)] > 0) {
        const _0x16346b = this[_0x29ea5c(1803)][_0x29ea5c(1449)]();
        _0x16346b && (_0x5123ec++, _0x5582a5 += _0x16346b[_0x29ea5c(1115)], yield protobuf[_0x29ea5c(1288)](StreamMessageSchema, { "payload": { "case": _0x29ea5c(1319), "value": protobuf[_0x29ea5c(1288)](AudioChunkSchema, { "audioData": _0x16346b }) } }));
      }
    }
    const _0x1abf3a = _0x5582a5 / this[_0x29ea5c(1356)] / this[_0x29ea5c(1633)] * 1e3;
    console[_0x29ea5c(926)](_0x29ea5c(291), _0x5123ec, ", Total bytes sent:", _0x5582a5, ", Total duration:", _0x1abf3a[_0x29ea5c(608)](0), "ms");
  }
  [_0x54a1b7(167)]() {
    const _0x16cb84 = _0x54a1b7;
    this[_0x16cb84(1804)] = !![], this[_0x16cb84(1803)] = [], this[_0x16cb84(352)] = [], this[_0x16cb84(1186)] = ![], this[_0x16cb84(1673)] = 0;
  }
  [_0x54a1b7(304)]() {
    const _0x456111 = _0x54a1b7;
    this[_0x456111(1804)] = ![], this[_0x456111(1784)] && (this[_0x456111(1784)](), this[_0x456111(1784)] = null);
  }
  [_0x54a1b7(511)](_0x591488) {
    const _0x4c9c9a = _0x54a1b7;
    if (!this[_0x4c9c9a(1804)]) return;
    this[_0x4c9c9a(1803)][_0x4c9c9a(529)](_0x591488), this[_0x4c9c9a(352)][_0x4c9c9a(529)](_0x591488), this[_0x4c9c9a(1673)] += _0x591488[_0x4c9c9a(1115)], this[_0x4c9c9a(1784)] && (this[_0x4c9c9a(1784)](), this[_0x4c9c9a(1784)] = null);
  }
  [_0x54a1b7(469)](_0x4cc67a) {
    const _0x4a1747 = _0x54a1b7;
    if (!this[_0x4a1747(1804)]) {
      console[_0x4a1747(1697)]("[AudioStreamManager] Cannot add control message - not streaming");
      return;
    }
    console[_0x4a1747(926)]("[AudioStreamManager] Queueing control message:", _0x4cc67a[_0x4a1747(1616)][_0x4a1747(370)]), this[_0x4a1747(982)][_0x4a1747(529)](_0x4cc67a), this[_0x4a1747(1784)] && (this[_0x4a1747(1784)](), this[_0x4a1747(1784)] = null);
  }
  [_0x54a1b7(1224)]() {
    const _0x56deef = _0x54a1b7;
    return Buffer[_0x56deef(346)](this[_0x56deef(352)]);
  }
  [_0x54a1b7(811)](_0x35b30a) {
    const _0x3c5c80 = _0x54a1b7;
    typeof _0x35b30a[_0x3c5c80(1104)] === _0x3c5c80(605) && _0x35b30a[_0x3c5c80(1104)] > 0 && (this[_0x3c5c80(1633)] = _0x35b30a[_0x3c5c80(1104)]);
  }
  [_0x54a1b7(1815)]() {
    const _0x148075 = _0x54a1b7;
    return this[_0x148075(1633)];
  }
  [_0x54a1b7(625)]() {
    const _0x2225d2 = _0x54a1b7;
    return this[_0x2225d2(1804)];
  }
  [_0x54a1b7(1527)]() {
    const _0x8719ec = _0x54a1b7;
    this[_0x8719ec(352)] = [];
  }
  [_0x54a1b7(1403)]() {
    const _0x5c4b35 = _0x54a1b7, _0x490e99 = this[_0x5c4b35(1673)] / this[_0x5c4b35(1356)], _0x4c2acc = _0x490e99 / this[_0x5c4b35(1633)];
    return Math[_0x5c4b35(1225)](_0x4c2acc * 1e3);
  }
  [_0x54a1b7(1098)]() {
    const _0x50179e = _0x54a1b7;
    return this[_0x50179e(1403)]() >= this[_0x50179e(538)];
  }
}
class DictationManager {
  [_0x54a1b7(1869)] = null;
  [_0x54a1b7(308)] = null;
  [_0x54a1b7(757)]() {
    const _0x371a3a = _0x54a1b7;
    return this[_0x371a3a(1869)] = uuid["v4"](), this[_0x371a3a(308)] = Date[_0x371a3a(1536)](), this[_0x371a3a(1869)];
  }
  [_0x54a1b7(454)]() {
    const _0x4d36f1 = _0x54a1b7;
    return this[_0x4d36f1(1869)];
  }
  [_0x54a1b7(1508)]() {
    const _0x32e30a = _0x54a1b7;
    return this[_0x32e30a(308)];
  }
  [_0x54a1b7(255)](_0x207c56) {
    const _0x1eb736 = _0x54a1b7;
    this[_0x1eb736(1869)] = _0x207c56, this[_0x1eb736(308)] = Date[_0x1eb736(1536)]();
  }
  async [_0x54a1b7(126)](_0x156f78, _0x393426, _0x1fd435, _0xa02e1d = VoiceOSMode[_0x54a1b7(124)], _0x12cf74) {
    const _0x2178eb = _0x54a1b7;
    if (!this[_0x2178eb(1869)]) {
      log[_0x2178eb(1697)]("[DictationManager] No current dictation ID, skipping dictation creation.");
      return;
    }
    try {
      const _0x5ecf88 = store[_0x2178eb(1043)](STORE_KEYS[_0x2178eb(1850)]), _0x46f3fc = _0x5ecf88?.["id"];
      if (!_0x46f3fc) {
        log[_0x2178eb(1697)]("[DictationManager] No user ID found, not creating dictation.");
        return;
      }
      const _0x5e74fa = Date[_0x2178eb(1536)](), _0x258060 = this[_0x2178eb(308)] ? _0x5e74fa - this[_0x2178eb(308)] : 0, _0x1f3315 = _0x258060 / 1e3, _0x2fd5c9 = { "transcript": _0x156f78, "totalAudioBytes": _0x393426[_0x2178eb(1115)], "error": _0x12cf74 || null, "timestamp": (/* @__PURE__ */ new Date())[_0x2178eb(582)](), "durationMs": _0x258060 }, _0xa97ef0 = countWords(_0x156f78), _0x5daae2 = (/* @__PURE__ */ new Date())[_0x2178eb(582)](), _0x994732 = store[_0x2178eb(1043)](STORE_KEYS[_0x2178eb(193)]), _0xac355e = _0x994732?.[_0x2178eb(1372)] ?? !![], _0x2e167a = grpcClient[_0x2178eb(1093)](_0x156f78);
      _0x2e167a[_0x2178eb(843)]((_0x55dfe9) => {
        const _0x5f5b59 = _0x2178eb;
        log[_0x5f5b59(1341)](_0x5f5b59(357) + _0x55dfe9[_0x5f5b59(585)] + _0x5f5b59(814) + _0x55dfe9[_0x5f5b59(1572)]), electron[_0x5f5b59(963)][_0x5f5b59(1274)]()[_0x5f5b59(878)]((_0x11630d) => {
          const _0x2e38b3 = _0x5f5b59;
          _0x11630d[_0x2e38b3(890)][_0x2e38b3(965)]("usage-updated", { "currentUsage": _0x55dfe9[_0x2e38b3(585)], "limit": _0x55dfe9[_0x2e38b3(287)], "allowed": _0x55dfe9[_0x2e38b3(1572)], "reason": _0x55dfe9[_0x2e38b3(383)], "planType": _0x55dfe9[_0x2e38b3(973)] });
        });
        if (!_0x55dfe9[_0x5f5b59(1572)]) {
          log[_0x5f5b59(1697)]("[DictationManager] User exceeded limit, showing error state");
          const _0x3e23ee = getPillWindow();
          if (_0x3e23ee && !_0x3e23ee[_0x5f5b59(496)]()) {
            const _0x40294a = { "code": _0x5f5b59(1847), "message": _0x55dfe9[_0x5f5b59(383)] };
            _0x3e23ee[_0x5f5b59(890)][_0x5f5b59(965)](IPC_EVENTS[_0x5f5b59(1462)], _0x40294a);
          }
        }
      })[_0x2178eb(564)]((_0x4c213e) => {
        const _0x3ede80 = _0x2178eb;
        log[_0x3ede80(981)]("[DictationManager] Failed to record usage:", _0x4c213e);
      });
      const _0x2698fa = await getActiveWindow(), _0x30fcc2 = _0x2698fa?.[_0x2178eb(1856)] || null, _0x4bdb01 = _0x2698fa?.[_0x2178eb(221)] || null;
      _0x2698fa && log[_0x2178eb(1341)](_0x2178eb(1173) + _0x30fcc2 + _0x2178eb(977) + _0x4bdb01);
      if (_0x30fcc2) {
        const _0x546c62 = _0x30fcc2[_0x2178eb(1566)]();
        if (_0x546c62[_0x2178eb(1580)]("voiceos") || _0x546c62[_0x2178eb(1580)]("electron")) {
          log[_0x2178eb(1341)](_0x2178eb(1055) + _0x30fcc2 + _0x2178eb(163));
          return;
        }
      }
      let _0x420044 = null;
      if (_0x30fcc2) try {
        const { getCachedAppIcon: _0x2faf45 } = await Promise[_0x2178eb(1786)]()[_0x2178eb(843)](() => activeApplication), _0xbb471d = _0x2faf45(_0x30fcc2);
        if (_0xbb471d) {
          const { AppIconsTable: _0x435462 } = await Promise[_0x2178eb(1786)]()[_0x2178eb(843)](() => repo), _0x54f299 = await _0x435462[_0x2178eb(810)]({ "user_id": _0x46f3fc, "app_name": _0x30fcc2, "icon_base64": _0xbb471d });
          _0x420044 = _0x54f299["id"], log[_0x2178eb(1341)](_0x2178eb(1046) + _0x30fcc2 + ": " + _0x420044);
        }
      } catch (_0x2fd1ed) {
        log[_0x2178eb(981)](_0x2178eb(189) + _0x30fcc2 + ":", _0x2fd1ed);
      }
      const _0x479a93 = { "id": this[_0x2178eb(1869)], "user_id": _0x46f3fc, "transcript": _0x156f78 || null, "generated_text": _0x156f78 || null, "app_name": _0x30fcc2, "window_title": _0x4bdb01, "audio_blob_id": null, "duration_seconds": _0x1f3315, "sample_rate": _0x1fd435, "word_count": _0xa97ef0, "mode": _0xa02e1d, "app_icon_id": _0x420044, "created_at": _0x5daae2, "updated_at": _0x5daae2, "deleted_at": null, "sync_failed_at": null };
      await VoiceSessionsTable[_0x2178eb(810)](_0x479a93);
      _0xac355e ? grpcClient[_0x2178eb(1659)]({ ..._0x479a93, "audio_blob": _0x393426 })[_0x2178eb(843)](() => {
        const _0x5a4840 = _0x2178eb;
        log[_0x5a4840(1341)](_0x5a4840(1590) + this[_0x5a4840(1869)]);
      })[_0x2178eb(564)]((_0x4406e3) => {
        const _0x48aa29 = _0x2178eb;
        log[_0x48aa29(981)]("[DictationManager] Failed to send voice session to server:", _0x4406e3);
      }) : log[_0x2178eb(1341)]("[DictationManager] Analytics sharing disabled, voice session not synced to server");
      const _0x41be66 = "voice-session-created";
      electron[_0x2178eb(963)][_0x2178eb(1274)]()[_0x2178eb(878)]((_0x2634ad) => {
        const _0x28067a = _0x2178eb;
        _0x2634ad[_0x28067a(890)][_0x28067a(965)](_0x41be66, { "id": this[_0x28067a(1869)], "transcript": _0x156f78, "timestamp": _0x5daae2, "durationMs": _0x258060 });
      });
    } catch (_0x19307f) {
      log[_0x2178eb(981)]("[DictationManager] Failed to create dictation:", _0x19307f);
    }
  }
  [_0x54a1b7(644)]() {
    const _0x2bd3d8 = _0x54a1b7;
    this[_0x2bd3d8(1869)] = null, this[_0x2bd3d8(308)] = null;
  }
}
class WindowMessenger {
  [_0x54a1b7(280)] = null;
  [_0x54a1b7(1706)](_0x24be71) {
    const _0x65ba1f = _0x54a1b7;
    this[_0x65ba1f(280)] = _0x24be71;
  }
  [_0x54a1b7(242)](_0x2eeeb0) {
    const _0x351ec8 = _0x54a1b7;
    if (this[_0x351ec8(601)]()) try {
      this[_0x351ec8(280)][_0x351ec8(890)][_0x351ec8(965)]("transcription-result", _0x2eeeb0);
    } catch (_0x23a217) {
      console[_0x351ec8(981)](" Error sending transcription result to main window:", _0x23a217);
    }
  }
  [_0x54a1b7(1277)](_0xf51096) {
    const _0x7765a5 = _0x54a1b7;
    if (this[_0x7765a5(601)]()) try {
      this[_0x7765a5(280)][_0x7765a5(890)][_0x7765a5(965)]("transcription-error", _0xf51096);
    } catch (_0x3f31af) {
      console[_0x7765a5(981)](" Error sending transcription error to main window:", _0x3f31af);
    }
  }
  [_0x54a1b7(601)]() {
    const _0x38b8f3 = _0x54a1b7;
    return !!(this[_0x38b8f3(280)] && !this[_0x38b8f3(280)][_0x38b8f3(496)]() && this[_0x38b8f3(280)][_0x38b8f3(890)] && !this[_0x38b8f3(280)][_0x38b8f3(890)][_0x38b8f3(496)]());
  }
}
const nativeModuleName$3 = "text-injector";
function convertUrlsToHtml(_0x3ec9) {
  const _0x34dc30 = _0x54a1b7, _0x26cd5a = /\[([^\]]+)\]\((https?:\/\/[^)]+)\)/g, _0x4f7446 = [];
  let _0x8ac2c = 0;
  const _0x4e6dfe = _0x3ec9[_0x34dc30(1541)](_0x26cd5a, (_0x307a85, _0x5cb0c1, _0x367b3f) => {
    const _0x4a9166 = _0x34dc30, _0x404614 = _0x4a9166(191) + _0x8ac2c + "__", _0x5099c8 = _0x5cb0c1[_0x4a9166(1541)](/&/g, _0x4a9166(514))[_0x4a9166(1541)](/</g, _0x4a9166(885))[_0x4a9166(1541)](/>/g, _0x4a9166(1650))[_0x4a9166(1541)](/"/g, _0x4a9166(1307));
    return _0x4f7446[_0x4a9166(529)]({ "placeholder": _0x404614, "html": _0x4a9166(1494) + _0x367b3f + '">' + _0x5099c8 + _0x4a9166(918) }), _0x8ac2c++, _0x404614;
  });
  let _0x5e92a0 = _0x4e6dfe[_0x34dc30(1541)](/&/g, _0x34dc30(514))[_0x34dc30(1541)](/</g, _0x34dc30(885))[_0x34dc30(1541)](/>/g, _0x34dc30(1650))[_0x34dc30(1541)](/"/g, _0x34dc30(1307));
  const _0x4c5626 = /(https?:\/\/[^\s<>"{}|\\^`[\]]+)/gi;
  _0x5e92a0 = _0x5e92a0[_0x34dc30(1541)](_0x4c5626, (_0x224f63) => {
    const _0x58e919 = _0x34dc30, _0x16ff81 = _0x224f63[_0x58e919(1541)](/&amp;/g, "&")[_0x58e919(1541)](/&lt;/g, "<")[_0x58e919(1541)](/&gt;/g, ">")[_0x58e919(1541)](/&quot;/g, '"');
    return _0x58e919(1494) + _0x16ff81 + '">' + _0x224f63 + _0x58e919(918);
  });
  for (const _0x325a19 of _0x4f7446) {
    _0x5e92a0 = _0x5e92a0[_0x34dc30(1541)](_0x325a19[_0x34dc30(728)], _0x325a19[_0x34dc30(1795)]);
  }
  return _0x5e92a0 = _0x5e92a0[_0x34dc30(1541)](/\n/g, _0x34dc30(599)), _0x34dc30(1499) + _0x5e92a0 + _0x34dc30(974);
}
function convertMarkdownLinksToPlainText(_0x1f3347) {
  const _0x86eac4 = _0x54a1b7;
  return _0x1f3347[_0x86eac4(1541)](/\[([^\]]+)\]\((https?:\/\/[^)]+)\)/g, "$2");
}
function containsUrls(_0x1340fe) {
  const _0x1107d0 = _0x54a1b7, _0x11a54b = /https?:\/\/[^\s<>"{}|\\^`[\]]+/i, _0x39ea20 = /\[[^\]]+\]\(https?:\/\/[^)]+\)/i;
  return _0x11a54b[_0x1107d0(1103)](_0x1340fe) || _0x39ea20[_0x1107d0(1103)](_0x1340fe);
}
function setFocusedText(_0x58dfb4, _0x306dde = { "delay": 0, "charDelay": 0 }) {
  return new Promise((_0x4ececc) => {
    const _0x54b2dc = _0x1d03, _0x43ffd2 = getNativeBinaryPath(nativeModuleName$3);
    if (!_0x43ffd2) return console[_0x54b2dc(981)](_0x54b2dc(171) + nativeModuleName$3 + _0x54b2dc(1237) + os[_0x54b2dc(1394)]() + _0x54b2dc(847) + os[_0x54b2dc(1129)]()), _0x4ececc(![]);
    const _0x5e691f = [];
    _0x306dde[_0x54b2dc(1545)] !== void 0 && _0x306dde[_0x54b2dc(1545)] > 0 && _0x5e691f[_0x54b2dc(529)]("--delay", _0x306dde[_0x54b2dc(1545)][_0x54b2dc(1450)]());
    if (_0x306dde[_0x54b2dc(913)]) _0x5e691f[_0x54b2dc(529)]("--char-delay", "1");
    else _0x306dde[_0x54b2dc(894)] !== void 0 && _0x306dde[_0x54b2dc(894)] > 0 && _0x5e691f[_0x54b2dc(529)]("--char-delay", _0x306dde[_0x54b2dc(894)][_0x54b2dc(1450)]());
    _0x306dde[_0x54b2dc(1795)] && !_0x306dde[_0x54b2dc(913)] && _0x5e691f[_0x54b2dc(529)](_0x54b2dc(1867), _0x306dde[_0x54b2dc(1795)]), _0x5e691f[_0x54b2dc(529)]("--", _0x58dfb4), child_process[_0x54b2dc(770)](_0x43ffd2, _0x5e691f, (_0x204c45, _0x44043d, _0x586a8b) => {
      const _0x451ca8 = _0x54b2dc;
      if (_0x204c45) return console[_0x451ca8(981)](" text-injector error:", _0x586a8b), _0x4ececc(![]);
      _0x4ececc(!![]);
    });
  });
}
function setFocusedTextWithLinks(_0x166288, _0x15855e = { "delay": 0, "charDelay": 0 }) {
  const _0xbeee35 = _0x54a1b7;
  if (containsUrls(_0x166288) && !_0x15855e[_0xbeee35(913)]) {
    const _0x5d8565 = convertUrlsToHtml(_0x166288), _0x54d306 = convertMarkdownLinksToPlainText(_0x166288);
    return setFocusedText(_0x54d306, { ..._0x15855e, "html": _0x5d8565 });
  }
  return setFocusedText(_0x166288, _0x15855e);
}
function pressEnterKey() {
  return new Promise((_0x1db2fd) => {
    const _0x59f9c3 = _0x1d03, _0x20d2c2 = getNativeBinaryPath(nativeModuleName$3);
    if (!_0x20d2c2) return console[_0x59f9c3(981)](_0x59f9c3(171) + nativeModuleName$3 + _0x59f9c3(1237) + os[_0x59f9c3(1394)]() + _0x59f9c3(847) + os[_0x59f9c3(1129)]()), _0x1db2fd(![]);
    child_process[_0x59f9c3(770)](_0x20d2c2, ["--press-enter"], (_0x476271, _0xde6fde, _0x4bf785) => {
      const _0x1a7f92 = _0x59f9c3;
      if (_0x476271) return console[_0x1a7f92(981)](" text-injector pressEnterKey error:", _0x4bf785), _0x1db2fd(![]);
      _0x1db2fd(!![]);
    });
  });
}
const textWriter = Object[_0x54a1b7(502)](Object[_0x54a1b7(634)]({ "__proto__": null, "containsUrls": containsUrls, "convertMarkdownLinksToPlainText": convertMarkdownLinksToPlainText, "convertUrlsToHtml": convertUrlsToHtml, "pressEnterKey": pressEnterKey, "setFocusedText": setFocusedText, "setFocusedTextWithLinks": setFocusedTextWithLinks }, Symbol[_0x54a1b7(1177)], { "value": _0x54a1b7(1416) }));
class TextInserter {
  async [_0x54a1b7(1809)](_0x11a485, _0xe0d5c2, _0x551b73) {
    const _0x25504a = _0x54a1b7;
    if (!_0x11a485) return ![];
    const { fastMode = ![] } = _0x551b73 || {}, _0x17df15 = containsUrls(_0x11a485);
    try {
      const _0x5aa388 = await setFocusedTextWithLinks(_0x11a485, { "delay": 0, "charDelay": 0, "fastMode": fastMode });
      return _0xe0d5c2 && traceLogger[_0x25504a(1118)](_0xe0d5c2, _0x25504a(1602), { "transcript": _0x11a485, "transcriptLength": _0x11a485[_0x25504a(1115)], "success": _0x5aa388, "fastMode": fastMode, "hasUrls": _0x17df15 }), _0x5aa388;
    } catch (_0x32f3fa) {
      return console[_0x25504a(981)](" Error inserting text:", _0x32f3fa), _0xe0d5c2 && traceLogger[_0x25504a(730)](_0xe0d5c2, _0x25504a(1160), _0x32f3fa instanceof Error ? _0x32f3fa[_0x25504a(1486)] : String(_0x32f3fa)), ![];
    }
  }
}
const TERMINAL_APPS = /* @__PURE__ */ new Set([_0x54a1b7(1229), _0x54a1b7(1568), _0x54a1b7(1502), "alacritty", "kitty", "hyper", _0x54a1b7(1411), _0x54a1b7(1209), "tabby", _0x54a1b7(1054), "console", "xterm", _0x54a1b7(616), _0x54a1b7(1628), _0x54a1b7(1570), _0x54a1b7(1859), _0x54a1b7(218), "msys2", "cygwin", _0x54a1b7(679), _0x54a1b7(626), _0x54a1b7(983), "visual studio code", "visual studio code - insiders", "code", "code - insiders", _0x54a1b7(153), _0x54a1b7(1837), _0x54a1b7(713), "intellij idea", "intellij idea ultimate", "intellij idea community edition", _0x54a1b7(381), "pycharm", "pycharm professional", "pycharm community edition", "clion", _0x54a1b7(1864), "rubymine", _0x54a1b7(1482), "datagrip", "rider", "android studio", _0x54a1b7(863), _0x54a1b7(1259), _0x54a1b7(230), _0x54a1b7(1559), "konsole", "xfce4-terminal", _0x54a1b7(806), "lxterminal", _0x54a1b7(1375), "tilix", _0x54a1b7(1569), "yakuake"]);
function isTerminalApplication(_0x14f188) {
  const _0x2d17fb = _0x54a1b7, _0x2d102c = _0x14f188[_0x2d17fb(1566)]();
  return TERMINAL_APPS[_0x2d17fb(1764)](_0x2d102c);
}
async function canGetContextFromCurrentApp() {
  const _0x20d98c = _0x54a1b7;
  try {
    const _0x510839 = await getActiveWindow();
    if (!_0x510839?.[_0x20d98c(1856)]) return ![];
    return !isTerminalApplication(_0x510839[_0x20d98c(1856)]);
  } catch (_0x150b43) {
    return console[_0x20d98c(981)]("Failed to get active window:", _0x150b43), ![];
  }
}
const applicationDetection = Object[_0x54a1b7(502)](Object[_0x54a1b7(634)]({ "__proto__": null, "canGetContextFromCurrentApp": canGetContextFromCurrentApp, "isTerminalApplication": isTerminalApplication }, Symbol[_0x54a1b7(1177)], { "value": _0x54a1b7(1416) }));
class GrammarRulesService {
  [_0x54a1b7(1693)](_0x3b1ba5, _0x4b402f) {
    const _0x1bf52f = _0x54a1b7;
    if (!_0x4b402f) return _0x4b402f;
    const _0x5dd1c5 = _0x4b402f[_0x1bf52f(1699)]();
    if (this[_0x1bf52f(420)](_0x5dd1c5)) return _0x4b402f;
    if (this[_0x1bf52f(1760)](_0x5dd1c5)) return _0x4b402f;
    if (this[_0x1bf52f(1805)](_0x5dd1c5)) return _0x4b402f;
    if (this[_0x1bf52f(1553)](_0x5dd1c5)) return _0x4b402f;
    if (this[_0x1bf52f(1349)](_0x5dd1c5)) return _0x4b402f;
    if (!_0x3b1ba5) {
      const _0x3e49e4 = _0x4b402f[_0x1bf52f(241)](/[a-zA-Z]/);
      if (_0x3e49e4 >= 0) return _0x4b402f[_0x1bf52f(350)](0, _0x3e49e4) + _0x4b402f[_0x1bf52f(1830)](_0x3e49e4)[_0x1bf52f(1171)]() + _0x4b402f[_0x1bf52f(350)](_0x3e49e4 + 1);
      return _0x4b402f;
    }
    let _0x48b717 = _0x4b402f;
    const _0x3c1a74 = _0x48b717[_0x1bf52f(1699)]()[_0x1bf52f(1163)](/\s+/)[0] || "", _0x528f6a = this[_0x1bf52f(1686)](_0x3b1ba5, _0x3c1a74), _0x2f607d = _0x48b717[_0x1bf52f(241)](/[a-zA-Z]/);
    if (_0x2f607d < 0) return _0x48b717;
    return _0x528f6a ? _0x48b717 = _0x48b717[_0x1bf52f(350)](0, _0x2f607d) + _0x48b717[_0x1bf52f(1830)](_0x2f607d)[_0x1bf52f(1171)]() + _0x48b717[_0x1bf52f(350)](_0x2f607d + 1) : !this[_0x1bf52f(223)](_0x3c1a74) && (_0x48b717 = _0x48b717[_0x1bf52f(350)](0, _0x2f607d) + _0x48b717[_0x1bf52f(1830)](_0x2f607d)[_0x1bf52f(1566)]() + _0x48b717[_0x1bf52f(350)](_0x2f607d + 1)), _0x48b717;
  }
  [_0x54a1b7(637)](_0x1ac8b1, _0x20613a) {
    const _0x128400 = _0x54a1b7;
    if (!_0x20613a) return _0x20613a;
    const _0x223e8d = this[_0x128400(1248)](_0x1ac8b1);
    if (_0x223e8d) return " " + _0x20613a;
    return _0x20613a;
  }
  [_0x54a1b7(796)](_0x2ae496) {
    const _0x16dc8d = _0x54a1b7;
    if (!_0x2ae496) return _0x2ae496;
    const _0x37ee55 = _0x2ae496[_0x16dc8d(1699)]();
    if (_0x37ee55[_0x16dc8d(1580)](" ")) return _0x2ae496;
    const _0x335da5 = _0x37ee55[_0x16dc8d(1583)](".") ? _0x37ee55[_0x16dc8d(337)](0, -1) : _0x37ee55;
    return _0x335da5;
  }
  [_0x54a1b7(243)](_0x4f432d) {
    const _0x4b945b = _0x54a1b7;
    if (!_0x4f432d) return _0x4f432d;
    return _0x4f432d[_0x4b945b(1541)](/\b[Oo][Kk][Aa][Yy]\b/g, "ok");
  }
  [_0x54a1b7(709)](_0x18e5bb, _0x5ef85) {
    const _0x1e2d15 = _0x54a1b7;
    if (!_0x5ef85) return _0x5ef85;
    const _0x307f46 = this[_0x1e2d15(759)](_0x18e5bb, _0x5ef85);
    if (_0x307f46) return _0x5ef85 + " ";
    return _0x5ef85;
  }
  [_0x54a1b7(759)](_0x386a07, _0x7314aa) {
    const _0x463074 = _0x54a1b7;
    if (!_0x386a07 || _0x386a07[_0x463074(1115)] === 0) return ![];
    const _0xa42020 = _0x386a07[_0x463074(1830)](0);
    if (/^\s/[_0x463074(1103)](_0x386a07) || _0xa42020 === "") return ![];
    if (/\s$/[_0x463074(1103)](_0x7314aa) || _0x7314aa[_0x463074(1583)]("")) return ![];
    const _0x4942d4 = [")", "]", "}", ",", ".", "!", "?", ";", ":", "'", '"'];
    if (_0x4942d4[_0x463074(1580)](_0xa42020)) return ![];
    if (/^[a-zA-Z0-9]/[_0x463074(1103)](_0x386a07)) return !![];
    return ![];
  }
  [_0x54a1b7(1248)](_0x14bbd1) {
    const _0x3d5606 = _0x54a1b7;
    if (!_0x14bbd1 || _0x14bbd1[_0x3d5606(1115)] === 0) return ![];
    const _0x5a90ca = _0x14bbd1[_0x3d5606(1830)](_0x14bbd1[_0x3d5606(1115)] - 1);
    if (/\s$/[_0x3d5606(1103)](_0x14bbd1) || _0x5a90ca === "") return ![];
    const _0x46ec49 = ["(", "[", "{", '"', "'", "`"];
    if (_0x46ec49[_0x3d5606(1580)](_0x5a90ca)) return ![];
    if (/[a-zA-Z0-9)\]}"'`.,;:!?]$/[_0x3d5606(1103)](_0x14bbd1)) return !![];
    return ![];
  }
  [_0x54a1b7(434)](_0x1e9535) {
    const _0x2633d5 = _0x54a1b7;
    if (!_0x1e9535 || _0x1e9535[_0x2633d5(1699)]()[_0x2633d5(1115)] === 0) return ![];
    const _0x399f74 = nlp(_0x1e9535[_0x2633d5(1699)]());
    return _0x399f74[_0x2633d5(1764)](_0x2633d5(1220)) || _0x399f74[_0x2633d5(1764)]("#Person") || _0x399f74[_0x2633d5(1764)](_0x2633d5(1107)) || _0x399f74[_0x2633d5(1764)]("#Organization") || _0x399f74[_0x2633d5(1764)]("#WeekDay") || _0x399f74[_0x2633d5(1764)]("#Month");
  }
  [_0x54a1b7(223)](_0x5c44c8) {
    const _0x18a1af = _0x54a1b7;
    if (!_0x5c44c8 || _0x5c44c8[_0x18a1af(1699)]()[_0x18a1af(1115)] === 0) return ![];
    const _0x307c94 = _0x5c44c8[_0x18a1af(1541)](/[^a-zA-Z]/g, "");
    return _0x307c94[_0x18a1af(1115)] >= 2 && _0x307c94 === _0x307c94[_0x18a1af(1171)]();
  }
  [_0x54a1b7(1760)](_0x891241) {
    const _0x164526 = _0x54a1b7;
    if (!_0x891241 || _0x891241[_0x164526(1699)]()[_0x164526(1115)] === 0) return ![];
    const _0x40d2bf = _0x891241[_0x164526(1699)]()[_0x164526(1566)](), _0x2b2096 = _0x40d2bf[_0x164526(1163)](/\s+/)[0] || "", _0x7b7f6e = /^[a-z0-9._%+-]+@[a-z0-9.-]+\.[a-z]{2,}$/;
    return _0x7b7f6e[_0x164526(1103)](_0x2b2096);
  }
  [_0x54a1b7(1805)](_0x243fbc) {
    const _0x36ff9f = _0x54a1b7;
    if (!_0x243fbc || _0x243fbc[_0x36ff9f(1699)]()[_0x36ff9f(1115)] === 0) return ![];
    const _0x403e11 = _0x243fbc[_0x36ff9f(1699)](), _0x22b83f = _0x403e11[_0x36ff9f(1163)](/\s+/)[0] || "";
    if (/^(\/|\.\/|\.\.\/)/[_0x36ff9f(1103)](_0x22b83f)) return !![];
    if (/^\.[a-z0-9_-]+$/i[_0x36ff9f(1103)](_0x22b83f)) return !![];
    const _0x54eb42 = [_0x36ff9f(1481), ".tsx", _0x36ff9f(1395), ".jsx", ".json", ".yaml", ".yml", _0x36ff9f(246), ".txt", _0x36ff9f(1654), _0x36ff9f(1195), _0x36ff9f(1316), _0x36ff9f(367), _0x36ff9f(1087), ".py", _0x36ff9f(1009), _0x36ff9f(1240), _0x36ff9f(1443), _0x36ff9f(807), ".c", _0x36ff9f(1687), ".h", _0x36ff9f(531), _0x36ff9f(1669), _0x36ff9f(393), _0x36ff9f(1187), _0x36ff9f(990), _0x36ff9f(1437), _0x36ff9f(649), _0x36ff9f(1285), _0x36ff9f(374), ".xml", _0x36ff9f(544), _0x36ff9f(1574), _0x36ff9f(165), _0x36ff9f(584), _0x36ff9f(449), _0x36ff9f(1435), _0x36ff9f(1731), _0x36ff9f(578), _0x36ff9f(154), ".docx", ".xls", ".xlsx", _0x36ff9f(959), ".env", _0x36ff9f(879), _0x36ff9f(804), ".conf", ".config", _0x36ff9f(182), _0x36ff9f(1166), _0x36ff9f(833), _0x36ff9f(1839), _0x36ff9f(1662)], _0x4cc822 = _0x22b83f[_0x36ff9f(1566)]();
    return _0x54eb42[_0x36ff9f(620)]((_0x56e7ef) => _0x4cc822[_0x36ff9f(1583)](_0x56e7ef));
  }
  [_0x54a1b7(1553)](_0x30ad66) {
    const _0xdf9f54 = _0x54a1b7;
    if (!_0x30ad66 || _0x30ad66[_0xdf9f54(1699)]()[_0xdf9f54(1115)] === 0) return ![];
    const _0x4a3399 = _0x30ad66[_0xdf9f54(1699)]()[_0xdf9f54(1566)](), _0x218144 = _0x4a3399[_0xdf9f54(1163)](/\s+/)[0] || "", _0x13a683 = [_0xdf9f54(1585), "npx", "yarn", _0xdf9f54(883), _0xdf9f54(1123), _0xdf9f54(1399), _0xdf9f54(615), _0xdf9f54(169), "cd", "ls", _0xdf9f54(597), _0xdf9f54(978), _0xdf9f54(389), "rm", "cp", "mv", _0xdf9f54(678), _0xdf9f54(790), _0xdf9f54(1132), _0xdf9f54(445), _0xdf9f54(1175), _0xdf9f54(816), "curl", "wget", _0xdf9f54(409), _0xdf9f54(1337), "rsync", _0xdf9f54(422), _0xdf9f54(602), _0xdf9f54(1774), _0xdf9f54(481), "apt-get", _0xdf9f54(253), "yum", _0xdf9f54(1101), _0xdf9f54(1138), "docker", "docker-compose", _0xdf9f54(1491), _0xdf9f54(859), _0xdf9f54(199), _0xdf9f54(140), _0xdf9f54(1535), _0xdf9f54(224), _0xdf9f54(1477), _0xdf9f54(760), _0xdf9f54(315), _0xdf9f54(1849), _0xdf9f54(623), "go", "python", "python3", _0xdf9f54(1261), _0xdf9f54(1861), "ruby", _0xdf9f54(146), _0xdf9f54(400), _0xdf9f54(1119), _0xdf9f54(1452), _0xdf9f54(1480), _0xdf9f54(278), _0xdf9f54(555), _0xdf9f54(296), _0xdf9f54(1641), _0xdf9f54(1259), _0xdf9f54(902), _0xdf9f54(1269), _0xdf9f54(230), "code", _0xdf9f54(1290), _0xdf9f54(1459), "xdg-open", _0xdf9f54(1137), _0xdf9f54(473), _0xdf9f54(1200), _0xdf9f54(1730), "type", _0xdf9f54(1548), "export", _0xdf9f54(932), "env", "printenv", "set", "unset", "history", "clear", "exit", _0xdf9f54(1386), "killall", "ps", _0xdf9f54(714), _0xdf9f54(1256), "df", "du", _0xdf9f54(1461), "uname", _0xdf9f54(1112), "id", "su", _0xdf9f54(1289), _0xdf9f54(195), _0xdf9f54(372), "ifconfig", "ip", _0xdf9f54(1362), _0xdf9f54(1314), _0xdf9f54(1434), _0xdf9f54(740), _0xdf9f54(406), _0xdf9f54(1056), _0xdf9f54(1440), _0xdf9f54(1737), _0xdf9f54(746), _0xdf9f54(828), _0xdf9f54(1470), _0xdf9f54(882), _0xdf9f54(1608), _0xdf9f54(443), "wc", _0xdf9f54(1017), _0xdf9f54(938), _0xdf9f54(1517), "ln", _0xdf9f54(1169), _0xdf9f54(1796), "file", "xargs", _0xdf9f54(486), _0xdf9f54(1770), _0xdf9f54(451), "tmux", "cron", "crontab", "systemctl", _0xdf9f54(1265), _0xdf9f54(909), _0xdf9f54(475), _0xdf9f54(1525), "az", "gh", _0xdf9f54(1679), "netlify", _0xdf9f54(1777), "fly", "railway"];
    return _0x13a683[_0xdf9f54(1580)](_0x218144);
  }
  [_0x54a1b7(1349)](_0x1c9868) {
    const _0x441c26 = _0x54a1b7;
    if (!_0x1c9868 || _0x1c9868[_0x441c26(1699)]()[_0x441c26(1115)] === 0) return ![];
    const _0x49b81d = _0x1c9868[_0x441c26(1699)](), _0x5e6e59 = /^[a-zA-Z_$][a-zA-Z0-9_$]*(\.[a-zA-Z_$][a-zA-Z0-9_$]*)+\s*\(/;
    if (_0x5e6e59[_0x441c26(1103)](_0x49b81d)) return !![];
    const _0x12eb4a = /^[a-zA-Z_$][a-zA-Z0-9_$]*\.[a-zA-Z_$][a-zA-Z0-9_$]*\s*\(/;
    if (_0x12eb4a[_0x441c26(1103)](_0x49b81d)) return !![];
    const _0x4ee540 = _0x49b81d[_0x441c26(1163)](/[\s.(]/)[0]?.[_0x441c26(1566)]() || "", _0x4f9152 = [_0x441c26(439), _0x441c26(706), "console", "array", _0x441c26(656), _0x441c26(1305), _0x441c26(605), "json", _0x441c26(1385), _0x441c26(1668), "regexp", _0x441c26(1489), "fetch", _0x441c26(952), "sessionstorage", _0x441c26(417), "location", "history", _0x441c26(451), _0x441c26(1353), "error", _0x441c26(306), "set", _0x441c26(203), "weakset", "symbol", "proxy", _0x441c26(321), _0x441c26(136), "webassembly", _0x441c26(855), "sharedarraybuffer", "dataview", "arraybuffer", "uint8array", "int32array", "float64array", _0x441c26(1213), _0x441c26(373), _0x441c26(1409), _0x441c26(560), "exports", _0x441c26(207), "__dirname", "__filename", _0x441c26(1315)];
    if (_0x4f9152[_0x441c26(1580)](_0x4ee540) && _0x49b81d[_0x441c26(1580)](".")) return !![];
    const _0x5672c8 = /^[a-zA-Z_$][a-zA-Z0-9_$]*\s*\(/, _0x1a5135 = [_0x441c26(1409), "fetch", _0x441c26(1012), _0x441c26(1657), "settimeout", "setinterval", "cleartimeout", "clearinterval", _0x441c26(1612), "confirm", _0x441c26(1836), _0x441c26(937), _0x441c26(1109), _0x441c26(1400), _0x441c26(387), "encodeuricomponent", "decodeuricomponent", "encodeuri", "decodeuri", _0x441c26(1401), _0x441c26(1235)];
    if (_0x5672c8[_0x441c26(1103)](_0x49b81d) && _0x1a5135[_0x441c26(1580)](_0x4ee540)) return !![];
    return ![];
  }
  [_0x54a1b7(420)](_0x1ba6ac) {
    const _0x4ddc63 = _0x54a1b7;
    if (!_0x1ba6ac || _0x1ba6ac[_0x4ddc63(1699)]()[_0x4ddc63(1115)] === 0) return ![];
    const _0x3cff8d = _0x1ba6ac[_0x4ddc63(1699)]()[_0x4ddc63(1566)](), _0x414fce = _0x3cff8d[_0x4ddc63(1163)](/\s+/)[0] || "";
    if (_0x414fce[_0x4ddc63(137)]("http://") || _0x414fce[_0x4ddc63(137)]("https://") || _0x414fce[_0x4ddc63(137)](_0x4ddc63(970))) return !![];
    const _0x5c70c5 = /^[a-z0-9]([a-z0-9-]*[a-z0-9])?(\.[a-z0-9]([a-z0-9-]*[a-z0-9])?)+$/;
    if (_0x5c70c5[_0x4ddc63(1103)](_0x414fce)) {
      const _0x5173d1 = [_0x4ddc63(1705), _0x4ddc63(820), _0x4ddc63(1366), _0x4ddc63(540), _0x4ddc63(1501), _0x4ddc63(1355), _0x4ddc63(629), _0x4ddc63(1365), _0x4ddc63(1744), ".dev", _0x4ddc63(1335), _0x4ddc63(919), _0x4ddc63(1392), _0x4ddc63(899), _0x4ddc63(1710), _0x4ddc63(1373), _0x4ddc63(1421), _0x4ddc63(1546), _0x4ddc63(783), _0x4ddc63(1862), _0x4ddc63(509), _0x4ddc63(1003), _0x4ddc63(128), _0x4ddc63(1528), _0x4ddc63(992), _0x4ddc63(247), _0x4ddc63(272), _0x4ddc63(1826), _0x4ddc63(850), _0x4ddc63(468), _0x4ddc63(1841), _0x4ddc63(722), _0x4ddc63(1611), _0x4ddc63(1302), _0x4ddc63(771), _0x4ddc63(1696), _0x4ddc63(329), ".xyz", ".online", _0x4ddc63(1231), _0x4ddc63(345), _0x4ddc63(1472), _0x4ddc63(279)];
      return _0x5173d1[_0x4ddc63(620)]((_0x26093e) => _0x414fce[_0x4ddc63(1583)](_0x26093e));
    }
    return ![];
  }
  [_0x54a1b7(1686)](_0x229650, _0x165044) {
    const _0x167a7d = _0x54a1b7;
    if (this[_0x167a7d(434)](_0x165044)) return !![];
    if (!_0x229650 || _0x229650[_0x167a7d(1699)]()[_0x167a7d(1115)] === 0) return !![];
    if (this[_0x167a7d(151)](_0x229650)) return !![];
    const _0x1fc5f6 = _0x229650[_0x167a7d(1699)](), _0x26950a = [".", "!", "?"], _0x46195c = _0x1fc5f6[_0x167a7d(1830)](_0x1fc5f6[_0x167a7d(1115)] - 1);
    if (_0x26950a[_0x167a7d(1580)](_0x46195c)) return !![];
    const _0x42b652 = [",", ";", ":", "-", "", ""];
    if (_0x42b652[_0x167a7d(1580)](_0x46195c)) return ![];
    if (/[a-zA-Z0-9]$/[_0x167a7d(1103)](_0x1fc5f6)) return ![];
    return !![];
  }
  [_0x54a1b7(151)](_0x27e170) {
    const _0x50de75 = _0x54a1b7;
    if (!_0x27e170) return ![];
    const _0x33ec10 = _0x27e170[_0x50de75(419)](/[\s\u00A0]*$/), _0x2c1c71 = _0x33ec10?.[0] ?? "";
    return /[\r\n\u2028\u2029\u0085]/[_0x50de75(1103)](_0x2c1c71);
  }
}
const grammarRulesService = new GrammarRulesService(), DEFAULT_RESTORE_DELAY_MS = 800;
class ClipboardManager {
  [_0x54a1b7(817)] = null;
  [_0x54a1b7(1212)] = ![];
  [_0x54a1b7(1198)] = 0;
  [_0x54a1b7(1350)] = null;
  [_0x54a1b7(1625)]() {
    const _0x46521b = _0x54a1b7;
    this[_0x46521b(1350)] !== null && log[_0x46521b(1341)](_0x46521b(1601) + this[_0x46521b(1198)] + ")");
    this[_0x46521b(1350)] = null, this[_0x46521b(1198)]++;
    const _0x1385b3 = this[_0x46521b(1198)];
    try {
      this[_0x46521b(817)] = electron[_0x46521b(549)][_0x46521b(1584)](), this[_0x46521b(1212)] = !![], log[_0x46521b(1341)](_0x46521b(1064) + (this[_0x46521b(817)]?.[_0x46521b(1115)] || 0) + _0x46521b(787) + _0x1385b3 + ")");
    } catch (_0x3a6f2e) {
      log[_0x46521b(981)](_0x46521b(1817), _0x3a6f2e), this[_0x46521b(817)] = null, this[_0x46521b(1212)] = ![];
    }
  }
  [_0x54a1b7(788)](_0x5a8573 = DEFAULT_RESTORE_DELAY_MS) {
    const _0x1998eb = _0x54a1b7;
    if (!this[_0x1998eb(1212)]) {
      log[_0x1998eb(1341)]("[ClipboardManager] No saved content to restore");
      return;
    }
    const _0x29c51f = this[_0x1998eb(1198)];
    this[_0x1998eb(1350)] = _0x29c51f, log[_0x1998eb(1341)](_0x1998eb(1040) + _0x5a8573 + _0x1998eb(1604) + _0x29c51f + ")"), setTimeout(() => {
      const _0x21a57a = _0x1998eb;
      if (this[_0x21a57a(1350)] !== _0x29c51f) {
        log[_0x21a57a(1341)](_0x21a57a(1655) + _0x29c51f + _0x21a57a(1412) + this[_0x21a57a(1350)] + ")");
        return;
      }
      try {
        this[_0x21a57a(817)] !== null ? (electron[_0x21a57a(549)][_0x21a57a(1073)](this[_0x21a57a(817)]), log[_0x21a57a(1341)](_0x21a57a(289) + this[_0x21a57a(817)][_0x21a57a(1115)] + _0x21a57a(787) + _0x29c51f + ")")) : (electron[_0x21a57a(549)][_0x21a57a(1723)](), log[_0x21a57a(1341)](_0x21a57a(654) + _0x29c51f + ")"));
      } catch (_0x1abcdf) {
        log[_0x21a57a(981)]("[ClipboardManager] Failed to restore clipboard:", _0x1abcdf);
      } finally {
        this[_0x21a57a(817)] = null, this[_0x21a57a(1212)] = ![], this[_0x21a57a(1350)] = null;
      }
    }, _0x5a8573);
  }
  [_0x54a1b7(464)]() {
    const _0x1a3712 = _0x54a1b7;
    this[_0x1a3712(817)] = null, this[_0x1a3712(1212)] = ![], this[_0x1a3712(1350)] = null, log[_0x1a3712(1341)](_0x1a3712(1663));
  }
  [_0x54a1b7(801)]() {
    const _0x54d6f1 = _0x54a1b7;
    return this[_0x54d6f1(1212)];
  }
}
const clipboardManager = new ClipboardManager(), nativeModuleName$2 = "focused-element-reader", DEFAULT_ELEMENT_RESULT = { "text": null, "isEditable": ![], "role": null, "elementHash": null, "frameX": null, "frameY": null, "frameWidth": null, "frameHeight": null, "appPid": null, "windowId": null }, WINDOWS_DEFAULT_ELEMENT_RESULT = { "text": null, "isEditable": !![], "role": null, "elementHash": null, "frameX": null, "frameY": null, "frameWidth": null, "frameHeight": null, "appPid": null, "windowId": null };
function getFocusedElementInfo() {
  return new Promise((_0x22bdc0) => {
    const _0x4e239b = _0x1d03, _0x102aae = getNativeBinaryPath(nativeModuleName$2);
    if (!_0x102aae) {
      if (os[_0x4e239b(1394)]() === "win32") return _0x22bdc0(WINDOWS_DEFAULT_ELEMENT_RESULT);
      return log[_0x4e239b(981)](_0x4e239b(797) + nativeModuleName$2 + _0x4e239b(1237) + os[_0x4e239b(1394)]() + _0x4e239b(847) + os[_0x4e239b(1129)]()), _0x22bdc0(DEFAULT_ELEMENT_RESULT);
    }
    child_process[_0x4e239b(770)](_0x102aae, [], { "timeout": 2e3 }, (_0x1666bd, _0x1fd851, _0x45041f) => {
      const _0x25ad73 = _0x4e239b;
      if (_0x1666bd) return log[_0x25ad73(981)](_0x25ad73(1038), _0x45041f || _0x1666bd[_0x25ad73(1486)]), _0x22bdc0(DEFAULT_ELEMENT_RESULT);
      try {
        const _0x1b3078 = JSON[_0x25ad73(675)](_0x1fd851[_0x25ad73(1699)]());
        return _0x22bdc0(_0x1b3078);
      } catch (_0xb40fe7) {
        return log[_0x25ad73(981)]("[FocusedElementReader] JSON parse error:", _0xb40fe7), _0x22bdc0(DEFAULT_ELEMENT_RESULT);
      }
    });
  });
}
async function isFocusedElementEditable() {
  const _0x5ece8d = _0x54a1b7, _0x2bd1bc = await getFocusedElementInfo();
  return _0x2bd1bc[_0x5ece8d(612)];
}
async function getFocusedText() {
  const _0x5a37ba = _0x54a1b7, _0x33cdc1 = await getFocusedElementInfo();
  return _0x33cdc1[_0x5a37ba(785)];
}
const focusedElementReader = Object[_0x54a1b7(502)](Object[_0x54a1b7(634)]({ "__proto__": null, "getFocusedElementInfo": getFocusedElementInfo, "getFocusedText": getFocusedText, "isFocusedElementEditable": isFocusedElementEditable }, Symbol[_0x54a1b7(1177)], { "value": _0x54a1b7(1416) })), MAX_INPUT_LENGTH = 8e3, SESSION_TIMEOUT_MS = 6e4, DICTATION_ADD_THRESHOLD = 10, DICTATION_DELETE_THRESHOLD = 20, POLLING_INTERVAL_MS = 1e3, DEBUG = process[_0x54a1b7(1498)][_0x54a1b7(378)] === _0x54a1b7(1034), LOG_PREFIX = "[EditSession]";
function debugLog(..._0x1f3017) {
  const _0x4c124b = _0x54a1b7;
  DEBUG && console[_0x4c124b(926)](LOG_PREFIX, ..._0x1f3017);
}
class EditSessionManager {
  [_0x54a1b7(685)] = null;
  [_0x54a1b7(320)] = ![];
  [_0x54a1b7(718)] = null;
  async [_0x54a1b7(1854)](_0x1f3ac9) {
    const _0x3a58d5 = _0x54a1b7;
    debugLog("startSession() called for dictation:", _0x1f3ac9);
    this[_0x3a58d5(685)] && this[_0x3a58d5(755)]("new_dictation_started")[_0x3a58d5(564)](() => {
    });
    try {
      const _0x3fe560 = await getFocusedElementInfo(), _0x568a75 = _0x3fe560[_0x3a58d5(785)];
      if (_0x568a75 === null || _0x568a75 === void 0) {
        debugLog("No focused text field (null/undefined) - skipping session");
        return;
      }
      debugLog(_0x3a58d5(1469) + _0x568a75[_0x3a58d5(350)](0, 50) + (_0x568a75[_0x3a58d5(1115)] > 50 ? _0x3a58d5(875) : "") + _0x3a58d5(934) + _0x568a75[_0x3a58d5(1115)] + ")");
      if (_0x568a75[_0x3a58d5(1115)] > MAX_INPUT_LENGTH) {
        debugLog("Text too long - skipping session");
        return;
      }
      const _0x1cf8a2 = { "elementHash": _0x3fe560[_0x3a58d5(931)], "appPid": _0x3fe560[_0x3a58d5(979)], "windowId": _0x3fe560[_0x3a58d5(858)] };
      let _0x3e034a = null;
      try {
        const _0x5f0be0 = await getActiveWindow();
        _0x3e034a = _0x5f0be0?.[_0x3a58d5(1856)] || null, debugLog("Captured app name:", _0x3e034a);
      } catch (_0x43ec1b) {
        debugLog("Failed to get active window:", _0x43ec1b);
      }
      this[_0x3a58d5(685)] = { "preDictationText": _0x568a75, "postPasteText": "", "insertedTranscript": "", "dictationStartIndex": _0x568a75[_0x3a58d5(1115)], "dictationEndIndex": _0x568a75[_0x3a58d5(1115)], "dictationId": _0x1f3ac9, "startTime": Date[_0x3a58d5(1536)](), "timeoutId": null, "lastKnownText": null, "originalElement": _0x1cf8a2, "appName": _0x3e034a }, debugLog("Session started, pre-text length:", _0x568a75[_0x3a58d5(1115)], "element hash:", _0x1cf8a2[_0x3a58d5(931)], _0x3a58d5(1820), _0x3e034a);
    } catch (_0x1a752d) {
      log[_0x3a58d5(981)](LOG_PREFIX + _0x3a58d5(1076), _0x1a752d);
    }
  }
  async [_0x54a1b7(1369)](_0x4a1980) {
    const _0x5c57ef = _0x54a1b7;
    debugLog("onTranscriptPasted() called");
    if (!this[_0x5c57ef(685)]) {
      debugLog("No active session - skipping");
      return;
    }
    try {
      await new Promise((_0x2e8315) => setTimeout(_0x2e8315, 100));
      const _0x2a1d00 = await getFocusedText();
      if (_0x2a1d00 === null || _0x2a1d00[_0x5c57ef(1115)] > MAX_INPUT_LENGTH) {
        debugLog("Post-paste text invalid - clearing session"), this[_0x5c57ef(144)]();
        return;
      }
      const _0x473e2c = this[_0x5c57ef(1151)](this[_0x5c57ef(685)][_0x5c57ef(1070)], _0x2a1d00, _0x4a1980);
      if (!_0x473e2c) {
        debugLog("Could not determine insertion point - clearing session"), this[_0x5c57ef(144)]();
        return;
      }
      this[_0x5c57ef(685)][_0x5c57ef(1189)] = _0x2a1d00, this[_0x5c57ef(685)][_0x5c57ef(1512)] = _0x4a1980, this[_0x5c57ef(685)][_0x5c57ef(344)] = _0x473e2c[_0x5c57ef(1582)], this[_0x5c57ef(685)][_0x5c57ef(1622)] = _0x473e2c[_0x5c57ef(1631)], this[_0x5c57ef(685)][_0x5c57ef(1474)] = _0x2a1d00, this[_0x5c57ef(685)][_0x5c57ef(186)] = setTimeout(() => {
        const _0x1d3114 = _0x5c57ef;
        this[_0x1d3114(755)](_0x1d3114(775))[_0x1d3114(564)](() => {
        });
      }, SESSION_TIMEOUT_MS), this[_0x5c57ef(185)](), debugLog("Transcript paste captured, insertion at:", _0x473e2c[_0x5c57ef(1582)], "-", _0x473e2c[_0x5c57ef(1631)]);
    } catch (_0x46c905) {
      log[_0x5c57ef(981)](LOG_PREFIX + _0x5c57ef(1726), _0x46c905), this[_0x5c57ef(144)]();
    }
  }
  async [_0x54a1b7(755)](_0x395f42 = _0x54a1b7(1141), _0x3390b3) {
    const _0x3d9037 = _0x54a1b7;
    debugLog("endSession() called, reason:", _0x395f42);
    if (!this[_0x3d9037(685)] || this[_0x3d9037(320)]) return;
    this[_0x3d9037(685)][_0x3d9037(186)] && clearTimeout(this[_0x3d9037(685)][_0x3d9037(186)]);
    this[_0x3d9037(335)]();
    if (!this[_0x3d9037(685)][_0x3d9037(1189)]) {
      this[_0x3d9037(144)]();
      return;
    }
    this[_0x3d9037(320)] = !![];
    const _0x523df4 = this[_0x3d9037(685)];
    this[_0x3d9037(685)] = null;
    const _0x2f9d05 = _0x523df4[_0x3d9037(1856)];
    debugLog(_0x3d9037(1485) + _0x2f9d05 + _0x3d9037(1279) + _0x395f42);
    try {
      const _0x982c99 = _0x3390b3 ?? await getFocusedText();
      debugLog(_0x3d9037(1749) + (_0x982c99?.[_0x3d9037(1115)] ?? _0x3d9037(1431)) + _0x3d9037(694) + _0x523df4[_0x3d9037(1189)][_0x3d9037(1115)]);
      if (_0x982c99 === null || _0x982c99[_0x3d9037(1115)] > MAX_INPUT_LENGTH) {
        debugLog("Final text invalid - skipping analysis");
        return;
      }
      await this[_0x3d9037(524)](_0x523df4, _0x982c99, _0x2f9d05);
    } catch (_0xc94afc) {
      log[_0x3d9037(981)](LOG_PREFIX + _0x3d9037(340), _0xc94afc);
    } finally {
      this[_0x3d9037(320)] = ![];
    }
  }
  [_0x54a1b7(1165)](_0x4e4862, _0xc622fe) {
    const _0x22433d = _0x54a1b7;
    if (!_0x4e4862) return !![];
    if (_0x4e4862[_0x22433d(979)] !== null && _0xc622fe[_0x22433d(979)] !== _0x4e4862[_0x22433d(979)]) return debugLog(_0x22433d(1479), _0x4e4862[_0x22433d(979)], "->", _0xc622fe[_0x22433d(979)]), ![];
    if (_0x4e4862[_0x22433d(858)] !== null && _0xc622fe[_0x22433d(858)] !== null && _0x4e4862[_0x22433d(858)] !== _0xc622fe[_0x22433d(858)]) return debugLog(_0x22433d(827), _0x4e4862[_0x22433d(858)], "->", _0xc622fe[_0x22433d(858)]), ![];
    if (_0x4e4862[_0x22433d(931)] !== null && _0xc622fe[_0x22433d(931)] !== null) {
      const _0x546b82 = (_0x1d19c4) => {
        const _0x4586c5 = _0x22433d, _0x3013b7 = _0x1d19c4[_0x4586c5(1163)]("|"), _0x225484 = _0x3013b7[_0x4586c5(1380)]((_0x2c7e59) => _0x2c7e59[_0x4586c5(137)](_0x4586c5(845)) || _0x2c7e59[_0x4586c5(137)]("id:") || _0x2c7e59[_0x4586c5(137)](_0x4586c5(520)));
        return _0x225484[_0x4586c5(1638)]("|");
      }, _0x189bd5 = _0x546b82(_0x4e4862[_0x22433d(931)]), _0x3bd9c3 = _0x546b82(_0xc622fe[_0x22433d(931)]);
      if (_0x189bd5 !== _0x3bd9c3) return debugLog("Element identity changed:", _0x189bd5, "->", _0x3bd9c3), ![];
    }
    return !![];
  }
  async [_0x54a1b7(1367)]() {
    const _0x370200 = _0x54a1b7;
    if (!this[_0x370200(685)] || !this[_0x370200(685)][_0x370200(1189)]) return ![];
    try {
      const _0x511be6 = await getFocusedElementInfo(), _0x111093 = _0x511be6[_0x370200(785)], _0x2099cf = _0x511be6[_0x370200(612)];
      if (!this[_0x370200(1165)](this[_0x370200(685)][_0x370200(226)], _0x511be6)) return debugLog("Focus moved to different element - skipping check (session continues)"), ![];
      if (_0x2099cf && (_0x111093 === null || _0x111093[_0x370200(1699)]()[_0x370200(1115)] === 0)) {
        const _0x4ff6ce = this[_0x370200(685)][_0x370200(1474)];
        if (_0x4ff6ce && _0x4ff6ce[_0x370200(1699)]()[_0x370200(1115)] > 0) return debugLog("Input cleared - ending session with last known state, lastKnownText length:", _0x4ff6ce[_0x370200(1115)]), this[_0x370200(755)]("input_cleared", _0x4ff6ce)[_0x370200(564)](() => {
        }), !![];
        return debugLog("Input cleared but no last known text - clearing session"), this[_0x370200(144)](), !![];
      }
      if (!_0x2099cf || _0x111093 === null) return debugLog("Focus not on editable field - skipping check"), ![];
      const _0x584d8f = this[_0x370200(685)][_0x370200(1474)];
      this[_0x370200(685)][_0x370200(1474)] = _0x111093;
      if (_0x111093[_0x370200(1115)] > MAX_INPUT_LENGTH) return this[_0x370200(755)](_0x370200(525))[_0x370200(564)](() => {
      }), !![];
      const _0x56be26 = this[_0x370200(685)], _0x4794cb = _0x56be26[_0x370200(1189)], _0x5565a4 = _0x4794cb[_0x370200(350)](0, _0x56be26[_0x370200(344)]), _0x27b499 = _0x4794cb[_0x370200(350)](_0x56be26[_0x370200(1622)]), _0x308a19 = _0x111093[_0x370200(350)](0, _0x56be26[_0x370200(344)]);
      if (_0x308a19 !== _0x5565a4) return this[_0x370200(755)]("edit_outside_dictation")[_0x370200(564)](() => {
      }), !![];
      if (_0x27b499) {
        const _0x39881a = _0x111093[_0x370200(350)](_0x111093[_0x370200(1115)] - _0x27b499[_0x370200(1115)]);
        if (_0x39881a !== _0x27b499) return this[_0x370200(755)]("edit_outside_dictation")[_0x370200(564)](() => {
        }), !![];
      } else {
        if (_0x584d8f) {
          if (_0x111093[_0x370200(1115)] > _0x584d8f[_0x370200(1115)] && _0x111093[_0x370200(137)](_0x584d8f)) {
            const _0x4bef7b = _0x111093[_0x370200(350)](_0x584d8f[_0x370200(1115)]), _0xc36078 = _0x584d8f[_0x370200(1115)] > 0 ? _0x584d8f[_0x584d8f[_0x370200(1115)] - 1] : "";
            if (/\s/[_0x370200(1103)](_0x4bef7b) || /\s/[_0x370200(1103)](_0xc36078)) return debugLog(_0x370200(1005) + _0x4bef7b[_0x370200(350)](0, 20) + _0x370200(1202)), this[_0x370200(755)]("edit_outside_dictation")[_0x370200(564)](() => {
            }), !![];
          }
        }
      }
      const _0x5e4df2 = _0x111093[_0x370200(1115)] - _0x27b499[_0x370200(1115)], _0x3b9c47 = _0x111093[_0x370200(350)](_0x56be26[_0x370200(344)], _0x5e4df2), _0x409205 = _0x4794cb[_0x370200(350)](_0x56be26[_0x370200(344)], _0x56be26[_0x370200(1622)]), _0x352279 = _0x409205[_0x370200(1115)] - _0x3b9c47[_0x370200(1115)];
      if (_0x352279 >= DICTATION_DELETE_THRESHOLD) return this[_0x370200(755)](_0x370200(525))[_0x370200(564)](() => {
      }), !![];
      const _0x2c687 = _0x3b9c47[_0x370200(1115)] - _0x409205[_0x370200(1115)];
      if (_0x2c687 >= DICTATION_ADD_THRESHOLD) return this[_0x370200(755)](_0x370200(525))[_0x370200(564)](() => {
      }), !![];
      return ![];
    } catch (_0x5da4cb) {
      return log[_0x370200(981)](LOG_PREFIX + _0x370200(556), _0x5da4cb), ![];
    }
  }
  [_0x54a1b7(1754)]() {
    const _0x32f52a = _0x54a1b7;
    return this[_0x32f52a(685)] !== null;
  }
  [_0x54a1b7(1151)](_0x4f53b3, _0x2b76dd, _0x5c11bf) {
    const _0x2b0ffd = _0x54a1b7;
    if (_0x2b76dd[_0x2b0ffd(1583)](_0x5c11bf) && _0x2b76dd[_0x2b0ffd(137)](_0x4f53b3)) return { "startIndex": _0x4f53b3[_0x2b0ffd(1115)], "endIndex": _0x2b76dd[_0x2b0ffd(1115)] };
    const _0x4848e9 = _0x2b76dd[_0x2b0ffd(1257)](_0x5c11bf);
    if (_0x4848e9 !== -1) return { "startIndex": _0x4848e9, "endIndex": _0x4848e9 + _0x5c11bf[_0x2b0ffd(1115)] };
    let _0x225d06 = 0;
    const _0x4a160a = Math[_0x2b0ffd(1125)](_0x4f53b3[_0x2b0ffd(1115)], _0x2b76dd[_0x2b0ffd(1115)]);
    for (let _0x498ab1 = 0; _0x498ab1 < _0x4a160a; _0x498ab1++) {
      if (_0x4f53b3[_0x498ab1] === _0x2b76dd[_0x498ab1]) _0x225d06++;
      else break;
    }
    let _0x356018 = 0;
    for (let _0x291d2f = 0; _0x291d2f < _0x4a160a - _0x225d06; _0x291d2f++) {
      if (_0x4f53b3[_0x4f53b3[_0x2b0ffd(1115)] - 1 - _0x291d2f] === _0x2b76dd[_0x2b76dd[_0x2b0ffd(1115)] - 1 - _0x291d2f]) _0x356018++;
      else break;
    }
    const _0x838057 = _0x225d06, _0x23021c = _0x2b76dd[_0x2b0ffd(1115)] - _0x356018;
    return _0x23021c > _0x838057 ? { "startIndex": _0x838057, "endIndex": _0x23021c } : null;
  }
  [_0x54a1b7(1542)](_0x402525) {
    const _0x469be5 = _0x54a1b7;
    return /[\u3040-\u309F\u30A0-\u30FF\u4E00-\u9FFF\u31F0-\u31FF\uFF65-\uFF9F]/[_0x469be5(1103)](_0x402525);
  }
  [_0x54a1b7(1624)](_0x3bfc31) {
    const _0x2b45c6 = _0x54a1b7, _0xeb6b = [], _0x2eba99 = /[]/, _0xaa7dd1 = /[\u4E00-\u9FFF\u30A0-\u30FF\u31F0-\u31FF\uFF65-\uFF9F]+[\u3040-\u309F]*|[\u3040-\u309F]+|[A-Za-z][A-Za-z0-9'-]*|[0-9]+/g;
    let _0x2a88eb;
    while ((_0x2a88eb = _0xaa7dd1[_0x2b45c6(1083)](_0x3bfc31)) !== null) {
      const _0x2ab86c = _0x2a88eb[0];
      if (_0x2ab86c[_0x2b45c6(1115)] === 1 && _0x2eba99[_0x2b45c6(1103)](_0x2ab86c)) continue;
      if (/^[\u3040-\u309F]+$/[_0x2b45c6(1103)](_0x2ab86c) && _0x2ab86c[_0x2b45c6(1115)] > 1) {
        const _0x283630 = _0x2ab86c[_0x2b45c6(1163)]("")[_0x2b45c6(1380)]((_0x21f0cc) => !_0x2eba99[_0x2b45c6(1103)](_0x21f0cc));
        if (_0x283630[_0x2b45c6(1115)] === 0) continue;
        let _0x39b095 = _0x2a88eb[_0x2b45c6(1454)], _0x5440cc = "", _0xc25fcc = _0x2a88eb[_0x2b45c6(1454)];
        for (const _0x1e389d of _0x2ab86c) {
          _0x2eba99[_0x2b45c6(1103)](_0x1e389d) ? (_0x5440cc[_0x2b45c6(1115)] > 0 && _0xeb6b[_0x2b45c6(529)]({ "word": _0x5440cc, "startIndex": _0xc25fcc, "endIndex": _0xc25fcc + _0x5440cc[_0x2b45c6(1115)] }), _0x39b095++, _0x5440cc = "", _0xc25fcc = _0x39b095) : (_0x5440cc[_0x2b45c6(1115)] === 0 && (_0xc25fcc = _0x39b095), _0x5440cc += _0x1e389d, _0x39b095++);
        }
        _0x5440cc[_0x2b45c6(1115)] > 0 && _0xeb6b[_0x2b45c6(529)]({ "word": _0x5440cc, "startIndex": _0xc25fcc, "endIndex": _0xc25fcc + _0x5440cc[_0x2b45c6(1115)] });
      } else _0xeb6b[_0x2b45c6(529)]({ "word": _0x2ab86c, "startIndex": _0x2a88eb[_0x2b45c6(1454)], "endIndex": _0x2a88eb[_0x2b45c6(1454)] + _0x2ab86c[_0x2b45c6(1115)] });
    }
    return _0xeb6b;
  }
  [_0x54a1b7(655)](_0x45a355) {
    const _0x227f59 = _0x54a1b7;
    if (this[_0x227f59(1542)](_0x45a355)) return this[_0x227f59(1624)](_0x45a355);
    const _0x3ee8ed = [], _0x1fb7d5 = /\b[\w'-]+\b/g;
    let _0x3b361e;
    while ((_0x3b361e = _0x1fb7d5[_0x227f59(1083)](_0x45a355)) !== null) {
      _0x3ee8ed[_0x227f59(529)]({ "word": _0x3b361e[0], "startIndex": _0x3b361e[_0x227f59(1454)], "endIndex": _0x3b361e[_0x227f59(1454)] + _0x3b361e[0][_0x227f59(1115)] });
    }
    return _0x3ee8ed;
  }
  async [_0x54a1b7(524)](_0x263211, _0x4e6589, _0x370119) {
    const _0x27196c = _0x54a1b7, _0x583c12 = _0x263211[_0x27196c(1189)][_0x27196c(350)](_0x263211[_0x27196c(344)], _0x263211[_0x27196c(1622)]), _0x30fcc4 = _0x263211[_0x27196c(344)], _0x5ab0d5 = _0x263211[_0x27196c(1189)][_0x27196c(350)](_0x263211[_0x27196c(1622)]), _0x172f37 = _0x4e6589[_0x27196c(1115)] - _0x5ab0d5[_0x27196c(1115)];
    if (_0x172f37 <= _0x30fcc4) {
      debugLog("Dictation section was deleted");
      return;
    }
    const _0x5ba74c = _0x4e6589[_0x27196c(350)](_0x30fcc4, _0x172f37);
    log[_0x27196c(1341)](LOG_PREFIX + _0x27196c(150) + _0x583c12 + _0x27196c(998) + _0x5ba74c + '"');
    const _0x496da9 = this[_0x27196c(655)](_0x583c12), _0x4a0dbc = this[_0x27196c(655)](_0x5ba74c), _0x38fad9 = this[_0x27196c(999)](_0x496da9, _0x4a0dbc, _0x583c12, _0x5ba74c);
    if (_0x38fad9[_0x27196c(1115)] === 0) {
      debugLog("No word modifications detected");
      return;
    }
    debugLog(_0x27196c(768) + _0x38fad9[_0x27196c(1115)] + _0x27196c(984) + _0x370119), _0x38fad9[_0x27196c(878)]((_0x21a599, _0x1b304c) => {
      const _0x1d6f7d = _0x27196c;
      debugLog(_0x1d6f7d(1417) + _0x1b304c + _0x1d6f7d(1354) + _0x21a599[_0x1d6f7d(725)] + _0x1d6f7d(998) + _0x21a599[_0x1d6f7d(1271)] + '"');
    }), await this[_0x27196c(1048)](_0x38fad9, _0x370119);
  }
  [_0x54a1b7(999)](_0x31e39c, _0x36e7f2, _0x29c7cb, _0x4f4545) {
    const _0x2f614f = _0x54a1b7, _0x1081c7 = [];
    if (_0x31e39c[_0x2f614f(1115)] >= 2 && _0x36e7f2[_0x2f614f(1115)] === 1) {
      const _0x36fc92 = _0x36e7f2[0][_0x2f614f(865)], _0x3054d4 = _0x29c7cb[_0x2f614f(1699)]();
      if (_0x36fc92[_0x2f614f(1115)] < _0x3054d4[_0x2f614f(1115)]) return debugLog(_0x2f614f(333) + _0x3054d4 + _0x2f614f(998) + _0x36fc92 + '"'), _0x1081c7[_0x2f614f(529)]({ "before": _0x3054d4, "after": _0x36fc92, "position": 0 }), _0x1081c7;
    }
    if (_0x31e39c[_0x2f614f(1115)] > _0x36e7f2[_0x2f614f(1115)]) {
      let _0x5d7262 = 0;
      for (let _0x847efa = 0; _0x847efa < Math[_0x2f614f(1125)](_0x31e39c[_0x2f614f(1115)], _0x36e7f2[_0x2f614f(1115)]); _0x847efa++) {
        if (_0x31e39c[_0x847efa][_0x2f614f(865)] === _0x36e7f2[_0x847efa][_0x2f614f(865)]) _0x5d7262++;
        else break;
      }
      let _0x22d7fd = 0;
      for (let _0x445889 = 0; _0x445889 < Math[_0x2f614f(1125)](_0x31e39c[_0x2f614f(1115)], _0x36e7f2[_0x2f614f(1115)]) - _0x5d7262; _0x445889++) {
        const _0x21f2ce = _0x31e39c[_0x2f614f(1115)] - 1 - _0x445889, _0x57be07 = _0x36e7f2[_0x2f614f(1115)] - 1 - _0x445889;
        if (_0x31e39c[_0x21f2ce][_0x2f614f(865)] === _0x36e7f2[_0x57be07][_0x2f614f(865)]) _0x22d7fd++;
        else break;
      }
      const _0x1ef2dd = _0x5d7262, _0x50c289 = _0x31e39c[_0x2f614f(1115)] - _0x22d7fd, _0x2951d9 = _0x31e39c[_0x2f614f(337)](_0x1ef2dd, _0x50c289), _0x2d2523 = _0x5d7262, _0x275638 = _0x36e7f2[_0x2f614f(1115)] - _0x22d7fd, _0x76d61f = _0x36e7f2[_0x2f614f(337)](_0x2d2523, _0x275638);
      if (_0x2951d9[_0x2f614f(1115)] >= 2 && _0x76d61f[_0x2f614f(1115)] === 1) {
        const _0x171896 = _0x2951d9[_0x2f614f(306)]((_0xa2f8ed) => _0xa2f8ed[_0x2f614f(865)])[_0x2f614f(1638)](" "), _0x5cd1e6 = _0x76d61f[0][_0x2f614f(865)];
        if (_0x5cd1e6[_0x2f614f(1115)] < _0x171896[_0x2f614f(1115)]) return debugLog(_0x2f614f(1176) + _0x171896 + _0x2f614f(998) + _0x5cd1e6 + '"'), _0x1081c7[_0x2f614f(529)]({ "before": _0x171896, "after": _0x5cd1e6, "position": _0x1ef2dd }), _0x1081c7;
      }
    }
    const _0x385a93 = Math[_0x2f614f(1507)](_0x31e39c[_0x2f614f(1115)], _0x36e7f2[_0x2f614f(1115)]);
    for (let _0x39b88c = 0; _0x39b88c < _0x385a93; _0x39b88c++) {
      const _0x421ed1 = _0x31e39c[_0x39b88c], _0x4b625a = _0x36e7f2[_0x39b88c];
      _0x421ed1 && _0x4b625a && _0x421ed1[_0x2f614f(865)] !== _0x4b625a[_0x2f614f(865)] && _0x1081c7[_0x2f614f(529)]({ "before": _0x421ed1[_0x2f614f(865)], "after": _0x4b625a[_0x2f614f(865)], "position": _0x39b88c });
    }
    return _0x1081c7;
  }
  async [_0x54a1b7(1048)](_0x1d237c, _0x4f3ed9) {
    const _0x469798 = _0x54a1b7;
    try {
      const _0x2a843e = await grpcClient[_0x469798(1455)](_0x1d237c);
      if (_0x2a843e?.[_0x469798(310)] && _0x2a843e[_0x469798(682)]) {
        const _0x378e56 = _0x2a843e[_0x469798(607)] ? _0x469798(1596) + _0x2a843e[_0x469798(607)] + ")" : "";
        log[_0x469798(1341)](LOG_PREFIX + _0x469798(1626) + _0x2a843e[_0x469798(682)] + '"' + _0x378e56 + _0x469798(977) + _0x2a843e[_0x469798(383)]);
        const _0x2b69d2 = _0x1d237c[_0x469798(445)]((_0x2e92e1) => _0x2e92e1[_0x469798(1271)] === _0x2a843e[_0x469798(682)]);
        await this[_0x469798(901)](_0x2a843e[_0x469798(682)], _0x2b69d2?.[_0x469798(725)], _0x2a843e[_0x469798(607)]);
        return;
      }
      debugLog("LLM rejected keyword addition:", _0x2a843e?.[_0x469798(383)]);
      const _0x3e662e = await grpcClient[_0x469798(239)](_0x1d237c);
      _0x3e662e?.[_0x469798(310)] && _0x3e662e[_0x469798(1560)] && _0x3e662e[_0x469798(743)] && _0x3e662e[_0x469798(1154)] ? (log[_0x469798(1341)](LOG_PREFIX + _0x469798(231) + _0x3e662e[_0x469798(743)] + _0x469798(998) + _0x3e662e[_0x469798(1560)] + _0x469798(1114) + _0x3e662e[_0x469798(1154)] + _0x469798(1085) + _0x3e662e[_0x469798(383)]), await this[_0x469798(479)](_0x3e662e[_0x469798(1560)], _0x3e662e[_0x469798(743)], _0x3e662e[_0x469798(1154)], _0x4f3ed9)) : debugLog("LLM rejected abbreviation addition:", _0x3e662e?.[_0x469798(383)]);
    } catch (_0x5276c0) {
      log[_0x469798(981)](LOG_PREFIX + _0x469798(1140), _0x5276c0);
    }
  }
  async [_0x54a1b7(479)](_0x28f562, _0x52eff3, _0x4e74c1, _0x34a0b9) {
    const _0x1c147a = _0x54a1b7;
    try {
      const _0x530ee5 = getCurrentUserId();
      if (!_0x530ee5) {
        log[_0x1c147a(1697)](LOG_PREFIX + _0x1c147a(1292));
        return;
      }
      let _0x1013c0 = null;
      _0x4e74c1 === _0x1c147a(463) && _0x34a0b9 ? (_0x1013c0 = [_0x34a0b9], debugLog(_0x1c147a(1711) + _0x28f562 + _0x1c147a(1015) + _0x34a0b9)) : debugLog(_0x1c147a(697) + _0x28f562 + _0x1c147a(844));
      const _0x231e2f = await DictionaryTable[_0x1c147a(1306)]({ "user_id": _0x530ee5, "text": _0x28f562, "description": _0x52eff3, "app_identifiers": _0x1013c0 });
      if (_0x231e2f[_0x1c147a(522)] && _0x231e2f[_0x1c147a(1135)]) {
        const _0x1dbaa0 = _0x231e2f[_0x1c147a(1656)] && _0x231e2f[_0x1c147a(197)] && _0x231e2f[_0x1c147a(197)][_0x1c147a(1115)] > 0;
        let _0x1fd324;
        if (_0x4e74c1 === _0x1c147a(463) && _0x34a0b9) _0x1fd324 = _0x34a0b9;
        else _0x1dbaa0 && (_0x1fd324 = _0x231e2f[_0x1c147a(197)][0]);
        const _0x129420 = _0x1fd324 ? appIconCache[_0x1c147a(1043)](_0x1fd324) || void 0 : void 0;
        log[_0x1c147a(1341)](LOG_PREFIX + _0x1c147a(1027) + _0x52eff3 + _0x1c147a(998) + _0x28f562 + _0x1c147a(1114) + _0x4e74c1 + ")" + (_0x1fd324 ? _0x1c147a(987) + _0x1fd324 : "") + (_0x1dbaa0 ? _0x1c147a(297) : ""));
        const _0x391162 = getPillWindow();
        if (_0x391162 && !_0x391162[_0x1c147a(496)]()) {
          const _0x138180 = { "keyword": _0x28f562, "keywordId": _0x231e2f[_0x1c147a(1135)]["id"], "originalWord": _0x52eff3, "addedApp": _0x1fd324, "addedAppIcon": _0x129420 };
          _0x391162[_0x1c147a(890)][_0x1c147a(965)](IPC_EVENTS[_0x1c147a(898)], _0x138180);
        }
        mainWindow && !mainWindow[_0x1c147a(496)]() && mainWindow[_0x1c147a(890)][_0x1c147a(965)](IPC_EVENTS[_0x1c147a(1002)]);
      } else !_0x231e2f[_0x1c147a(522)] && debugLog("Failed to add abbreviation:", _0x231e2f[_0x1c147a(981)]);
    } catch (_0x1ca307) {
      log[_0x1c147a(981)](LOG_PREFIX + _0x1c147a(1549), _0x1ca307);
    }
  }
  async [_0x54a1b7(901)](_0x1b7eb5, _0x5caccd, _0x4518be) {
    const _0x16e04d = _0x54a1b7;
    try {
      const _0x2c5295 = getCurrentUserId();
      if (!_0x2c5295) {
        log[_0x16e04d(1697)](LOG_PREFIX + _0x16e04d(229));
        return;
      }
      const _0x5bf844 = await DictionaryTable[_0x16e04d(1306)]({ "user_id": _0x2c5295, "text": _0x1b7eb5, "description": _0x4518be || null, "app_identifiers": null });
      if (_0x5bf844[_0x16e04d(522)] && _0x5bf844[_0x16e04d(1135)]) {
        const _0x391185 = _0x4518be ? _0x16e04d(1596) + _0x4518be + ")" : "";
        log[_0x16e04d(1341)](LOG_PREFIX + _0x16e04d(732) + _0x1b7eb5 + '"' + _0x391185);
        const _0x349cac = getPillWindow();
        if (_0x349cac && !_0x349cac[_0x16e04d(496)]()) {
          const _0x52f266 = { "keyword": _0x1b7eb5, "keywordId": _0x5bf844[_0x16e04d(1135)]["id"], "originalWord": _0x5caccd || _0x4518be || void 0 };
          _0x349cac[_0x16e04d(890)][_0x16e04d(965)](IPC_EVENTS[_0x16e04d(898)], _0x52f266);
        }
        mainWindow && !mainWindow[_0x16e04d(496)]() && mainWindow[_0x16e04d(890)][_0x16e04d(965)](IPC_EVENTS[_0x16e04d(1002)]);
      } else !_0x5bf844[_0x16e04d(522)] && debugLog("Failed to add keyword:", _0x5bf844[_0x16e04d(981)]);
    } catch (_0x4936a2) {
      log[_0x16e04d(981)](LOG_PREFIX + _0x16e04d(1228), _0x4936a2);
    }
  }
  [_0x54a1b7(144)]() {
    const _0xd59ac5 = _0x54a1b7;
    this[_0xd59ac5(335)](), this[_0xd59ac5(685)]?.[_0xd59ac5(186)] && clearTimeout(this[_0xd59ac5(685)][_0xd59ac5(186)]), this[_0xd59ac5(685)] = null;
  }
  [_0x54a1b7(185)]() {
    const _0x19f5ca = _0x54a1b7;
    this[_0x19f5ca(335)](), this[_0x19f5ca(718)] = setInterval(() => {
      const _0x3da237 = _0x19f5ca;
      this[_0x3da237(1367)]()[_0x3da237(564)](() => {
      });
    }, POLLING_INTERVAL_MS), debugLog(_0x19f5ca(1199));
  }
  [_0x54a1b7(335)]() {
    const _0x130c11 = _0x54a1b7;
    this[_0x130c11(718)] && (clearInterval(this[_0x130c11(718)]), this[_0x130c11(718)] = null, debugLog(_0x130c11(1379)));
  }
}
const editSessionManager = new EditSessionManager(), MAX_MESSAGES = 20;
class ChatSessionManager {
  [_0x54a1b7(1197)] = null;
  [_0x54a1b7(375)] = [];
  [_0x54a1b7(1418)] = ![];
  [_0x54a1b7(1854)](_0x264436) {
    const _0x4c96eb = _0x54a1b7;
    log[_0x4c96eb(1341)]("[ChatSessionManager] Starting new chat session", { "hasOcrText": !!_0x264436[_0x4c96eb(1751)], "hasSelectedText": !!_0x264436[_0x4c96eb(493)], "appName": _0x264436[_0x4c96eb(1856)], "originalTranscript": _0x264436[_0x4c96eb(1672)]?.[_0x4c96eb(350)](0, 50) }), this[_0x4c96eb(1197)] = _0x264436, this[_0x4c96eb(375)] = [], this[_0x4c96eb(1418)] = !![], _0x264436[_0x4c96eb(1672)] && this[_0x4c96eb(375)][_0x4c96eb(529)]({ "role": _0x4c96eb(1067), "content": _0x264436[_0x4c96eb(1672)] }), _0x264436[_0x4c96eb(147)] && this[_0x4c96eb(375)][_0x4c96eb(529)]({ "role": _0x4c96eb(261), "content": _0x264436[_0x4c96eb(147)] });
  }
  [_0x54a1b7(1433)](_0x306045) {
    const _0xf4a29a = _0x54a1b7;
    if (!this[_0xf4a29a(1418)]) {
      log[_0xf4a29a(1697)]("[ChatSessionManager] Cannot add message - no active session");
      return;
    }
    this[_0xf4a29a(375)][_0xf4a29a(529)]({ "role": _0xf4a29a(1067), "content": _0x306045 }), this[_0xf4a29a(431)](), log[_0xf4a29a(1341)]("[ChatSessionManager] Added user message", { "messageCount": this[_0xf4a29a(375)][_0xf4a29a(1115)] });
  }
  [_0x54a1b7(737)](_0x39f0d8) {
    const _0x486e98 = _0x54a1b7;
    if (!this[_0x486e98(1418)]) {
      log[_0x486e98(1697)]("[ChatSessionManager] Cannot add message - no active session");
      return;
    }
    this[_0x486e98(375)][_0x486e98(529)]({ "role": _0x486e98(261), "content": _0x39f0d8 }), this[_0x486e98(431)](), log[_0x486e98(1341)]("[ChatSessionManager] Added assistant message", { "messageCount": this[_0x486e98(375)][_0x486e98(1115)] });
  }
  [_0x54a1b7(798)]() {
    const _0xf48a28 = _0x54a1b7;
    return [...this[_0xf48a28(375)]];
  }
  [_0x54a1b7(986)]() {
    const _0x34cb4b = _0x54a1b7;
    return [...this[_0x34cb4b(375)]];
  }
  [_0x54a1b7(1791)]() {
    const _0x1b4a0a = _0x54a1b7;
    return this[_0x1b4a0a(1197)];
  }
  get [_0x54a1b7(1727)]() {
    const _0x3b231e = _0x54a1b7;
    return this[_0x3b231e(1418)];
  }
  [_0x54a1b7(755)]() {
    const _0x1454f5 = _0x54a1b7;
    this[_0x1454f5(1418)] && log[_0x1454f5(1341)]("[ChatSessionManager] Ending chat session", { "messageCount": this[_0x1454f5(375)][_0x1454f5(1115)] }), this[_0x1454f5(1197)] = null, this[_0x1454f5(375)] = [], this[_0x1454f5(1418)] = ![];
  }
  [_0x54a1b7(431)]() {
    const _0x86cc1e = _0x54a1b7;
    if (this[_0x86cc1e(375)][_0x86cc1e(1115)] > MAX_MESSAGES) {
      const _0x4cc79a = this[_0x86cc1e(375)][_0x86cc1e(1115)] - MAX_MESSAGES;
      this[_0x86cc1e(375)] = this[_0x86cc1e(375)][_0x86cc1e(337)](-MAX_MESSAGES), log[_0x86cc1e(1341)]("[ChatSessionManager] Trimmed history", { "removed": _0x4cc79a, "remaining": this[_0x86cc1e(375)][_0x86cc1e(1115)] });
    }
  }
}
const chatSessionManager = new ChatSessionManager(), ChatSessionManager$1 = Object[_0x54a1b7(502)](Object[_0x54a1b7(634)]({ "__proto__": null, "chatSessionManager": chatSessionManager }, Symbol[_0x54a1b7(1177)], { "value": _0x54a1b7(1416) })), voiceOSModeToRecordingMode = (_0x33e8da) => {
  const _0xf58215 = _0x54a1b7;
  switch (_0x33e8da) {
    case VoiceOSMode[_0xf58215(1607)]:
      return "write";
    case VoiceOSMode[_0xf58215(872)]:
      return _0xf58215(348);
    case VoiceOSMode[_0xf58215(124)]:
    default:
      return "dictation";
  }
};
class TranscriptionService {
  [_0x54a1b7(1062)] = new AudioStreamManager();
  [_0x54a1b7(1060)]() {
    const _0xfae187 = _0x54a1b7;
    return this[_0xfae187(1062)];
  }
  [_0x54a1b7(127)] = new DictationManager();
  [_0x54a1b7(1052)] = new WindowMessenger();
  [_0x54a1b7(1134)] = new TextInserter();
  [_0x54a1b7(1172)] = ![];
  [_0x54a1b7(436)] = ![];
  [_0x54a1b7(331)] = null;
  [_0x54a1b7(838)] = null;
  [_0x54a1b7(198)] = ![];
  [_0x54a1b7(742)] = 0;
  [_0x54a1b7(916)] = ![];
  [_0x54a1b7(1768)]() {
    const _0x37145a = _0x54a1b7;
    log[_0x37145a(1341)]("[TranscriptionService] Cancellation requested by user"), this[_0x37145a(198)] = !![];
  }
  [_0x54a1b7(837)](_0x5de3f3) {
    const _0x1a772a = _0x54a1b7;
    this[_0x1a772a(916)] = _0x5de3f3, log[_0x1a772a(1341)](_0x1a772a(1564) + (_0x5de3f3 ? _0x1a772a(949) : _0x1a772a(1402)));
  }
  [_0x54a1b7(1509)]() {
    const _0x16c6de = _0x54a1b7;
    return this[_0x16c6de(916)];
  }
  async [_0x54a1b7(1554)](_0x45b3c0) {
    const _0x2ab0a6 = _0x54a1b7;
    if (this[_0x2ab0a6(1062)][_0x2ab0a6(625)]()) return log[_0x2ab0a6(1697)]("[TranscriptionService] Stream already in progress."), ![];
    chatSessionManager[_0x2ab0a6(1727)] && !this[_0x2ab0a6(916)] && (log[_0x2ab0a6(1341)]("[TranscriptionService] Ending previous chat session"), chatSessionManager[_0x2ab0a6(755)]());
    this[_0x2ab0a6(198)] = ![];
    if (this[_0x2ab0a6(1172)]) return log[_0x2ab0a6(1697)]("[TranscriptionService] Finalizing previous interaction, ignoring new start."), ![];
    this[_0x2ab0a6(1062)][_0x2ab0a6(167)](), this[_0x2ab0a6(436)] = ![], this[_0x2ab0a6(331)] = _0x45b3c0;
    const _0x3a7d2d = globalThis[_0x2ab0a6(683)];
    return _0x3a7d2d ? (this[_0x2ab0a6(127)][_0x2ab0a6(255)](_0x3a7d2d), this[_0x2ab0a6(838)] = _0x3a7d2d) : (this[_0x2ab0a6(838)] = this[_0x2ab0a6(127)][_0x2ab0a6(757)](), globalThis[_0x2ab0a6(683)] = this[_0x2ab0a6(838)]), log[_0x2ab0a6(1341)]("[TranscriptionService] Starting new transcription stream."), traceLogger[_0x2ab0a6(1118)](this[_0x2ab0a6(838)], _0x2ab0a6(574), { "localInteractionId": this[_0x2ab0a6(838)], "startTime": this[_0x2ab0a6(127)][_0x2ab0a6(1508)]() }), _0x45b3c0 === VoiceOSMode[_0x2ab0a6(124)] && this[_0x2ab0a6(838)] && editSessionManager[_0x2ab0a6(1854)](this[_0x2ab0a6(838)])[_0x2ab0a6(564)](() => {
    }), !![];
  }
  async [_0x54a1b7(304)]() {
    const _0x4ab05d = _0x54a1b7;
    log[_0x4ab05d(1341)](_0x4ab05d(532) + this[_0x4ab05d(331)] + _0x4ab05d(234) + this[_0x4ab05d(436)]);
    this[_0x4ab05d(331)] === VoiceOSMode[_0x4ab05d(1607)] && log[_0x4ab05d(1341)]("[TranscriptionService] GEN mode - VLM/OCR extraction handled server-side");
    if (!this[_0x4ab05d(436)]) {
      const _0x2e4a64 = globalThis[_0x4ab05d(683)], _0x75b813 = this[_0x4ab05d(127)][_0x4ab05d(454)](), { shortcutState: _0x53df3b } = await Promise[_0x4ab05d(1786)]()[_0x4ab05d(843)](() => keyboard), _0x489d26 = _0x53df3b[_0x4ab05d(331)] ?? this[_0x4ab05d(331)];
      if (_0x2e4a64 || _0x75b813) {
        const _0xc34a2d = _0x2e4a64 || _0x75b813;
        traceLogger[_0x4ab05d(1118)](_0xc34a2d, _0x4ab05d(1361), { "localInteractionId": _0x75b813, "bufferedMs": this[_0x4ab05d(1062)][_0x4ab05d(1403)]() }), traceLogger[_0x4ab05d(692)](_0xc34a2d, _0x4ab05d(1471), { "reason": "insufficient_audio_duration", "localInteractionId": _0x75b813 }), globalThis[_0x4ab05d(683)] = null;
      }
      this[_0x4ab05d(127)][_0x4ab05d(644)](), this[_0x4ab05d(1172)] = ![], clipboardManager[_0x4ab05d(788)]();
      (_0x489d26 === VoiceOSMode[_0x4ab05d(1607)] || _0x489d26 === VoiceOSMode[_0x4ab05d(872)]) && (log[_0x4ab05d(1341)](_0x4ab05d(1327) + _0x489d26 + ")"), Promise[_0x4ab05d(1786)]()[_0x4ab05d(843)](() => writeInputService)[_0x4ab05d(843)](({ getWriteInputService: _0x558a78 }) => {
        const _0x5af45a = _0x4ab05d, _0x28b701 = _0x558a78();
        _0x28b701[_0x5af45a(969)]();
      })[_0x4ab05d(564)]((_0x397831) => {
        const _0x4b6ccb = _0x4ab05d;
        log[_0x4b6ccb(981)]("[TranscriptionService] Error canceling WRITE session on early release:", _0x397831);
      }));
      const _0x50c0ad = { "isProcessing": ![] };
      getPillWindow()?.[_0x4ab05d(890)][_0x4ab05d(965)](IPC_EVENTS[_0x4ab05d(1113)], _0x50c0ad);
    }
    this[_0x4ab05d(1062)][_0x4ab05d(304)]();
  }
  [_0x54a1b7(1028)](_0xeb9231) {
    const _0x2b491e = _0x54a1b7;
    this[_0x2b491e(1062)][_0x2b491e(511)](_0xeb9231), this[_0x2b491e(313)]();
  }
  async [_0x54a1b7(313)]() {
    const _0x270b05 = _0x54a1b7;
    if (this[_0x270b05(436)] || !this[_0x270b05(1062)][_0x270b05(625)]() || !this[_0x270b05(1062)][_0x270b05(1098)]() || this[_0x270b05(331)] === null) return;
    this[_0x270b05(436)] = !![], this[_0x270b05(742)] = Date[_0x270b05(1536)](), console[_0x270b05(926)]("[TranscriptionService] Starting gRPC stream. Audio buffer:", this[_0x270b05(1062)][_0x270b05(1403)](), _0x270b05(829), this[_0x270b05(1062)][_0x270b05(1815)](), "Hz");
    const { ModeUpdateSchema: _0x858a84, StreamMessageSchema: _0x316365 } = await Promise[_0x270b05(1786)]()[_0x270b05(843)](() => voiceos_pb), { create: _0x571727 } = await import("@bufbuild/protobuf"), _0xae81e8 = _0x571727(_0x316365, { "payload": { "case": _0x270b05(1759), "value": _0x571727(_0x858a84, { "mode": this[_0x270b05(331)] }) } });
    this[_0x270b05(1062)][_0x270b05(469)](_0xae81e8), console[_0x270b05(926)](_0x270b05(1775) + this[_0x270b05(331)]), grpcClient[_0x270b05(484)](this[_0x270b05(1062)][_0x270b05(869)](), this[_0x270b05(331)])[_0x270b05(843)]((_0x4f706e) => {
      const _0x21457d = _0x270b05;
      return this[_0x21457d(587)](_0x4f706e);
    })[_0x270b05(564)]((_0x3def85) => {
      const _0xb677ff = _0x270b05;
      this[_0xb677ff(751)](_0x3def85);
    });
  }
  async [_0x54a1b7(587)](_0x116615) {
    const _0x5d6724 = _0x54a1b7;
    if (this[_0x5d6724(198)]) {
      log[_0x5d6724(1341)]("[TranscriptionService] Transcription cancelled by user, discarding result"), this[_0x5d6724(1172)] = ![], this[_0x5d6724(436)] = ![], this[_0x5d6724(331)] = null, this[_0x5d6724(838)] = null, this[_0x5d6724(198)] = ![], this[_0x5d6724(916)] = ![], globalThis[_0x5d6724(683)] = null, this[_0x5d6724(127)][_0x5d6724(644)](), clipboardManager[_0x5d6724(788)]();
      const _0xa801e6 = { "isProcessing": ![] };
      getPillWindow()?.[_0x5d6724(890)][_0x5d6724(965)](IPC_EVENTS[_0x5d6724(1113)], _0xa801e6);
      return;
    }
    const _0x28f15e = this[_0x5d6724(838)], _0x5432f2 = this[_0x5d6724(331)], _0x332d10 = this[_0x5d6724(1062)][_0x5d6724(1224)](), _0x3cbf5c = this[_0x5d6724(1062)][_0x5d6724(1815)](), _0x34d74a = _0x332d10[_0x5d6724(1115)] / 2 / _0x3cbf5c * 1e3;
    this[_0x5d6724(1172)] = ![], this[_0x5d6724(436)] = ![], this[_0x5d6724(331)] = null, this[_0x5d6724(838)] = null, globalThis[_0x5d6724(683)] = null, console[_0x5d6724(926)]("[TranscriptionService] Processing transcription response:", { "transcript": _0x116615[_0x5d6724(1099)], "transcriptLength": _0x116615[_0x5d6724(1099)]?.[_0x5d6724(1115)] || 0, "hasTranscript": !!_0x116615[_0x5d6724(1099)], "isEmptyOrWhitespace": !_0x116615[_0x5d6724(1099)]?.[_0x5d6724(1699)](), "hasError": !!_0x116615[_0x5d6724(981)], "errorCode": _0x116615[_0x5d6724(981)]?.[_0x5d6724(1303)], "errorType": _0x116615[_0x5d6724(981)]?.[_0x5d6724(1154)], "errorProvider": _0x116615[_0x5d6724(981)]?.[_0x5d6724(761)], "dictationId": _0x28f15e, "audioBufferSize": _0x332d10[_0x5d6724(1115)], "audioDurationMs": _0x34d74a[_0x5d6724(608)](0), "audioSampleRate": _0x3cbf5c, "securityWarning": _0x116615[_0x5d6724(846)] });
    if (_0x116615[_0x5d6724(846)]) {
      const _0x444378 = getPillWindow();
      if (_0x444378 && !_0x444378[_0x5d6724(496)]()) {
        const _0x26cdc2 = { "attemptCount": _0x116615[_0x5d6724(1522)] || 3, "maxAttempts": 5, "message": "Suspicious activity detected. Further attempts may result in temporary suspension." };
        _0x444378[_0x5d6724(890)][_0x5d6724(965)](IPC_EVENTS[_0x5d6724(184)], _0x26cdc2), console[_0x5d6724(1697)]("[TranscriptionService] Security warning sent to client:", _0x26cdc2);
      }
    }
    const _0x2827c3 = _0x116615[_0x5d6724(981)] ? _0x116615[_0x5d6724(981)][_0x5d6724(1486)] : void 0;
    !_0x116615[_0x5d6724(981)] && (!_0x116615[_0x5d6724(1099)] || !_0x116615[_0x5d6724(1099)][_0x5d6724(1699)]()) && console[_0x5d6724(1697)]("[TranscriptionService] No speech detected despite audio being sent. Audio details:", { "audioBufferSize": _0x332d10[_0x5d6724(1115)], "audioDurationMs": _0x34d74a[_0x5d6724(608)](0), "audioSampleRate": _0x3cbf5c, "transcriptValue": JSON[_0x5d6724(1516)](_0x116615[_0x5d6724(1099)]), "possibleCauses": ["No-speech-threshold too aggressive", "Low-quality-threshold too aggressive", _0x5d6724(576), _0x5d6724(1458), _0x5d6724(1520), "ASR model/provider issue"] });
    if (_0x116615[_0x5d6724(981)]) {
      const _0x7494c3 = _0x116615[_0x5d6724(981)][_0x5d6724(1486)]?.[_0x5d6724(1580)]("Weekly limit") || _0x116615[_0x5d6724(981)][_0x5d6724(1486)]?.[_0x5d6724(1580)]("Usage limit exceeded"), _0x1c90ea = _0x7494c3 ? _0x5d6724(1847) : _0x116615[_0x5d6724(981)][_0x5d6724(1303)] || _0x5d6724(327), _0x5e5ddf = [_0x5d6724(145), _0x5d6724(758), _0x5d6724(1757)], _0x2ad367 = _0x5e5ddf[_0x5d6724(1580)](_0x1c90ea), _0x4e16df = getPillWindow();
      if (_0x4e16df && !_0x4e16df[_0x5d6724(496)]() && !_0x2ad367) {
        const _0x11bc19 = { "code": _0x1c90ea, "message": _0x116615[_0x5d6724(981)][_0x5d6724(1486)], "details": _0x116615[_0x5d6724(981)][_0x5d6724(1863)] };
        _0x4e16df[_0x5d6724(890)][_0x5d6724(965)](IPC_EVENTS[_0x5d6724(1462)], _0x11bc19), log[_0x5d6724(1341)](_0x5d6724(254) + _0x1c90ea);
      } else _0x2ad367 && log[_0x5d6724(1341)](_0x5d6724(800) + _0x1c90ea);
      _0x7494c3 && (log[_0x5d6724(1697)]("[TranscriptionService] Usage limit exceeded error received from server"), electron[_0x5d6724(963)][_0x5d6724(1274)]()[_0x5d6724(878)]((_0x4ef1aa) => {
        const _0x534e0f = _0x5d6724;
        _0x4ef1aa[_0x534e0f(890)][_0x534e0f(965)]("usage-updated", { "allowed": ![], "reason": _0x116615[_0x534e0f(981)][_0x534e0f(1486)] });
      }));
      if (_0x5432f2 === VoiceOSMode[_0x5d6724(1607)] || _0x5432f2 === VoiceOSMode[_0x5d6724(872)]) {
        const _0x40918b = _0x5432f2 === VoiceOSMode[_0x5d6724(872)] ? _0x5d6724(872) : _0x5d6724(1607);
        log[_0x5d6724(1341)](_0x5d6724(1463) + _0x40918b + _0x5d6724(851)), Promise[_0x5d6724(1786)]()[_0x5d6724(843)](() => writeInputService)[_0x5d6724(843)](({ getWriteInputService: _0x2eb3ec }) => {
          const _0x4c82f8 = _0x5d6724, _0x386898 = _0x2eb3ec();
          _0x386898[_0x4c82f8(969)]();
        })[_0x5d6724(564)]((_0x3b3f63) => {
          const _0x1b3747 = _0x5d6724;
          log[_0x1b3747(981)](_0x1b3747(853) + _0x40918b + _0x1b3747(213), _0x3b3f63);
        }), this[_0x5d6724(1062)][_0x5d6724(1527)](), this[_0x5d6724(127)][_0x5d6724(644)]();
        _0x28f15e && traceLogger[_0x5d6724(692)](_0x28f15e, _0x7494c3 ? _0x5d6724(1847) : _0x40918b + _0x5d6724(271), { "error": _0x116615[_0x5d6724(981)][_0x5d6724(1486)] });
        !_0x2ad367 && captureTranscriptionFailed({ "mode": voiceOSModeToRecordingMode(_0x5432f2), "audio_duration_ms": Math[_0x5d6724(303)](_0x34d74a), "error_type": _0x1c90ea, "error_message": _0x116615[_0x5d6724(981)][_0x5d6724(1486)] });
        return;
      }
      _0x116615[_0x5d6724(981)][_0x5d6724(1303)] == _0x5d6724(1757) && (_0x28f15e && traceLogger[_0x5d6724(1118)](_0x28f15e, _0x5d6724(1361), { "transcript": _0x116615[_0x5d6724(1099)], "transcriptLength": _0x116615[_0x5d6724(1099)]?.[_0x5d6724(1115)] || 0 }));
      await this[_0x5d6724(127)][_0x5d6724(126)](_0x116615[_0x5d6724(1099)] || "", _0x332d10, _0x3cbf5c, _0x5432f2 || VoiceOSMode[_0x5d6724(124)], _0x2827c3);
      const _0xc05bb7 = { "isProcessing": ![] };
      getPillWindow()?.[_0x5d6724(890)][_0x5d6724(965)](IPC_EVENTS[_0x5d6724(1113)], _0xc05bb7), _0x28f15e && traceLogger[_0x5d6724(692)](_0x28f15e, _0x7494c3 ? _0x5d6724(1847) : _0x5d6724(821), { "error": _0x116615[_0x5d6724(981)][_0x5d6724(1486)] }), !_0x2ad367 && captureTranscriptionFailed({ "mode": voiceOSModeToRecordingMode(_0x5432f2), "audio_duration_ms": Math[_0x5d6724(303)](_0x34d74a), "error_type": _0x1c90ea, "error_message": _0x116615[_0x5d6724(981)][_0x5d6724(1486)] }), this[_0x5d6724(1062)][_0x5d6724(1527)](), this[_0x5d6724(127)][_0x5d6724(644)](), clipboardManager[_0x5d6724(788)]();
    } else {
      _0x28f15e && traceLogger[_0x5d6724(1118)](_0x28f15e, _0x5d6724(459), { "transcript": _0x116615[_0x5d6724(1099)], "transcriptLength": _0x116615[_0x5d6724(1099)]?.[_0x5d6724(1115)] || 0 });
      const _0x7d7062 = _0x116615[_0x5d6724(1099)] || "", _0x530a80 = _0x7d7062[_0x5d6724(1699)]()[_0x5d6724(1163)](/\s+/)[_0x5d6724(1380)](Boolean)[_0x5d6724(1115)], _0xdf8aab = _0x7d7062[_0x5d6724(1115)], _0x3696ad = this[_0x5d6724(742)] ? Date[_0x5d6724(1536)]() - this[_0x5d6724(742)] : void 0, _0x51f150 = _0x3696ad !== void 0 ? Math[_0x5d6724(1507)](0, _0x3696ad - _0x34d74a) : void 0;
      captureTranscriptionCompleted({ "mode": voiceOSModeToRecordingMode(_0x5432f2), "audio_duration_ms": Math[_0x5d6724(303)](_0x34d74a), "word_count": _0x530a80, "char_count": _0xdf8aab, "total_latency_ms": _0x3696ad, "network_overhead_ms": _0x51f150 ? Math[_0x5d6724(303)](_0x51f150) : void 0 });
      if (this[_0x5d6724(916)]) {
        log[_0x5d6724(1341)](_0x5d6724(214)), this[_0x5d6724(916)] = ![];
        const _0x17472c = (_0x116615[_0x5d6724(1099)] || "")[_0x5d6724(1699)]();
        if (!_0x17472c) {
          log[_0x5d6724(1697)]("[TranscriptionService] Voice follow-up: empty transcript, skipping"), this[_0x5d6724(1062)][_0x5d6724(1527)](), this[_0x5d6724(127)][_0x5d6724(644)]();
          const _0x61e58d = getPillWindow();
          _0x61e58d && !_0x61e58d[_0x5d6724(496)]() && _0x61e58d[_0x5d6724(890)][_0x5d6724(965)](IPC_EVENTS[_0x5d6724(471)], { "isRecording": ![], "mode": null, "skipSound": !![], "isVoiceFollowUp": !![] });
          return;
        }
        const _0x4e9a9c = getPillWindow();
        _0x4e9a9c && !_0x4e9a9c[_0x5d6724(496)]() && _0x4e9a9c[_0x5d6724(890)][_0x5d6724(965)](IPC_EVENTS[_0x5d6724(1576)], { "text": applyJapaneseHomophoneCorrections(_0x17472c) });
        this[_0x5d6724(429)](_0x17472c), this[_0x5d6724(1062)][_0x5d6724(1527)](), this[_0x5d6724(127)][_0x5d6724(644)]();
        _0x28f15e && traceLogger[_0x5d6724(692)](_0x28f15e, _0x5d6724(777), { "textLength": _0x17472c[_0x5d6724(1115)] });
        return;
      }
      if (_0x5432f2 === VoiceOSMode[_0x5d6724(1607)] || _0x5432f2 === VoiceOSMode[_0x5d6724(872)]) {
        const _0x3cca79 = _0x5432f2 === VoiceOSMode[_0x5d6724(872)] ? _0x5d6724(872) : _0x5d6724(1607);
        log[_0x5d6724(1341)](_0x5d6724(1059) + _0x3cca79 + _0x5d6724(1581));
        const _0x2f5d36 = this[_0x5d6724(1062)][_0x5d6724(1224)](), _0x588f57 = this[_0x5d6724(1062)][_0x5d6724(1815)]();
        Promise[_0x5d6724(1786)]()[_0x5d6724(843)](() => writeInputService)[_0x5d6724(843)](({ getWriteInputService: _0x367cb7 }) => {
          const _0x400e5c = _0x5d6724, _0x1a08e5 = _0x367cb7();
          return _0x2f5d36 && _0x588f57 && _0x1a08e5[_0x400e5c(1051)](_0x2f5d36, _0x588f57, _0x116615[_0x400e5c(651)] || _0x116615[_0x400e5c(1099)]), _0x1a08e5[_0x400e5c(1238)](_0x116615[_0x400e5c(1099)], _0x5432f2, _0x116615[_0x400e5c(651)]);
        })[_0x5d6724(564)]((_0x536fb8) => {
          const _0x963aba = _0x5d6724;
          log[_0x963aba(981)](" [TranscriptionService] Error calling WriteInputService:", _0x536fb8);
        }), this[_0x5d6724(1062)][_0x5d6724(1527)](), this[_0x5d6724(127)][_0x5d6724(644)]();
        if (_0x28f15e) {
          const _0x202df0 = _0x5432f2 === VoiceOSMode[_0x5d6724(872)] ? _0x5d6724(1753) : _0x5d6724(924);
          traceLogger[_0x5d6724(692)](_0x28f15e, _0x202df0, { "transcript": _0x116615[_0x5d6724(1099)], "transcriptLength": _0x116615[_0x5d6724(1099)]?.[_0x5d6724(1115)] || 0 });
        }
      } else {
        this[_0x5d6724(1052)][_0x5d6724(242)](_0x116615);
        _0x28f15e && traceLogger[_0x5d6724(692)](_0x28f15e, _0x5d6724(989), { "transcript": _0x116615[_0x5d6724(1099)], "transcriptLength": _0x116615[_0x5d6724(1099)]?.[_0x5d6724(1115)] || 0 });
        if (_0x116615[_0x5d6724(1099)]) {
          let _0x232477 = _0x116615[_0x5d6724(1099)];
          try {
            const _0x3a282e = 4, _0xe639e1 = await canGetContextFromCurrentApp();
            let _0x10ed46 = "", _0x5e14b3 = "";
            try {
              if (_0xe639e1) {
                const _0x44a92c = await getFullCursorContext(_0x3a282e);
                _0x10ed46 = _0x44a92c[_0x5d6724(1377)], _0x5e14b3 = _0x44a92c[_0x5d6724(839)];
              }
            } catch (_0x3d6b1d) {
              console[_0x5d6724(981)](" Cursor context failed:", _0x3d6b1d);
            }
            const _0x33d52b = _0x232477[_0x5d6724(1699)]()[_0x5d6724(1163)](/\s+/)[_0x5d6724(1115)] === 1;
            _0x33d52b && (_0x232477 = grammarRulesService[_0x5d6724(796)](_0x232477));
            _0x232477 = grammarRulesService[_0x5d6724(1693)](_0x10ed46, _0x232477), _0x232477 = grammarRulesService[_0x5d6724(637)](_0x10ed46, _0x232477), _0x232477 = grammarRulesService[_0x5d6724(709)](_0x5e14b3, _0x232477);
            const _0x14a33c = await isFocusedElementEditable();
            if (!_0x14a33c) {
              log[_0x5d6724(1341)]("[TranscriptionService] No editable text field focused, copying to clipboard"), electron[_0x5d6724(549)][_0x5d6724(1073)](_0x232477[_0x5d6724(1699)]());
              const _0x5aef7c = getPillWindow();
              _0x5aef7c && !_0x5aef7c[_0x5d6724(496)]() && _0x5aef7c[_0x5d6724(890)][_0x5d6724(965)](IPC_EVENTS[_0x5d6724(1113)], { "isProcessing": ![] });
            } else {
              getPillWindow()?.[_0x5d6724(890)][_0x5d6724(965)](IPC_EVENTS[_0x5d6724(1113)], { "isProcessing": ![] });
              const _0x5012dd = shouldSimulateEnterAndClear();
              this[_0x5d6724(1134)][_0x5d6724(1809)](_0x232477, _0x28f15e)[_0x5d6724(843)](async () => {
                const _0x57997a = _0x5d6724;
                clipboardManager[_0x57997a(788)](), editSessionManager[_0x57997a(1369)](_0x232477)[_0x57997a(564)](() => {
                }), _0x5012dd && (log[_0x57997a(1341)]("[TranscriptionService] Simulating Enter key after text insertion"), await new Promise((_0x143b9c) => setTimeout(_0x143b9c, 50)), await pressEnterKey());
              })[_0x5d6724(564)]((_0xedb720) => {
                const _0xd1c07e = _0x5d6724;
                log[_0xd1c07e(981)](" [TranscriptionService] Text insertion failed:", _0xedb720), clipboardManager[_0xd1c07e(788)]();
              });
            }
          } catch (_0x54a6c3) {
            log[_0x5d6724(981)](" [TranscriptionService] Text insertion flow failed, retrying with raw transcript paste:", _0x54a6c3);
            try {
              getPillWindow()?.[_0x5d6724(890)][_0x5d6724(965)](IPC_EVENTS[_0x5d6724(1113)], { "isProcessing": ![] }), await this[_0x5d6724(1134)][_0x5d6724(1809)](_0x232477, _0x28f15e), clipboardManager[_0x5d6724(788)]();
            } catch (_0x449200) {
              log[_0x5d6724(981)](" [TranscriptionService] Retry paste also failed, copying to clipboard:", _0x449200), electron[_0x5d6724(549)][_0x5d6724(1073)](_0x232477[_0x5d6724(1699)]()), getPillWindow()?.[_0x5d6724(890)][_0x5d6724(965)](IPC_EVENTS[_0x5d6724(1113)], { "isProcessing": ![] }), clipboardManager[_0x5d6724(788)]();
            }
          }
          this[_0x5d6724(127)][_0x5d6724(126)](_0x116615[_0x5d6724(1099)], _0x332d10, _0x3cbf5c, _0x5432f2 || VoiceOSMode[_0x5d6724(124)], _0x2827c3)[_0x5d6724(843)](() => {
            const _0x5385e3 = _0x5d6724;
            this[_0x5385e3(1062)][_0x5385e3(1527)](), this[_0x5385e3(127)][_0x5385e3(644)]();
          })[_0x5d6724(564)]((_0x1a805d) => {
            const _0x353aa8 = _0x5d6724;
            console[_0x353aa8(981)](" [TranscriptionService] Failed to save interaction:", _0x1a805d), this[_0x353aa8(1062)][_0x353aa8(1527)](), this[_0x353aa8(127)][_0x353aa8(644)]();
          });
        } else getPillWindow()?.[_0x5d6724(890)][_0x5d6724(965)](IPC_EVENTS[_0x5d6724(1113)], { "isProcessing": ![] }), this[_0x5d6724(1062)][_0x5d6724(1527)](), this[_0x5d6724(127)][_0x5d6724(644)]();
      }
    }
  }
  async [_0x54a1b7(751)](_0x146167) {
    const _0x13238d = _0x54a1b7, _0x376f5e = this[_0x13238d(838)], _0x1ad638 = this[_0x13238d(331)];
    this[_0x13238d(1172)] = ![], this[_0x13238d(436)] = ![], this[_0x13238d(331)] = null, this[_0x13238d(838)] = null, this[_0x13238d(916)] = ![], globalThis[_0x13238d(683)] = null, log[_0x13238d(981)](" [TranscriptionService] An unexpected error occurred during transcription:", _0x146167);
    let _0x465053 = _0x13238d(327);
    const _0x50b4e4 = _0x146167[_0x13238d(1486)] || String(_0x146167);
    if (_0x146167 instanceof connect[_0x13238d(382)]) _0x146167[_0x13238d(1303)] === connect[_0x13238d(778)][_0x13238d(1748)] || _0x146167[_0x13238d(1303)] === connect[_0x13238d(778)][_0x13238d(1700)] || _0x146167[_0x13238d(1303)] === connect[_0x13238d(778)][_0x13238d(266)] ? _0x465053 = _0x13238d(1133) : _0x465053 = _0x13238d(363);
    else (_0x50b4e4[_0x13238d(1580)](_0x13238d(1490)) || _0x50b4e4[_0x13238d(1580)]("fetch failed") || _0x50b4e4[_0x13238d(1580)]("connection") || _0x50b4e4[_0x13238d(1580)]("not running")) && (_0x465053 = _0x13238d(1133));
    const _0x2b9679 = getPillWindow();
    if (_0x2b9679 && !_0x2b9679[_0x13238d(496)]()) {
      const _0x52603d = { "code": _0x465053, "message": _0x50b4e4 };
      _0x2b9679[_0x13238d(890)][_0x13238d(965)](IPC_EVENTS[_0x13238d(1462)], _0x52603d), log[_0x13238d(1341)](_0x13238d(205) + _0x465053);
    }
    if (_0x1ad638 === VoiceOSMode[_0x13238d(1607)] || _0x1ad638 === VoiceOSMode[_0x13238d(872)]) {
      const _0x316f83 = _0x1ad638 === VoiceOSMode[_0x13238d(872)] ? _0x13238d(872) : _0x13238d(1607);
      log[_0x13238d(1341)](_0x13238d(1463) + _0x316f83 + _0x13238d(851)), Promise[_0x13238d(1786)]()[_0x13238d(843)](() => writeInputService)[_0x13238d(843)](({ getWriteInputService: _0x1d19d5 }) => {
        const _0x162a45 = _0x13238d, _0x2b1913 = _0x1d19d5();
        _0x2b1913[_0x162a45(969)]();
      })[_0x13238d(564)]((_0x31094b) => {
        const _0xdd9fb1 = _0x13238d;
        log[_0xdd9fb1(981)](_0xdd9fb1(853) + _0x316f83 + _0xdd9fb1(213), _0x31094b);
      });
    } else {
      this[_0x13238d(1052)][_0x13238d(1277)](_0x146167);
      const _0x40c6e7 = { "isProcessing": ![] };
      getPillWindow()?.[_0x13238d(890)][_0x13238d(965)](IPC_EVENTS[_0x13238d(1113)], _0x40c6e7), clipboardManager[_0x13238d(788)]();
    }
    _0x376f5e && traceLogger[_0x13238d(730)](_0x376f5e, _0x13238d(1462), _0x146167[_0x13238d(1486)]), this[_0x13238d(127)][_0x13238d(644)](), this[_0x13238d(1062)][_0x13238d(1527)]();
  }
  async [_0x54a1b7(442)]() {
    const _0x13d454 = _0x54a1b7;
    console[_0x13d454(926)]("[TranscriptionService] Stopping transcription. gRPC started:", this[_0x13d454(436)], ", Buffered duration:", this[_0x13d454(1062)][_0x13d454(1403)](), "ms"), await this[_0x13d454(304)]();
  }
  [_0x54a1b7(188)](_0x333f68) {
    const _0x1f35b4 = _0x54a1b7;
    return this[_0x1f35b4(1028)](_0x333f68);
  }
  [_0x54a1b7(811)](_0x3e5dd9) {
    const _0x4489e4 = _0x54a1b7;
    this[_0x4489e4(1062)][_0x4489e4(811)](_0x3e5dd9);
  }
  [_0x54a1b7(316)](_0x458be1) {
    const _0x484987 = _0x54a1b7;
    this[_0x484987(331)] !== null && (log[_0x484987(1341)](_0x484987(407) + this[_0x484987(331)] + _0x484987(1194) + _0x458be1), this[_0x484987(331)] = _0x458be1);
  }
  [_0x54a1b7(1706)](_0x413229) {
    const _0x5a0b23 = _0x54a1b7;
    this[_0x5a0b23(1052)][_0x5a0b23(1706)](_0x413229);
  }
  [_0x54a1b7(517)]() {
    const _0x4f953d = _0x54a1b7;
    this[_0x4f953d(1172)] && (this[_0x4f953d(1172)] = ![]);
  }
  [_0x54a1b7(1035)]() {
    const _0xeae833 = _0x54a1b7;
    return this[_0xeae833(1172)];
  }
  async [_0x54a1b7(429)](_0x1c5e7a) {
    const _0x20bb7c = _0x54a1b7;
    try {
      if (!chatSessionManager[_0x20bb7c(1727)]) {
        log[_0x20bb7c(1697)]("[TranscriptionService] No active chat session for voice follow-up");
        return;
      }
      const _0x3986fc = chatSessionManager[_0x20bb7c(1791)](), _0x321569 = chatSessionManager[_0x20bb7c(798)]();
      chatSessionManager[_0x20bb7c(1433)](_0x1c5e7a);
      const _0x4d29ec = getPillWindow();
      _0x4d29ec && !_0x4d29ec[_0x20bb7c(496)]() && _0x4d29ec[_0x20bb7c(890)][_0x20bb7c(965)](IPC_EVENTS[_0x20bb7c(131)], { "isProcessing": !![] });
      try {
        const _0x32ff5d = await grpcClient[_0x20bb7c(1614)]({ "text": _0x1c5e7a, "conversationHistory": _0x321569, "ocrText": _0x3986fc?.[_0x20bb7c(1751)], "selectedText": _0x3986fc?.[_0x20bb7c(493)], "appName": _0x3986fc?.[_0x20bb7c(1856)], "windowTitle": _0x3986fc?.[_0x20bb7c(688)], "windowUrl": _0x3986fc?.[_0x20bb7c(648)], "accessibilityText": _0x3986fc?.[_0x20bb7c(696)], "vlmDescription": _0x3986fc?.[_0x20bb7c(1806)], "originalTranscript": _0x3986fc?.[_0x20bb7c(1672)] });
        chatSessionManager[_0x20bb7c(737)](_0x32ff5d[_0x20bb7c(785)]), _0x4d29ec && !_0x4d29ec[_0x20bb7c(496)]() && (_0x4d29ec[_0x20bb7c(890)][_0x20bb7c(965)](IPC_EVENTS[_0x20bb7c(131)], { "isProcessing": ![] }), _0x4d29ec[_0x20bb7c(890)][_0x20bb7c(965)](IPC_EVENTS[_0x20bb7c(663)], { "text": _0x32ff5d[_0x20bb7c(785)] })), log[_0x20bb7c(1341)]("[TranscriptionService] Voice follow-up completed successfully");
      } catch (_0x20bca6) {
        log[_0x20bb7c(981)]("[TranscriptionService] Voice follow-up failed:", _0x20bca6), _0x4d29ec && !_0x4d29ec[_0x20bb7c(496)]() && (_0x4d29ec[_0x20bb7c(890)][_0x20bb7c(965)](IPC_EVENTS[_0x20bb7c(131)], { "isProcessing": ![] }), _0x4d29ec[_0x20bb7c(890)][_0x20bb7c(965)](IPC_EVENTS[_0x20bb7c(663)], { "text": "", "error": String(_0x20bca6) }));
      }
    } catch (_0x3d48be) {
      log[_0x20bb7c(981)]("[TranscriptionService] Failed to process voice follow-up:", _0x3d48be);
    }
  }
}
const transcriptionService = new TranscriptionService(), transcriptionService$1 = Object[_0x54a1b7(502)](Object[_0x54a1b7(634)]({ "__proto__": null, "TranscriptionService": TranscriptionService, "transcriptionService": transcriptionService }, Symbol[_0x54a1b7(1177)], { "value": _0x54a1b7(1416) }));
class VoiceSessionManager {
  [_0x54a1b7(159)] = null;
  [_0x54a1b7(628)] = null;
  [_0x54a1b7(1854)]() {
    const _0x442881 = _0x54a1b7;
    return this[_0x442881(159)] = uuid["v4"](), this[_0x442881(628)] = Date[_0x442881(1536)](), this[_0x442881(159)];
  }
  [_0x54a1b7(1131)]() {
    const _0x510e2c = _0x54a1b7;
    return this[_0x510e2c(159)];
  }
  [_0x54a1b7(1832)]() {
    const _0x3116c9 = _0x54a1b7;
    return this[_0x3116c9(628)];
  }
  [_0x54a1b7(1329)](_0x5d0e59) {
    const _0x1fbcc5 = _0x54a1b7;
    this[_0x1fbcc5(159)] = _0x5d0e59, this[_0x1fbcc5(628)] = Date[_0x1fbcc5(1536)]();
  }
  async [_0x54a1b7(1659)](_0x368c4d, _0xf9edca, _0x1b38c5, _0x5be44f, _0x514402, _0x4c9111, _0x41173d) {
    const _0x11a671 = _0x54a1b7;
    if (!this[_0x11a671(159)]) {
      log[_0x11a671(1697)]("[VoiceSessionManager] No current session ID, skipping session creation.");
      return;
    }
    if (_0x1b38c5) {
      const _0x3bc0c3 = _0x1b38c5[_0x11a671(1566)]();
      if (_0x3bc0c3[_0x11a671(1580)]("voiceos") || _0x3bc0c3[_0x11a671(1580)]("electron")) {
        log[_0x11a671(1341)](_0x11a671(1358) + _0x1b38c5);
        return;
      }
    }
    if (_0x1b38c5 && _0x1b38c5[_0x11a671(1580)](_0x11a671(1716))) {
      log[_0x11a671(1341)](_0x11a671(1767) + _0x1b38c5);
      return;
    }
    try {
      const _0x5cf3dd = store[_0x11a671(1043)](STORE_KEYS[_0x11a671(1850)]), _0x37918b = _0x5cf3dd?.["id"];
      if (!_0x37918b) {
        log[_0x11a671(1697)]("[VoiceSessionManager] No user ID found, not creating voice session.");
        return;
      }
      const _0x1aa5e9 = store[_0x11a671(1043)](STORE_KEYS[_0x11a671(193)]), _0x492ec5 = _0x1aa5e9?.[_0x11a671(1372)] ?? !![], _0x33c132 = Date[_0x11a671(1536)](), _0x519b6d = this[_0x11a671(628)] ? _0x33c132 - this[_0x11a671(628)] : 0, _0x2c7657 = _0x519b6d / 1e3, _0x48d41d = countWords(_0x368c4d);
      let _0x43bfa9 = null;
      if (_0x1b38c5) try {
        const _0x552e4d = getCachedAppIcon(_0x1b38c5);
        if (_0x552e4d) {
          const _0x5ca31c = await AppIconsTable[_0x11a671(810)]({ "user_id": _0x37918b, "app_name": _0x1b38c5, "icon_base64": _0x552e4d });
          _0x43bfa9 = _0x5ca31c["id"], log[_0x11a671(1341)](_0x11a671(794) + _0x1b38c5 + ": " + _0x43bfa9);
        }
      } catch (_0x20c7ed) {
        log[_0x11a671(981)](_0x11a671(1642) + _0x1b38c5 + ":", _0x20c7ed);
      }
      const _0x45df14 = (/* @__PURE__ */ new Date())[_0x11a671(582)](), _0x28ac43 = { "id": this[_0x11a671(159)], "user_id": _0x37918b, "transcript": _0x368c4d || null, "generated_text": _0xf9edca || null, "app_name": _0x1b38c5 || null, "window_title": _0x5be44f || null, "audio_blob_id": null, "duration_seconds": _0x2c7657, "sample_rate": _0x4c9111, "word_count": _0x48d41d, "mode": _0x41173d, "app_icon_id": _0x43bfa9, "created_at": _0x45df14, "updated_at": _0x45df14, "deleted_at": null, "sync_failed_at": null };
      await VoiceSessionsTable[_0x11a671(810)](_0x28ac43), log[_0x11a671(1341)](_0x11a671(1079) + this[_0x11a671(159)]), grpcClient[_0x11a671(1093)](_0x368c4d)[_0x11a671(843)]((_0x268134) => {
        const _0x29e5c3 = _0x11a671;
        log[_0x29e5c3(1341)](_0x29e5c3(1333) + _0x268134[_0x29e5c3(585)] + _0x29e5c3(814) + _0x268134[_0x29e5c3(1572)]), electron[_0x29e5c3(963)][_0x29e5c3(1274)]()[_0x29e5c3(878)]((_0x554f1f) => {
          const _0x5e4e0f = _0x29e5c3;
          _0x554f1f[_0x5e4e0f(890)][_0x5e4e0f(965)]("usage-updated", { "currentUsage": _0x268134[_0x5e4e0f(585)], "limit": _0x268134[_0x5e4e0f(287)], "allowed": _0x268134[_0x5e4e0f(1572)], "reason": _0x268134[_0x5e4e0f(383)], "planType": _0x268134[_0x5e4e0f(973)] });
        });
      })[_0x11a671(564)]((_0x19c37f) => {
        const _0x5d3123 = _0x11a671;
        log[_0x5d3123(981)]("[VoiceSessionManager] Failed to record usage:", _0x19c37f);
      }), _0x492ec5 ? grpcClient[_0x11a671(1659)]({ ..._0x28ac43, "audio_blob": _0x514402 })[_0x11a671(843)](() => {
        const _0xbea0d6 = _0x11a671;
        log[_0xbea0d6(1341)](_0xbea0d6(1518) + this[_0xbea0d6(159)]);
      })[_0x11a671(564)]((_0xaf1279) => {
        const _0x406239 = _0x11a671;
        log[_0x406239(981)]("[VoiceSessionManager] Failed to sync voice session to server:", _0xaf1279), VoiceSessionsTable[_0x406239(874)](this[_0x406239(159)])[_0x406239(564)]((_0x4fea1f) => {
          const _0x291faa = _0x406239;
          log[_0x291faa(981)]("[VoiceSessionManager] Failed to mark sync as failed:", _0x4fea1f);
        });
      }) : log[_0x11a671(1341)]("[VoiceSessionManager] Analytics sharing disabled, voice session not synced to server"), electron[_0x11a671(963)][_0x11a671(1274)]()[_0x11a671(878)]((_0x378b4d) => {
        const _0x1ab4b8 = _0x11a671;
        _0x378b4d[_0x1ab4b8(890)][_0x1ab4b8(965)]("voice-session-created", { "id": this[_0x1ab4b8(159)], "transcript": _0x368c4d, "generatedText": _0xf9edca, "timestamp": _0x45df14, "durationMs": _0x519b6d });
      });
    } catch (_0x2400e9) {
      log[_0x11a671(981)]("[VoiceSessionManager] Failed to create voice session:", _0x2400e9);
    }
  }
  [_0x54a1b7(1145)]() {
    const _0x4a821d = _0x54a1b7;
    this[_0x4a821d(159)] = null, this[_0x4a821d(628)] = null;
  }
}
class WriteInputService {
  [_0x54a1b7(1134)] = new TextInserter();
  [_0x54a1b7(579)] = new VoiceSessionManager();
  [_0x54a1b7(1727)] = ![];
  [_0x54a1b7(1790)] = null;
  [_0x54a1b7(1714)] = null;
  [_0x54a1b7(1008)] = null;
  [_0x54a1b7(803)] = null;
  [_0x54a1b7(917)] = null;
  [_0x54a1b7(1591)] = null;
  [_0x54a1b7(1104)] = null;
  [_0x54a1b7(1099)] = null;
  [_0x54a1b7(1258)] = null;
  [_0x54a1b7(696)] = null;
  [_0x54a1b7(958)] = ![];
  async [_0x54a1b7(1390)]() {
    const _0xdd1b10 = _0x54a1b7;
    if (this[_0xdd1b10(1727)]) return log[_0xdd1b10(1697)]("[WriteInputService] Write session already active"), ![];
    chatSessionManager[_0xdd1b10(1727)] && (log[_0xdd1b10(1341)]("[WriteInputService] Ending previous chat session"), chatSessionManager[_0xdd1b10(755)]());
    this[_0xdd1b10(1727)] = !![], this[_0xdd1b10(1790)] = uuid["v4"](), globalThis[_0xdd1b10(683)] = this[_0xdd1b10(1790)];
    const _0xe3edd5 = this[_0xdd1b10(579)][_0xdd1b10(1854)]();
    return log[_0xdd1b10(1341)]("[WriteInputService] Starting GEN mode session", { "interactionId": this[_0xdd1b10(1790)], "voiceSessionId": _0xe3edd5 }), traceLogger[_0xdd1b10(1118)](this[_0xdd1b10(1790)], _0xdd1b10(968), { "timestamp": Date[_0xdd1b10(1536)]() }), getActiveWindow()[_0xdd1b10(843)](async (_0x3c99cf) => {
      const _0x48bf9d = _0xdd1b10;
      if (!this[_0x48bf9d(1727)]) {
        log[_0x48bf9d(1341)]("[WriteInputService] Session cancelled before app icon loaded, skipping pill update");
        return;
      }
      if (_0x3c99cf && (_0x3c99cf[_0x48bf9d(852)] || _0x3c99cf[_0x48bf9d(1856)])) {
        const _0x2cd800 = getPillWindow();
        if (_0x2cd800 && !_0x2cd800[_0x48bf9d(496)]()) {
          let _0x18f5b6 = _0x3c99cf[_0x48bf9d(852)], _0x466031 = ![];
          if (_0x3c99cf[_0x48bf9d(503)]) {
            const { faviconCache: _0x3b72f5 } = await Promise[_0x48bf9d(1786)]()[_0x48bf9d(843)](() => require("./chunks/favicon-cache-hWTFEtqN.js")), _0x585ea1 = _0x3b72f5[_0x48bf9d(1043)](_0x3c99cf[_0x48bf9d(503)]);
            _0x585ea1 && (_0x18f5b6 = _0x585ea1, _0x466031 = !![], log[_0x48bf9d(1341)]("[WriteInputService] Using cached favicon"));
          }
          _0x2cd800[_0x48bf9d(890)][_0x48bf9d(965)](IPC_EVENTS[_0x48bf9d(471)], { "isRecording": !![], "appIcon": _0x18f5b6 || null, "appName": _0x3c99cf[_0x48bf9d(1856)], "skipSound": !![], "isFavicon": _0x466031 });
        }
      }
    })[_0xdd1b10(564)]((_0x5bb35b) => {
      const _0x3e8a8 = _0xdd1b10;
      log[_0x3e8a8(981)]("[WriteInputService] Error fetching app icon:", _0x5bb35b);
    }), !![];
  }
  [_0x54a1b7(1649)](_0x1d44b8, _0x503c20, _0x22a040, _0x179990, _0x426417, _0x44a1dc) {
    const _0x45aeea = _0x54a1b7;
    this[_0x45aeea(1714)] = _0x1d44b8, this[_0x45aeea(1008)] = _0x503c20 || null, this[_0x45aeea(803)] = _0x22a040 || null, this[_0x45aeea(917)] = _0x179990 || null, this[_0x45aeea(696)] = _0x426417 || null, this[_0x45aeea(958)] = _0x44a1dc || ![], log[_0x45aeea(1341)]("[WriteInputService] Session data set", { "hasScreenshot": !!_0x1d44b8, "screenshotSize": _0x1d44b8 ? Math[_0x45aeea(303)](_0x1d44b8[_0x45aeea(1115)] / 1024) + "KB" : _0x45aeea(302), "hasPreExtractedOcr": !!_0x503c20, "preExtractedOcrLength": _0x503c20?.[_0x45aeea(1115)] || 0, "hasScreenshotPromise": !!_0x22a040, "hasOcrPromise": !!_0x179990, "hasAccessibilityText": !!_0x426417, "accessibilityTextLength": _0x426417?.[_0x45aeea(1115)] || 0, "hasSelectedText": !!_0x44a1dc });
  }
  [_0x54a1b7(1051)](_0x25d040, _0x4b3484, _0x49f0f0) {
    const _0x91b9c9 = _0x54a1b7;
    this[_0x91b9c9(1591)] = _0x25d040, this[_0x91b9c9(1104)] = _0x4b3484, this[_0x91b9c9(1099)] = _0x49f0f0, log[_0x91b9c9(1341)]("[WriteInputService] Audio data set for voice session", { "audioSize": _0x25d040[_0x91b9c9(1115)], "sampleRate": _0x4b3484, "transcriptLength": _0x49f0f0[_0x91b9c9(1115)] });
  }
  async [_0x54a1b7(1238)](_0x47758f, _0x515e89, _0x51ac40) {
    const _0x281ef7 = _0x54a1b7;
    if (!this[_0x281ef7(1727)]) {
      log[_0x281ef7(1697)]("[WriteInputService] No active session, ignoring transcription");
      return;
    }
    const _0x3c82be = _0x515e89 === VoiceOSMode[_0x281ef7(872)], _0x5c84bb = _0x3c82be ? _0x281ef7(872) : _0x281ef7(1607);
    log[_0x281ef7(1341)](_0x281ef7(386) + _0x5c84bb + _0x281ef7(942) + _0x47758f[_0x281ef7(1115)] + _0x281ef7(591));
    const _0x3fa9c2 = getPillWindow();
    log[_0x281ef7(1341)]("[WriteInputService] Transitioning pill to processing state");
    _0x3fa9c2 && !_0x3fa9c2[_0x281ef7(496)]() ? (_0x3fa9c2[_0x281ef7(890)][_0x281ef7(965)](IPC_EVENTS[_0x281ef7(471)], { "isRecording": ![], "mode": null, "skipSound": !![] }), _0x3fa9c2[_0x281ef7(890)][_0x281ef7(965)](IPC_EVENTS[_0x281ef7(1113)], { "isProcessing": !![] }), log[_0x281ef7(1341)]("[WriteInputService] Pill transitioned to processing state")) : log[_0x281ef7(1697)](_0x281ef7(1870));
    try {
      let _0x5a7ef3, _0x340c2a, _0x3104e2;
      if (this[_0x281ef7(1258)]) _0x5a7ef3 = this[_0x281ef7(1258)][_0x281ef7(1856)], _0x340c2a = this[_0x281ef7(1258)][_0x281ef7(688)], log[_0x281ef7(1341)](_0x281ef7(1389) + _0x5a7ef3 + _0x281ef7(977) + _0x340c2a);
      else {
        const _0x3cf947 = await getActiveWindow();
        _0x5a7ef3 = _0x3cf947?.[_0x281ef7(1856)], _0x340c2a = _0x3cf947?.[_0x281ef7(221)], _0x3104e2 = _0x3cf947?.[_0x281ef7(503)], _0x3cf947 && (log[_0x281ef7(1341)](_0x281ef7(708) + _0x5a7ef3 + _0x281ef7(977) + _0x340c2a), _0x3cf947[_0x281ef7(503)] && console[_0x281ef7(926)](_0x281ef7(1326) + _0x3cf947[_0x281ef7(503)]));
      }
      const _0x293872 = _0x3c82be ? _0x281ef7(348) : "write";
      log[_0x281ef7(1341)](_0x281ef7(490) + _0x293872[_0x281ef7(1171)]() + _0x281ef7(1828) + _0x47758f[_0x281ef7(1115)] + _0x281ef7(591));
      let _0x3d3ba3 = _0x47758f;
      const _0x13c0b3 = 4, _0x96b468 = await canGetContextFromCurrentApp();
      let _0x4f9617 = "", _0x2232a0 = "";
      try {
        if (_0x96b468) {
          const _0xea97b4 = await getFullCursorContext(_0x13c0b3);
          _0x4f9617 = _0xea97b4[_0x281ef7(1377)], _0x2232a0 = _0xea97b4[_0x281ef7(839)];
        }
      } catch (_0x4dc19a) {
        console[_0x281ef7(981)](" Cursor context failed:", _0x4dc19a);
      }
      const _0x24fb0f = _0x3d3ba3[_0x281ef7(1699)]()[_0x281ef7(1163)](/\s+/)[_0x281ef7(1115)] === 1;
      _0x24fb0f && (_0x3d3ba3 = grammarRulesService[_0x281ef7(796)](_0x3d3ba3));
      _0x3d3ba3 = grammarRulesService[_0x281ef7(1693)](_0x4f9617, _0x3d3ba3), _0x3d3ba3 = grammarRulesService[_0x281ef7(637)](_0x4f9617, _0x3d3ba3), _0x3d3ba3 = grammarRulesService[_0x281ef7(709)](_0x2232a0, _0x3d3ba3), log[_0x281ef7(1341)](_0x281ef7(397) + _0x293872[_0x281ef7(1171)]() + _0x281ef7(1204));
      const _0x54b776 = await isFocusedElementEditable(), _0x475c80 = store[_0x281ef7(1043)](STORE_KEYS[_0x281ef7(193)]), _0x5cb2b8 = _0x475c80?.[_0x281ef7(596)] ?? ![];
      if (!_0x54b776 || !_0x5cb2b8) {
        log[_0x281ef7(1341)](_0x281ef7(1603) + _0x54b776 + _0x281ef7(1397) + _0x5cb2b8 + ")");
        const _0x3b9b24 = grpcClient[_0x281ef7(815)](), _0x59f7b2 = applyJapaneseHomophoneCorrections(_0x51ac40 || _0x47758f);
        chatSessionManager[_0x281ef7(1854)]({ "ocrText": this[_0x281ef7(1008)] || void 0, "selectedText": _0x3b9b24 || void 0, "appName": _0x5a7ef3, "windowTitle": _0x340c2a, "windowUrl": _0x3104e2, "accessibilityText": this[_0x281ef7(696)] || void 0, "originalTranscript": _0x59f7b2, "originalResponse": _0x3d3ba3[_0x281ef7(1699)]() }), _0x3fa9c2 && !_0x3fa9c2[_0x281ef7(496)]() && _0x3fa9c2[_0x281ef7(890)][_0x281ef7(965)](IPC_EVENTS[_0x281ef7(206)], { "text": _0x3d3ba3[_0x281ef7(1699)](), "sessionActive": !![], "originalTranscript": _0x59f7b2 }), clipboardManager[_0x281ef7(788)]();
      } else {
        _0x3fa9c2 && !_0x3fa9c2[_0x281ef7(496)]() && (_0x3fa9c2[_0x281ef7(890)][_0x281ef7(965)](IPC_EVENTS[_0x281ef7(1113)], { "isProcessing": ![] }), _0x3fa9c2[_0x281ef7(890)][_0x281ef7(965)](IPC_EVENTS[_0x281ef7(471)], { "isRecording": ![], "mode": null, "skipSound": !![] }));
        const _0x2bbd74 = shouldSimulateEnterAndClear();
        await this[_0x281ef7(1134)][_0x281ef7(1809)](_0x3d3ba3, this[_0x281ef7(1790)]), clipboardManager[_0x281ef7(788)](), _0x2bbd74 && (log[_0x281ef7(1341)]("[WriteInputService] Simulating Enter key after text insertion"), await new Promise((_0x457ca0) => setTimeout(_0x457ca0, 50)), await pressEnterKey()), _0x3fa9c2 && !_0x3fa9c2[_0x281ef7(496)]() && (_0x3fa9c2[_0x281ef7(890)][_0x281ef7(965)](IPC_EVENTS[_0x281ef7(471)], { "isRecording": ![], "mode": null, "skipSound": !![] }), log[_0x281ef7(1341)]("[WriteInputService] Text insertion complete (silent)"));
      }
      this[_0x281ef7(1591)] && this[_0x281ef7(1104)] && this[_0x281ef7(1099)] && _0x47758f ? (log[_0x281ef7(1341)]("[WriteInputService] Saving voice session"), this[_0x281ef7(579)][_0x281ef7(1659)](this[_0x281ef7(1099)], _0x3d3ba3, _0x5a7ef3, _0x340c2a, this[_0x281ef7(1591)], this[_0x281ef7(1104)], _0x515e89)[_0x281ef7(843)](() => {
        const _0x259f08 = _0x281ef7;
        log[_0x259f08(1341)]("[WriteInputService] Voice session saved successfully"), this[_0x259f08(579)][_0x259f08(1145)]();
      })[_0x281ef7(564)]((_0x144569) => {
        const _0x20836d = _0x281ef7;
        log[_0x20836d(981)]("[WriteInputService] Failed to save voice session:", _0x144569), this[_0x20836d(579)][_0x20836d(1145)]();
      })) : (log[_0x281ef7(1697)]("[WriteInputService] Skipping voice session save - missing data", { "hasAudioBuffer": !!this[_0x281ef7(1591)], "hasSampleRate": !!this[_0x281ef7(1104)], "hasTranscript": !!this[_0x281ef7(1099)] }), this[_0x281ef7(579)][_0x281ef7(1145)]());
      if (this[_0x281ef7(1790)]) {
        const _0x107bc4 = _0x3c82be ? _0x281ef7(669) : _0x281ef7(1100);
        traceLogger[_0x281ef7(1118)](this[_0x281ef7(1790)], _0x107bc4, { "textLength": _0x3d3ba3[_0x281ef7(1115)] });
      }
    } catch (_0x13cdb0) {
      log[_0x281ef7(981)]("[WriteInputService] Error in OCR/generate API call:", _0x13cdb0);
      const _0x5e812d = _0x13cdb0 instanceof Error ? _0x13cdb0[_0x281ef7(1486)] : String(_0x13cdb0), _0x4edda5 = _0x5e812d[_0x281ef7(1580)]("Weekly limit") || _0x5e812d[_0x281ef7(1580)]("Usage limit exceeded"), _0x454cdb = _0x4edda5 ? _0x281ef7(1847) : _0x281ef7(363), _0x1ada40 = getPillWindow();
      if (_0x1ada40 && !_0x1ada40[_0x281ef7(496)]()) {
        const _0x31b531 = { "code": _0x454cdb, "message": _0x5e812d };
        _0x1ada40[_0x281ef7(890)][_0x281ef7(965)](IPC_EVENTS[_0x281ef7(1462)], _0x31b531), log[_0x281ef7(1341)](_0x281ef7(312) + _0x454cdb);
      }
      if (_0x4edda5) {
        log[_0x281ef7(1697)]("[WriteInputService] Usage limit exceeded error in generate API");
        const { BrowserWindow: _0x1ad758 } = await import("electron");
        _0x1ad758[_0x281ef7(1274)]()[_0x281ef7(878)]((_0x2b3f64) => {
          const _0x1b8af9 = _0x281ef7;
          _0x2b3f64[_0x1b8af9(890)][_0x1b8af9(965)]("usage-updated", { "allowed": ![], "reason": _0x5e812d });
        });
      }
      clipboardManager[_0x281ef7(788)](), this[_0x281ef7(579)][_0x281ef7(1145)]();
    } finally {
      this[_0x281ef7(237)](!![]);
    }
  }
  [_0x54a1b7(969)]() {
    const _0x37c223 = _0x54a1b7;
    if (!this[_0x37c223(1727)]) {
      log[_0x37c223(1341)]("[WriteInputService] Cancel requested but no active session");
      return;
    }
    log[_0x37c223(1341)]("[WriteInputService] Canceling GEN mode session"), clipboardManager[_0x37c223(788)](), this[_0x37c223(579)][_0x37c223(1145)](), this[_0x37c223(237)](!![]);
  }
  [_0x54a1b7(237)](_0x1e95ca = !![]) {
    const _0x49835d = _0x54a1b7;
    this[_0x49835d(1727)] = ![], this[_0x49835d(1714)] = null, this[_0x49835d(1008)] = null, this[_0x49835d(803)] = null, this[_0x49835d(917)] = null, this[_0x49835d(1790)] = null, this[_0x49835d(1591)] = null, this[_0x49835d(1104)] = null, this[_0x49835d(1099)] = null, this[_0x49835d(696)] = null, this[_0x49835d(958)] = ![];
    if (_0x1e95ca) {
      const _0x20b7f3 = getPillWindow();
      _0x20b7f3 && !_0x20b7f3[_0x49835d(496)]() && (_0x20b7f3[_0x49835d(890)][_0x49835d(965)](IPC_EVENTS[_0x49835d(1113)], { "isProcessing": ![] }), _0x20b7f3[_0x49835d(890)][_0x49835d(965)](IPC_EVENTS[_0x49835d(471)], { "isRecording": ![], "mode": null, "skipSound": !![] }), log[_0x49835d(1341)]("[WriteInputService] Pill UI reset during cleanup"));
    }
    log[_0x49835d(1341)]("[WriteInputService] Write session cleaned up");
  }
  [_0x54a1b7(1205)]() {
    const _0x227165 = _0x54a1b7;
    return this[_0x227165(1727)];
  }
  [_0x54a1b7(1579)](_0x5081e1, _0x468225, _0x463ae8) {
    const _0x483a3e = _0x54a1b7;
    this[_0x483a3e(1258)] = { "appName": _0x5081e1, "windowTitle": _0x468225, "contextText": _0x463ae8 }, log[_0x483a3e(1341)]("[WriteInputService] Override app context set:", { "appName": _0x5081e1, "windowTitle": _0x468225, "contextTextLength": _0x463ae8?.[_0x483a3e(1115)] || 0 });
  }
  [_0x54a1b7(342)]() {
    const _0xadeb9e = _0x54a1b7;
    this[_0xadeb9e(1258)] = null, log[_0xadeb9e(1341)]("[WriteInputService] Override app context cleared");
  }
}
let writeInputServiceInstance = null;
function getWriteInputService() {
  return !writeInputServiceInstance && (writeInputServiceInstance = new WriteInputService()), writeInputServiceInstance;
}
const writeInputService = Object[_0x54a1b7(502)](Object[_0x54a1b7(634)]({ "__proto__": null, "WriteInputService": WriteInputService, "getWriteInputService": getWriteInputService }, Symbol[_0x54a1b7(1177)], { "value": _0x54a1b7(1416) }));
class VoiceInputService {
  [_0x54a1b7(1589)] = null;
  constructor() {
    const _0x288315 = _0x54a1b7;
    this[_0x288315(173)]();
  }
  [_0x54a1b7(173)]() {
    startAppMonitor(async (_0x5d2516) => {
      const _0xe94471 = _0x1d03;
      try {
        const { appName: _0x19ee73, iconBase64: _0x50534d, url: _0x3c7ef8 } = _0x5d2516, _0x99a567 = this[_0xe94471(1589)]?.[_0xe94471(1856)] !== _0x19ee73, _0x1470e6 = !this[_0xe94471(1589)]?.[_0xe94471(852)] && !!_0x50534d, _0x146467 = this[_0xe94471(1589)]?.[_0xe94471(503)] !== _0x3c7ef8;
        if (_0x99a567 || _0x1470e6 || _0x146467) {
          this[_0xe94471(1589)] = { "appName": _0x19ee73, "iconBase64": _0x50534d, "url": _0x3c7ef8 };
          let _0x639504 = _0x50534d;
          if (_0x3c7ef8 && _0x146467) {
            const { fetchFavicon: _0x441273 } = await Promise[_0xe94471(1786)]()[_0xe94471(843)](() => require("./chunks/favicon-fetcher-Cu0dRpSg.js")), { faviconCache: _0x5dd40a } = await Promise[_0xe94471(1786)]()[_0xe94471(843)](() => require("./chunks/favicon-cache-hWTFEtqN.js")), { appIconCache: _0xbb87a5 } = await Promise[_0xe94471(1786)]()[_0xe94471(843)](() => appIconCache$1), _0xab7969 = _0x5dd40a[_0xe94471(1043)](_0x3c7ef8);
            if (_0xab7969) _0x639504 = _0xab7969, this[_0xe94471(1589)][_0xe94471(621)] = _0xab7969, _0xbb87a5[_0xe94471(1359)](_0x19ee73, _0xab7969);
            else {
              const _0xecf774 = await _0x441273(_0x3c7ef8);
              _0xecf774 && (_0x639504 = _0xecf774, this[_0xe94471(1589)][_0xe94471(621)] = _0xecf774, _0xbb87a5[_0xe94471(1359)](_0x19ee73, _0xecf774));
            }
          } else _0x3c7ef8 && this[_0xe94471(1589)]?.[_0xe94471(621)] && (_0x639504 = this[_0xe94471(1589)][_0xe94471(621)]);
          getPillWindow()?.[_0xe94471(890)][_0xe94471(965)](IPC_EVENTS[_0xe94471(1331)], { "appIcon": _0x639504 || null, "appName": _0x19ee73, "isFavicon": !!this[_0xe94471(1589)][_0xe94471(621)] && _0x639504 === this[_0xe94471(1589)][_0xe94471(621)] });
        }
      } catch (_0x589f15) {
        log[_0xe94471(981)]("Error in app monitor callback:", _0x589f15);
      }
    });
  }
  [_0x54a1b7(896)] = async (_0x33e3e6, _0x29ea48) => {
    const _0x35c50c = _0x54a1b7;
    _0x29ea48?.[_0x35c50c(916)] && transcriptionService[_0x35c50c(837)](!![]);
    let _0x385092, _0x35e149 = ![];
    _0x33e3e6 !== void 0 ? (_0x385092 = _0x33e3e6, console[_0x35c50c(1341)](_0x35c50c(1039), _0x385092 === VoiceOSMode[_0x35c50c(1607)] ? _0x35c50c(1607) : _0x385092 === VoiceOSMode[_0x35c50c(872)] ? _0x35c50c(872) : _0x35c50c(1647), _0x29ea48?.[_0x35c50c(916)] ? _0x35c50c(542) : "")) : (_0x35e149 = await hasSelectedText(), _0x385092 = VoiceOSMode[_0x35c50c(124)], console[_0x35c50c(1341)](_0x35c50c(835), _0x35e149 ? "(text selected - will be replaced)" : "(no text selected)"));
    const _0x285ce0 = store[_0x35c50c(1043)](STORE_KEYS[_0x35c50c(193)])[_0x35c50c(548)], _0x5c17cf = store[_0x35c50c(1043)](STORE_KEYS[_0x35c50c(193)]), _0x54ec53 = globalThis[_0x35c50c(683)];
    _0x54ec53 && traceLogger[_0x35c50c(1118)](_0x54ec53, _0x35c50c(1090), { "deviceId": _0x285ce0, "muteWhenDictating": _0x5c17cf?.[_0x35c50c(347)], "mode": _0x385092, "textIsSelected": _0x35e149, "wasRequested": _0x33e3e6 !== void 0 });
    const _0x2d7100 = await transcriptionService[_0x35c50c(1554)](_0x385092);
    if (!_0x2d7100) {
      console[_0x35c50c(1697)]("[Audio] Transcription did not start, skipping recorder start");
      return;
    }
    console[_0x35c50c(1341)]("[Audio] Starting audio recording on device:", _0x285ce0), audioRecorderService[_0x35c50c(802)](_0x285ce0);
    const _0x158b16 = this[_0x35c50c(1589)], _0x5996ee = { "isRecording": !![], "deviceId": _0x285ce0, "mode": _0x385092, "appIcon": _0x158b16?.[_0x35c50c(852)] || null, "appName": _0x158b16?.[_0x35c50c(1856)], "isFavicon": ![] };
    getPillWindow()?.[_0x35c50c(890)][_0x35c50c(965)](IPC_EVENTS[_0x35c50c(471)], _0x5996ee);
    if (this[_0x35c50c(1589)]) {
      const _0x52bbaf = !!this[_0x35c50c(1589)][_0x35c50c(621)], _0x25bb09 = this[_0x35c50c(1589)][_0x35c50c(621)] || this[_0x35c50c(1589)][_0x35c50c(852)];
      if (_0x25bb09 || this[_0x35c50c(1589)][_0x35c50c(1856)]) {
        const _0x3c6b17 = { "isRecording": !![], "deviceId": _0x285ce0, "mode": _0x385092, "appIcon": _0x25bb09 || null, "appName": this[_0x35c50c(1589)][_0x35c50c(1856)], "skipSound": !![], "isFavicon": _0x52bbaf };
        getPillWindow()?.[_0x35c50c(890)][_0x35c50c(965)](IPC_EVENTS[_0x35c50c(471)], _0x3c6b17), log[_0x35c50c(1341)](_0x35c50c(653) + (_0x52bbaf ? "cached favicon" : "cached app icon"));
      }
    }
    notifyPillIfUpdateReady();
  };
  [_0x54a1b7(1158)] = () => {
    const _0x3b4476 = _0x54a1b7;
    console[_0x3b4476(1341)](_0x3b4476(1371));
    const _0x5046a1 = globalThis[_0x3b4476(683)];
    _0x5046a1 && traceLogger[_0x3b4476(1118)](_0x5046a1, _0x3b4476(1077), { "muteWhenDictating": store[_0x3b4476(1043)](STORE_KEYS[_0x3b4476(193)])[_0x3b4476(347)] });
    audioRecorderService[_0x3b4476(976)](), transcriptionService[_0x3b4476(442)]();
    store[_0x3b4476(1043)](STORE_KEYS[_0x3b4476(193)])[_0x3b4476(347)] && (console[_0x3b4476(1341)]("[Audio] Unmuting system audio after dictation"), unmuteSystemAudio());
    const _0x31ad8b = { "isRecording": ![], "deviceId": "" };
    getPillWindow()?.[_0x3b4476(890)][_0x3b4476(965)](IPC_EVENTS[_0x3b4476(471)], _0x31ad8b);
    const _0x1a46ea = { "isProcessing": !![] };
    getPillWindow()?.[_0x3b4476(890)][_0x3b4476(965)](IPC_EVENTS[_0x3b4476(1113)], _0x1a46ea);
  };
  [_0x54a1b7(1364)] = () => {
    const _0x2daaaf = _0x54a1b7;
    audioRecorderService["on"]("audio-config", ({ outputSampleRate: _0x13d47e, sampleRate: _0x3852b6 }) => {
      const _0x12984e = _0x1d03, _0x355dc8 = _0x13d47e || _0x3852b6 || 16e3;
      transcriptionService[_0x12984e(811)]({ "sampleRate": _0x355dc8 });
    }), audioRecorderService["on"](_0x2daaaf(772), (_0x5f0422) => {
      const _0x6e4a8f = _0x2daaaf;
      transcriptionService[_0x6e4a8f(188)](_0x5f0422);
    }), audioRecorderService["on"]("volume-update", (_0x291b8d) => {
      const _0x5e20ff = _0x2daaaf;
      getPillWindow()?.[_0x5e20ff(890)][_0x5e20ff(965)](IPC_EVENTS[_0x5e20ff(405)], _0x291b8d), mainWindow && !mainWindow[_0x5e20ff(496)]() && !mainWindow[_0x5e20ff(890)][_0x5e20ff(496)]() && mainWindow[_0x5e20ff(890)][_0x5e20ff(965)](IPC_EVENTS[_0x5e20ff(405)], _0x291b8d);
    }), audioRecorderService["on"]("error", (_0x163c25) => {
      const _0x808cf6 = _0x2daaaf;
      console[_0x808cf6(981)](_0x808cf6(1513), _0x163c25[_0x808cf6(1486)]);
    }), audioRecorderService[_0x2daaaf(1247)]();
  };
  [_0x54a1b7(1268)] = (_0x2bf2b4) => {
    const _0x4fe9b0 = _0x54a1b7;
    audioRecorderService[_0x4fe9b0(353)](_0x2bf2b4);
  };
  [_0x54a1b7(1579)] = (_0x9dd23) => {
    const _0x4196ef = _0x54a1b7;
    grpcClient[_0x4196ef(1579)](_0x9dd23), _0x9dd23 && getWriteInputService()[_0x4196ef(1579)](_0x9dd23[_0x4196ef(1856)], _0x9dd23[_0x4196ef(688)], _0x9dd23[_0x4196ef(518)]);
  };
  [_0x54a1b7(1678)] = () => {
    const _0x4d2476 = _0x54a1b7;
    return grpcClient[_0x4d2476(1678)]();
  };
  [_0x54a1b7(342)] = () => {
    const _0x286d20 = _0x54a1b7;
    grpcClient[_0x286d20(342)](), getWriteInputService()[_0x286d20(342)]();
  };
}
const voiceInputService = new VoiceInputService(), voiceInputService$1 = Object[_0x54a1b7(502)](Object[_0x54a1b7(634)]({ "__proto__": null, "VoiceInputService": VoiceInputService, "voiceInputService": voiceInputService }, Symbol[_0x54a1b7(1177)], { "value": _0x54a1b7(1416) })), keyNameMap = { "MetaLeft": _0x54a1b7(447), "MetaRight": _0x54a1b7(980), "ControlLeft": "control-left", "ControlRight": "control-right", "Alt": "option-left", "AltGr": "option-right", "ShiftLeft": _0x54a1b7(903), "ShiftRight": _0x54a1b7(1404), "Function": "fn", "Unknown(179)": _0x54a1b7(1769), "KeyA": "a", "KeyB": "b", "KeyC": "c", "KeyD": "d", "KeyE": "e", "KeyF": "f", "KeyG": "g", "KeyH": "h", "KeyI": "i", "KeyJ": "j", "KeyK": "k", "KeyL": "l", "KeyM": "m", "KeyN": "n", "KeyO": "o", "KeyP": "p", "KeyQ": "q", "KeyR": "r", "KeyS": "s", "KeyT": "t", "KeyU": "u", "KeyV": "v", "KeyW": "w", "KeyX": "x", "KeyY": "y", "KeyZ": "z", "Digit1": "1", "Digit2": "2", "Digit3": "3", "Digit4": "4", "Digit5": "5", "Digit6": "6", "Digit7": "7", "Digit8": "8", "Digit9": "9", "Digit0": "0", "Space": _0x54a1b7(1842), "Enter": _0x54a1b7(470), "Return": _0x54a1b7(470), "Escape": _0x54a1b7(1621), "Backspace": _0x54a1b7(300), "Tab": _0x54a1b7(1266), "CapsLock": _0x54a1b7(487), "Delete": "delete", "BackQuote": "`", "ArrowUp": "", "ArrowDown": "", "ArrowLeft": "", "ArrowRight": "" }, legacyKeyMap = { "command": _0x54a1b7(447), "control": "control-left", "option": "option-left", "shift": _0x54a1b7(903), "alt": "option-left" };
function normalizeLegacyKey(_0x236c38) {
  return legacyKeyMap[_0x236c38] || _0x236c38;
}
const pillState = { "isActive": ![], "currentMode": null, "sessionActive": ![], "selectedText": null, "capturedScreenshot": null, "accessibilityText": null, "cropBounds": null };
function resetState() {
  const _0x10e9ed = _0x54a1b7;
  pillState[_0x10e9ed(1727)] = ![], pillState[_0x10e9ed(331)] = null, pillState[_0x10e9ed(1418)] = ![], pillState[_0x10e9ed(493)] = null, pillState[_0x10e9ed(552)] = null, pillState[_0x10e9ed(696)] = null, pillState[_0x10e9ed(1551)] = null;
}
function _0x475e() {
  const _0x7080dc = ["gcloud", " chars\n", "clearInteractionAudio", ".it", ", hasText=", "AXHeading", "[gRPC Client]   DEPRECATED: setAccessibilityTree() - Use AccessibilityContext stream message instead (", "stdout", "[AudioService] Recording stopped", '\n\n[Voice command: "', "make", "now", ") pressed during recording - activating hands-free mode", "customInstructions", ", branchStart=", "\n      INSERT INTO voice_sessions (id, user_id, transcript, generated_text, app_name, window_title, audio_blob_id, duration_seconds, sample_rate, word_count, mode, app_icon_id, created_at, updated_at, deleted_at, sync_failed_at)\n      VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)\n    ", "replace", "containsJapanese", " [Key listener] No heartbeat received for ", " pending migrations. Applying...", "delay", ".fr", "default-language", "alias", " Error adding abbreviation:", "ELECTRON_VITE_DEV_SERVER_URL", "cropBounds", " Failed to push dictionary item ", "isBashCommand", "startTranscription", "getBounds", "isQuitting", "[SelectedTextService]  Request ", "[WRITE][Keyboard] Accessibility extracted ", "gnome-terminal", "abbreviation", "[Keyboard] Cannot get cursor context from current app, skipping", ", pillActive=", "askForMediaAccess", "[TranscriptionService] Voice follow-up mode ", ", totalLines=", "toLowerCase", " reverted successfully. App will quit, please relaunch.", "iterm2", "guake", "powershell", "/llm/transform-text", "allowed", "setAppUserModelId", ".png", ", hasMicPermission: ", "VOICE_FOLLOW_UP_USER_MESSAGE", "input_sample_rate", "generated_text", "setOverrideAppContext", "includes", " mode transcription complete, forwarding to WriteInputService", "startIndex", "endsWith", "readText", "npm", "devices", "\nTree Length: ", "[WindowTextReader]  DEBUG: Condensed tree from ", "cachedActiveWindow", "[DictationManager] Voice session sent to server: ", "audioBuffer", "[TRANSCRIBE][Keyboard] Accessibility tree extracted ", "user_id", "UNKNOWN", "getHeadersWithMetadata", " (furigana: ", "1880022eTSMtc", "posthog-node", "[IPC] Base URL:", "-apple-macosx/release", "[ClipboardManager] New save - invalidating pending restore (op ", "TEXT_INSERTION", "[WriteInputService] Showing output in pill (isEditable=", "ms (op ", "isMinimizable", "dark", "WRITE", "sort", "clearSelectedText", "logo.png", ".be", "alert", "resourcesPath", "chatFollowUp", "HOTKEY_ACTIVATED", "payload", " [...]", "createConnectTransport", "Microphone permission status: ", "[WRITE][Keyboard] Capturing accessibility text for edit mode with PID: ", "esc", "dictationEndIndex", "[ImageCrop] Cropped image size: ", "tokenizeJapanese", "saveClipboard", ' LLM approved keyword: "', "Tray", "command prompt", "[gRPC Client] Accessibility tree truncated from ", "[window-corners] ", "endIndex", "isFullScreenWindow", "currentSampleRate", "[PillRecording] Error capturing screenshot:", "tmpdir", "targetPid", "drop", "join", "isVisible", "workArea", "composer", "[VoiceSessionManager] Failed to save app icon for ", "pendingFollowUpTimer", "cut", ".build/", "FORCE_DEVICE_LIST_RELOAD", "TRANSCRIBE", "No stored access token found, user needs to log in", "setSessionData", "&gt;", "LLM transformation failed: ", "PUT", "\n      INSERT INTO custom_instructions (id, user_id, app_identifier, instruction, created_at, updated_at, deleted_at)\n      VALUES (?, ?, ?, ?, ?, ?, ?)\n    ", ".html", "[ClipboardManager] Restore cancelled - superseded by newer operation (op ", "wasMerged", "eval", "[SelectedTextService]  Parsed response for requestId: ", "createVoiceSession", "save for later", "runSync", ".gql", "[ClipboardManager] Cleared saved clipboard state", "isPackaged", " (PID: ", "_onboardingOriginalMicName", "setLoginItemSettings", "date", ".sh", "boolean", "\n      DROP INDEX IF EXISTS idx_custom_instructions_user_app;\n      DROP TABLE IF EXISTS custom_instructions;\n    ", "originalTranscript", "bufferedAudioBytes", "0000_initial_schema", "table", "instance", "IPC: Received 'start-native-recording-test'", "getOverrideAppContext", "vercel", "ctx_", "stop-voice-follow-up-from-pill", "ENOENT", "./chunks/screenshotService-8591CldN.js", "main-process", "toggleDevTools", "shouldCapitalizeBasedOnContext", ".cpp", ", textLength=", "Addon loaded: ", "fullScreenshot", "[WindowTextReader]  DEBUG: Raw tree written to ", "APP_INITIALIZED", "setCaseFirstWord", "word_count", "panel", ".tv", "warn", " found in DB but not in code.", "trim", "Canceled", "setWindowOpenHandler", "onboardingStep", "[ImageCrop]  Adding red outline around focused element: x=", "focus", ".com", "setMainWindow", "[PillRecording] Selected text detected (", "Failed to update user profile", "isRefreshingTokens", ".uk", 'Adding casual abbreviation "', "App monitor process error:", "active-window-listener", "screenshot", "[TRANSCRIBE][Keyboard] Using override context text for onboarding (", "(Onboarding)", "[TRANSCRIBE][Keyboard]  Override context sent via gRPC stream (", "light", "stop-handsfree-recording", "reduce", "sync.last_synced.", "[TraceLogger] Attempted to log step for unknown interaction: ", "clear", "fromWebContents", "Database", " Failed to capture post-paste state:", "isActive", "sqrt", "[TTS][grpcClient] Using fallback transformation format", "whereis", ".ico", "sent", " Cannot determine ", "[WindowTextReader]  DEBUG: Returning null because success=", "[Key listener] process closed with code: ", "setFullScreenable", "gunzip", "phc_w0ppTWhcPq9MGgvDoG9b4bR5TaaigHSOLTZ32WejPT8", "createClient", "tree", "base64:", "UPDATE_READY_FOR_PILL", "once", ".app", "[gRPC Client] Default language:", "STEP: ", "percentUsed", "Unavailable", "Final text length: ", "appInitialized", "ocrText", " timed out", "EDIT_MODE_TRANSCRIPTION_COMPLETED", "hasActiveSession", "hands-free-hint", "[PillRecording] Stopping recording from pill (paste)", "CLIENT_AUDIO_TOO_SHORT", '{}.constructor("return this")( )', "modeUpdate", "isEmail", "insert", "[WindowTextReader] Spawning window text reader at: ", "setToolTip", "has", "setFeedURL", "Column already exists, marking migration as applied: ", "[VoiceSessionManager] Skipping voice session creation for onboarding: ", "cancelTranscription", "fn_fast", "nohup", "% (", "return (function() ", "[IPC] Failed to stop hands-free recording:", "sudo", "[TranscriptionService] Sent mode update: ", "ONBOARDING_BLOCKED", "heroku", "chatSessionWasActive", "messageDesc", "deleteAllUserData", "setVisibleOnAllWorkspaces", "NODE_ENV", "setZoomLevel", "resolveNewChunk", "collapse", "resolve", "setAttribute", "Failed to delete knowledge item", "[PillRecording] Blocking Ask Mode during onboarding (step: ", "interactionId", "getContext", "idx", "voiceOSSessionStream", "getPosition", "html", "stat", "ms, restarting key listener...", "\n      INSERT INTO sync_metadata (id, timestamp)\n      VALUES (?, ?)\n      ON CONFLICT(id) DO UPDATE SET timestamp = excluded.timestamp;\n    ", "base64", "fileDesc", " chars) - EDIT mode", "capturePrimaryDisplay", "audioChunkQueue", "isStreaming", "isFileName", "vlmDescription", "restore", "auth", "insertText", "bounds", "Server responded with status: ", "://", "writeFileSync", "deleted_at", "getCurrentSampleRate", "getDisplayNearestPoint", "[ClipboardManager] Failed to save clipboard:", "denied", "DUPLICATE", "app:", " [Keyboard] Setting recording block keys: ", "ipcMain", "capture-failed", "pill-start-drag", "createDictionaryItem", ".ch", '[TTS][grpcClient] Transforming text with command: "', " mode - using generated text from transcription stream (", "getCaretBounds", "charAt", "paste", "getSessionStartTime", "setWindowCornerRadius result: ", "start-voice-follow-up-from-pill", "\n      INSERT INTO dictionary (id, user_id, text, description, app_identifiers, created_at, updated_at, deleted_at, sync_failed_at, auto_added)\n      VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?)\n      ON CONFLICT(id) DO UPDATE SET\n        text = excluded.text,\n        description = excluded.description,\n        app_identifiers = excluded.app_identifiers,\n        updated_at = excluded.updated_at,\n        deleted_at = excluded.deleted_at,\n        sync_failed_at = excluded.sync_failed_at,\n        auto_added = excluded.auto_added;\n    ", "prompt", "visual studio 2022", " Failed to revert migration ", ".graphql", "from", ".fi", "space", "setAuthToken", "[WindowTextReader]  DEBUG: getWindowTextString called with targetPid: ", "Escape", "1970-01-01T00:00:00.000Z", "USAGE_LIMIT_EXCEEDED", "traceId", "rustc", "USER_PROFILE", "[initializeAudioRecorder] Initializing audio recorder...", "weeklyLimit", "format", "startSession", "[gRPC Client] Selected text set: ", "appName", "[text] ", "content", "windows powershell", "NSImageNameStatusAvailable", "pip3", ".cn", "details", "phpstorm", "appIdentifiers", "[IPC] Failed to stop voice follow-up from pill:", "--html", "cropY", "currentDictationId", "[WriteInputService] Pill window not available", "systemPreferences", "DICTATE", "random", "createDictation", "dictationManager", ".br", "hide", "popUpContextMenu", "CHAT_FOLLOW_UP_PROCESSING", "Failed to spawn app monitor process:", "[IPC] Auth window navigating to:", "attachment", "SELECT 1;", "intl", "startsWith", "IPC: Received 'start-native-recording'", "Failed to activate trial:", "ansible", " knowledge items to gRPC client cache", "micSelected", "maximize", "clearSession", "CLIENT_NO_SPEECH_DETECTED", "gem", "originalResponse", " app icons to push", "quitAndInstall", ' Analyzing: "', "endsWithLineBreak", "console", "visual studio", ".doc", "watchWindowShortcuts", "[gRPC Client] Custom instructions updated: ", "[IPC] Auth window load failed:", "[gRPC Client] Adding knowledge items to headers:", "currentSessionId", "pathname", "\n        UPDATE custom_instructions \n        SET instruction = ?, updated_at = ?, deleted_at = NULL \n        WHERE id = ? \n        RETURNING *\n      ", "config", " (but usage was still recorded)", "onboardingCompleted", ".jpg", "app_identifiers", "startStreaming", "position", "git", ")...", "Cannot determine ", "Attempting to spawn key listener at: ", "initAppMonitor", "status", "pop", ", justCompleted=", "getVersion", "app", "http://localhost:", ") pressed again - stopping recording (submit)", "createAppIcon", ".ini", "width", "SECURITY_WARNING", "startPolling", "timeoutId", "handleAuthError", "handleAudioChunk", "[DictationManager] Failed to save app icon for ", "Migration ", "__MDLINK_", "selectAll", "SETTINGS", "[WRITE][Keyboard]   Stream not ready after ", "ping", ", App: ", "mergedApps", "cancelledByUser", "terraform", "getNativeWindowHandle", "[SelectedTextService] Cannot determine ", "[PillRecording] Including crop coordinates: x=", "weakmap", "keyboardShortcuts", "[TranscriptionService] Sent connection/transcription error to pill: ", "SHOW_OUTPUT_TEXT", "global", "[WRITE][Keyboard] Accessibility text for edit mode extracted (", "[IPC] Creating BrowserWindow for OAuth...", "transports", ", x=", "isMaximized", " session:", "[TranscriptionService] Voice follow-up mode - sending transcribed text as chat follow-up", "dismiss", "updateDictionaryItem", "setWindowCornerRadius", "git bash", "\n            INSERT INTO dictionary (id, user_id, text, description, app_identifiers, created_at, updated_at, deleted_at, sync_failed_at, auto_added)\n            VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?)\n        ", "Successfully set login item to: ", "title", "[TraceLogger] Cleaning up active interaction: ", "isAllUppercase", "cmake", "pathToFileURL", "originalElement", "Reverting migration: ", "Unmuting system audio. Restoring volume: ", " No user ID, cannot add keyword", "emacs", ' LLM approved abbreviation: "', "file_google_protobuf_duration", "chat-follow-up-processing", ", hasStartedGrpc=", "defaultApp", ", onboarding completed: ", "cleanup", "findById", "analyzeAbbreviationSuggestion", "SQLITE_CONSTRAINT_UNIQUE", "search", "sendTranscriptionResult", "normalizeOkay", "pillAppearance", "buildFromTemplate", ".md", ".ru", "getAccessibilityTree", "isSyncing", "maxTextLength", "Received: ", "[gRPC Client] Supported languages:", "brew", "[TranscriptionService] Sent transcription error to pill: ", "adoptDictationId", " Failed to push voice session ", "\n      CREATE TABLE IF NOT EXISTS app_icons (\n        id TEXT PRIMARY KEY,\n        user_id TEXT NOT NULL,\n        app_name TEXT NOT NULL,\n        icon_base64 TEXT NOT NULL,\n        created_at TEXT NOT NULL,\n        updated_at TEXT NOT NULL,\n        UNIQUE(user_id, app_name)\n      );\n      ALTER TABLE voice_sessions ADD COLUMN app_icon_id TEXT;\n      CREATE INDEX IF NOT EXISTS idx_app_icons_user_app ON app_icons(user_id, app_name);\n      CREATE INDEX IF NOT EXISTS idx_voice_sessions_app_icon_id ON voice_sessions(app_icon_id);\n    ", "listVoiceSessionsSince", "\nWindow: ", "app_icon_id", "assistant", "Result:", "initialize-audio-recorder", "compromise", "44NUDEbv", "DeadlineExceeded", "URL:", "terminate", "KB) with crop bounds: ", "[WRITE][Keyboard]  Accessibility context sent via gRPC stream (EDIT mode)", "_MODE_TRANSCRIPTION_FAILED", ".es", "[AudioService] Failed to start audio recorder:", "[AppMonitor] -> Saved as last external window\n", '" already exists in your dictionary', "[TraceLogger] Attempted to log error for unknown interaction: ", "quit", "mvn", ".blog", "mainWindow", "EventEmitter", "setCursorContext", "findIndex", "pill-unpin", "withRetry", "userId", "limit", "[WindowTextReader]  DEBUG: Filtered tree from ", "[ClipboardManager] Restored clipboard content (", "AXGroup", "[AudioStreamManager] Finished streaming. Total chunks sent:", "setAccessibilityTree", "setWindowButtonVisibility", "execSync", "[PillRecording] Blocking Dictation during onboarding (step: ", "php", " (merged)", "shell", "recordException", "backspace", "onHeadersReceived", "0KB", "round", "stopStreaming", "\n        DROP TABLE IF EXISTS notes;\n        DROP TABLE IF EXISTS dictionary_items;\n        DROP TABLE IF EXISTS interactions;\n        DROP TABLE IF EXISTS sync_metadata;\n      ", "map", "FAILED to load addon: ", "dictationStartTime", "keyboardShortcut", "shouldAdd", ' [current: "', "[WriteInputService] Sent transcription error to pill: ", "startGrpcIfReady", "currentShortcut", "clang", "updateMode", "\n      ALTER TABLE dictations ADD COLUMN sync_failed_at TEXT;\n      ALTER TABLE dictionary ADD COLUMN sync_failed_at TEXT;\n    ", "caret_", "Not authenticated - no access token found", "isAnalyzing", "reflect", " mode), starting recording...", "audio_blob_id", "update", "[SyncService] Successfully pushed app icon: ", "Shortcut ACTIVATED (", "UNKNOWN_ERROR", "\n      DROP TABLE IF EXISTS app_icons;\n      ALTER TABLE voice_sessions DROP COLUMN app_icon_id;\n    ", ".cc", "/#/pill", "currentMode", "promises", 'Detected potential multi-word abbreviation: "', "bind", "stopPolling", "error.", "slice", "[WRITE][Keyboard] Including crop coordinates: x=", "randomUUID", " Failed to analyze session:", "handsFreeKey", "clearOverrideAppContext", "Not authenticated", "dictationStartIndex", ".tech", "concat", "muteWhenDictating", "edit", "[PillRecording] No active recording to stop", "substring", " changes", "audioChunksForInteraction", "requestDeviceConfig", "execPath", "getLoginItemSettings", "getAccessibilityText", "[DictationManager] Session usage recorded, total sessions: ", "[Keyboard] Cursor context captured: ", ", mode: ", "END: ", "[PillRecording] Accessibility text captured (", "cropX", "CLIENT_API_ERROR", "=== RAW ACCESSIBILITY TREE ===\nTimestamp: ", ", w=", "instruction", ".sass", "[IPC] Received 'start-voice-follow-up-from-pill'", "Unknown(179)", "case", "setAlwaysOnTop", "netstat", "process", ".sql", "messages", "start", "toggleSounds", "DEBUG_EDIT_SESSION", "Failed to activate referral", "errno", "webstorm", "ConnectError", "reason", "clearKnowledgeItems", "\n      ALTER TABLE dictations DROP COLUMN sync_failed_at;\n      ALTER TABLE dictionary DROP COLUMN sync_failed_at;\n    ", "[WriteInputService] Transcription complete, ", "isfinite", "[IPC] Settings updated - handsFreeShortcut: ", "rmdir", "setFullScreen", " revert failed.", "listAppIcons", ".bash", "profile", "active", "setFocusable", "[WriteInputService] Applied grammar rules to ", "cropHeight", "maxDepth", "bundle", "[migrations] Running: ", "shouldUseDarkColors", " (type=", "lineIndex", "VOLUME_UPDATE", "zip", "[TranscriptionService] Updating mode from ", "[PillRecording] Cancelling recording from pill", "ssh", "forceDevUpdateConfig", "\n      -- Drop the old global unique index on text only\n      DROP INDEX IF EXISTS idx_dictionary_text_unique;\n      -- Create new unique index per user (user_id + text)\n      CREATE UNIQUE INDEX idx_dictionary_user_text_unique ON dictionary(user_id, text) WHERE deleted_at IS NULL;\n    ", "keysPressedTimestamp", "cropWidth", "activeSpans", "): ", "[WRITE][Keyboard] WRITE session activated (isUpgrade: ", "navigator", "value", "match", "isUrl", "deleteVoiceSession", "chmod", "[ImageCrop] Failed to create modified image", "deleteUserData", "Reverting the initial schema is not supported.", "unlink", "kai brokering", "softDelete", "handleVoiceFollowUp", "AUTH", "trimHistory", "KB)", `
      -- Repair migration: Add sync_failed_at to dictionary if it doesn't exist
      -- This fixes users whose 20251020000001 migration was incorrectly marked as applied
      -- If column already exists, this will fail with "duplicate column" which is handled by migration system
      ALTER TABLE dictionary ADD COLUMN sync_failed_at TEXT;
    `, "isProperNoun", "[Keyboard] DEBUG: key=", "hasStartedGrpc", "requestId", "[IPC] Received 'stop-voice-follow-up-from-pill'", "window", "findAll", " chars after", "stopTranscription", "uniq", "getAppPath", "find", "authToken", "command-left", "\n      -- This migration is likely already applied if duration_seconds exists\n      -- We'll make it safe by wrapping in a transaction\n      ALTER TABLE dictations ADD COLUMN duration_seconds REAL DEFAULT 0;\n    ", ".gif", "default", "screen", "window (", "18biFnGx", "getCurrentDictationId", "addCaretIndicator", "1770327TRHvfF", " chars before, ", "no-builtin-found", "TRANSCRIPTION_SUCCESS", "getActiveWindow", "SIGTERM", "getMediaAccessStatus", "casual", "clearSaved", "selectedTextPromise", "[PillRecording] Starting Ask Mode from pill", "minimize", ".no", "addControlMessage", "enter", "RECORDING_STATE_UPDATE", '" to built-in mic "', "which", "updatedAt", "aws", "VoiceOS", ", tree: ", "[PillRecording] Using override context for EDIT mode (", "addAbbreviationToDictionary", "\n      DROP INDEX IF EXISTS idx_dictionary_user_text_unique;\n      CREATE UNIQUE INDEX idx_dictionary_text_unique ON dictionary(text) WHERE deleted_at IS NULL;\n    ", "apt", "Failed to send message to main window on channel ", "cancelled", "transcribeStream", "gif picker", "tee", "caps", "[IPC] Redirect URI:", "ERR_ABORTED", "[WriteInputService] ", '[initializeMicrophoneSelection] Setting built-in microphone as default: "', "[SelectedTextService]  getCaretBounds called, process running: ", "selectedText", "findModifiedSince", "unref", "isDestroyed", "Deleting all data for user: ", ", voiceOSFocused: ", "icons", "setPosition", "setAsDefaultProtocolClient", "freeze", "url", "end.", "getZoomLevel", "delete", "knowledgeItems", "deletedAt", ".au", "findByAppIdentifier", "addAudioChunk", "createFromDataURL", "cachedOcrText", "&amp;", "toDataURL", "MetaRight", "clearFinalizingState", "contextText", "crop", "desc:", "getHeaders", "success", "SIGINT", "analyzeModifications", "significant_edit", "req_", "SETTINGS_UPDATE", "sample_rate", "push", "accessibilityTree", ".hpp", "[TranscriptionService] stopStreaming() called, currentMode=", "\n      CREATE TABLE IF NOT EXISTS voice_sessions (\n        id TEXT PRIMARY KEY,\n        user_id TEXT NOT NULL,\n        transcript TEXT,\n        generated_text TEXT,\n        app_name TEXT,\n        window_title TEXT,\n        audio_blob_id TEXT,\n        duration_seconds REAL,\n        sample_rate INTEGER,\n        word_count INTEGER,\n        created_at TEXT NOT NULL,\n        updated_at TEXT NOT NULL,\n        deleted_at TEXT,\n        sync_failed_at TEXT\n      );\n    ", "Auto select", "assign", ", focusedDepth=", "internal", "MINIMUM_AUDIO_DURATION_MS", "[WRITE][Keyboard] Full screenshot captured IMMEDIATELY (", ".edu", "knowledge-items", "(voice follow-up)", "cursorTextAfter", ".svg", "[IPC] Seat count:", "[Trace]", "chat-follow-up", "micDeviceId", "clipboard", "startTime", "Auto-detect", "capturedScreenshot", "height", "preventDefault", "gradle", " Error checking edit conditions:", "Service terminated", "AXLink", "reject", "module", "loadFile", "getInstance", "Loading addon from: ", "catch", "dock", "START: ", "isArray", "app_launched", "emit", "[IPC] Failed to stop recording from pill:", "getSources", "getPath", "Unsupported development platform for microphone-capture: ", "TRANSCRIPTION_START", "icon_base64", "Audio levels too low", "VOICE_FOLLOW_UP_ACTIVATED", ".pdf", "voiceSessionManager", "exception", "domain", "toISOString", "pill-stop-drag", ".jpeg", "currentUsage", "App monitor exited with code ", "handleTranscriptionResponse", "file_google_protobuf_timestamp", "transformTextWithLLM", "hostname", " chars)", "unmaximize", "initializeAudioRecorder", "[PostHog] Main process client initialized", "stderr", "autoPasteInstructMode", "pwd", " is not available on Windows", "<br>", "TimeoutError", "canSendMessage", "chown", "../../native/", "/referral/activate", "number", "Expected: ", "furigana", "toFixed", "overlayWindow", "updated_at", "[WindowTextReader]  DEBUG: Returning null because success=", "isEditable", "searchParams", " Failed to complete data deletion for user: ", "deno", "windows terminal", "listVoiceSessions", " Failed to apply migration ", "not-determined", "some", "favicon", "Request timed out", "cargo", '[IPC] Restored original microphone: "', "isCurrentlyStreaming", "debian", " custom instructions to gRPC client cache", "sessionStartTime", ".co", "radio", "cropImage", "bundleId", "supported-languages", "defineProperty", "[SelectedTextService]  Received data: ", "HANDS_FREE_HINT", "addLeadingSpaceIfNeeded", "shutdown", "[AudioService] Process exited with code: ", "channels", "accessToken", "[IPC] Chat follow-up failed:", "[SelectedTextService] Process exited with code: ", "clearCurrentDictation", ": with hostname 'auth' and pathname '/callback'", "Error parsing protocol URL:", "OUTPUT_TEXT_ESCAPE_DISMISS", "windowUrl", ".bat", "[IPC] Failed to delete voice session: ", "rawTranscript", "pullDictionaryItems", "[VoiceInput] Using ", "[ClipboardManager] Cleared clipboard (was empty before, op ", "tokenizeWords", "object", "ROLLBACK;", "No previous volume stored, cannot unmute", "clearAccessibilityTree", "[header] ", "[WRITE][Keyboard] Using override context text for edit mode (", "audio_blob", "CHAT_FOLLOW_UP_RESPONSE", "durationSeconds", "[IPC] Voice session soft-deleted on server: ", "#ffffff", '". Keeping their choice.', "macbook", "EDIT_MODE_COMPLETE", "[ImageCrop]  Element screen Y: ", "getByAppName", "Menu", "full-screen window", "First app launch detected, marking as initialized.", "parse", "[ImageCrop] Original image size: ", "createFromBitmap", "cat", "ubuntu", "data:text/html;charset=utf-8,", "toolbar", "keyword", "currentInteractionId", "ACCESS_TOKEN", "currentSession", "copy", "getCursorScreenPoint", "windowTitle", "createAudioStream", "Successfully set dock visibility to: ", "\n          UPDATE dictionary \n          SET app_identifiers = ?, description = COALESCE(?, description), updated_at = ?\n          WHERE id = ? \n          RETURNING *\n        ", "endInteraction", "readUInt8", ", postPasteText length: ", " with hostname '", "accessibilityText", 'Adding professional abbreviation "', "serviceDesc", "requestSingleInstanceLock", " sidebar zones to filter", "[WindowTextReader]  DEBUG: Service running: ", "[IPC] Failed to cancel recording from pill:", "[AppMonitor] getLastExternalActiveWindow() called, returning: ", "Migration with id ", "description", "document", "safeSendToMainWindow", "[WriteInputService] Active window context: ", "addTrailingSpaceIfNeeded", "audioBlob", "close", "pill-drag-move", "visual studio 2019", "top", "[SyncService] Found ", "[WRITE][Keyboard] Selected text detected (", " [PostHog] Failed to capture event:", "pollingIntervalId", "not-macos", "handsFreeShortcut", " applied successfully.", ".pl", "[SyncService] Pushing app icon: ", "ms, cannot send screenshot", "before", "clearCustomInstructions", "Accessibility permission status: ", "placeholder", "[IPC] Received 'chat-follow-up'", "logError", "getUsageStats", ' Auto-added keyword: "', "isTrustedAccessibilityClient", "no-original-stored", " skipped (already applied).", "setIgnoreMouseEvents", "addAssistantMessage", "sender", "sanitizeHeaderValue", "tar", "elementCount", "grpcStartTime", "expansion", "role", "capture", "head", "[PillRecording] No active recording to cancel", "972552msqGYo", "[WRITE][Keyboard] Sending full screenshot + crop bounds to server for VLM+OCR extraction (app: ", "getActiveInteractionCount", "handleTranscriptionError", "19DPVTiY", "[Keyboard] Skipping cursor context capture in override mode", "[WindowTextReader] Cannot determine ", "endSession", "[IPC] Received 'stop-handsfree-recording'", "startDictation", "CLIENT_TRANSCRIPTION_QUALITY_ERROR", "needsTrailingSpace", "g++", "provider", "client", "[TTS][grpcClient] LLM transformation successful", "[IPC] Has access token:", "[WindowTextReader]  DEBUG: getWindowText result: success=", "Failed to activate referral:", "[WindowTextReader]  DEBUG: Exception caught: ", "Found ", " items cached", "execFile", ".nz", "audio-chunk", "Got native handle, length: ", "file_google_protobuf_descriptor", "timeout", "stdin", "VOICE_FOLLOW_UP_SENT", "Code", "[IPC] Failed to capture screenshot", "/knowledge", " chars) - skipping screenshot", "[WRITE][Keyboard] Target app: ", ".jp", "events", "text", "getWindowText", " chars, op ", "restoreClipboard", "processId", "echo", "[main-auth] No access token found in store", "openExternal", "/knowledge/", "[VoiceSessionManager] App icon saved/updated for ", "AbortError", "normalizeOneWordDictation", "[FocusedElementReader] Cannot determine ", "getHistory", "firstName", "[TranscriptionService] Suppressed silent error (expected behavior): ", "hasPendingRestore", "startRecording", "screenshotPromise", ".log", "scaleFactor", "mate-terminal", ".java", "granted", '[TTS][grpcClient] Selected text: "', "upsert", "setAudioConfig", "[WRITE][Keyboard]  Accessibility context sent via gRPC stream (GEN mode, ", "machineId", ", allowed for next: ", "getSelectedText", "awk", "savedText", "[TRANSCRIBE][Keyboard]  Accessibility context sent via gRPC stream (text: ", "wordCount", ".org", "TRANSCRIPTION_FAILED", "undefined", "auto_added", "[CaretBounds] Native process returned error: ", "\n        UPDATE dictionary \n        SET description = ?, app_identifiers = ?, updated_at = ?, deleted_at = NULL, sync_failed_at = NULL, auto_added = 1 \n        WHERE id = ? \n        RETURNING *\n      ", "activate", "Window changed:", "tail", "ms, Sample rate:", "[IPC] Failed to delete voice session on server: ", "timestamp", "toBitmap", ".proto", "clearAccessibilityText", "[Audio] Starting STT service with DICTATE mode:", "daysUntilReset", "setVoiceFollowUpMode", "dictationId", "textAfter", "file", "[PillRecording] Using override context for WRITE mode (", "click", "then", '" (universal)', "role:", "securityWarning", " and arch ", "getSubscriptionStatus", "psl", ".se", " session due to transcription error", "iconBase64", " [TranscriptionService] Error canceling ", "[IPC] OAuth URL:", "atomics", "electronApp", "app_identifier", "windowId", "helm", "sessions", "app_name", "Successfully deleted all data for user: ", "neovim", "[CondenseTree] Detected ", "word", "\n      -- Check if column exists before adding (SQLite doesn't support IF NOT EXISTS for ALTER)\n      -- If this fails, the column already exists and we can safely ignore the error\n      ALTER TABLE dictations ADD COLUMN audio_blob BLOB;\n    ", "prototype", "isEmpty", "streamAudioChunks", "powerSaveBlocker", "hash", "EDIT", "Successfully completed data deletion for user: ", "markSyncFailed", "...", "net", "setAccessibilityText", "forEach", ".lock", "apply", "Quit VoiceOS", "more", "pnpm", "Failed", "&lt;", ", h=", "\n      INSERT INTO voice_sessions (id, user_id, transcript, generated_text, app_name, window_title, audio_blob_id, duration_seconds, sample_rate, word_count, mode, app_icon_id, created_at, updated_at, deleted_at, sync_failed_at)\n      VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)\n      ON CONFLICT(id) DO UPDATE SET\n        transcript = excluded.transcript,\n        generated_text = excluded.generated_text,\n        app_name = excluded.app_name,\n        window_title = excluded.window_title,\n        audio_blob_id = excluded.audio_blob_id,\n        duration_seconds = excluded.duration_seconds,\n        sample_rate = excluded.sample_rate,\n        word_count = excluded.word_count,\n        mode = excluded.mode,\n        app_icon_id = excluded.app_icon_id,\n        updated_at = excluded.updated_at,\n        deleted_at = excluded.deleted_at,\n        sync_failed_at = excluded.sync_failed_at;\n    ", "\n      INSERT INTO dictionary (id, user_id, text, description, app_identifiers, created_at, updated_at, deleted_at, sync_failed_at, auto_added)\n      VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?)\n    ", "cancelAtPeriodEnd", "webContents", "[AppMonitor] Window change detected: ", " error:", "open in", "charDelay", "ERR_FAILED", "startSTTService", "N/A", "KEYWORD_AUTO_ADDED", ".us", "ONBOARDING", "addKeywordToDictionary", "nvim", "shift-left", "desktopCapturer", '[initializeMicrophoneSelection] User has selected "', "constructor", "[TRANSCRIBE][Keyboard] Capturing accessibility text and tree with PID: ", "AXCell", "service", "readInt16LE", "trace", "transferred", "fastMode", "browser-window-created", "abs", "isVoiceFollowUp", "ocrPromise", "</a>", ".info", " binary path", "Failed to set corner radius: ", " chars from window", "Removing stuck key: ", "WRITE_MODE_TRANSCRIPTION_COMPLETED", "Download speed: ", "log", "window_title", "[IPC] Billing interval:", "homedir", "[WindowTextReader]  DEBUG: Filtered text length: ", "elementHash", "source", "functions", '" (length: ', "[TraceLogger] Attempted to end unknown interaction: ", "Applying migration: ", "parseint", "patch", "Restarting app via IPC request...", "createdAt", "moveTop", " mode, processing text (", "[CaretBounds] Native result: success=", "main", " (held for ", "remove", " [TTS][grpcClient] Error calling LLM transformation:", "emoji picker", "enabled", " ", " bytes, volume: ", "localstorage", "optimizer", "[WRITE][Keyboard] Screenshot captured for pill preview, skipping gRPC injection - using override context (onboarding/playground mode)", "getSize", "hotkeys", "whenReady", "hasSelectedText", ".csv", "captureForAI", "selectedAudioInput", "OUTPUT_TEXT_ENTER_PASTE", "BrowserWindow", ", user: ", "send", "[SyncService] Updating last sync timestamp to:", " - Downloaded ", "WRITE_MODE_START", "cancelWriteSession", "www.", "audioBlobId", "debug", "planType", "</body></html>", "audio", "stopRecording", " - ", "mkdir", "appPid", "command-right", "error", "controlMessageQueue", "kali", " modifications for app: ", "ERROR: ", "getFullHistory", " - for app: ", "Failed to create knowledge item", "TRANSCRIPTION_COMPLETED", ".fish", '" for onboarding', ".nl", "Unknown", "formatting", "setCustomInstructions", "DELETE", "open-auth-window", '" -> "', "findWordModifications", "Starting app monitor: ", "app-observer", "DICTIONARY_CHANGED", ".in", "syncInterval", 'Text appended after dictation - ending session. Added: "', "right-click", "[WindowTextReader]  DEBUG: getWindowText result: success=", "preExtractedOcrText", ".rb", "[ImageCrop]  Element position in image: x=", "cancel-handsfree-recording", "import", "returnValue", "unknown", '" for app: ', "reloadIgnoringCache", "diff", "transformedText", "pushDictionaryItems", "write", "items", "AUDIO_RECORDING_START", "USER_AUTH_UPDATE", "deleteDictionaryItem", "Initializing audio recorder (onboardingCompleted: ", "[IPC] Failed to process chat follow-up:", ' Auto-added abbreviation: "', "forwardAudioChunk", "[IPC] Error capturing screenshot:", "[WRITE][Keyboard]  Full screenshot + crop bounds sent to server via gRPC stream (", "POST", "enabledLanguages", "addEvent", "true", "isFinalizingState", " chars", "keys", "[FocusedElementReader] Error:", "[Audio] Starting STT service with requested mode:", "[ClipboardManager] Scheduling clipboard restore in ", "/stripe/prices", "output_sample_rate", "get", "ms,", "separator", "[DictationManager] App icon saved/updated for ", "16LcfCBQ", "sendToLlmForAnalysis", "\nApp: ", "all", "setAudioData", "windowMessenger", "pullVoiceSessions", "rio", "[DictationManager] Skipping voice session creation for filtered app: ", "unzip", "[NativeInterface] ", "\n      INSERT INTO app_icons (id, user_id, app_name, icon_base64, created_at, updated_at)\n      VALUES (?, ?, ?, ?, ?, ?)\n      ON CONFLICT(user_id, app_name) DO UPDATE SET\n        icon_base64 = excluded.icon_base64,\n        updated_at = excluded.updated_at\n      RETURNING *;\n    ", "[TranscriptionService] ", "getAudioStreamManager", "pullAppIcons", "audioStreamManager", "\n      ALTER TABLE dictations ADD COLUMN audio_blob_id TEXT;\n    ", "[ClipboardManager] Saved clipboard content (", "readUInt32LE", "[SelectedTextService] Spawning selected text reader at: ", "user", "getCustomInstruction", "[IPC] Voice session soft-deleted locally: ", "preDictationText", "end", "ID_TOKEN", "writeText", "AXRow", '" already exists', " Failed to start session:", "VOICE_INPUT_STOP", "nativeImage", "[VoiceSessionManager] Voice session saved locally: ", "built-in", ", treeLength=", "listDictionaryItems", "exec", "isRunning", ") - ", "setStatus", ".less", "[Keyboard] Hands-free shortcut (", "generatedText", "VOICE_INPUT_START", ", appName=", "getCustomInstructions", "recordVoiceSessionUsage", "\n      ALTER TABLE dictations ADD COLUMN sample_rate INTEGER;\n    ", ", pressedKeys=[", "[CondenseTree] Branch detection: focusedLine=", "[IPC] Failed to start gen mode from pill:", "hasMinimumDuration", "transcript", "WRITE_MODE_COMPLETE", "dnf", "autoUpdater", "test", "sampleRate", "checkForUpdates", "utf-8", "#Place", "<USER_TEXT_INPUT>", "parsefloat", "Process exited with code ", "[ScreenshotOverlay] Creating overlay on display at cursor: ", "whoami", "TRANSCRIPTION_PROCESSING", '" (', "length", "Starting complete data deletion for user: ", "ERROR", "logStep", "rails", "heading", "Server error: ", " [FOCUSED", "bun", "scroll", "min", "sqlite3", "MetaLeft", 'Custom instruction for "', "arch", "[ImageCrop]  Window bounds: x=", "getCurrentSessionId", "grep", "SERVER_CONNECTION_ERROR", "textInserter", "data", "[AudioStreamManager] Starting to stream audio chunks. Buffered:", "man", "pacman", "HOTKEY_UPGRADED", " Failed to analyze with LLM:", "manual", "created_at", "wtr_", "responseHeaders", "clearCurrentSession", "stop", "[AppMonitor] -> Ignored (VoiceOS/Electron)\n", "], allPressed=", "setSelectedText", "[Keyboard] Enter pressed - shortcutState.isActive=", "findInsertionPoint", 'osascript -e "set volume output volume ', "access_token", "type", "pipe", "state", " Failed to delete user data for user: ", "stopSTTService", "fetch", "TEXT_INSERTION_ERROR", "#/pill", "[IPC] Synced ", "split", ", handsFreeKeys=[", "isSameElement", ".toml", "getCursorTextAfter", ", y=", "readlink", "Failed to activate trial", "toUpperCase", "isFinalizing", "[DictationManager] Capturing window context: ", "BEGIN;", "sed", 'Detected multi-word replacement: "', "toStringTag", "showInactive", "[WindowTextReader]  DEBUG: getWindowTreeString called with targetPid: ", "[AudioService] First audio chunk received, size: ", ", hasTree=", "total", "[Keyboard] RAW KEY EVENT: ", "PostHog", "relaunch", "hasStartedStreaming", ".zsh", "NO_TEXT_FIELD_WARNING", "postPasteText", "FOCUSED: ", "[WindowTextReader] Process exited with code: ", "' and pathname '", "cancel", " to ", ".css", "characters", "context", "operationId", "Polling started", "where", "autoAdded", '..."', "every", " mode text", "isWriteSessionActive", ".exe", "Resource not found", "desc", "wezterm", "[Keyboard] Resetting shortcut state (reason: ", "cursorTextBefore", "hasSavedContent", "bigint", "[WRITE][Keyboard]  Override context sent via gRPC stream (EDIT mode, ", "Caret bounds request timed out", "[ScreenshotOverlay] Using full display overlay (", "setContextMenu", "sticker", "updateAvailable", "#ProperNoun", "transcribeAudioBuffer", "[ImageCrop] Error cropping image:", "updateDownloaded", "getInteractionAudioBuffer", "floor", "[PillRecording] Starting STT service with mode: ", "run", " Error adding keyword:", "terminal", "Unauthenticated", ".site", "[ScreenRecording] Triggering capture to register app with macOS...", "registerSchemesAsPrivileged", "[gRPC Client] Accessibility text truncated from ", "atob", "clearCursorContext", " binary path for platform ", "handleTranscriptionComplete", "heartbeat_ping", ".go", "undo", "getDeviceList", "isMaximizable", "/user/profile", " Failed to push app icon ", "\n      CREATE TABLE IF NOT EXISTS custom_instructions (\n        id TEXT PRIMARY KEY,\n        user_id TEXT NOT NULL,\n        app_identifier TEXT NOT NULL,\n        instruction TEXT NOT NULL,\n        created_at TEXT NOT NULL,\n        updated_at TEXT NOT NULL,\n        deleted_at TEXT,\n        UNIQUE(user_id, app_identifier)\n      );\n      CREATE INDEX IF NOT EXISTS idx_custom_instructions_user_app ON custom_instructions(user_id, app_identifier);\n    ", "initialize", "needsLeadingSpace", "listAppIconsSince", "utf8", "[ScreenshotOverlay] Skipping overlay for app: ", "listDictionaryItemsSince", "2150510hAsBQT", "session", "ELECTRON_RENDERER_URL", "htop", "indexOf", "overrideAppContext", "vim", "[...] ", "pip", "depth", "Failed to update knowledge item", "pushAppIcons", "journalctl", "tab", "isMinimized", "handleMicrophoneChanged", "nano", "[IPC] Failed to cancel hands-free recording:", "after", "__proto__", "kai:", "getAllWindows", "), scale: ", "name", "sendTranscriptionError", "loadURL", ", reason: ", "failed", "child_process", "[IPC] Screen capture failed:", " failed.", "_onboardingOriginalMicId", ".cmd", "show", "[ImageCrop] Cropping image to bounds: x=", "create", "passwd", "subl", "createFromNamedImage", " No user ID, cannot add abbreviation", "currentPeriodEnd", "pushVoiceSessions", "handle", "key", "[IPC] Received 'cancel-handsfree-recording'", "cache", "webRequest", "getCursorTextBefore", "screen-recording", ".at", "code", "No access token found", "string", "insertAutoAdded", "&quot;", "nativeTheme", "Supabase OAuth tokens found in protocol URL", "[AudioService] Recording started on device: ", "Screen Recording permission status: ", "2025-11-07-force-dark-pill", "reload", "dig", "buffer", ".scss", "autoRunAppAfterInstall", ", signal: ", "audioChunk", "alloc", "step.", "AUDIO_RECORDING_STOP", "\n        DROP TABLE IF EXISTS dictionary_items;\n        DROP TABLE IF EXISTS interactions;\n        DROP TABLE IF EXISTS sync_metadata;\n      ", "Bearer ", "[PillRecording] Full screenshot captured (", "[WriteInputService] Window URL: ", "[TranscriptionService] Canceling WRITE/EDIT session due to early release (hasStartedGrpc=false, actualMode=", "isFullScreen", "adoptSessionId", "duration_seconds", "ACTIVE_APP_UPDATE", "add", "[VoiceSessionManager] Session usage recorded, total sessions: ", "GET", ".me", "stopped", "scp", "isLoadingMainFrame", "captureFullScreenForAI", "defaultLanguage", "info", "airpods", "Failed to capture screenshot", "44012VxPoQB", "[AudioService] Unknown message type: ", ", error=", "startInteraction", "Shortcut DEACTIVATED, stopping recording...", "isCodeSnippet", "pendingRestoreId", ", position: (", "[WRITE][Keyboard]  Override context sent via gRPC stream (WRITE mode, ", "event", ': "', ".io", "bytesPerSample", "[gRPC Client] Knowledge items updated: ", "[VoiceSessionManager] Skipping voice session creation for filtered app: ", "set", "json", "TRANSCRIPTION_TOO_SHORT", "nslookup", "existsSync", "setUpAudioRecorderListeners", ".ai", ".net", "checkEditConditions", "setKnowledgeItems", "onTranscriptPasted", "resize", "[Audio] Stopping STT service", "shareUserData", ".ca", "0.0.23", "terminator", "getCursorContext", "textBefore", "size", "Polling stopped", "filter", "/trial/activate", '[Window: "', "0123456789abcdef", "maxLength", "math", "kill", "[TRANSCRIBE][Keyboard] Accessibility extracted ", "conversationHistory", "[WriteInputService] Using override app context: ", "startWriteSession", "started", ".biz", "[SelectedTextService]  Resolving request: ", "platform", ".js", "mode", ", autoPaste=", "Failed to parse active window JSON:", "node", "isnan", "btoa", "disabled", "getBufferedDurationMs", "shift-right", "level", "switched-to-builtin", "[gRPC Client]   DEPRECATED: setAccessibilityText() - Use AccessibilityContext stream message instead (", "drag", "require", "[AudioService] Spawning audio recorder at: ", "warp", " vs current ", "HOTKEY_PRESSED", "[IPC] Fetching:", " chars\n\n", "Module", "  Mod ", "sessionActive", "[gRPC Client] Selected text truncated to ", "[SelectedTextService]  Sending command: ", ".de", "createFromPath", "openMic", "spawn", "file_google_protobuf_field_mask", "percent", "COMMIT;", "\n        UPDATE dictionary \n        SET description = ?, app_identifiers = ?, updated_at = ?, deleted_at = NULL, sync_failed_at = NULL \n        WHERE id = ? \n        RETURNING *\n      ", "7c6b7a2e-0d7e-4a4a-9d3d-2a3d9b6f2b10", "protocol", "null", "1244635dEcNIs", "addUserMessage", "traceroute", ".webp", "6556dhaTSG", ".ps1", "[AudioService] Stopping audio recorder process.", "contextTextAfter", "gzip", '[IPC] Switched from "', "no-airpods-detected", ".rs", "ready-to-show: addon available = ", "[SelectedTextService]  Creating caret bounds request: ", "[IPC] Failed to start voice follow-up from pill:", "isHandsFree", "sync_failed_at", "shift", "toString", "entries", "java", "down", "index", "analyzeKeywordSuggestion", "host", "screen-saver", "Background noise drowning out speech", "open", "[WindowTextReader]  DEBUG: Exception caught: ", "free", "TRANSCRIPTION_ERROR", "[TranscriptionService] Canceling ", "[Keyboard] Blocking recording during onboarding (step: ", "statusText", "isDefaultProtocolClient", "bytesPerSecond", "[SyncService] Sync completed. Processed ", 'Pre-dictation text: "', "less", "TRANSCRIPTION_SKIPPED", ".store", "[ScreenshotOverlay] Creating overlay around active window: ", "lastKnownText", "redo", "click to", "gcc", "onboarding:", "App PID changed:", "javac", ".ts", "goland", "destroy", "YES", "Session ending for app: ", "message", "[gRPC Client] Cursor context set: ", "attributes", "promise", "ECONNREFUSED", "kubectl", "ONBOARDING_UPDATE", "spanId", '<a href="', '\n        <!DOCTYPE html>\n        <html>\n        <head>\n          <style>\n            * {\n              margin: 0;\n              padding: 0;\n              box-sizing: border-box;\n            }\n            body {\n              width: 100vw;\n              height: 100vh;\n              overflow: hidden;\n              background: transparent;\n            }\n            \n            .glass-container {\n              position: absolute;\n              top: 0;\n              left: 0;\n              right: 0;\n              bottom: 0;\n              overflow: hidden;\n              pointer-events: none;\n            }\n            \n            /* Main glass shine sweep */\n            .glass-shine {\n              position: absolute;\n              top: -50%;\n              left: -150%;\n              width: 80%;\n              height: 200%;\n              background: linear-gradient(\n                105deg,\n                transparent 0%,\n                transparent 35%,\n                rgba(120, 180, 255, 0.015) 38%,\n                rgba(120, 180, 255, 0.04) 42%,\n                rgba(120, 180, 255, 0.07) 45%,\n                rgba(120, 180, 255, 0.11) 48%,\n                rgba(120, 180, 255, 0.14) 50%,\n                rgba(120, 180, 255, 0.11) 52%,\n                rgba(120, 180, 255, 0.07) 55%,\n                rgba(120, 180, 255, 0.04) 58%,\n                rgba(120, 180, 255, 0.015) 62%,\n                transparent 65%,\n                transparent 100%\n              );\n              transform: rotate(15deg);\n              animation: shineSwipe 2.2s cubic-bezier(0.4, 0, 0.2, 1) forwards;\n            }\n            \n            /* Secondary softer shine for depth */\n            .glass-shine-soft {\n              position: absolute;\n              top: -50%;\n              left: -180%;\n              width: 120%;\n              height: 200%;\n              background: linear-gradient(\n                105deg,\n                transparent 0%,\n                transparent 40%,\n                rgba(120, 180, 255, 0.008) 44%,\n                rgba(120, 180, 255, 0.02) 48%,\n                rgba(120, 180, 255, 0.03) 50%,\n                rgba(120, 180, 255, 0.02) 52%,\n                rgba(120, 180, 255, 0.008) 56%,\n                transparent 60%,\n                transparent 100%\n              );\n              transform: rotate(15deg);\n              animation: shineSwipeSoft 2.2s cubic-bezier(0.4, 0, 0.2, 1) forwards;\n              animation-delay: 0.05s;\n            }\n            \n            @keyframes shineSwipe {\n              0% {\n                left: -150%;\n                opacity: 0;\n              }\n              10% {\n                opacity: 1;\n              }\n              80% {\n                opacity: 1;\n              }\n              100% {\n                left: 180%;\n                opacity: 0;\n              }\n            }\n            \n            @keyframes shineSwipeSoft {\n              0% {\n                left: -180%;\n                opacity: 0;\n              }\n              10% {\n                opacity: 1;\n              }\n              80% {\n                opacity: 1;\n              }\n              100% {\n                left: 150%;\n                opacity: 0;\n              }\n            }\n          </style>\n        </head>\n        <body>\n          <div class="glass-container">\n            <div class="glass-shine-soft"></div>\n            <div class="glass-shine"></div>\n          </div>\n        </body>\n        </html>\n      ', "Failed to spawn process", "item", "env", "<html><body>", "1.1", ".gov", "iterm", "stack", "[WRITE][Keyboard] Using override context text for write mode (", "[Key listener] process exited with code: ", "endTime", "max", "getDictationStartTime", "getVoiceFollowUpMode", "argv", "Settings", "insertedTranscript", " Audio Service Error:", "\n  CREATE TABLE dictations (\n    id TEXT PRIMARY KEY,\n    user_id TEXT,\n    final_transcription TEXT,\n    transcriber_response TEXT,\n    language_model_response TEXT,\n    audio_blob_id TEXT,\n    duration_seconds REAL,\n    sample_rate INTEGER,\n    word_count INTEGER,\n    created_at TEXT NOT NULL,\n    updated_at TEXT NOT NULL,\n    deleted_at TEXT,\n    sync_failed_at TEXT\n  );\n\n  CREATE TABLE dictionary (\n    id TEXT PRIMARY KEY,\n    user_id TEXT NOT NULL,\n    text TEXT NOT NULL,\n    description TEXT,\n    created_at TEXT NOT NULL,\n    updated_at TEXT NOT NULL,\n    deleted_at TEXT,\n    sync_failed_at TEXT,\n    auto_added INTEGER DEFAULT 0,\n    app_identifiers TEXT\n  );\n\n  CREATE TABLE voice_sessions (\n    id TEXT PRIMARY KEY,\n    user_id TEXT NOT NULL,\n    transcript TEXT,\n    generated_text TEXT,\n    app_name TEXT,\n    window_title TEXT,\n    audio_blob_id TEXT,\n    duration_seconds REAL,\n    sample_rate INTEGER,\n    word_count INTEGER,\n    mode INTEGER NOT NULL DEFAULT 0,\n    created_at TEXT NOT NULL,\n    updated_at TEXT NOT NULL,\n    deleted_at TEXT,\n    sync_failed_at TEXT,\n    app_icon_id TEXT\n  );\n\n  CREATE TABLE app_icons (\n    id TEXT PRIMARY KEY,\n    user_id TEXT NOT NULL,\n    app_name TEXT NOT NULL,\n    icon_base64 TEXT NOT NULL,\n    created_at TEXT NOT NULL,\n    updated_at TEXT NOT NULL,\n    UNIQUE(user_id, app_name)\n  );\n\n  CREATE TABLE sync_metadata (\n    id TEXT PRIMARY KEY,\n    timestamp TEXT\n  );\n", "CONVERSATION CONTENT:", "stringify", "touch", "[VoiceSessionManager] Voice session synced to server: ", ", isHandsFree=", "Incorrect sample rate", "[AudioService] stderr:", "securityAttemptCount", "Team ID is required", " [migrations] Failed: "];
  _0x475e = function() {
    return _0x7080dc;
  };
  return _0x475e();
}
async function startGenModeFromPill() {
  const _0xaabac0 = _0x54a1b7;
  if (pillState[_0xaabac0(1727)]) {
    log[_0xaabac0(1697)]("[PillRecording] Recording already active");
    return;
  }
  const _0x2a13e4 = store[_0xaabac0(1043)](STORE_KEYS[_0xaabac0(900)]);
  if (_0x2a13e4 && !_0x2a13e4[_0xaabac0(164)]) {
    const _0x21eef5 = _0x2a13e4[_0xaabac0(1702)], _0x4ab251 = [11, 12], _0x44f07b = isCurrentWindowVoiceOS();
    if (!_0x44f07b || !_0x4ab251[_0xaabac0(1580)](_0x21eef5)) {
      log[_0xaabac0(1341)](_0xaabac0(1789) + _0x21eef5 + _0xaabac0(498) + _0x44f07b + ")");
      if (!_0x44f07b) {
        const _0x4827fe = getPillWindow();
        _0x4827fe && !_0x4827fe[_0xaabac0(496)]() && _0x4827fe[_0xaabac0(890)][_0xaabac0(965)](IPC_EVENTS[_0xaabac0(1776)]);
      }
      return;
    }
  }
  log[_0xaabac0(1341)](_0xaabac0(466)), pillState[_0xaabac0(1727)] = !![], pillState[_0xaabac0(1418)] = !![];
  const _0x463454 = getLastExternalActiveWindow();
  let _0x32e229 = null;
  try {
    const { getSelectedTextString: _0x4129d0 } = await Promise[_0xaabac0(1786)]()[_0xaabac0(843)](() => selectedTextReader);
    _0x32e229 = await _0x4129d0();
    if (_0x32e229 && _0x32e229[_0xaabac0(1699)]()[_0xaabac0(1115)] > 0) {
      pillState[_0xaabac0(493)] = _0x32e229, log[_0xaabac0(1341)](_0xaabac0(1707) + _0x32e229[_0xaabac0(1115)] + _0xaabac0(1801));
      const _0x341ff6 = getPillWindow();
      _0x341ff6 && !_0x341ff6[_0xaabac0(496)]() && _0x341ff6[_0xaabac0(890)][_0xaabac0(965)]("selected-text-captured", { "text": _0x32e229 }), grpcClient[_0xaabac0(1149)](_0x32e229);
    }
  } catch (_0x13f064) {
    log[_0xaabac0(981)]("[PillRecording] Error reading selected text:", _0x13f064);
  }
  const _0x1b3a0c = _0x32e229 && _0x32e229[_0xaabac0(1699)]()[_0xaabac0(1115)] > 0 ? VoiceOSMode[_0xaabac0(872)] : VoiceOSMode[_0xaabac0(1607)];
  pillState[_0xaabac0(331)] = _0x1b3a0c;
  const _0x4f7a81 = getWriteInputService();
  _0x4f7a81[_0xaabac0(1390)](), log[_0xaabac0(1341)](_0xaabac0(1226) + (_0x1b3a0c === VoiceOSMode[_0xaabac0(872)] ? _0xaabac0(872) : _0xaabac0(1607))), voiceInputService[_0xaabac0(896)](_0x1b3a0c), captureContextInBackground(_0x463454, _0x1b3a0c);
}
async function captureContextInBackground(_0xad5f78, _0x734c25) {
  const _0x31be2c = _0x54a1b7;
  try {
    _0x734c25 === VoiceOSMode[_0x31be2c(872)] ? await captureEditModeContext(_0xad5f78) : await captureWriteModeContext(_0xad5f78);
  } catch (_0x4cc1be) {
    log[_0x31be2c(981)]("[PillRecording] Error in background context capture:", _0x4cc1be);
  } finally {
  }
}
async function captureEditModeContext(_0x25c539) {
  const _0x690580 = _0x54a1b7, _0x59c1a9 = grpcClient[_0x690580(1678)]();
  if (_0x59c1a9?.[_0x690580(518)]) {
    log[_0x690580(1341)](_0x690580(478) + _0x59c1a9[_0x690580(518)][_0x690580(1115)] + _0x690580(591)), pillState[_0x690580(696)] = _0x59c1a9[_0x690580(518)], grpcClient[_0x690580(877)](_0x59c1a9[_0x690580(518)]), sendAccessibilityViaGrpc(_0x59c1a9[_0x690580(518)]);
    return;
  }
  try {
    const _0x4f152f = _0x25c539?.[_0x690580(789)], { getWindowTextString: _0x43b8d8 } = await Promise[_0x690580(1786)]()[_0x690580(843)](() => windowTextReader), _0x3940bb = await _0x43b8d8(_0x4f152f);
    _0x3940bb && _0x3940bb[_0x690580(1699)]()[_0x690580(1115)] > 0 && (log[_0x690580(1341)](_0x690580(361) + _0x3940bb[_0x690580(1115)] + _0x690580(591)), pillState[_0x690580(696)] = _0x3940bb, sendAccessibilityViaGrpc(_0x3940bb));
  } catch (_0x88258c) {
    log[_0x690580(1697)]("[PillRecording] Error capturing accessibility text:", _0x88258c);
  }
  await captureScreenshot();
}
async function captureWriteModeContext(_0x15c648) {
  const _0x44bd5c = _0x54a1b7, _0x407c0a = grpcClient[_0x44bd5c(1678)]();
  if (_0x407c0a?.[_0x44bd5c(518)]) log[_0x44bd5c(1341)](_0x44bd5c(841) + _0x407c0a[_0x44bd5c(518)][_0x44bd5c(1115)] + _0x44bd5c(591)), pillState[_0x44bd5c(696)] = _0x407c0a[_0x44bd5c(518)], grpcClient[_0x44bd5c(877)](_0x407c0a[_0x44bd5c(518)]), sendAccessibilityViaGrpc(_0x407c0a[_0x44bd5c(518)]);
  else try {
    const _0x4b67be = _0x15c648?.[_0x44bd5c(789)], { getWindowTextString: _0x4e8827 } = await Promise[_0x44bd5c(1786)]()[_0x44bd5c(843)](() => windowTextReader), _0x5be6b4 = await _0x4e8827(_0x4b67be);
    _0x5be6b4 && _0x5be6b4[_0x44bd5c(1699)]()[_0x44bd5c(1115)] > 0 && (log[_0x44bd5c(1341)](_0x44bd5c(361) + _0x5be6b4[_0x44bd5c(1115)] + _0x44bd5c(591)), pillState[_0x44bd5c(696)] = _0x5be6b4, sendAccessibilityViaGrpc(_0x5be6b4));
  } catch (_0x579248) {
    log[_0x44bd5c(1697)]("[PillRecording] Error capturing accessibility text:", _0x579248);
  }
  await captureScreenshot();
}
async function captureScreenshot() {
  const _0x1fb76d = _0x54a1b7, { checkScreenRecordingPermission: _0x4f2a91 } = await Promise[_0x1fb76d(1786)]()[_0x1fb76d(843)](() => crossPlatform), _0x28fc72 = await _0x4f2a91(![]);
  if (!_0x28fc72) {
    log[_0x1fb76d(1341)]("[PillRecording] Screen recording permission not granted");
    const _0x3d96e7 = getPillWindow();
    _0x3d96e7 && !_0x3d96e7[_0x1fb76d(496)]() && _0x3d96e7[_0x1fb76d(890)][_0x1fb76d(965)]("write-mode-permission-required", _0x1fb76d(1301));
    return;
  }
  try {
    const { getScreenshotService: _0x2bb079 } = await Promise[_0x1fb76d(1786)]()[_0x1fb76d(843)](() => require(_0x1fb76d(1683))), _0x1dcae2 = _0x2bb079(), _0x41fdcd = await _0x1dcae2[_0x1fb76d(1339)]();
    if (_0x41fdcd && _0x41fdcd[_0x1fb76d(1690)] && pillState[_0x1fb76d(1418)]) {
      pillState[_0x1fb76d(552)] = _0x41fdcd[_0x1fb76d(1690)], pillState[_0x1fb76d(1551)] = _0x41fdcd[_0x1fb76d(1551)], log[_0x1fb76d(1341)](_0x1fb76d(1325) + Math[_0x1fb76d(303)](_0x41fdcd[_0x1fb76d(1690)][_0x1fb76d(1115)] / 1024) + _0x1fb76d(269) + (_0x41fdcd[_0x1fb76d(1551)] ? "x=" + _0x41fdcd[_0x1fb76d(1551)]["x"] + _0x1fb76d(1168) + _0x41fdcd[_0x1fb76d(1551)]["y"] + _0x1fb76d(365) + _0x41fdcd[_0x1fb76d(1551)][_0x1fb76d(183)] + _0x1fb76d(886) + _0x41fdcd[_0x1fb76d(1551)][_0x1fb76d(553)] : "none"));
      const _0x587d42 = getPillWindow();
      _0x587d42 && !_0x587d42[_0x1fb76d(496)]() && _0x587d42[_0x1fb76d(890)][_0x1fb76d(965)]("screenshot-captured", { "screenshot": _0x41fdcd[_0x1fb76d(1690)] }), sendScreenshotViaGrpc(_0x41fdcd[_0x1fb76d(1690)], _0x41fdcd[_0x1fb76d(1551)]);
    }
  } catch (_0x37e514) {
    log[_0x1fb76d(981)](_0x1fb76d(1634), _0x37e514);
  }
}
async function waitForStreamReady(_0x1266df = 2e3) {
  const _0x29c54d = _0x54a1b7, { transcriptionService: _0x5f2faa } = await Promise[_0x29c54d(1786)]()[_0x29c54d(843)](() => transcriptionService$1), _0x2032d2 = Date[_0x29c54d(1536)](), _0x232f95 = 50;
  while (Date[_0x29c54d(1536)]() - _0x2032d2 < _0x1266df) {
    if (_0x5f2faa[_0x29c54d(1060)]()[_0x29c54d(625)]()) return !![];
    await new Promise((_0x5c04a5) => setTimeout(_0x5c04a5, _0x232f95));
  }
  return ![];
}
async function sendAccessibilityViaGrpc(_0x1edd57) {
  const _0x513d8e = _0x54a1b7;
  try {
    const { transcriptionService: _0x1dae25 } = await Promise[_0x513d8e(1786)]()[_0x513d8e(843)](() => transcriptionService$1), { AccessibilityContextSchema: _0x19b88f, StreamMessageSchema: _0x2c8695 } = await Promise[_0x513d8e(1786)]()[_0x513d8e(843)](() => voiceos_pb), { create: _0x3635e5 } = await import("@bufbuild/protobuf"), _0x1ceedf = await waitForStreamReady();
    if (!_0x1ceedf) {
      log[_0x513d8e(1697)]("[PillRecording] Stream not ready, skipping accessibility context");
      return;
    }
    const _0x2b5aec = _0x3635e5(_0x2c8695, { "payload": { "case": "accessibilityContext", "value": _0x3635e5(_0x19b88f, { "accessibilityText": _0x1edd57 }) } });
    _0x1dae25[_0x513d8e(1060)]()[_0x513d8e(469)](_0x2b5aec), log[_0x513d8e(1341)]("[PillRecording] Accessibility context sent via gRPC");
  } catch (_0x2a1bfb) {
    log[_0x513d8e(981)]("[PillRecording] Error sending accessibility via gRPC:", _0x2a1bfb);
  }
}
async function sendScreenshotViaGrpc(_0x301620, _0x305088) {
  const _0x2fd8fe = _0x54a1b7, _0x5ea5db = grpcClient[_0x2fd8fe(1678)]();
  if (_0x5ea5db?.[_0x2fd8fe(518)]) {
    log[_0x2fd8fe(1341)]("[PillRecording] Skipping screenshot injection - using override context");
    return;
  }
  try {
    const { transcriptionService: _0x9aa31f } = await Promise[_0x2fd8fe(1786)]()[_0x2fd8fe(843)](() => transcriptionService$1), { ScreenshotContextSchema: _0x54ce40, StreamMessageSchema: _0x489295 } = await Promise[_0x2fd8fe(1786)]()[_0x2fd8fe(843)](() => voiceos_pb), { create: _0x2d8665 } = await import("@bufbuild/protobuf"), _0x56d831 = await waitForStreamReady();
    if (!_0x56d831) {
      log[_0x2fd8fe(1697)]("[PillRecording] Stream not ready, skipping screenshot context");
      return;
    }
    let _0x157061 = _0x301620;
    const _0x4d9425 = _0x301620[_0x2fd8fe(419)](/^data:[^;]+;base64,(.+)$/);
    _0x4d9425 && (_0x157061 = _0x4d9425[1]);
    const _0x401b98 = getLastExternalActiveWindow(), _0x6c706c = store[_0x2fd8fe(1043)](STORE_KEYS[_0x2fd8fe(193)]), _0x2dc150 = store[_0x2fd8fe(1043)](STORE_KEYS[_0x2fd8fe(430)]), _0x388bba = { "screenshotBase64": _0x157061, "appName": _0x401b98?.[_0x2fd8fe(1856)] || void 0, "userName": _0x6c706c?.[_0x2fd8fe(799)] || _0x2dc150?.[_0x2fd8fe(1067)]?.[_0x2fd8fe(1276)]?.[_0x2fd8fe(1163)](" ")[0] || void 0 };
    _0x305088 && (_0x388bba[_0x2fd8fe(362)] = Math[_0x2fd8fe(303)](_0x305088["x"]), _0x388bba[_0x2fd8fe(1868)] = Math[_0x2fd8fe(303)](_0x305088["y"]), _0x388bba[_0x2fd8fe(413)] = Math[_0x2fd8fe(303)](_0x305088[_0x2fd8fe(183)]), _0x388bba[_0x2fd8fe(398)] = Math[_0x2fd8fe(303)](_0x305088[_0x2fd8fe(553)]), log[_0x2fd8fe(1341)](_0x2fd8fe(202) + _0x305088["x"] + _0x2fd8fe(1168) + _0x305088["y"] + _0x2fd8fe(365) + _0x305088[_0x2fd8fe(183)] + _0x2fd8fe(886) + _0x305088[_0x2fd8fe(553)]));
    const _0x1d3b96 = _0x2d8665(_0x489295, { "payload": { "case": "screenshotContext", "value": _0x2d8665(_0x54ce40, _0x388bba) } });
    _0x9aa31f[_0x2fd8fe(1060)]()[_0x2fd8fe(469)](_0x1d3b96), log[_0x2fd8fe(1341)]("[PillRecording] Screenshot context sent via gRPC (full screen + crop coords)");
  } catch (_0x28fa5a) {
    log[_0x2fd8fe(981)]("[PillRecording] Error sending screenshot via gRPC:", _0x28fa5a);
  }
}
async function startDictationFromPill() {
  const _0x5c73c5 = _0x54a1b7;
  if (pillState[_0x5c73c5(1727)]) {
    log[_0x5c73c5(1697)]("[PillRecording] Recording already active");
    return;
  }
  const _0x426ba2 = store[_0x5c73c5(1043)](STORE_KEYS[_0x5c73c5(900)]);
  if (_0x426ba2 && !_0x426ba2[_0x5c73c5(164)]) {
    const _0x42dae1 = _0x426ba2[_0x5c73c5(1702)], _0x2391c4 = [7, 8], _0x3e1f1d = isCurrentWindowVoiceOS();
    if (!_0x3e1f1d || !_0x2391c4[_0x5c73c5(1580)](_0x42dae1)) {
      log[_0x5c73c5(1341)](_0x5c73c5(295) + _0x42dae1 + _0x5c73c5(498) + _0x3e1f1d + ")");
      if (!_0x3e1f1d) {
        const _0x250b04 = getPillWindow();
        _0x250b04 && !_0x250b04[_0x5c73c5(496)]() && _0x250b04[_0x5c73c5(890)][_0x5c73c5(965)](IPC_EVENTS[_0x5c73c5(1776)]);
      }
      return;
    }
  }
  log[_0x5c73c5(1341)]("[PillRecording] Starting Dictation from pill"), pillState[_0x5c73c5(1727)] = !![], pillState[_0x5c73c5(331)] = VoiceOSMode[_0x5c73c5(124)], captureCursorContext(), voiceInputService[_0x5c73c5(896)](VoiceOSMode[_0x5c73c5(124)]);
}
async function captureCursorContext() {
  const _0x3b1b2b = _0x54a1b7;
  try {
    const _0x457f3d = grpcClient[_0x3b1b2b(1678)]();
    if (_0x457f3d?.[_0x3b1b2b(518)]) {
      grpcClient[_0x3b1b2b(1236)]();
      return;
    }
    const { getFullCursorContext: _0x565d7e } = await Promise[_0x3b1b2b(1786)]()[_0x3b1b2b(843)](() => selectedTextReader), { canGetContextFromCurrentApp: _0x450a6c } = await Promise[_0x3b1b2b(1786)]()[_0x3b1b2b(843)](() => applicationDetection), _0x9dfc62 = await _0x450a6c();
    if (!_0x9dfc62) {
      grpcClient[_0x3b1b2b(1236)]();
      return;
    }
    const _0x4a8d96 = await _0x565d7e(100);
    _0x4a8d96[_0x3b1b2b(1377)] || _0x4a8d96[_0x3b1b2b(839)] ? grpcClient[_0x3b1b2b(282)](_0x4a8d96[_0x3b1b2b(1377)] || null, _0x4a8d96[_0x3b1b2b(839)] || null) : grpcClient[_0x3b1b2b(1236)]();
  } catch (_0x3f68fd) {
    log[_0x3b1b2b(1697)]("[PillRecording] Cursor context capture failed:", _0x3f68fd), grpcClient[_0x3b1b2b(1236)]();
  }
}
async function stopRecordingFromPill() {
  const _0x52e57e = _0x54a1b7;
  if (!pillState[_0x52e57e(1727)]) {
    log[_0x52e57e(1697)](_0x52e57e(349));
    return;
  }
  log[_0x52e57e(1341)](_0x52e57e(1756));
  const _0x345d36 = pillState[_0x52e57e(331)];
  if (_0x345d36 === VoiceOSMode[_0x52e57e(1607)] || _0x345d36 === VoiceOSMode[_0x52e57e(872)]) {
    const _0x58916d = getWriteInputService();
    _0x58916d[_0x52e57e(1649)](pillState[_0x52e57e(552)], null, null, null, pillState[_0x52e57e(696)], !!pillState[_0x52e57e(493)]);
  }
  voiceInputService[_0x52e57e(1158)](), resetState();
}
async function cancelRecordingFromPill() {
  const _0x38fc62 = _0x54a1b7;
  if (!pillState[_0x38fc62(1727)]) {
    log[_0x38fc62(1697)](_0x38fc62(747));
    return;
  }
  log[_0x38fc62(1341)](_0x38fc62(408));
  const _0x176fbc = pillState[_0x38fc62(331)];
  if (_0x176fbc === VoiceOSMode[_0x38fc62(1607)] || _0x176fbc === VoiceOSMode[_0x38fc62(872)]) {
    const _0x26ca6d = getWriteInputService();
    _0x26ca6d[_0x38fc62(969)]();
  }
  const { transcriptionService: _0x270f85 } = await Promise[_0x38fc62(1786)]()[_0x38fc62(843)](() => transcriptionService$1);
  _0x270f85[_0x38fc62(1768)](), voiceInputService[_0x38fc62(1158)](), grpcClient[_0x38fc62(834)](), grpcClient[_0x38fc62(1609)](), grpcClient[_0x38fc62(1236)](), resetState();
}
function isPillRecordingActive() {
  const _0x59f3cd = _0x54a1b7;
  return pillState[_0x59f3cd(1727)];
}
const pillRecording = Object[_0x54a1b7(502)](Object[_0x54a1b7(634)]({ "__proto__": null, "cancelRecordingFromPill": cancelRecordingFromPill, "isPillRecordingActive": isPillRecordingActive, "startDictationFromPill": startDictationFromPill, "startGenModeFromPill": startGenModeFromPill, "stopRecordingFromPill": stopRecordingFromPill }, Symbol[_0x54a1b7(1177)], { "value": _0x54a1b7(1416) }));
let KeyListenerProcess = null;
function createInitialShortcutState() {
  return { "isActive": ![], "currentMode": null, "currentShortcut": null, "keysPressedTimestamp": null, "isHandsFree": ![], "screenshotPromise": null, "capturedScreenshot": null, "ocrPromise": null, "cachedOcrText": null, "selectedTextPromise": null, "selectedText": null, "sessionActive": ![], "accessibilityText": null, "chatSessionWasActive": ![], "pendingFollowUpTimer": null, "isVoiceFollowUp": ![] };
}
let simulateEnterAfterInsert = ![];
function shouldSimulateEnterAndClear() {
  const _0x807869 = simulateEnterAfterInsert;
  return simulateEnterAfterInsert = ![], _0x807869;
}
function setSimulateEnterAfterInsert() {
  const _0x32e43a = _0x54a1b7;
  simulateEnterAfterInsert = !![], console[_0x32e43a(926)]("[Keyboard] Enter key will be simulated after text insertion");
}
let shortcutState = createInitialShortcutState(), lastHeartbeatReceived = Date[_0x54a1b7(1536)](), heartbeatCheckTimer = null;
const HEARTBEAT_CHECK_INTERVAL_MS = 5e3, HEARTBEAT_TIMEOUT_MS = 15e3;
let handsFreeHintTimer = null;
const HANDS_FREE_HINT_DELAY_MS = 45e3;
function startHandsFreeHintTimer() {
  stopHandsFreeHintTimer(), handsFreeHintTimer = setTimeout(() => {
    const _0x184fce = _0x1d03;
    if (shortcutState[_0x184fce(1727)] && !shortcutState[_0x184fce(1447)]) {
      const _0x45fd6b = store[_0x184fce(1043)](STORE_KEYS[_0x184fce(193)]), _0xef41a1 = _0x45fd6b?.[_0x184fce(720)]?.[_0x184fce(1037)] || [_0x184fce(1842)], _0x2e086d = shortcutState[_0x184fce(314)]?.[_0x184fce(1037)] || [];
      console[_0x184fce(926)]("[Keyboard] Showing hands-free hint after 60 seconds of holding shortcut");
      const _0x3ea1ed = getPillWindow();
      _0x3ea1ed && !_0x3ea1ed[_0x184fce(496)]() && _0x3ea1ed[_0x184fce(890)][_0x184fce(965)](IPC_EVENTS[_0x184fce(636)], { "currentShortcutKeys": _0x2e086d, "handsFreeShortcutKeys": _0xef41a1 });
    }
    handsFreeHintTimer = null;
  }, HANDS_FREE_HINT_DELAY_MS);
}
function stopHandsFreeHintTimer() {
  handsFreeHintTimer && (clearTimeout(handsFreeHintTimer), handsFreeHintTimer = null);
}
const nativeModuleName$1 = "keyboard-listener";
function normalizeKey(_0x145a1f) {
  const _0x4f75ec = _0x54a1b7;
  return keyNameMap[_0x145a1f] || _0x145a1f[_0x4f75ec(1566)]();
}
async function captureAccessibilityTextForDictation() {
  const _0x233b3e = _0x54a1b7;
  try {
    const _0x8f9be9 = grpcClient[_0x233b3e(1678)]();
    if (_0x8f9be9?.[_0x233b3e(518)]) {
      console[_0x233b3e(926)](_0x233b3e(1715) + _0x8f9be9[_0x233b3e(518)][_0x233b3e(1115)] + _0x233b3e(591)), grpcClient[_0x233b3e(877)](_0x8f9be9[_0x233b3e(518)]), grpcClient[_0x233b3e(659)]();
      const _0x453f81 = _0x8f9be9[_0x233b3e(518)];
      return (async () => {
        const _0x18854d = _0x233b3e;
        try {
          const { transcriptionService: _0x1748cc } = await Promise[_0x18854d(1786)]()[_0x18854d(843)](() => transcriptionService$1), { AccessibilityContextSchema: _0x5ee3f0, StreamMessageSchema: _0x5d7da0 } = await Promise[_0x18854d(1786)]()[_0x18854d(843)](() => voiceos_pb), { create: _0x5bd1ec } = await import("@bufbuild/protobuf"), _0x19b6a9 = _0x5bd1ec(_0x5d7da0, { "payload": { "case": "accessibilityContext", "value": _0x5bd1ec(_0x5ee3f0, { "accessibilityText": _0x453f81 }) } }), _0x5f4ce0 = _0x1748cc[_0x18854d(1060)]()[_0x18854d(625)]();
          _0x5f4ce0 && (_0x1748cc[_0x18854d(1060)]()[_0x18854d(469)](_0x19b6a9), console[_0x18854d(926)](_0x18854d(1717) + _0x453f81[_0x18854d(1115)] + _0x18854d(591)));
        } catch (_0x529d43) {
          console[_0x18854d(981)]("[TRANSCRIBE][Keyboard] Error sending override context via gRPC stream:", _0x529d43);
        }
      })(), _0x8f9be9[_0x233b3e(518)];
    }
    const _0x362632 = getLastExternalActiveWindow(), _0x1bd4e6 = _0x362632?.[_0x233b3e(789)], { getWindowTextString: _0x74bfbd, getWindowTreeString: _0x420238 } = await Promise[_0x233b3e(1786)]()[_0x233b3e(843)](() => windowTextReader);
    console[_0x233b3e(926)](_0x233b3e(907) + _0x1bd4e6);
    const [_0x162fb0, _0x17b2a3] = await Promise[_0x233b3e(1050)]([_0x74bfbd(_0x1bd4e6), _0x420238(_0x1bd4e6)]);
    return _0x162fb0 && _0x162fb0[_0x233b3e(1699)]()[_0x233b3e(1115)] > 0 ? (console[_0x233b3e(926)](_0x233b3e(1387) + _0x162fb0[_0x233b3e(1115)] + _0x233b3e(922)), grpcClient[_0x233b3e(877)](_0x162fb0)) : (console[_0x233b3e(926)]("[TRANSCRIBE][Keyboard] Accessibility returned no text"), grpcClient[_0x233b3e(834)]()), _0x17b2a3 && _0x17b2a3[_0x233b3e(1699)]()[_0x233b3e(1115)] > 0 ? (console[_0x233b3e(926)](_0x233b3e(1592) + _0x17b2a3[_0x233b3e(1115)] + _0x233b3e(922)), grpcClient[_0x233b3e(292)](_0x17b2a3)) : (console[_0x233b3e(926)]("[TRANSCRIBE][Keyboard] Accessibility returned no tree"), grpcClient[_0x233b3e(659)]()), (_0x17b2a3 && _0x17b2a3[_0x233b3e(1699)]()[_0x233b3e(1115)] > 0 || _0x162fb0 && _0x162fb0[_0x233b3e(1699)]()[_0x233b3e(1115)] > 0) && (async () => {
      const _0x1d81a3 = _0x233b3e;
      try {
        const { transcriptionService: _0x8d542c } = await Promise[_0x1d81a3(1786)]()[_0x1d81a3(843)](() => transcriptionService$1), { AccessibilityContextSchema: _0x49ba45, StreamMessageSchema: _0x2ad7a9 } = await Promise[_0x1d81a3(1786)]()[_0x1d81a3(843)](() => voiceos_pb), { create: _0x46ec17 } = await import("@bufbuild/protobuf"), _0x26b7d4 = _0x46ec17(_0x2ad7a9, { "payload": { "case": "accessibilityContext", "value": _0x46ec17(_0x49ba45, { "accessibilityText": _0x162fb0 || void 0, "accessibilityTree": _0x17b2a3 || void 0 }) } }), _0x5fe6e2 = _0x8d542c[_0x1d81a3(1060)]()[_0x1d81a3(625)]();
        _0x5fe6e2 && (_0x8d542c[_0x1d81a3(1060)]()[_0x1d81a3(469)](_0x26b7d4), console[_0x1d81a3(926)](_0x1d81a3(818) + (_0x162fb0?.[_0x1d81a3(1115)] || 0) + _0x1d81a3(477) + (_0x17b2a3?.[_0x1d81a3(1115)] || 0) + _0x1d81a3(591)));
      } catch (_0x317020) {
        console[_0x1d81a3(981)]("[TRANSCRIBE][Keyboard] Error sending accessibility via gRPC stream:", _0x317020);
      }
    })(), _0x162fb0;
  } catch (_0x5bbb4d) {
    return console[_0x233b3e(1697)]("[TRANSCRIBE][Keyboard] Accessibility extraction failed:", _0x5bbb4d), grpcClient[_0x233b3e(834)](), grpcClient[_0x233b3e(659)](), null;
  }
}
async function checkFocusedElementEditable() {
  const _0x1220aa = _0x54a1b7;
  try {
    const _0x4bb0e1 = await isFocusedElementEditable();
    if (!_0x4bb0e1) {
      console[_0x1220aa(926)]("[Keyboard] Warning: No editable text field focused");
      const _0x121c36 = getPillWindow();
      _0x121c36 && !_0x121c36[_0x1220aa(496)]() && _0x121c36[_0x1220aa(890)][_0x1220aa(965)](IPC_EVENTS[_0x1220aa(1188)]);
    }
  } catch (_0x199683) {
    console[_0x1220aa(1697)]("[Keyboard] Error checking focused element editability:", _0x199683);
  }
}
async function captureCursorContextForLLM() {
  const _0x160529 = _0x54a1b7;
  try {
    const _0x423954 = grpcClient[_0x160529(1678)]();
    if (_0x423954?.[_0x160529(518)]) {
      console[_0x160529(926)](_0x160529(753)), grpcClient[_0x160529(1236)]();
      return;
    }
    const { getFullCursorContext: _0x95cfcb } = await Promise[_0x160529(1786)]()[_0x160529(843)](() => selectedTextReader), { canGetContextFromCurrentApp: _0x1efba2 } = await Promise[_0x160529(1786)]()[_0x160529(843)](() => applicationDetection), _0x5bbea3 = await _0x1efba2();
    if (!_0x5bbea3) {
      console[_0x160529(926)](_0x160529(1561)), grpcClient[_0x160529(1236)]();
      return;
    }
    const _0xb98b67 = 100, _0x12e0ba = await _0x95cfcb(_0xb98b67);
    _0x12e0ba[_0x160529(1377)] || _0x12e0ba[_0x160529(839)] ? (console[_0x160529(926)](_0x160529(358) + _0x12e0ba[_0x160529(1377)][_0x160529(1115)] + _0x160529(457) + _0x12e0ba[_0x160529(839)][_0x160529(1115)] + _0x160529(441)), grpcClient[_0x160529(282)](_0x12e0ba[_0x160529(1377)] || null, _0x12e0ba[_0x160529(839)] || null)) : (console[_0x160529(926)]("[Keyboard] No cursor context available"), grpcClient[_0x160529(1236)]());
  } catch (_0x39e6b3) {
    console[_0x160529(1697)]("[Keyboard] Cursor context capture failed:", _0x39e6b3), grpcClient[_0x160529(1236)]();
  }
}
function startWriteContextCapture(_0x12b9e0 = ![]) {
  const _0x1d4d73 = _0x54a1b7, _0x31be6b = getLastExternalActiveWindow();
  _0x31be6b ? process[_0x1d4d73(1532)][_0x1d4d73(1020)](_0x1d4d73(782) + _0x31be6b[_0x1d4d73(1856)] + _0x1d4d73(1665) + _0x31be6b[_0x1d4d73(789)] + ")\n") : process[_0x1d4d73(1532)][_0x1d4d73(1020)]("[WRITE][Keyboard] No external active window tracked yet\n"), shortcutState[_0x1d4d73(465)] = (async () => {
    const _0x2bf29c = _0x1d4d73;
    try {
      const { getSelectedTextString: _0x1a086d } = await Promise[_0x2bf29c(1786)]()[_0x2bf29c(843)](() => selectedTextReader), _0x280910 = await _0x1a086d();
      if (_0x280910 && _0x280910[_0x2bf29c(1699)]()[_0x2bf29c(1115)] > 0) {
        if (!shortcutState[_0x2bf29c(1727)]) return null;
        shortcutState[_0x2bf29c(493)] = _0x280910, console[_0x2bf29c(926)](_0x2bf29c(716) + _0x280910[_0x2bf29c(1115)] + _0x2bf29c(781));
        const _0x4f0c21 = getPillWindow();
        return _0x4f0c21 && !_0x4f0c21[_0x2bf29c(496)]() && (_0x4f0c21[_0x2bf29c(890)][_0x2bf29c(965)]("selected-text-captured", { "text": _0x280910 }), console[_0x2bf29c(926)]("[WRITE][Keyboard] Selected text sent to pill for preview")), grpcClient[_0x2bf29c(1149)](_0x280910), console[_0x2bf29c(926)]("[WRITE][Keyboard] Selected text set on grpcClient"), _0x280910;
      }
      return console[_0x2bf29c(926)]("[WRITE][Keyboard] No selected text, will use screenshot"), null;
    } catch (_0x316804) {
      return console[_0x2bf29c(981)](" [WRITE][Keyboard] Error reading selected text:", _0x316804), null;
    }
  })(), shortcutState[_0x1d4d73(803)] = (async () => {
    const _0x4836fb = _0x1d4d73;
    try {
      console[_0x4836fb(926)]("[WRITE][Keyboard] Starting screenshot capture immediately (parallel with selected text detection)...");
      const _0x451cec = grpcClient[_0x4836fb(1678)](), { checkScreenRecordingPermission: _0x7c2fec } = await Promise[_0x4836fb(1786)]()[_0x4836fb(843)](() => crossPlatform), _0x37a539 = await _0x7c2fec(![]);
      let _0x302a41 = null;
      if (!_0x37a539) {
        console[_0x4836fb(926)]("[WRITE][Keyboard] Screen recording permission not granted, skipping screenshot");
        const _0x3a9026 = getPillWindow();
        _0x3a9026 && !_0x3a9026[_0x4836fb(496)]() && _0x3a9026[_0x4836fb(890)][_0x4836fb(965)]("write-mode-permission-required", _0x4836fb(1301));
      } else {
        const { getScreenshotService: _0x13c7c8 } = await Promise[_0x4836fb(1786)]()[_0x4836fb(843)](() => require(_0x4836fb(1683))), _0x38ecdc = _0x13c7c8(), _0x21282f = await _0x38ecdc[_0x4836fb(1339)]();
        _0x302a41 = _0x21282f?.[_0x4836fb(1690)] || null;
        const _0xbac2a2 = _0x21282f?.[_0x4836fb(1551)] || null;
        shortcutState[_0x4836fb(552)] = _0x302a41, console[_0x4836fb(926)](_0x4836fb(539) + (_0x302a41 ? Math[_0x4836fb(303)](_0x302a41[_0x4836fb(1115)] / 1024) : 0) + _0x4836fb(269) + (_0xbac2a2 ? "x=" + _0xbac2a2["x"] + _0x4836fb(1168) + _0xbac2a2["y"] + _0x4836fb(365) + _0xbac2a2[_0x4836fb(183)] + _0x4836fb(886) + _0xbac2a2[_0x4836fb(553)] : "none"));
        if (_0x302a41 && shortcutState[_0x4836fb(1727)]) {
          const _0x2e88d7 = getPillWindow();
          _0x2e88d7 && !_0x2e88d7[_0x4836fb(496)]() && (_0x2e88d7[_0x4836fb(890)][_0x4836fb(965)]("screenshot-captured", { "screenshot": _0x302a41 }), console[_0x4836fb(926)]("[WRITE][Keyboard] Full screenshot sent to pill for preview"));
        }
        if (_0x302a41 && !_0x451cec?.[_0x4836fb(518)]) {
          const _0x37ad0e = _0x31be6b?.[_0x4836fb(1856)], _0x48c00a = store[_0x4836fb(1043)](STORE_KEYS[_0x4836fb(193)]), _0x1c42e6 = store[_0x4836fb(1043)](STORE_KEYS[_0x4836fb(430)]), _0x355c93 = _0x48c00a?.[_0x4836fb(799)] || _0x1c42e6?.[_0x4836fb(1067)]?.[_0x4836fb(1276)]?.[_0x4836fb(1163)](" ")[0] || void 0;
          console[_0x4836fb(926)](_0x4836fb(749) + (_0x37ad0e || _0x4836fb(1014)) + _0x4836fb(964) + (_0x355c93 || _0x4836fb(1014)) + _0x4836fb(170));
          let _0x2cb942 = _0x302a41;
          const _0x19ee46 = _0x302a41[_0x4836fb(419)](/^data:[^;]+;base64,(.+)$/);
          _0x19ee46 && (_0x2cb942 = _0x19ee46[1]), (async () => {
            const _0x29cf09 = _0x4836fb;
            try {
              const { transcriptionService: _0x4e2744 } = await Promise[_0x29cf09(1786)]()[_0x29cf09(843)](() => transcriptionService$1), { ScreenshotContextSchema: _0x597554, StreamMessageSchema: _0x1e586e } = await Promise[_0x29cf09(1786)]()[_0x29cf09(843)](() => voiceos_pb), { create: _0x2e0b57 } = await import("@bufbuild/protobuf"), _0x591100 = { "screenshotBase64": _0x2cb942, "appName": _0x37ad0e, "userName": _0x355c93 };
              _0xbac2a2 && (_0x591100[_0x29cf09(362)] = Math[_0x29cf09(303)](_0xbac2a2["x"]), _0x591100[_0x29cf09(1868)] = Math[_0x29cf09(303)](_0xbac2a2["y"]), _0x591100[_0x29cf09(413)] = Math[_0x29cf09(303)](_0xbac2a2[_0x29cf09(183)]), _0x591100[_0x29cf09(398)] = Math[_0x29cf09(303)](_0xbac2a2[_0x29cf09(553)]), console[_0x29cf09(926)](_0x29cf09(338) + _0xbac2a2["x"] + _0x29cf09(1168) + _0xbac2a2["y"] + _0x29cf09(365) + _0xbac2a2[_0x29cf09(183)] + _0x29cf09(886) + _0xbac2a2[_0x29cf09(553)]));
              const _0x3a5047 = _0x2e0b57(_0x1e586e, { "payload": { "case": "screenshotContext", "value": _0x2e0b57(_0x597554, _0x591100) } }), _0x126950 = 2e3, _0x282c7 = 50, _0x157dfc = Date[_0x29cf09(1536)]();
              let _0x409c4e = ![];
              while (Date[_0x29cf09(1536)]() - _0x157dfc < _0x126950) {
                if (_0x4e2744[_0x29cf09(1060)]()[_0x29cf09(625)]()) {
                  _0x409c4e = !![];
                  break;
                }
                await new Promise((_0x17134d) => setTimeout(_0x17134d, _0x282c7));
              }
              _0x409c4e ? (_0x4e2744[_0x29cf09(1060)]()[_0x29cf09(469)](_0x3a5047), console[_0x29cf09(926)](_0x29cf09(1030) + Math[_0x29cf09(303)](_0x2cb942[_0x29cf09(1115)] / 1024) + _0x29cf09(432))) : console[_0x29cf09(1697)](_0x29cf09(194) + _0x126950 + _0x29cf09(724));
            } catch (_0x1a54d4) {
              console[_0x29cf09(981)]("[WRITE][Keyboard] Error sending screenshot via gRPC stream:", _0x1a54d4);
            }
          })();
        } else _0x451cec?.[_0x4836fb(518)] && console[_0x4836fb(926)](_0x4836fb(954));
      }
      const _0x4fda6e = await shortcutState[_0x4836fb(465)];
      if (_0x4fda6e && _0x4fda6e[_0x4836fb(1699)]()[_0x4836fb(1115)] > 0) {
        console[_0x4836fb(926)]("[WRITE][Keyboard] Using selected text as primary context for EDIT mode"), shortcutState[_0x4836fb(513)] = _0x4fda6e;
        if (_0x451cec?.[_0x4836fb(518)]) {
          console[_0x4836fb(926)](_0x4836fb(661) + _0x451cec[_0x4836fb(518)][_0x4836fb(1115)] + _0x4836fb(591)), shortcutState[_0x4836fb(696)] = _0x451cec[_0x4836fb(518)], grpcClient[_0x4836fb(877)](_0x451cec[_0x4836fb(518)]);
          const _0x35da31 = _0x451cec[_0x4836fb(518)];
          (async () => {
            const _0x54c7c2 = _0x4836fb;
            try {
              const { transcriptionService: _0x8a766a } = await Promise[_0x54c7c2(1786)]()[_0x54c7c2(843)](() => transcriptionService$1), { AccessibilityContextSchema: _0x8ca81e, StreamMessageSchema: _0x17f54b } = await Promise[_0x54c7c2(1786)]()[_0x54c7c2(843)](() => voiceos_pb), { create: _0x2ecb8b } = await import("@bufbuild/protobuf"), _0x506b17 = _0x2ecb8b(_0x17f54b, { "payload": { "case": "accessibilityContext", "value": _0x2ecb8b(_0x8ca81e, { "accessibilityText": _0x35da31 }) } }), _0x4045dc = _0x8a766a[_0x54c7c2(1060)]()[_0x54c7c2(625)]();
              _0x4045dc && (_0x8a766a[_0x54c7c2(1060)]()[_0x54c7c2(469)](_0x506b17), console[_0x54c7c2(926)](_0x54c7c2(1214) + _0x35da31[_0x54c7c2(1115)] + _0x54c7c2(591)));
            } catch (_0x520f68) {
              console[_0x54c7c2(981)]("[WRITE][Keyboard] Error sending override context via gRPC stream:", _0x520f68);
            }
          })();
        } else try {
          const _0x367917 = _0x31be6b?.[_0x4836fb(789)], { getWindowTextString: _0x3ecb80 } = await Promise[_0x4836fb(1786)]()[_0x4836fb(843)](() => windowTextReader);
          process[_0x4836fb(1532)][_0x4836fb(1020)](_0x4836fb(1620) + _0x367917 + "\n");
          const _0x1fd461 = await _0x3ecb80(_0x367917);
          _0x1fd461 && _0x1fd461[_0x4836fb(1699)]()[_0x4836fb(1115)] > 0 ? (console[_0x4836fb(926)](_0x4836fb(208) + _0x1fd461[_0x4836fb(1115)] + _0x4836fb(591)), shortcutState[_0x4836fb(696)] = _0x1fd461, (async () => {
            const _0x299b21 = _0x4836fb;
            try {
              const { transcriptionService: _0x56182f } = await Promise[_0x299b21(1786)]()[_0x299b21(843)](() => transcriptionService$1), { AccessibilityContextSchema: _0x1c4c8b, StreamMessageSchema: _0x46b045 } = await Promise[_0x299b21(1786)]()[_0x299b21(843)](() => voiceos_pb), { create: _0x4f5fb0 } = await import("@bufbuild/protobuf"), _0x3d1fef = _0x4f5fb0(_0x46b045, { "payload": { "case": "accessibilityContext", "value": _0x4f5fb0(_0x1c4c8b, { "accessibilityText": _0x1fd461 }) } }), _0x5b9c50 = _0x56182f[_0x299b21(1060)]()[_0x299b21(625)]();
              _0x5b9c50 && (_0x56182f[_0x299b21(1060)]()[_0x299b21(469)](_0x3d1fef), console[_0x299b21(926)](_0x299b21(270)));
            } catch (_0x399832) {
              console[_0x299b21(981)]("[WRITE][Keyboard] Error sending accessibility via gRPC stream:", _0x399832);
            }
          })()) : console[_0x4836fb(926)]("[WRITE][Keyboard] No accessibility text available for edit mode context");
        } catch (_0x39c788) {
          console[_0x4836fb(1697)]("[WRITE][Keyboard] Error capturing accessibility text for edit mode:", _0x39c788);
        }
        return _0x302a41;
      }
      console[_0x4836fb(926)]("[WRITE][Keyboard] No selected text (WRITE mode), capturing accessibility text...");
      const _0x4ef934 = (async () => {
        const _0x458d6f = _0x4836fb;
        try {
          if (_0x451cec?.[_0x458d6f(518)]) {
            console[_0x458d6f(926)](_0x458d6f(1504) + _0x451cec[_0x458d6f(518)][_0x458d6f(1115)] + _0x458d6f(591)), shortcutState[_0x458d6f(696)] = _0x451cec[_0x458d6f(518)], grpcClient[_0x458d6f(877)](_0x451cec[_0x458d6f(518)]);
            if (!shortcutState[_0x458d6f(1727)]) return null;
            const _0x5a547a = getPillWindow();
            _0x5a547a && !_0x5a547a[_0x458d6f(496)]() && (_0x5a547a[_0x458d6f(890)][_0x458d6f(965)]("window-text-captured", { "text": _0x451cec[_0x458d6f(518)] }), console[_0x458d6f(926)]("[WRITE][Keyboard] Override context text sent to pill for preview"));
            const _0x44afb2 = _0x451cec[_0x458d6f(518)];
            return (async () => {
              const _0x32a2d5 = _0x458d6f;
              try {
                const { transcriptionService: _0x597f7b } = await Promise[_0x32a2d5(1786)]()[_0x32a2d5(843)](() => transcriptionService$1), { AccessibilityContextSchema: _0x3ff7c9, StreamMessageSchema: _0x552583 } = await Promise[_0x32a2d5(1786)]()[_0x32a2d5(843)](() => voiceos_pb), { create: _0x1baff1 } = await import("@bufbuild/protobuf"), _0x472441 = _0x1baff1(_0x552583, { "payload": { "case": "accessibilityContext", "value": _0x1baff1(_0x3ff7c9, { "accessibilityText": _0x44afb2 }) } }), _0x4e3943 = _0x597f7b[_0x32a2d5(1060)]()[_0x32a2d5(625)]();
                _0x4e3943 && (_0x597f7b[_0x32a2d5(1060)]()[_0x32a2d5(469)](_0x472441), console[_0x32a2d5(926)](_0x32a2d5(1352) + _0x44afb2[_0x32a2d5(1115)] + _0x32a2d5(591)));
              } catch (_0x21f688) {
                console[_0x32a2d5(981)]("[WRITE][Keyboard] Error sending override context via gRPC stream:", _0x21f688);
              }
            })(), _0x451cec[_0x458d6f(518)];
          }
          const _0x29c50b = _0x31be6b?.[_0x458d6f(789)], { getWindowTextString: _0x485447 } = await Promise[_0x458d6f(1786)]()[_0x458d6f(843)](() => windowTextReader), _0x4ad3fa = await _0x485447(_0x29c50b);
          if (_0x4ad3fa && _0x4ad3fa[_0x458d6f(1699)]()[_0x458d6f(1115)] > 0) {
            console[_0x458d6f(926)](_0x458d6f(1558) + _0x4ad3fa[_0x458d6f(1115)] + _0x458d6f(922)), shortcutState[_0x458d6f(696)] = _0x4ad3fa;
            if (!shortcutState[_0x458d6f(1727)]) return null;
            const _0x47d992 = getPillWindow();
            return _0x47d992 && !_0x47d992[_0x458d6f(496)]() && (_0x47d992[_0x458d6f(890)][_0x458d6f(965)]("window-text-captured", { "text": _0x4ad3fa }), console[_0x458d6f(926)]("[WRITE][Keyboard] Window text sent to pill for preview")), (async () => {
              const _0x1871f6 = _0x458d6f;
              try {
                const { transcriptionService: _0x3e3163 } = await Promise[_0x1871f6(1786)]()[_0x1871f6(843)](() => transcriptionService$1), { AccessibilityContextSchema: _0x278578, StreamMessageSchema: _0x5db9b5 } = await Promise[_0x1871f6(1786)]()[_0x1871f6(843)](() => voiceos_pb), { create: _0x1ddba6 } = await import("@bufbuild/protobuf"), _0x9f3677 = _0x1ddba6(_0x5db9b5, { "payload": { "case": "accessibilityContext", "value": _0x1ddba6(_0x278578, { "accessibilityText": _0x4ad3fa }) } }), _0x1e1276 = _0x3e3163[_0x1871f6(1060)]()[_0x1871f6(625)]();
                _0x1e1276 && (_0x3e3163[_0x1871f6(1060)]()[_0x1871f6(469)](_0x9f3677), console[_0x1871f6(926)](_0x1871f6(812) + _0x4ad3fa[_0x1871f6(1115)] + _0x1871f6(591)));
              } catch (_0x1a7a72) {
                console[_0x1871f6(981)]("[WRITE][Keyboard] Error sending accessibility via gRPC stream:", _0x1a7a72);
              }
            })(), _0x4ad3fa;
          }
          return console[_0x458d6f(926)]("[WRITE][Keyboard] Accessibility returned no text"), null;
        } catch (_0x37a9ff) {
          return console[_0x458d6f(1697)]("[WRITE][Keyboard] Accessibility extraction failed:", _0x37a9ff), null;
        }
      })(), _0x3c7869 = await _0x4ef934;
      _0x3c7869 && !shortcutState[_0x4836fb(513)] && (shortcutState[_0x4836fb(513)] = _0x3c7869);
      if (!_0x302a41 && !_0x3c7869 && !_0x37a539) return shortcutState[_0x4836fb(552)] = null, shortcutState[_0x4836fb(513)] = null, null;
      return _0x302a41;
    } catch (_0x326ac3) {
      return console[_0x4836fb(981)](" [WRITE][Keyboard] Error in GEN mode context capture:", _0x326ac3), resetShortcutState("context-capture-failed"), null;
    }
  })(), Promise[_0x1d4d73(1786)]()[_0x1d4d73(843)](() => writeInputService)[_0x1d4d73(843)](({ getWriteInputService: _0x204202 }) => {
    const _0x23eeb4 = _0x1d4d73;
    if (!shortcutState[_0x23eeb4(1727)]) return null;
    const _0x524209 = _0x204202();
    return _0x524209[_0x23eeb4(1390)]();
  })[_0x1d4d73(843)](async (_0x55b7d5) => {
    const _0x14ed0c = _0x1d4d73;
    if (_0x55b7d5 === null) return;
    if (!shortcutState[_0x14ed0c(1727)]) return;
    if (!_0x55b7d5) {
      console[_0x14ed0c(981)](" [WRITE][Keyboard] Failed to start WRITE session");
      !_0x12b9e0 ? resetShortcutState("start-session-failed") : console[_0x14ed0c(1697)]("[WRITE][Keyboard] Upgrade: WRITE session already active or failed to start");
      return;
    }
    console[_0x14ed0c(926)](_0x14ed0c(416) + _0x12b9e0 + ")");
  })[_0x1d4d73(564)]((_0x470322) => {
    const _0xfbe139 = _0x1d4d73;
    console[_0xfbe139(981)](" [WRITE][Keyboard] Error starting WRITE session:", _0x470322), !_0x12b9e0 && resetShortcutState("start-session-error");
  });
}
function activateVoiceFollowUp(_0x4dfb4e) {
  const _0x256e32 = _0x54a1b7;
  console[_0x256e32(926)]("[Keyboard] Chat session active - activating voice follow-up mode (fn+ctrl)"), shortcutState[_0x256e32(1727)] = !![], shortcutState[_0x256e32(331)] = VoiceOSMode[_0x256e32(124)], shortcutState[_0x256e32(314)] = _0x4dfb4e, shortcutState[_0x256e32(412)] = Date[_0x256e32(1536)](), shortcutState[_0x256e32(1778)] = ![], shortcutState[_0x256e32(1643)] = null, shortcutState[_0x256e32(916)] = !![], setRecordingBlockKeys();
  const _0x12c412 = traceLogger[_0x256e32(1347)](_0x256e32(577), { "shortcut": _0x4dfb4e[_0x256e32(1037)], "pressedKeys": Array[_0x256e32(1840)](pressedKeys) });
  globalThis[_0x256e32(683)] = _0x12c412;
  const _0xb4b399 = getPillWindow();
  _0xb4b399 && !_0xb4b399[_0x256e32(496)]() && _0xb4b399[_0x256e32(890)][_0x256e32(965)](IPC_EVENTS[_0x256e32(471)], { "isRecording": !![], "mode": VoiceOSMode[_0x256e32(124)], "skipSound": ![], "isVoiceFollowUp": !![] }), voiceInputService[_0x256e32(896)](VoiceOSMode[_0x256e32(124)], { "isVoiceFollowUp": !![] });
}
function activateShortcut(_0x2cf99d) {
  const _0x2a4f86 = _0x54a1b7, _0x5b8a09 = store[_0x2a4f86(1043)](STORE_KEYS[_0x2a4f86(900)]);
  if (_0x5b8a09 && !_0x5b8a09[_0x2a4f86(164)]) {
    const _0x1ca373 = _0x5b8a09[_0x2a4f86(1702)], _0x5a448b = [7, 8], _0x4fae5e = [11, 12], _0x5f107c = isCurrentWindowVoiceOS(), _0x229a40 = _0x2cf99d[_0x2a4f86(1396)] === VoiceOSMode[_0x2a4f86(124)] && _0x5a448b[_0x2a4f86(1580)](_0x1ca373) && _0x5f107c, _0x6a4195 = _0x2cf99d[_0x2a4f86(1396)] === VoiceOSMode[_0x2a4f86(1607)] && _0x4fae5e[_0x2a4f86(1580)](_0x1ca373) && _0x5f107c;
    if (!_0x229a40 && !_0x6a4195) {
      if (_0x1ca373 === 6 || _0x1ca373 === 10) {
        console[_0x2a4f86(926)]("[Keyboard] Skipping shortcut activation during TEST_TRIGGER_KEY onboarding step");
        return;
      }
      console[_0x2a4f86(926)](_0x2a4f86(1464) + _0x1ca373 + _0x2a4f86(359) + _0x2cf99d[_0x2a4f86(1396)] + _0x2a4f86(498) + _0x5f107c + ")");
      if (!_0x5f107c) {
        const _0x3f25b3 = getPillWindow();
        _0x3f25b3 && !_0x3f25b3[_0x2a4f86(496)]() && _0x3f25b3[_0x2a4f86(890)][_0x2a4f86(965)](IPC_EVENTS[_0x2a4f86(1776)]);
      }
      return;
    }
  }
  if (_0x2cf99d[_0x2a4f86(1396)] === VoiceOSMode[_0x2a4f86(1607)] && chatSessionManager[_0x2a4f86(1727)]) {
    activateVoiceFollowUp(_0x2cf99d);
    return;
  }
  if (_0x2cf99d[_0x2a4f86(1396)] === VoiceOSMode[_0x2a4f86(124)] && chatSessionManager[_0x2a4f86(1727)]) {
    console[_0x2a4f86(926)]("[Keyboard] Chat session active + fn pressed - debouncing for potential follow-up upgrade"), shortcutState[_0x2a4f86(1727)] = !![], shortcutState[_0x2a4f86(331)] = VoiceOSMode[_0x2a4f86(124)], shortcutState[_0x2a4f86(314)] = _0x2cf99d, shortcutState[_0x2a4f86(412)] = Date[_0x2a4f86(1536)](), shortcutState[_0x2a4f86(1778)] = !![], setRecordingBlockKeys(), shortcutState[_0x2a4f86(1643)] = setTimeout(() => {
      const _0x34c81c = _0x2a4f86;
      shortcutState[_0x34c81c(1643)] = null, shortcutState[_0x34c81c(1778)] = ![];
      if (!shortcutState[_0x34c81c(1727)]) return;
      if (chatSessionManager[_0x34c81c(1727)]) {
        console[_0x34c81c(926)]("[Keyboard] Chat session still active after debounce  skipping dictation to preserve session"), shortcutState[_0x34c81c(1727)] = ![], shortcutState[_0x34c81c(331)] = null, shortcutState[_0x34c81c(314)] = null, shortcutState[_0x34c81c(412)] = null, clearRecordingBlockKeys();
        return;
      }
      console[_0x34c81c(926)]("[Keyboard] Follow-up debounce expired  proceeding with normal dictation"), startHandsFreeHintTimer();
      const _0x52b06b = traceLogger[_0x34c81c(1347)](_0x34c81c(1413), { "shortcut": _0x2cf99d[_0x34c81c(1037)], "mode": _0x2cf99d[_0x34c81c(1396)], "pressedKeys": Array[_0x34c81c(1840)](pressedKeys) });
      globalThis[_0x34c81c(683)] = _0x52b06b, voiceInputService[_0x34c81c(896)](VoiceOSMode[_0x34c81c(124)]);
    }, 200);
    return;
  }
  shortcutState[_0x2a4f86(1727)] = !![], shortcutState[_0x2a4f86(331)] = _0x2cf99d[_0x2a4f86(1396)], shortcutState[_0x2a4f86(314)] = _0x2cf99d, shortcutState[_0x2a4f86(412)] = Date[_0x2a4f86(1536)](), startHandsFreeHintTimer(), process[_0x2a4f86(1532)][_0x2a4f86(1020)](" [Keyboard] activateShortcut() - setting recording block keys\n"), setRecordingBlockKeys(), clipboardManager[_0x2a4f86(1625)]();
  const _0x240722 = traceLogger[_0x2a4f86(1347)](_0x2a4f86(1615), { "shortcut": _0x2cf99d[_0x2a4f86(1037)], "mode": _0x2cf99d[_0x2a4f86(1396)], "pressedKeys": Array[_0x2a4f86(1840)](pressedKeys) });
  globalThis[_0x2a4f86(683)] = _0x240722, checkFocusedElementEditable(), captureCursorContextForLLM(), _0x2cf99d[_0x2a4f86(1396)] === VoiceOSMode[_0x2a4f86(1607)] ? (shortcutState[_0x2a4f86(1418)] = !![], startWriteContextCapture(![]), (async () => {
    const _0x5642f1 = _0x2a4f86;
    try {
      if (!shortcutState[_0x5642f1(1727)]) return;
      const _0x4513d3 = await shortcutState[_0x5642f1(465)];
      if (!shortcutState[_0x5642f1(1727)]) return;
      const _0x444b69 = _0x4513d3 && _0x4513d3[_0x5642f1(1699)]()[_0x5642f1(1115)] > 0 ? VoiceOSMode[_0x5642f1(872)] : VoiceOSMode[_0x5642f1(1607)];
      shortcutState[_0x5642f1(331)] = _0x444b69;
      if (!shortcutState[_0x5642f1(1727)]) return;
      voiceInputService[_0x5642f1(896)](_0x444b69);
    } catch {
      voiceInputService[_0x5642f1(896)](VoiceOSMode[_0x5642f1(1607)]);
    }
  })()) : (_0x2cf99d[_0x2a4f86(1396)] === VoiceOSMode[_0x2a4f86(124)] && captureAccessibilityTextForDictation(), console[_0x2a4f86(1341)](_0x2a4f86(326) + _0x2cf99d[_0x2a4f86(1396)] + _0x2a4f86(322)), voiceInputService[_0x2a4f86(896)](_0x2cf99d[_0x2a4f86(1396)]));
}
function handleWriteRelease(_0x59a6d0) {
  const _0x4995dc = _0x54a1b7, _0x4b6586 = getPillWindow();
  _0x4b6586 && !_0x4b6586[_0x4995dc(496)]() && _0x4b6586[_0x4995dc(890)][_0x4995dc(965)]("recording-state-update", { "isRecording": ![], "mode": null, "skipSound": !![] });
  const _0x6a8960 = shortcutState[_0x4995dc(803)], _0x483a1 = shortcutState[_0x4995dc(917)], _0x3a4b28 = shortcutState[_0x4995dc(493)];
  shortcutState[_0x4995dc(1418)] = ![], (async () => {
    const _0x5dec5c = _0x4995dc;
    try {
      _0x6a8960 && (console[_0x5dec5c(926)]("[WRITE][Keyboard] Waiting for context capture to complete..."), await _0x6a8960);
      const _0xa0c7b = shortcutState[_0x5dec5c(552)], _0x4c7344 = shortcutState[_0x5dec5c(513)], _0x5339c3 = shortcutState[_0x5dec5c(696)], { getWriteInputService: _0xc68b74 } = await Promise[_0x5dec5c(1786)]()[_0x5dec5c(843)](() => writeInputService), _0x169000 = _0xc68b74(), _0x1819e5 = !!_0x3a4b28 && _0x3a4b28[_0x5dec5c(1699)]()[_0x5dec5c(1115)] > 0;
      console[_0x5dec5c(926)]("[WRITE][Keyboard] Setting session data", { "hasCachedScreenshot": !!_0xa0c7b, "hasCachedOcr": !!_0x4c7344, "hasSelectedText": _0x1819e5, "hasAccessibilityText": !!_0x5339c3 }), _0x169000[_0x5dec5c(1649)](_0xa0c7b, _0x4c7344, null, _0x483a1, _0x5339c3, _0x1819e5), shortcutState[_0x5dec5c(803)] = null, shortcutState[_0x5dec5c(552)] = null, shortcutState[_0x5dec5c(917)] = null, shortcutState[_0x5dec5c(513)] = null, shortcutState[_0x5dec5c(465)] = null, shortcutState[_0x5dec5c(493)] = null, shortcutState[_0x5dec5c(696)] = null, grpcClient[_0x5dec5c(834)](), grpcClient[_0x5dec5c(659)](), grpcClient[_0x5dec5c(1609)](), console[_0x5dec5c(926)]("[WRITE][Keyboard] Cleared grpcClient state (accessibility + selected text)");
    } catch (_0x4a5cac) {
      console[_0x5dec5c(981)](" [WRITE][Keyboard] Error setting session data:", _0x4a5cac), resetShortcutState("set-session-data-error");
    }
  })();
}
function releaseShortcut() {
  const _0x32aea7 = _0x54a1b7;
  if (!shortcutState[_0x32aea7(1727)]) return;
  stopHandsFreeHintTimer();
  const _0x381826 = shortcutState[_0x32aea7(331)], _0x1a3111 = shortcutState[_0x32aea7(916)];
  shortcutState[_0x32aea7(412)] ? Date[_0x32aea7(1536)]() - shortcutState[_0x32aea7(412)] : 0;
  if (_0x1a3111) {
    const _0x130ff7 = getPillWindow();
    _0x130ff7 && !_0x130ff7[_0x32aea7(496)]() && _0x130ff7[_0x32aea7(890)][_0x32aea7(965)](IPC_EVENTS[_0x32aea7(471)], { "isRecording": ![], "mode": VoiceOSMode[_0x32aea7(124)], "skipSound": !![], "isVoiceFollowUp": !![] });
  }
  voiceInputService[_0x32aea7(1158)](), (_0x381826 === VoiceOSMode[_0x32aea7(1607)] || _0x381826 === VoiceOSMode[_0x32aea7(872)]) && handleWriteRelease(), _0x381826 === VoiceOSMode[_0x32aea7(124)] && (grpcClient[_0x32aea7(834)](), grpcClient[_0x32aea7(659)](), grpcClient[_0x32aea7(1609)]()), shortcutState[_0x32aea7(1727)] = ![], shortcutState[_0x32aea7(331)] = null, shortcutState[_0x32aea7(314)] = null, shortcutState[_0x32aea7(412)] = null, shortcutState[_0x32aea7(1447)] = ![], shortcutState[_0x32aea7(1778)] = ![], shortcutState[_0x32aea7(916)] = ![], shortcutState[_0x32aea7(1643)] && (clearTimeout(shortcutState[_0x32aea7(1643)]), shortcutState[_0x32aea7(1643)] = null), clearRecordingBlockKeys();
}
function stopHandsFreeRecording() {
  const _0x5dfad8 = _0x54a1b7;
  if (!shortcutState[_0x5dfad8(1727)] || !shortcutState[_0x5dfad8(1447)]) {
    console[_0x5dfad8(1697)]("[Keyboard] stopHandsFreeRecording called but not in hands-free mode");
    return;
  }
  console[_0x5dfad8(926)]("[Keyboard] Stopping hands-free recording (paste action)");
  const _0x37bafe = shortcutState[_0x5dfad8(331)];
  shortcutState[_0x5dfad8(412)] ? Date[_0x5dfad8(1536)]() - shortcutState[_0x5dfad8(412)] : 0, voiceInputService[_0x5dfad8(1158)](), (_0x37bafe === VoiceOSMode[_0x5dfad8(1607)] || _0x37bafe === VoiceOSMode[_0x5dfad8(872)]) && handleWriteRelease(), _0x37bafe === VoiceOSMode[_0x5dfad8(124)] && (grpcClient[_0x5dfad8(834)](), grpcClient[_0x5dfad8(659)](), grpcClient[_0x5dfad8(1609)]()), shortcutState[_0x5dfad8(1727)] = ![], shortcutState[_0x5dfad8(331)] = null, shortcutState[_0x5dfad8(314)] = null, shortcutState[_0x5dfad8(412)] = null, shortcutState[_0x5dfad8(1447)] = ![], clearRecordingBlockKeys();
}
async function cancelHandsFreeRecording() {
  const _0x151761 = _0x54a1b7;
  if (!shortcutState[_0x151761(1727)] || !shortcutState[_0x151761(1447)]) {
    console[_0x151761(1697)]("[Keyboard] cancelHandsFreeRecording called but not in hands-free mode");
    return;
  }
  console[_0x151761(926)]("[Keyboard] Cancelling hands-free recording (discard action)");
  const _0x47bcff = shortcutState[_0x151761(331)], { transcriptionService: _0x5937a3 } = await Promise[_0x151761(1786)]()[_0x151761(843)](() => transcriptionService$1);
  _0x5937a3[_0x151761(1768)](), voiceInputService[_0x151761(1158)]();
  if (_0x47bcff === VoiceOSMode[_0x151761(1607)] || _0x47bcff === VoiceOSMode[_0x151761(872)]) try {
    const _0x2ea3f4 = getWriteInputService();
    _0x2ea3f4[_0x151761(969)]();
  } catch (_0x3d8dec) {
    console[_0x151761(981)]("[Keyboard] Error canceling write session:", _0x3d8dec);
  }
  grpcClient[_0x151761(834)](), grpcClient[_0x151761(659)](), grpcClient[_0x151761(1609)](), shortcutState[_0x151761(1727)] = ![], shortcutState[_0x151761(331)] = null, shortcutState[_0x151761(314)] = null, shortcutState[_0x151761(412)] = null, shortcutState[_0x151761(1447)] = ![], clearRecordingBlockKeys();
  const _0x1350a5 = getPillWindow();
  _0x1350a5 && !_0x1350a5[_0x151761(496)]() && _0x1350a5[_0x151761(890)][_0x151761(965)]("recording-state-update", { "isRecording": ![], "mode": null, "skipSound": !![] });
}
function handleHeartbeat(_0x1fe193) {
  const _0x27af22 = _0x54a1b7;
  lastHeartbeatReceived = Date[_0x27af22(1536)]();
}
function startHeartbeatChecker() {
  !heartbeatCheckTimer && (heartbeatCheckTimer = setInterval(() => {
    const _0x5c45f9 = _0x1d03, _0x5ac535 = Date[_0x5c45f9(1536)]() - lastHeartbeatReceived;
    _0x5ac535 > HEARTBEAT_TIMEOUT_MS && (console[_0x5c45f9(981)](_0x5c45f9(1543) + _0x5ac535 + _0x5c45f9(1797)), restartKeyListener());
  }, HEARTBEAT_CHECK_INTERVAL_MS));
}
function stopHeartbeatChecker() {
  heartbeatCheckTimer && (clearInterval(heartbeatCheckTimer), heartbeatCheckTimer = null);
}
function restartKeyListener() {
  const _0x560b2f = _0x54a1b7;
  console[_0x560b2f(1697)](" Restarting keyboard listener due to timeout..."), stopKeyListener(), setTimeout(() => {
    startKeyListener();
  }, 1e3);
}
const pressedKeys = /* @__PURE__ */ new Set(), keyPressTimestamps = /* @__PURE__ */ new Map();
let stuckKeyCheckTimer = null;
const STUCK_KEY_TIMEOUT = 5e3, STUCK_KEY_CHECK_INTERVAL = 1e3;
function resetShortcutState(_0x436c8b = _0x54a1b7(1014)) {
  const _0x382ebe = _0x54a1b7;
  console[_0x382ebe(926)](_0x382ebe(1210) + _0x436c8b + ")");
  if (shortcutState[_0x382ebe(331)] === VoiceOSMode[_0x382ebe(1607)] || shortcutState[_0x382ebe(331)] === VoiceOSMode[_0x382ebe(872)]) try {
    const _0x5a083f = getWriteInputService();
    _0x5a083f[_0x382ebe(969)]();
  } catch (_0x265966) {
    console[_0x382ebe(981)](" [Keyboard] Error canceling write session:", _0x265966);
  }
  shortcutState[_0x382ebe(1643)] && clearTimeout(shortcutState[_0x382ebe(1643)]);
  const _0x4aa31f = shortcutState[_0x382ebe(916)];
  shortcutState = createInitialShortcutState(), grpcClient[_0x382ebe(834)](), grpcClient[_0x382ebe(659)](), grpcClient[_0x382ebe(1609)]();
  const _0x27407e = getPillWindow();
  _0x27407e && !_0x27407e[_0x382ebe(496)]() && (_0x4aa31f && _0x27407e[_0x382ebe(890)][_0x382ebe(965)]("recording-state-update", { "isRecording": ![], "mode": VoiceOSMode[_0x382ebe(124)], "skipSound": !![], "isVoiceFollowUp": !![] }), _0x27407e[_0x382ebe(890)][_0x382ebe(965)]("recording-state-update", { "isRecording": ![], "mode": null, "skipSound": !![] }), _0x27407e[_0x382ebe(890)][_0x382ebe(965)]("transcription-processing", { "isProcessing": ![] }));
}
function checkForStuckKeys() {
  const _0x52314b = _0x54a1b7, _0x33b9da = Date[_0x52314b(1536)](), _0x55ed57 = [];
  for (const [_0x409226, _0x387d5f] of keyPressTimestamps) {
    _0x33b9da - _0x387d5f > STUCK_KEY_TIMEOUT && _0x55ed57[_0x52314b(529)](_0x409226);
  }
  for (const _0x6eed9a of _0x55ed57) {
    let _0x5e0371 = !![];
    if (shortcutState[_0x52314b(1727)] && shortcutState[_0x52314b(314)]) {
      const _0xf34222 = shortcutState[_0x52314b(314)][_0x52314b(1037)][_0x52314b(306)](normalizeLegacyKey);
      _0xf34222[_0x52314b(1580)](_0x6eed9a) && (_0x5e0371 = ![]);
    }
    _0x5e0371 && (console[_0x52314b(1697)](_0x52314b(923) + _0x6eed9a + _0x52314b(945) + (_0x33b9da - keyPressTimestamps[_0x52314b(1043)](_0x6eed9a)) / 1e3 + "s)"), pressedKeys[_0x52314b(506)](_0x6eed9a), keyPressTimestamps[_0x52314b(506)](_0x6eed9a));
  }
}
function startStuckKeyChecker() {
  !stuckKeyCheckTimer && (stuckKeyCheckTimer = setInterval(checkForStuckKeys, STUCK_KEY_CHECK_INTERVAL));
}
function stopStuckKeyChecker() {
  stuckKeyCheckTimer && (clearInterval(stuckKeyCheckTimer), stuckKeyCheckTimer = null);
}
function handleKeyEventInMain(_0x46c3b0) {
  const _0x1c6f16 = _0x54a1b7;
  _0x46c3b0[_0x1c6f16(1154)] === "keydown" && console[_0x1c6f16(926)](_0x1c6f16(1183) + _0x46c3b0[_0x1c6f16(1296)] + _0x1c6f16(403) + _0x46c3b0[_0x1c6f16(1154)] + ")");
  const { isShortcutGloballyEnabled: _0x50e192, keyboardShortcuts: _0x479ed0 } = store[_0x1c6f16(1043)](STORE_KEYS[_0x1c6f16(193)]);
  if (!_0x50e192) {
    shortcutState[_0x1c6f16(1727)] && (console[_0x1c6f16(1341)](_0x1c6f16(1348)), audioRecorderService[_0x1c6f16(976)](), shortcutState[_0x1c6f16(1727)] = ![], shortcutState[_0x1c6f16(331)] = null, shortcutState[_0x1c6f16(314)] = null);
    return;
  }
  const _0x1ac8e7 = normalizeKey(_0x46c3b0[_0x1c6f16(1296)]);
  if (_0x1ac8e7 === _0x1c6f16(1769)) return;
  _0x46c3b0[_0x1c6f16(1154)] === "keydown" ? (pressedKeys[_0x1c6f16(1332)](_0x1ac8e7), !keyPressTimestamps[_0x1c6f16(1764)](_0x1ac8e7) && keyPressTimestamps[_0x1c6f16(1359)](_0x1ac8e7, Date[_0x1c6f16(1536)]())) : (pressedKeys[_0x1c6f16(506)](_0x1ac8e7), keyPressTimestamps[_0x1c6f16(506)](_0x1ac8e7));
  const _0x5ba9be = store[_0x1c6f16(1043)](STORE_KEYS[_0x1c6f16(193)]), _0x4ba34 = _0x5ba9be?.[_0x1c6f16(720)]?.[_0x1c6f16(1037)]?.[_0x1c6f16(1115)] > 0 ? _0x5ba9be[_0x1c6f16(720)][_0x1c6f16(1037)][_0x1c6f16(306)](normalizeLegacyKey) : [_0x1c6f16(1842)], _0x32e29b = _0x4ba34[_0x1c6f16(1203)]((_0x1b449c) => pressedKeys[_0x1c6f16(1764)](_0x1b449c)), _0x3744a1 = _0x4ba34[_0x1c6f16(1580)](_0x1ac8e7) && _0x32e29b;
  shortcutState[_0x1c6f16(1727)] && !shortcutState[_0x1c6f16(1447)] && _0x46c3b0[_0x1c6f16(1154)] === "keydown" && console[_0x1c6f16(926)](_0x1c6f16(435) + _0x1ac8e7 + _0x1c6f16(1164) + _0x4ba34[_0x1c6f16(1638)](",") + _0x1c6f16(1148) + _0x32e29b + _0x1c6f16(176) + _0x3744a1 + _0x1c6f16(1095) + Array[_0x1c6f16(1840)](pressedKeys)[_0x1c6f16(1638)](",") + "]");
  if (_0x3744a1 && _0x46c3b0[_0x1c6f16(1154)] === "keydown" && shortcutState[_0x1c6f16(1727)] && !shortcutState[_0x1c6f16(1447)]) {
    console[_0x1c6f16(926)](_0x1c6f16(1088) + _0x4ba34[_0x1c6f16(1638)]("+") + _0x1c6f16(1537)), shortcutState[_0x1c6f16(1447)] = !![], stopHandsFreeHintTimer();
    const _0x4439f3 = getPillWindow();
    _0x4439f3 && !_0x4439f3[_0x1c6f16(496)]() && _0x4439f3[_0x1c6f16(890)][_0x1c6f16(965)]("recording-state-update", { "isRecording": !![], "isHandsFree": !![], "skipSound": !![] });
    return;
  }
  if (shortcutState[_0x1c6f16(1447)] && _0x46c3b0[_0x1c6f16(1154)] === "keydown") {
    if (_0x3744a1) {
      console[_0x1c6f16(926)](_0x1c6f16(1088) + _0x4ba34[_0x1c6f16(1638)]("+") + _0x1c6f16(180)), stopHandsFreeRecording();
      return;
    }
    if (_0x1ac8e7 === _0x1c6f16(1621)) {
      console[_0x1c6f16(926)]("[Keyboard] Escape pressed during hands-free mode - cancelling recording"), cancelHandsFreeRecording();
      return;
    }
    if (_0x1ac8e7 === _0x1c6f16(470)) {
      console[_0x1c6f16(926)]("[Keyboard] Enter pressed during hands-free mode - stopping recording and will simulate Enter after paste"), setSimulateEnterAfterInsert(), stopHandsFreeRecording();
      return;
    }
  }
  if (_0x46c3b0[_0x1c6f16(1154)] === "keydown" && _0x1ac8e7 === _0x1c6f16(470)) {
    console[_0x1c6f16(926)](_0x1c6f16(1150) + shortcutState[_0x1c6f16(1727)] + _0x1c6f16(1519) + shortcutState[_0x1c6f16(1447)] + _0x1c6f16(1562) + isPillRecordingActive());
    if (shortcutState[_0x1c6f16(1727)] && !shortcutState[_0x1c6f16(1447)]) {
      console[_0x1c6f16(926)]("[Keyboard] Enter pressed during shortcut recording - stopping and will simulate Enter after paste"), setSimulateEnterAfterInsert(), releaseShortcut();
      return;
    }
    if (isPillRecordingActive()) {
      console[_0x1c6f16(926)]("[Keyboard] Enter pressed during pill recording - stopping and will simulate Enter after paste"), setSimulateEnterAfterInsert(), stopRecordingFromPill();
      return;
    }
    const _0x1e041c = getPillWindow();
    _0x1e041c && !_0x1e041c[_0x1c6f16(496)]() && _0x1e041c[_0x1c6f16(890)][_0x1c6f16(965)](IPC_EVENTS[_0x1c6f16(962)]);
  }
  if (_0x46c3b0[_0x1c6f16(1154)] === "keydown" && _0x1ac8e7 === _0x1c6f16(1621)) {
    if (!shortcutState[_0x1c6f16(1727)]) {
      const _0x42c04b = getPillWindow();
      _0x42c04b && !_0x42c04b[_0x1c6f16(496)]() && _0x42c04b[_0x1c6f16(890)][_0x1c6f16(965)](IPC_EVENTS[_0x1c6f16(647)]);
    }
  }
  const _0x4686ce = _0x479ed0[_0x1c6f16(1380)]((_0x25590d) => _0x25590d[_0x1c6f16(1037)][_0x1c6f16(1115)] > 0)[_0x1c6f16(1608)]((_0x42ac93, _0x2c705c) => _0x2c705c[_0x1c6f16(1037)][_0x1c6f16(1115)] - _0x42ac93[_0x1c6f16(1037)][_0x1c6f16(1115)]), _0x1ad0bd = _0x4686ce[_0x1c6f16(445)]((_0x3738c2) => {
    const _0x18eb23 = _0x1c6f16, _0x3ac85b = _0x3738c2[_0x18eb23(1037)][_0x18eb23(306)](normalizeLegacyKey), _0xe2d30d = _0x3ac85b[_0x18eb23(1203)]((_0x34317e) => pressedKeys[_0x18eb23(1764)](_0x34317e)), _0x5aabe8 = _0x3ac85b[_0x18eb23(1115)] === pressedKeys[_0x18eb23(1378)] && _0xe2d30d;
    return _0x5aabe8;
  }), _0x44f90b = _0x4686ce[_0x1c6f16(445)]((_0x188570) => {
    const _0x38ed4d = _0x1c6f16, _0x2d96e4 = _0x188570[_0x38ed4d(1037)][_0x38ed4d(306)](normalizeLegacyKey);
    return _0x2d96e4[_0x38ed4d(1203)]((_0x5f58fb) => pressedKeys[_0x38ed4d(1764)](_0x5f58fb));
  });
  if (_0x1ad0bd && !shortcutState[_0x1c6f16(1727)]) Promise[_0x1c6f16(1786)]()[_0x1c6f16(843)](() => transcriptionService$1)[_0x1c6f16(843)](({ transcriptionService: _0xb9507f }) => {
    const _0x3a0302 = _0x1c6f16;
    _0xb9507f[_0x3a0302(517)]();
  })[_0x1c6f16(564)](() => {
  }), activateShortcut(_0x1ad0bd);
  else {
    if (_0x1ad0bd && shortcutState[_0x1c6f16(1727)] && shortcutState[_0x1c6f16(314)]) {
      const _0x5bb5b0 = shortcutState[_0x1c6f16(314)][_0x1c6f16(1037)][_0x1c6f16(306)](normalizeLegacyKey), _0x3c93cf = _0x1ad0bd[_0x1c6f16(1037)][_0x1c6f16(306)](normalizeLegacyKey), _0x14f9cc = _0x3c93cf[_0x1c6f16(1115)] > _0x5bb5b0[_0x1c6f16(1115)], _0x6e1a74 = _0x5bb5b0[_0x1c6f16(1203)]((_0x4d7cd0) => _0x3c93cf[_0x1c6f16(1580)](_0x4d7cd0)), _0x5a54bc = _0x1ad0bd["id"] !== shortcutState[_0x1c6f16(314)]["id"];
      if (_0x14f9cc && _0x6e1a74 && _0x5a54bc) {
        if (shortcutState[_0x1c6f16(1778)] && _0x1ad0bd[_0x1c6f16(1396)] === VoiceOSMode[_0x1c6f16(1607)]) {
          shortcutState[_0x1c6f16(1643)] && (clearTimeout(shortcutState[_0x1c6f16(1643)]), shortcutState[_0x1c6f16(1643)] = null);
          shortcutState[_0x1c6f16(1727)] = ![], shortcutState[_0x1c6f16(331)] = null, shortcutState[_0x1c6f16(314)] = null, shortcutState[_0x1c6f16(1778)] = ![], clearRecordingBlockKeys(), console[_0x1c6f16(926)]("[Keyboard] Upgrade intercepted  activating voice follow-up (fn+ctrl during chat session)"), activateVoiceFollowUp(_0x1ad0bd);
          return;
        }
        const _0x40ad6e = shortcutState[_0x1c6f16(331)];
        shortcutState[_0x1c6f16(331)] = _0x1ad0bd[_0x1c6f16(1396)], shortcutState[_0x1c6f16(314)] = _0x1ad0bd, traceLogger[_0x1c6f16(1347)](_0x1c6f16(1139), { "fromMode": _0x40ad6e, "toMode": _0x1ad0bd[_0x1c6f16(1396)], "fromKeys": _0x5bb5b0, "toKeys": _0x3c93cf }), _0x1ad0bd[_0x1c6f16(1396)] === VoiceOSMode[_0x1c6f16(1607)] && _0x40ad6e === VoiceOSMode[_0x1c6f16(124)] && (shortcutState[_0x1c6f16(1418)] = !![], startWriteContextCapture(!![]), (async () => {
          const _0x2432a2 = _0x1c6f16;
          try {
            if (!shortcutState[_0x2432a2(1727)]) return;
            const _0x663cd7 = await shortcutState[_0x2432a2(465)];
            if (!shortcutState[_0x2432a2(1727)]) return;
            const _0x19f7f6 = _0x663cd7 && _0x663cd7[_0x2432a2(1699)]()[_0x2432a2(1115)] > 0 ? VoiceOSMode[_0x2432a2(872)] : VoiceOSMode[_0x2432a2(1607)];
            if (!shortcutState[_0x2432a2(1727)]) return;
            shortcutState[_0x2432a2(331)] = _0x19f7f6;
            const _0x3b05d5 = getPillWindow();
            _0x3b05d5 && !_0x3b05d5[_0x2432a2(496)]() && _0x3b05d5[_0x2432a2(890)][_0x2432a2(965)]("recording-state-update", { "isRecording": !![], "mode": _0x19f7f6, "skipSound": !![] });
            if (!shortcutState[_0x2432a2(1727)]) return;
            const { transcriptionService: _0x1fe2f4 } = await Promise[_0x2432a2(1786)]()[_0x2432a2(843)](() => transcriptionService$1);
            _0x1fe2f4[_0x2432a2(316)](_0x19f7f6);
            const { ModeUpdateSchema: _0x4b3fe5, StreamMessageSchema: _0x48de42 } = await Promise[_0x2432a2(1786)]()[_0x2432a2(843)](() => voiceos_pb), { create: _0x478079 } = await import("@bufbuild/protobuf"), _0x46c077 = _0x478079(_0x48de42, { "payload": { "case": _0x2432a2(1759), "value": _0x478079(_0x4b3fe5, { "mode": _0x19f7f6 }) } }), _0x45e356 = _0x1fe2f4[_0x2432a2(1060)]()[_0x2432a2(625)]();
            if (_0x45e356) {
              if (!shortcutState[_0x2432a2(1727)]) return;
              _0x1fe2f4[_0x2432a2(1060)]()[_0x2432a2(469)](_0x46c077);
            }
          } catch {
          }
        })());
      }
    } else {
      if (!_0x44f90b && shortcutState[_0x1c6f16(1727)]) {
        if (shortcutState[_0x1c6f16(1643)]) {
          console[_0x1c6f16(926)]("[Keyboard] Shortcut released during follow-up debounce  cancelling"), clearTimeout(shortcutState[_0x1c6f16(1643)]), shortcutState[_0x1c6f16(1643)] = null, shortcutState[_0x1c6f16(1778)] = ![], shortcutState[_0x1c6f16(1727)] = ![], shortcutState[_0x1c6f16(331)] = null, shortcutState[_0x1c6f16(314)] = null, shortcutState[_0x1c6f16(412)] = null, clearRecordingBlockKeys();
          return;
        }
        shortcutState[_0x1c6f16(1447)] ? console[_0x1c6f16(926)]("[Keyboard] Shortcut released but hands-free mode active - keeping recording") : releaseShortcut();
      }
    }
  }
}
const startKeyListener = () => {
  const _0x1827cb = _0x54a1b7;
  if (KeyListenerProcess) {
    console[_0x1827cb(1697)]("Key listener already running.");
    return;
  }
  const _0x44dfd1 = getNativeBinaryPath(nativeModuleName$1);
  if (!_0x44dfd1) {
    console[_0x1827cb(981)](" Could not determine key listener binary path.");
    return;
  }
  console[_0x1827cb(926)]("--- Key Listener Initialization ---"), console[_0x1827cb(926)](_0x1827cb(172) + _0x44dfd1);
  try {
    const _0x47b6ac = { ...process[_0x1827cb(1498)], "RUST_BACKTRACE": "1", "OBJC_DISABLE_INITIALIZE_FORK_SAFETY": _0x1827cb(1484) };
    KeyListenerProcess = child_process[_0x1827cb(1424)](_0x44dfd1, [], { "stdio": [_0x1827cb(1155), _0x1827cb(1155), _0x1827cb(1155)], "env": _0x47b6ac, "detached": !![] });
    if (!KeyListenerProcess) throw new Error(_0x1827cb(1496));
    KeyListenerProcess[_0x1827cb(495)]();
    let _0x77ae0f = "";
    KeyListenerProcess[_0x1827cb(1532)]?.["on"]("data", (_0x5649af) => {
      const _0x4b5fca = _0x1827cb, _0x4c528e = _0x5649af[_0x4b5fca(1450)]();
      _0x77ae0f += _0x4c528e;
      const _0x535b90 = _0x77ae0f[_0x4b5fca(1163)]("\n");
      _0x77ae0f = _0x535b90[_0x4b5fca(175)]() || "";
      for (const _0x21d1c3 of _0x535b90) {
        if (_0x21d1c3[_0x4b5fca(1699)]()) try {
          const _0x173508 = JSON[_0x4b5fca(675)](_0x21d1c3);
          if (_0x173508[_0x4b5fca(1154)] === _0x4b5fca(1239)) {
            handleHeartbeat(_0x173508);
            continue;
          } else {
            if (_0x173508[_0x4b5fca(1154)] === "registered_hotkeys") {
              console[_0x4b5fca(1341)](" Registered hotkeys received:", _0x173508[_0x4b5fca(956)]);
              continue;
            }
          }
          if (_0x173508[_0x4b5fca(1154)] === "keydown" || _0x173508[_0x4b5fca(1154)] === "keyup") {
            handleKeyEventInMain(_0x173508);
            const _0x3ca725 = process[_0x4b5fca(1394)], _0x414a53 = _0x173508[_0x4b5fca(1296)] === _0x4b5fca(1127) || _0x173508[_0x4b5fca(1296)] === _0x4b5fca(516);
            if (_0x3ca725 !== "darwin" && _0x414a53) continue;
            electron[_0x4b5fca(963)][_0x4b5fca(1274)]()[_0x4b5fca(878)]((_0x2cbed9) => {
              const _0x2da9c5 = _0x4b5fca;
              !_0x2cbed9[_0x2da9c5(890)][_0x2da9c5(496)]() && _0x2cbed9[_0x2da9c5(890)][_0x2da9c5(965)]("key-event", _0x173508);
            });
          }
        } catch (_0x568742) {
          console[_0x4b5fca(981)](" Failed to parse key process event:", _0x21d1c3, _0x568742);
        }
      }
    }), KeyListenerProcess[_0x1827cb(595)]?.["on"]("data", (_0x107c42) => {
      const _0x8e6f4 = _0x1827cb;
      console[_0x8e6f4(981)](" [Key listener] stderr:", _0x107c42[_0x8e6f4(1450)]());
    }), KeyListenerProcess["on"]("error", (_0x2067bb) => {
      const _0x40fa7f = _0x1827cb;
      console[_0x40fa7f(981)](" [Key listener] process spawn error:", _0x2067bb), KeyListenerProcess = null;
    }), KeyListenerProcess["on"]("close", (_0x8430cf, _0x565403) => {
      const _0xfc5364 = _0x1827cb;
      console[_0xfc5364(1697)](_0xfc5364(1735) + _0x8430cf + _0xfc5364(1318) + _0x565403), KeyListenerProcess = null;
    }), KeyListenerProcess["on"]("exit", (_0x10feb4, _0x53d134) => {
      const _0x157f45 = _0x1827cb;
      console[_0x157f45(1697)](_0x157f45(1505) + _0x10feb4 + _0x157f45(1318) + _0x53d134), KeyListenerProcess = null;
    }), console[_0x1827cb(926)]("[Key listener] started successfully."), registerAllHotkeys(), startStuckKeyChecker(), lastHeartbeatReceived = Date[_0x1827cb(1536)](), startHeartbeatChecker();
  } catch (_0x4103b5) {
    console[_0x1827cb(981)](" Failed to start key listener:", _0x4103b5), KeyListenerProcess = null;
  }
}, registerAllHotkeys = () => {
  const _0x32890a = _0x54a1b7;
  if (!KeyListenerProcess) {
    console[_0x32890a(1697)]("Key listener not running, cannot register hotkeys.");
    return;
  }
  const { keyboardShortcuts: _0x247a0c } = store[_0x32890a(1043)](STORE_KEYS[_0x32890a(193)]), _0x577157 = _0x247a0c[_0x32890a(1380)]((_0x193828) => _0x193828[_0x32890a(1037)][_0x32890a(1115)] > 0)[_0x32890a(306)]((_0x23084a) => ({ "keys": getKeysToRegister(_0x23084a) }));
  console[_0x32890a(1341)]("Registering hotkeys with listener:", _0x577157), KeyListenerProcess[_0x32890a(776)]?.[_0x32890a(1020)](JSON[_0x32890a(1516)]({ "command": "register_hotkeys", "hotkeys": _0x577157 }) + "\n");
}, reverseKeyNameMap = Object[_0x54a1b7(1451)](keyNameMap)[_0x54a1b7(1720)]((_0x3f8b83, [_0x528907, _0x29e936]) => {
  const _0x5c3f31 = _0x54a1b7;
  return !_0x3f8b83[_0x29e936] && (_0x3f8b83[_0x29e936] = []), _0x3f8b83[_0x29e936][_0x5c3f31(529)](_0x528907), _0x3f8b83;
}, {}), getKeysToRegister = (_0x12a875) => {
  const _0x1d7d9b = _0x54a1b7;
  if (!_0x12a875) return [];
  const _0x41bea3 = [];
  for (const _0x41e0f8 of _0x12a875[_0x1d7d9b(1037)]) {
    const _0x5d6e48 = normalizeLegacyKey(_0x41e0f8), _0x2301ac = reverseKeyNameMap[_0x5d6e48];
    _0x2301ac && _0x2301ac[_0x1d7d9b(1115)] > 0 ? _0x41bea3[_0x1d7d9b(529)](..._0x2301ac) : _0x41bea3[_0x1d7d9b(529)](_0x41e0f8);
  }
  return _0x12a875[_0x1d7d9b(1037)][_0x1d7d9b(1580)]("fn") && _0x41bea3[_0x1d7d9b(529)](_0x1d7d9b(369)), [...new Set(_0x41bea3)];
}, getRecordingBlockKeys = () => {
  const _0x337c9f = _0x54a1b7, _0x93f9f3 = store[_0x337c9f(1043)](STORE_KEYS[_0x337c9f(193)]), _0x39ad79 = _0x93f9f3?.[_0x337c9f(720)]?.[_0x337c9f(1037)] || [_0x337c9f(1842)], _0x45c1d1 = [];
  for (const _0x58c51b of _0x39ad79) {
    const _0x3683ba = normalizeLegacyKey(_0x58c51b), _0x5b606f = reverseKeyNameMap[_0x3683ba];
    _0x5b606f && _0x5b606f[_0x337c9f(1115)] > 0 ? _0x45c1d1[_0x337c9f(529)](..._0x5b606f) : _0x45c1d1[_0x337c9f(529)](_0x58c51b);
  }
  return _0x39ad79[_0x337c9f(1580)]("fn") && _0x45c1d1[_0x337c9f(529)](_0x337c9f(369)), _0x45c1d1[_0x337c9f(529)](_0x337c9f(1845)), [...new Set(_0x45c1d1)];
}, activeRecordingBlockKeys = /* @__PURE__ */ new Set(), activeUiBlockedKeys = /* @__PURE__ */ new Set(), syncAllBlockedKeysToNative = () => {
  const _0xb49ae7 = _0x54a1b7;
  if (!KeyListenerProcess) return;
  const _0x597647 = [.../* @__PURE__ */ new Set([...activeRecordingBlockKeys, ...activeUiBlockedKeys])];
  KeyListenerProcess[_0xb49ae7(776)]?.[_0xb49ae7(1020)](JSON[_0xb49ae7(1516)]({ "command": "set_recording_block_keys", "keys": _0x597647 }) + "\n");
}, setRecordingBlockKeys = () => {
  const _0x7bfa03 = _0x54a1b7;
  process[_0x7bfa03(1532)][_0x7bfa03(1020)](" [Keyboard] setRecordingBlockKeys() called\n");
  if (!KeyListenerProcess) {
    process[_0x7bfa03(1532)][_0x7bfa03(1020)](" [Keyboard] Key listener not running, cannot set recording block keys\n");
    return;
  }
  const _0x86713b = getRecordingBlockKeys();
  process[_0x7bfa03(1532)][_0x7bfa03(1020)](_0x7bfa03(1821) + JSON[_0x7bfa03(1516)](_0x86713b) + "\n"), activeRecordingBlockKeys[_0x7bfa03(1723)]();
  for (const _0x4ef3fb of _0x86713b) activeRecordingBlockKeys[_0x7bfa03(1332)](_0x4ef3fb);
  syncAllBlockedKeysToNative();
}, clearRecordingBlockKeys = () => {
  const _0x4d9e66 = _0x54a1b7;
  if (!KeyListenerProcess) return;
  console[_0x4d9e66(926)]("[Keyboard] Clearing recording block keys"), activeRecordingBlockKeys[_0x4d9e66(1723)](), syncAllBlockedKeysToNative();
}, addUiBlockedKeys = (_0x54d4b9) => {
  const _0xd5f9fe = _0x54a1b7;
  for (const _0x19cfd7 of _0x54d4b9) activeUiBlockedKeys[_0xd5f9fe(1332)](_0x19cfd7);
  syncAllBlockedKeysToNative();
}, removeUiBlockedKey = (_0x58faea) => {
  const _0x3965ef = _0x54a1b7;
  activeUiBlockedKeys[_0x3965ef(506)](_0x58faea), syncAllBlockedKeysToNative();
}, getUiBlockedKeys = () => {
  return [...activeUiBlockedKeys];
}, stopKeyListener = () => {
  const _0x303304 = _0x54a1b7;
  KeyListenerProcess && (pressedKeys[_0x303304(1723)](), keyPressTimestamps[_0x303304(1723)](), stopStuckKeyChecker(), stopHeartbeatChecker(), KeyListenerProcess[_0x303304(1386)](_0x303304(461)), KeyListenerProcess = null);
}, keyboard = Object[_0x54a1b7(502)](Object[_0x54a1b7(634)]({ "__proto__": null, get "KeyListenerProcess"() {
  return KeyListenerProcess;
}, "addUiBlockedKeys": addUiBlockedKeys, "cancelHandsFreeRecording": cancelHandsFreeRecording, "clearRecordingBlockKeys": clearRecordingBlockKeys, "getUiBlockedKeys": getUiBlockedKeys, "keyNameMap": keyNameMap, "registerAllHotkeys": registerAllHotkeys, "removeUiBlockedKey": removeUiBlockedKey, "setRecordingBlockKeys": setRecordingBlockKeys, get "shortcutState"() {
  return shortcutState;
}, "shouldSimulateEnterAndClear": shouldSimulateEnterAndClear, "startKeyListener": startKeyListener, "stopHandsFreeRecording": stopHandsFreeRecording, "stopKeyListener": stopKeyListener }, Symbol[_0x54a1b7(1177)], { "value": _0x54a1b7(1416) })), handleIPC = (_0x42f4bc, _0x54dff2) => {
  const _0x99d5c1 = _0x54a1b7;
  electron[_0x99d5c1(1822)][_0x99d5c1(1295)](_0x42f4bc, _0x54dff2);
};
function registerIPC() {
  const _0x5b0eca = _0x54a1b7;
  electron[_0x5b0eca(1822)]["on"]("electron-store-get", (_0x447101, _0x3ac4f0) => {
    const _0xdbdd17 = _0x5b0eca;
    _0x447101[_0xdbdd17(1013)] = store[_0xdbdd17(1043)](_0x3ac4f0);
  }), electron[_0x5b0eca(1822)]["on"]("electron-store-set", (_0x56b73a, _0x4c6538, _0x414178) => {
    const _0x4f0f1f = _0x5b0eca;
    _0x4c6538 === STORE_KEYS[_0x4f0f1f(193)] && _0x414178?.[_0x4f0f1f(720)] && log[_0x4f0f1f(1341)](_0x4f0f1f(388) + JSON[_0x4f0f1f(1516)](_0x414178[_0x4f0f1f(720)])), store[_0x4f0f1f(1359)](_0x4c6538, _0x414178);
  }), electron[_0x5b0eca(1822)]["on"]("audio-devices-changed", () => {
    const _0x50bfe8 = _0x5b0eca;
    log[_0x50bfe8(1341)]("[IPC] Audio devices changed, notifying windows."), mainWindow && !mainWindow[_0x50bfe8(496)]() && !mainWindow[_0x50bfe8(890)][_0x50bfe8(496)]() && mainWindow[_0x50bfe8(890)][_0x50bfe8(965)](IPC_EVENTS[_0x50bfe8(1646)]), getPillWindow()?.[_0x50bfe8(890)][_0x50bfe8(965)](IPC_EVENTS[_0x50bfe8(1646)]);
  }), electron[_0x5b0eca(1822)]["on"]("install-update", () => {
    const _0x29a1bd = _0x5b0eca;
    electronUpdater[_0x29a1bd(1102)][_0x29a1bd(149)](!![], !![]);
  }), electron[_0x5b0eca(1822)][_0x5b0eca(1295)]("get-update-status", () => {
    return getUpdateStatus();
  }), handleIPC("restart-app", () => {
    const _0x34d861 = _0x5b0eca;
    log[_0x34d861(1341)](_0x34d861(939)), electron[_0x34d861(178)][_0x34d861(1185)](), electron[_0x34d861(178)][_0x34d861(277)]();
  }), handleIPC("set-login-item-settings", (_0x19f846, _0x2a41b1) => {
    const _0x16a77b = _0x5b0eca;
    try {
      electron[_0x16a77b(178)][_0x16a77b(1667)]({ "openAtLogin": _0x2a41b1, "openAsHidden": ![] }), log[_0x16a77b(1341)](_0x16a77b(220) + _0x2a41b1);
    } catch (_0x34ac8c) {
      log[_0x16a77b(981)]("Failed to set login item settings:", _0x34ac8c);
    }
  }), handleIPC("get-login-item-settings", () => {
    const _0x47efca = _0x5b0eca;
    try {
      return electron[_0x47efca(178)][_0x47efca(355)]();
    } catch (_0x47c0fd) {
      return log[_0x47efca(981)]("Failed to get login item settings:", _0x47c0fd), { "openAtLogin": ![], "openAsHidden": ![] };
    }
  }), handleIPC("set-dock-visibility", (_0x2da16d, _0x27d0d7) => {
    const _0x2c590b = _0x5b0eca;
    try {
      process[_0x2c590b(1394)] === "darwin" ? (_0x27d0d7 ? electron[_0x2c590b(178)][_0x2c590b(565)]?.[_0x2c590b(1286)]() : electron[_0x2c590b(178)][_0x2c590b(565)]?.[_0x2c590b(129)](), log[_0x2c590b(1341)](_0x2c590b(690) + _0x27d0d7)) : log[_0x2c590b(1697)]("Dock visibility setting is only available on macOS");
    } catch (_0x3dc98c) {
      log[_0x2c590b(981)]("Failed to set dock visibility:", _0x3dc98c);
    }
  }), handleIPC("get-dock-visibility", () => {
    const _0x31f4d6 = _0x5b0eca;
    try {
      if (process[_0x31f4d6(1394)] === "darwin" && electron[_0x31f4d6(178)][_0x31f4d6(565)]) {
        const _0x2ac1d3 = electron[_0x31f4d6(178)][_0x31f4d6(565)][_0x31f4d6(1639)]();
        return { "isVisible": _0x2ac1d3 };
      } else return log[_0x31f4d6(1697)]("Dock visibility check is only available on macOS"), { "isVisible": !![] };
    } catch (_0x1b65a5) {
      return log[_0x31f4d6(981)]("Failed to get dock visibility:", _0x1b65a5), { "isVisible": !![] };
    }
  }), handleIPC("start-key-listener-service", () => {
    startKeyListener();
  }), handleIPC("stop-key-listener", () => stopKeyListener()), handleIPC("register-hotkeys", () => registerAllHotkeys()), handleIPC("start-native-recording-service", () => voiceInputService[_0x5b0eca(896)](VoiceOSMode[_0x5b0eca(124)])), handleIPC("stop-native-recording-service", () => voiceInputService[_0x5b0eca(1158)]()), handleIPC("set-override-app-context", (_0x3208b1, _0x5d4ee3, _0x146ba3, _0x29de1e) => {
    const _0x5e8cf4 = _0x5b0eca;
    voiceInputService[_0x5e8cf4(1579)]({ "appName": _0x5d4ee3, "windowTitle": _0x146ba3, "contextText": _0x29de1e });
  }), handleIPC("clear-override-app-context", () => {
    const _0x1ff4c0 = _0x5b0eca;
    voiceInputService[_0x1ff4c0(342)]();
  }), handleIPC("block-keys", (_0x398d2c, _0x3bf83c) => {
    addUiBlockedKeys(_0x3bf83c);
  }), handleIPC("unblock-key", (_0x4dbeb1, _0x2c7732) => {
    removeUiBlockedKey(_0x2c7732);
  }), handleIPC("get-blocked-keys", () => {
    return getUiBlockedKeys();
  }), handleIPC("check-accessibility-permission", (_0x2655da, _0x9a8132 = ![]) => checkAccessibilityPermission(_0x9a8132)), handleIPC("get-accessibility-permission-status", () => getAccessibilityPermissionStatus()), handleIPC("open-accessibility-settings", async () => {
    const _0x1658fe = _0x5b0eca;
    log[_0x1658fe(1341)]("[IPC] open-accessibility-settings called"), await openAccessibilitySettings();
  }), handleIPC("check-microphone-permission", async (_0x5217fa, _0x5daaea = ![]) => {
    return checkMicrophonePermission(_0x5daaea);
  }), handleIPC("get-microphone-permission-status", () => getMicrophonePermissionStatus()), handleIPC(_0x5b0eca(263), async () => {
    const _0x6be358 = _0x5b0eca;
    return log[_0x6be358(1341)]("[IPC] initialize-audio-recorder called"), initializeAudioRecorder();
  }), handleIPC("check-screen-recording-permission", async (_0x227c2c, _0x2fe89c = ![]) => {
    return checkScreenRecordingPermission(_0x2fe89c);
  }), handleIPC("open-screen-recording-settings", async () => {
    const _0x32c49b = _0x5b0eca;
    log[_0x32c49b(1341)]("[IPC] open-screen-recording-settings called"), process[_0x32c49b(1394)] === "darwin" ? (log[_0x32c49b(1341)]("[IPC] Opening screen recording settings on macOS"), await electron[_0x32c49b(298)][_0x32c49b(792)]("x-apple.systempreferences:com.apple.preference.security?Privacy_ScreenCapture"), log[_0x32c49b(1341)]("[IPC] Screen recording settings opened")) : log[_0x32c49b(1341)]("[IPC] Screen recording settings not supported on platform:", process[_0x32c49b(1394)]);
  }), handleIPC("trigger-screen-capture-consent", async () => {
    const _0x494fa5 = _0x5b0eca;
    log[_0x494fa5(1341)]("[IPC] trigger-screen-capture-consent called");
    if (process[_0x494fa5(1394)] === "darwin") {
      const { getScreenshotService: _0x388f8d } = await Promise[_0x494fa5(1786)]()[_0x494fa5(843)](() => require(_0x494fa5(1683))), _0x1a4428 = _0x388f8d();
      try {
        return log[_0x494fa5(1341)]("[IPC] Triggering full screen capture to prompt consent dialog"), await _0x1a4428[_0x494fa5(1802)](), log[_0x494fa5(1341)]("[IPC] Screen capture completed successfully"), { "success": !![] };
      } catch (_0x41efad) {
        return log[_0x494fa5(981)](_0x494fa5(1282), _0x41efad), { "success": ![], "reason": _0x494fa5(1823), "error": String(_0x41efad) };
      }
    }
    return { "success": !![], "reason": _0x494fa5(719) };
  }), handleIPC("logout", () => handleLogout()), handleIPC("notify-login-success", async (_0x112984, { profile: _0x523a18, idToken: _0x308ed3, accessToken: _0x3db599 }) => {
    const _0x15e306 = _0x5b0eca;
    console[_0x15e306(926)]("notify-login-success: Updating main process with auth tokens"), store[_0x15e306(1359)](STORE_KEYS[_0x15e306(1850)], _0x523a18), _0x3db599 && (store[_0x15e306(1359)](STORE_KEYS[_0x15e306(684)], _0x3db599), grpcClient[_0x15e306(1843)](_0x3db599)), _0x308ed3 && store[_0x15e306(1359)](STORE_KEYS[_0x15e306(1072)], _0x308ed3);
  }), handleIPC("refresh-tokens", async () => {
    const _0x400cda = _0x5b0eca;
    try {
      const _0x221799 = await refreshSession();
      return _0x221799;
    } catch (_0x5af54a) {
      return console[_0x400cda(981)](" Manual session refresh failed:", _0x5af54a), { "success": ![], "error": _0x5af54a instanceof Error ? _0x5af54a[_0x400cda(1486)] : "Unknown error" };
    }
  }), handleIPC("get-onboarding-state", async () => {
    const _0x50efa0 = _0x5b0eca;
    try {
      const _0x59263d = getCurrentUserId();
      if (!_0x59263d) return null;
      const _0x533a3f = await SyncMetadata[_0x50efa0(1043)](_0x50efa0(1478) + _0x59263d);
      return _0x533a3f ? JSON[_0x50efa0(675)](_0x533a3f) : null;
    } catch (_0x40351a) {
      return log[_0x50efa0(981)]("[IPC] Failed to get onboarding state:", _0x40351a), null;
    }
  });
  const _0x518e78 = (_0x4ba841) => electron[_0x5b0eca(963)][_0x5b0eca(1724)](_0x4ba841[_0x5b0eca(738)]);
  handleIPC("init-window", (_0x2be0a1) => {
    const _0x8fcf7e = _0x5b0eca, _0xc5c44f = _0x518e78(_0x2be0a1);
    if (!_0xc5c44f) return {};
    const { width: _0xb3c213, height: _0x3317ce } = _0xc5c44f[_0x8fcf7e(1555)]();
    return { "width": _0xb3c213, "height": _0x3317ce, "minimizable": _0xc5c44f[_0x8fcf7e(1605)](), "maximizable": _0xc5c44f[_0x8fcf7e(1243)](), "platform": os[_0x8fcf7e(1394)]() };
  }), handleIPC("is-window-minimizable", (_0x17b43f) => _0x518e78(_0x17b43f)?.[_0x5b0eca(1605)]()), handleIPC("is-window-maximizable", (_0x56cf8e) => _0x518e78(_0x56cf8e)?.[_0x5b0eca(1243)]()), handleIPC("window-minimize", (_0x4c8437) => _0x518e78(_0x4c8437)?.[_0x5b0eca(467)]()), handleIPC("window-maximize", (_0x1fc2fa) => _0x518e78(_0x1fc2fa)?.[_0x5b0eca(143)]()), handleIPC("window-close", (_0x25553f) => _0x518e78(_0x25553f)?.[_0x5b0eca(711)]()), handleIPC("window-maximize-toggle", (_0x23249f) => {
    const _0x392f41 = _0x5b0eca, _0x164645 = _0x518e78(_0x23249f);
    if (_0x164645?.[_0x392f41(212)]()) _0x164645[_0x392f41(592)]();
    else _0x164645?.[_0x392f41(143)]();
  });
  const _0x2f20cd = (_0x3dd475) => _0x3dd475[_0x5b0eca(738)];
  handleIPC("web-undo", (_0x25d2e7) => _0x2f20cd(_0x25d2e7)[_0x5b0eca(1241)]()), handleIPC("web-redo", (_0x43f3ad) => _0x2f20cd(_0x43f3ad)[_0x5b0eca(1475)]()), handleIPC("web-cut", (_0x50dc12) => _0x2f20cd(_0x50dc12)[_0x5b0eca(1644)]()), handleIPC("web-copy", (_0x225362) => _0x2f20cd(_0x225362)[_0x5b0eca(686)]()), handleIPC("web-paste", (_0x5cceb5) => _0x2f20cd(_0x5cceb5)[_0x5b0eca(1831)]()), handleIPC("web-delete", (_0x5d685a) => _0x2f20cd(_0x5d685a)[_0x5b0eca(506)]()), handleIPC("web-select-all", (_0xe504b6) => _0x2f20cd(_0xe504b6)[_0x5b0eca(192)]()), handleIPC("web-reload", (_0x490b87) => _0x2f20cd(_0x490b87)[_0x5b0eca(1313)]()), handleIPC("web-force-reload", (_0x4d4d93) => _0x2f20cd(_0x4d4d93)[_0x5b0eca(1016)]()), handleIPC("web-toggle-devtools", (_0x526348) => _0x2f20cd(_0x526348)[_0x5b0eca(1685)]()), handleIPC("web-actual-size", (_0xeaf305) => _0x2f20cd(_0xeaf305)[_0x5b0eca(1783)](0)), handleIPC("web-zoom-in", (_0x1ee95f) => _0x2f20cd(_0x1ee95f)[_0x5b0eca(1783)](_0x2f20cd(_0x1ee95f)[_0x5b0eca(505)]() + 0.5)), handleIPC("web-zoom-out", (_0x47feef) => _0x2f20cd(_0x47feef)[_0x5b0eca(1783)](_0x2f20cd(_0x47feef)[_0x5b0eca(505)]() - 0.5)), handleIPC("web-toggle-fullscreen", (_0x43a1d9) => {
    const _0x238876 = _0x5b0eca, _0x5e31cc = _0x518e78(_0x43a1d9);
    _0x5e31cc?.[_0x238876(390)](!_0x5e31cc[_0x238876(1328)]());
  }), handleIPC("web-open-url", (_0x35bd5a, _0x3acb9d) => electron[_0x5b0eca(298)][_0x5b0eca(792)](_0x3acb9d)), handleIPC(_0x5b0eca(997), async (_0x167d20, { url: _0x3296a2, redirectUri: _0x2bcbfc }) => {
    const _0x4e5e56 = _0x5b0eca;
    try {
      console[_0x4e5e56(926)]("[IPC]  open-auth-window called"), console[_0x4e5e56(926)](_0x4e5e56(854), _0x3296a2), console[_0x4e5e56(926)](_0x4e5e56(488), _0x2bcbfc);
      if (!_0x3296a2 || !_0x2bcbfc) return console[_0x4e5e56(981)](" [IPC] Missing url or redirectUri"), { "success": ![], "error": "Missing url or redirectUri" };
      console[_0x4e5e56(926)](_0x4e5e56(209));
      const _0x245067 = new electron[_0x4e5e56(963)]({ "parent": mainWindow ?? void 0, "modal": !![], "width": 480, "height": 720, "show": !![], "autoHideMenuBar": !![], "webPreferences": { "nodeIntegration": ![], "contextIsolation": !![], "sandbox": !![] } });
      let _0x3100b1 = ![];
      const _0x33f799 = (_0x487963, _0x3ade16) => {
        const _0x3b947d = _0x4e5e56;
        try {
          console[_0x3b947d(926)](_0x3b947d(133), _0x3ade16);
          if (!_0x3ade16) return;
          if (_0x3ade16[_0x3b947d(137)](_0x2bcbfc) || _0x3ade16[_0x3b947d(1580)]("/auth/callback")) {
            _0x487963[_0x3b947d(554)](), _0x3100b1 = !![];
            const _0x6b977f = _0x3ade16[_0x3b947d(1257)]("#");
            if (_0x6b977f !== -1) {
              const _0x2ca2c0 = _0x3ade16[_0x3b947d(350)](_0x6b977f + 1), _0x1e2654 = new URLSearchParams(_0x2ca2c0), _0xa9e980 = _0x1e2654[_0x3b947d(1043)]("access_token"), _0x502c3b = _0x1e2654[_0x3b947d(1043)]("refresh_token"), _0xf850d7 = _0x1e2654[_0x3b947d(1043)]("expires_in");
              if (_0xa9e980) {
                console[_0x3b947d(926)]("[IPC]  Supabase OAuth successful! Tokens extracted from hash");
                mainWindow && !mainWindow[_0x3b947d(496)]() && mainWindow[_0x3b947d(890)][_0x3b947d(965)]("supabase-auth-success", { "access_token": _0xa9e980, "refresh_token": _0x502c3b, "expires_in": _0xf850d7 ? parseInt(_0xf850d7) : void 0 });
                setTimeout(() => {
                  const _0x3da00d = _0x3b947d;
                  if (!_0x245067[_0x3da00d(496)]()) _0x245067[_0x3da00d(711)]();
                }, 100);
                return;
              }
            }
            console[_0x3b947d(1697)]("[IPC] Callback received but no tokens found");
            if (!_0x245067[_0x3b947d(496)]()) _0x245067[_0x3b947d(711)]();
          }
        } catch (_0x20108d) {
          console[_0x3b947d(981)](" [IPC] open-auth-window redirect parse error:", _0x20108d);
        }
      };
      _0x245067[_0x4e5e56(890)]["on"]("did-fail-load", (_0xd1ec9, _0x2c8105, _0x539670, _0xd1d9c2) => {
        const _0x290dee = _0x4e5e56;
        if (_0xd1d9c2[_0x290dee(137)](_0x2bcbfc)) {
          console[_0x290dee(926)]("[IPC] Protocol URL triggered (expected), ignoring load failure");
          return;
        }
        console[_0x290dee(1697)](_0x290dee(157), _0x2c8105, _0x539670, _0xd1d9c2);
      }), _0x245067[_0x4e5e56(890)]["on"]("will-redirect", _0x33f799), _0x245067[_0x4e5e56(890)]["on"]("will-navigate", _0x33f799);
      try {
        await _0x245067[_0x4e5e56(1278)](_0x3296a2);
      } catch (_0x41cd8d) {
        if (_0x3100b1) return console[_0x4e5e56(926)]("[IPC]  Auth completed successfully (ignoring protocol navigation error)"), { "success": !![] };
        if (_0x41cd8d[_0x4e5e56(1486)]?.[_0x4e5e56(1580)](_0x4e5e56(895)) || _0x41cd8d[_0x4e5e56(1486)]?.[_0x4e5e56(1580)](_0x4e5e56(489))) return console[_0x4e5e56(926)]("[IPC] Auth window closed (protocol redirect triggered)"), { "success": !![] };
        throw _0x41cd8d;
      }
      return { "success": !![] };
    } catch (_0x549dcc) {
      return console[_0x4e5e56(981)](" [IPC] open-auth-window error:", _0x549dcc), { "success": ![], "error": _0x549dcc?.[_0x4e5e56(1486)] || "Unknown error" };
    }
  }), handleIPC("get-native-audio-devices", async () => {
    const _0x476113 = _0x5b0eca;
    return log[_0x476113(1341)]("[IPC] Received get-native-audio-devices, calling requestDeviceListPromise..."), audioRecorderService[_0x476113(1242)]();
  }), handleIPC("force-builtin-microphone-for-onboarding", async () => {
    const _0x32a572 = _0x5b0eca;
    log[_0x32a572(1341)]("[IPC] Received force-builtin-microphone-for-onboarding");
    try {
      const _0xdc08a0 = await audioRecorderService[_0x32a572(1242)](), _0x9ec1f6 = store[_0x32a572(1043)](STORE_KEYS[_0x32a572(193)]), _0x1cf23f = _0x9ec1f6?.[_0x32a572(548)] || _0x32a572(450), _0x2d607b = _0x1cf23f[_0x32a572(1566)]()[_0x32a572(1580)](_0x32a572(1342)), _0x41bd3c = _0xdc08a0[_0x32a572(445)]((_0x505f53) => _0x505f53[_0x32a572(1566)]()[_0x32a572(1580)](_0x32a572(1342))), _0x2d87c1 = _0x1cf23f === _0x32a572(450) && _0x41bd3c;
      if (!_0x2d607b && !_0x2d87c1) return log[_0x32a572(1341)]("[IPC] No AirPods detected, keeping current microphone"), { "success": !![], "switched": ![], "reason": _0x32a572(1442), "currentDevice": _0x1cf23f };
      const _0x365c3a = _0xdc08a0[_0x32a572(445)]((_0x21d2f7) => {
        const _0x156e5b = _0x32a572, _0x4e1db2 = _0x21d2f7[_0x156e5b(1566)]();
        return _0x4e1db2[_0x156e5b(1580)](_0x156e5b(1080)) || _0x4e1db2[_0x156e5b(1580)](_0x156e5b(537)) || _0x4e1db2[_0x156e5b(1580)](_0x156e5b(668));
      });
      if (!_0x365c3a) return log[_0x32a572(1697)]("[IPC] No built-in microphone found"), { "success": ![], "switched": ![], "reason": _0x32a572(458), "currentDevice": _0x1cf23f };
      const _0x17b38e = _0x1cf23f, _0x1517c8 = _0x9ec1f6?.[_0x32a572(142)] || _0x32a572(551), _0x276b27 = { ..._0x9ec1f6, "micDeviceId": _0x365c3a, "micSelected": _0x365c3a, "_onboardingOriginalMicId": _0x17b38e, "_onboardingOriginalMicName": _0x1517c8 };
      return store[_0x32a572(1359)](STORE_KEYS[_0x32a572(193)], _0x276b27), log[_0x32a572(1341)](_0x32a572(1441) + _0x17b38e + _0x32a572(472) + _0x365c3a + _0x32a572(991)), { "success": !![], "switched": !![], "reason": _0x32a572(1406), "previousDevice": _0x17b38e, "newDevice": _0x365c3a };
    } catch (_0x14514b) {
      return log[_0x32a572(981)]("[IPC] Failed to force built-in microphone:", _0x14514b), { "success": ![], "switched": ![], "reason": "error", "error": _0x14514b[_0x32a572(1486)] || "Unknown error" };
    }
  }), handleIPC("restore-original-microphone-after-onboarding", async () => {
    const _0x5e1d28 = _0x5b0eca;
    log[_0x5e1d28(1341)]("[IPC] Received restore-original-microphone-after-onboarding");
    try {
      const _0x366fc4 = store[_0x5e1d28(1043)](STORE_KEYS[_0x5e1d28(193)]), _0x4a73b0 = _0x366fc4?.[_0x5e1d28(1284)], _0x1a314c = _0x366fc4?.[_0x5e1d28(1666)];
      if (!_0x4a73b0) return log[_0x5e1d28(1341)]("[IPC] No original microphone to restore"), { "success": !![], "restored": ![], "reason": _0x5e1d28(734) };
      const _0x2f3bbe = { ..._0x366fc4, "micDeviceId": _0x4a73b0, "micSelected": _0x1a314c || _0x5e1d28(551) };
      return delete _0x2f3bbe[_0x5e1d28(1284)], delete _0x2f3bbe[_0x5e1d28(1666)], store[_0x5e1d28(1359)](STORE_KEYS[_0x5e1d28(193)], _0x2f3bbe), log[_0x5e1d28(1341)](_0x5e1d28(624) + _0x4a73b0 + '"'), { "success": !![], "restored": !![], "restoredDevice": _0x4a73b0 };
    } catch (_0x5432d3) {
      return log[_0x5e1d28(981)]("[IPC] Failed to restore original microphone:", _0x5432d3), { "success": ![], "restored": ![], "reason": "error", "error": _0x5432d3[_0x5e1d28(1486)] || "Unknown error" };
    }
  }), handleIPC("get-platform", () => {
    const _0x4df7ec = _0x5b0eca;
    return process[_0x4df7ec(1394)];
  }), handleIPC("get-system-theme", () => {
    const _0x567eb1 = _0x5b0eca;
    return electron[_0x567eb1(1308)][_0x567eb1(402)] ? _0x567eb1(1606) : _0x567eb1(1718);
  }), electron[_0x5b0eca(1308)]["on"]("updated", () => {
    const _0x238961 = _0x5b0eca, _0x16b572 = electron[_0x238961(1308)][_0x238961(402)] ? _0x238961(1606) : _0x238961(1718);
    log[_0x238961(1341)]("[System Theme] Theme changed to:", _0x16b572);
    mainWindow && !mainWindow[_0x238961(496)]() && mainWindow[_0x238961(890)][_0x238961(965)]("system-theme-changed", _0x16b572);
    const _0x3ea201 = getPillWindow();
    _0x3ea201 && !_0x3ea201[_0x238961(496)]() && _0x3ea201[_0x238961(890)][_0x238961(965)]("system-theme-changed", _0x16b572);
  }), handleIPC("get-selected-text", async (_0x579a72, _0x5636c8) => {
    const _0x1d257c = _0x5b0eca;
    return log[_0x1d257c(1341)]("[IPC] Received get-selected-text with options:", _0x5636c8), getSelectedText(_0x5636c8);
  }), handleIPC("get-selected-text-string", async (_0x16c100, _0x51dcff) => {
    const _0x2b7eac = _0x5b0eca;
    return log[_0x2b7eac(1341)]("[IPC] Received get-selected-text-string"), getSelectedTextString(_0x51dcff);
  }), handleIPC("has-selected-text", async () => {
    const _0x5e8b4a = _0x5b0eca;
    return log[_0x5e8b4a(1341)]("[IPC] Received has-selected-text"), hasSelectedText();
  }), handleIPC("screenshot:capture-primary", async (_0x243ec4) => {
    const _0x342061 = _0x5b0eca;
    log[_0x342061(1341)]("[IPC] screenshot:capture-primary - Capturing primary display");
    try {
      const { getScreenshotService: _0x4f4df5 } = await Promise[_0x342061(1786)]()[_0x342061(843)](() => require(_0x342061(1683))), _0x4991a9 = _0x4f4df5(), _0x255583 = await _0x4991a9[_0x342061(960)]();
      if (!_0x255583) return log[_0x342061(981)](_0x342061(779)), { "success": ![], "error": _0x342061(1343) };
      return log[_0x342061(1341)]("[IPC] Screenshot captured successfully"), { "success": !![], "dataUri": _0x255583 };
    } catch (_0x404450) {
      return log[_0x342061(981)](_0x342061(1029), _0x404450), { "success": ![], "error": _0x404450?.[_0x342061(1486)] || "Unknown error" };
    }
  }), electron[_0x5b0eca(178)]["on"]("before-quit", () => stopKeyListener()), handleIPC("dictionary:get-all", () => {
    const _0x43c6c8 = _0x5b0eca, _0x445db0 = getCurrentUserId();
    return DictionaryTable[_0x43c6c8(440)](_0x445db0);
  }), handleIPC("dictionary:add", async (_0x6584f8, _0x2e36ff) => {
    const _0x3ec601 = _0x5b0eca;
    return await DictionaryTable[_0x3ec601(1761)](_0x2e36ff);
  }), handleIPC("dictionary:update", async (_0x1880fa, { id: _0x470450, text: _0x4d0872, description: _0x284ee7, app_identifiers: _0x554f35 }) => {
    const _0x266eab = _0x5b0eca;
    return await DictionaryTable[_0x266eab(324)](_0x470450, _0x4d0872, _0x284ee7, _0x554f35);
  }), handleIPC("dictionary:delete", async (_0x4db159, _0x3260b9) => {
    const _0x26c941 = _0x5b0eca, _0x2fe087 = await DictionaryTable[_0x26c941(428)](_0x3260b9);
    return mainWindow && !mainWindow[_0x26c941(496)]() && mainWindow[_0x26c941(890)][_0x26c941(965)](IPC_EVENTS[_0x26c941(1002)]), _0x2fe087;
  }), handleIPC("voice-sessions:get-all", () => {
    const _0x23864e = _0x5b0eca, _0x24bbb1 = getCurrentUserId();
    return VoiceSessionsTable[_0x23864e(440)](_0x24bbb1);
  }), handleIPC("voice-sessions:delete", async (_0x4173d6, _0xf967de) => {
    const _0x5e633d = _0x5b0eca;
    try {
      await VoiceSessionsTable[_0x5e633d(428)](_0xf967de), log[_0x5e633d(1341)](_0x5e633d(1069) + _0xf967de);
      const _0x406d3f = store[_0x5e633d(1043)](STORE_KEYS[_0x5e633d(193)]), _0x4c4edb = _0x406d3f?.[_0x5e633d(1372)] ?? !![];
      if (_0x4c4edb) try {
        await grpcClient[_0x5e633d(421)](_0xf967de), log[_0x5e633d(1341)](_0x5e633d(665) + _0xf967de);
      } catch (_0x4286ff) {
        log[_0x5e633d(981)](_0x5e633d(830) + _0xf967de, _0x4286ff);
      }
      return { "success": !![] };
    } catch (_0x655564) {
      return log[_0x5e633d(981)](_0x5e633d(650) + _0xf967de, _0x655564), { "success": ![], "error": _0x655564[_0x5e633d(1486)] || "Failed to delete" };
    }
  }), handleIPC("app-icons:get-all", () => {
    const _0x2855e2 = _0x5b0eca, _0x2ba146 = getCurrentUserId();
    if (!_0x2ba146) return [];
    return AppIconsTable[_0x2855e2(440)](_0x2ba146);
  }), handleIPC("app-icons:get-by-name", (_0x20609d, _0x482b79) => {
    const _0x297749 = _0x5b0eca, _0x5c6f30 = getCurrentUserId();
    if (!_0x5c6f30) return null;
    return AppIconsTable[_0x297749(671)](_0x5c6f30, _0x482b79);
  });
  const _0x3e7b43 = () => {
    return "https://api.voiceos.com";
  };
  handleIPC("knowledge:get-all", async () => {
    const _0x3c5005 = _0x5b0eca;
    try {
      const _0x551920 = store[_0x3c5005(1043)](STORE_KEYS[_0x3c5005(684)]);
      if (!_0x551920) return { "success": ![], "error": _0x3c5005(343) };
      const _0x395c72 = await fetch(_0x3e7b43() + _0x3c5005(780), { "method": _0x3c5005(1334), "headers": { "Authorization": _0x3c5005(1324) + _0x551920, "Content-Type": "application/json" } });
      if (!_0x395c72["ok"]) {
        const _0x464d88 = await _0x395c72[_0x3c5005(1360)]()[_0x3c5005(564)](() => ({}));
        return { "success": ![], "error": _0x464d88[_0x3c5005(1486)] || _0x3c5005(1121) + _0x395c72[_0x3c5005(174)] };
      }
      const _0x5e505e = await _0x395c72[_0x3c5005(1360)]();
      return { "success": !![], "items": _0x5e505e[_0x3c5005(1021)] || [] };
    } catch (_0x2a992b) {
      return log[_0x3c5005(981)]("[IPC] Failed to get knowledge items:", _0x2a992b), { "success": ![], "error": _0x2a992b[_0x3c5005(1486)] || "Failed to fetch knowledge items" };
    }
  }), handleIPC("knowledge:add", async (_0x301e60, { title: _0x2f2f4e, content: _0x29698a }) => {
    const _0x788ff5 = _0x5b0eca;
    try {
      const _0x1490d2 = store[_0x788ff5(1043)](STORE_KEYS[_0x788ff5(684)]);
      if (!_0x1490d2) return { "success": ![], "error": _0x788ff5(343) };
      const _0x2b3bca = await fetch(_0x3e7b43() + _0x788ff5(780), { "method": _0x788ff5(1031), "headers": { "Authorization": _0x788ff5(1324) + _0x1490d2, "Content-Type": "application/json" }, "body": JSON[_0x788ff5(1516)]({ "title": _0x2f2f4e, "content": _0x29698a }) });
      if (!_0x2b3bca["ok"]) {
        const _0x12f6b5 = await _0x2b3bca[_0x788ff5(1360)]()[_0x788ff5(564)](() => ({}));
        return { "success": ![], "error": _0x12f6b5[_0x788ff5(1486)] || _0x788ff5(988) };
      }
      const _0x20e494 = await _0x2b3bca[_0x788ff5(1360)]();
      return { "success": !![], "item": _0x20e494[_0x788ff5(1497)] };
    } catch (_0x55fdae) {
      return log[_0x788ff5(981)]("[IPC] Failed to add knowledge item:", _0x55fdae), { "success": ![], "error": _0x55fdae[_0x788ff5(1486)] || "Failed to add knowledge item" };
    }
  }), handleIPC("knowledge:update", async (_0x730ca7, { id: _0x25a725, title: _0x457d1a, content: _0x1d95f7 }) => {
    const _0x34a4e4 = _0x5b0eca;
    try {
      const _0xdd10a2 = store[_0x34a4e4(1043)](STORE_KEYS[_0x34a4e4(684)]);
      if (!_0xdd10a2) return { "success": ![], "error": _0x34a4e4(343) };
      const _0x430558 = await fetch(_0x3e7b43() + _0x34a4e4(793) + _0x25a725, { "method": _0x34a4e4(1652), "headers": { "Authorization": _0x34a4e4(1324) + _0xdd10a2, "Content-Type": "application/json" }, "body": JSON[_0x34a4e4(1516)]({ "title": _0x457d1a, "content": _0x1d95f7 }) });
      if (!_0x430558["ok"]) {
        const _0x85bddb = await _0x430558[_0x34a4e4(1360)]()[_0x34a4e4(564)](() => ({}));
        return { "success": ![], "error": _0x85bddb[_0x34a4e4(1486)] || _0x34a4e4(1263) };
      }
      const _0x2f4f55 = await _0x430558[_0x34a4e4(1360)]();
      return { "success": !![], "item": _0x2f4f55[_0x34a4e4(1497)] };
    } catch (_0x393332) {
      return log[_0x34a4e4(981)]("[IPC] Failed to update knowledge item:", _0x393332), { "success": ![], "error": _0x393332[_0x34a4e4(1486)] || "Failed to update knowledge item" };
    }
  }), handleIPC("knowledge:delete", async (_0x33160b, _0x8091bc) => {
    const _0x862947 = _0x5b0eca;
    try {
      const _0x2eae85 = store[_0x862947(1043)](STORE_KEYS[_0x862947(684)]);
      if (!_0x2eae85) return { "success": ![], "error": _0x862947(343) };
      const _0x129087 = await fetch(_0x3e7b43() + _0x862947(793) + _0x8091bc, { "method": _0x862947(996), "headers": { "Authorization": _0x862947(1324) + _0x2eae85 } });
      if (!_0x129087["ok"]) {
        const _0x4e667c = await _0x129087[_0x862947(1360)]()[_0x862947(564)](() => ({}));
        return { "success": ![], "error": _0x4e667c[_0x862947(1486)] || _0x862947(1788) };
      }
      return { "success": !![] };
    } catch (_0x539d93) {
      return log[_0x862947(981)]("[IPC] Failed to delete knowledge item:", _0x539d93), { "success": ![], "error": _0x539d93[_0x862947(1486)] || "Failed to delete knowledge item" };
    }
  }), handleIPC("knowledge:sync-to-grpc", (_0x3a5212, _0x2ee53e) => {
    const _0x3d815 = _0x5b0eca;
    try {
      return grpcClient[_0x3d815(1368)](_0x2ee53e), log[_0x3d815(1341)](_0x3d815(1162) + _0x2ee53e[_0x3d815(1115)] + _0x3d815(141)), { "success": !![], "count": _0x2ee53e[_0x3d815(1115)] };
    } catch (_0x3ae9b9) {
      return log[_0x3d815(981)]("[IPC] Failed to sync knowledge to gRPC client:", _0x3ae9b9), { "success": ![], "count": 0 };
    }
  }), handleIPC("custom-instructions:get-all", async () => {
    const _0x51b5a2 = _0x5b0eca;
    try {
      const _0x271c8f = getCurrentUserId();
      if (!_0x271c8f) return { "success": ![], "error": _0x51b5a2(343) };
      const _0x1a4b9b = await CustomInstructionsTable[_0x51b5a2(440)](_0x271c8f);
      return { "success": !![], "items": _0x1a4b9b };
    } catch (_0x3c1ecf) {
      return log[_0x51b5a2(981)]("[IPC] Failed to get custom instructions:", _0x3c1ecf), { "success": ![], "error": _0x3c1ecf[_0x51b5a2(1486)] || "Failed to fetch" };
    }
  }), handleIPC("custom-instructions:add", async (_0x512ae9, { appIdentifier: _0x3dc374, instruction: _0x20289e }) => {
    const _0x5ba3a2 = _0x5b0eca;
    try {
      const _0x26bd6b = getCurrentUserId();
      if (!_0x26bd6b) return { "success": ![], "error": _0x5ba3a2(343) };
      const _0x494e7b = await CustomInstructionsTable[_0x5ba3a2(1761)]({ "user_id": _0x26bd6b, "app_identifier": _0x3dc374, "instruction": _0x20289e });
      if (_0x494e7b[_0x5ba3a2(522)]) {
        const _0x1133ac = await CustomInstructionsTable[_0x5ba3a2(440)](_0x26bd6b);
        return grpcClient[_0x5ba3a2(995)](_0x1133ac), { "success": !![], "item": _0x494e7b[_0x5ba3a2(1135)] };
      }
      return { "success": ![], "error": _0x494e7b[_0x5ba3a2(981)] };
    } catch (_0x2bacb6) {
      return log[_0x5ba3a2(981)]("[IPC] Failed to add custom instruction:", _0x2bacb6), { "success": ![], "error": _0x2bacb6[_0x5ba3a2(1486)] || "Failed to add" };
    }
  }), handleIPC("custom-instructions:update", async (_0x5d66c2, { id: _0x3c0b2f, appIdentifier: _0x304f39, instruction: _0x359403 }) => {
    const _0xef71ff = _0x5b0eca;
    try {
      const _0x2d94f7 = getCurrentUserId();
      if (!_0x2d94f7) return { "success": ![], "error": _0xef71ff(343) };
      const _0x1fe74b = await CustomInstructionsTable[_0xef71ff(324)](_0x3c0b2f, _0x304f39, _0x359403);
      if (_0x1fe74b[_0xef71ff(522)]) {
        const _0x1bad9f = await CustomInstructionsTable[_0xef71ff(440)](_0x2d94f7);
        return grpcClient[_0xef71ff(995)](_0x1bad9f), { "success": !![], "item": _0x1fe74b[_0xef71ff(1135)] };
      }
      return { "success": ![], "error": _0x1fe74b[_0xef71ff(981)] };
    } catch (_0x252d3d) {
      return log[_0xef71ff(981)]("[IPC] Failed to update custom instruction:", _0x252d3d), { "success": ![], "error": _0x252d3d[_0xef71ff(1486)] || "Failed to update" };
    }
  }), handleIPC("custom-instructions:delete", async (_0x131430, _0x458b29) => {
    const _0x5ef79f = _0x5b0eca;
    try {
      const _0x3ca0ed = getCurrentUserId();
      if (!_0x3ca0ed) return { "success": ![], "error": _0x5ef79f(343) };
      await CustomInstructionsTable[_0x5ef79f(428)](_0x458b29);
      const _0x5b708f = await CustomInstructionsTable[_0x5ef79f(440)](_0x3ca0ed);
      return grpcClient[_0x5ef79f(995)](_0x5b708f), { "success": !![] };
    } catch (_0x5124a3) {
      return log[_0x5ef79f(981)]("[IPC] Failed to delete custom instruction:", _0x5124a3), { "success": ![], "error": _0x5124a3[_0x5ef79f(1486)] || "Failed to delete" };
    }
  }), handleIPC("custom-instructions:sync-to-grpc", async (_0xebc189) => {
    const _0x44e195 = _0x5b0eca;
    try {
      const _0x38b4d6 = getCurrentUserId();
      if (!_0x38b4d6) return { "success": ![], "count": 0 };
      const _0x4c6f5c = await CustomInstructionsTable[_0x44e195(440)](_0x38b4d6);
      return grpcClient[_0x44e195(995)](_0x4c6f5c), log[_0x44e195(1341)](_0x44e195(1162) + _0x4c6f5c[_0x44e195(1115)] + _0x44e195(627)), { "success": !![], "count": _0x4c6f5c[_0x44e195(1115)] };
    } catch (_0x3b72e2) {
      return log[_0x44e195(981)]("[IPC] Failed to sync custom instructions to gRPC client:", _0x3b72e2), { "success": ![], "count": 0 };
    }
  }), handleIPC("custom-instructions:get-used-apps", async () => {
    const _0xd8f383 = _0x5b0eca;
    try {
      const _0x4c86a7 = getCurrentUserId();
      if (!_0x4c86a7) return { "success": ![], "error": _0xd8f383(343), "apps": [] };
      const _0x361e9f = await VoiceSessionsTable[_0xd8f383(440)](_0x4c86a7), _0x58eae6 = [...new Set(_0x361e9f[_0xd8f383(306)]((_0x563da2) => _0x563da2[_0xd8f383(861)])[_0xd8f383(1380)]((_0x952465) => !!_0x952465 && _0x952465[_0xd8f383(1699)]()[_0xd8f383(1115)] > 0))][_0xd8f383(1608)]();
      return { "success": !![], "apps": _0x58eae6 };
    } catch (_0x56adca) {
      return log[_0xd8f383(981)]("[IPC] Failed to get used apps:", _0x56adca), { "success": ![], "error": _0x56adca[_0xd8f383(1486)] || "Failed to fetch", "apps": [] };
    }
  });
  const _0x2e99f0 = () => {
    return "https://api.voiceos.com";
  };
  handleIPC("user-profile:get", async () => {
    const _0x7f56b0 = _0x5b0eca;
    try {
      const _0x46d468 = store[_0x7f56b0(1043)](STORE_KEYS[_0x7f56b0(684)]);
      if (!_0x46d468) return { "success": ![], "error": _0x7f56b0(343) };
      const _0x25ba1d = await fetch(_0x2e99f0() + _0x7f56b0(1244), { "method": _0x7f56b0(1334), "headers": { "Authorization": _0x7f56b0(1324) + _0x46d468, "Content-Type": "application/json" } });
      if (!_0x25ba1d["ok"]) {
        const _0x551102 = await _0x25ba1d[_0x7f56b0(1360)]()[_0x7f56b0(564)](() => ({}));
        return { "success": ![], "error": _0x551102[_0x7f56b0(1486)] || _0x7f56b0(1121) + _0x25ba1d[_0x7f56b0(174)] };
      }
      const _0x5d4f32 = await _0x25ba1d[_0x7f56b0(1360)]();
      return { "success": !![], "profile": _0x5d4f32[_0x7f56b0(394)] };
    } catch (_0x3f2470) {
      return log[_0x7f56b0(981)]("[IPC] Failed to get user profile:", _0x3f2470), { "success": ![], "error": _0x3f2470[_0x7f56b0(1486)] || "Failed to fetch user profile" };
    }
  }), handleIPC("user-profile:update", async (_0x2afdaf, _0x1ef60c) => {
    const _0x1023cc = _0x5b0eca;
    try {
      const _0x3b47fa = store[_0x1023cc(1043)](STORE_KEYS[_0x1023cc(684)]);
      if (!_0x3b47fa) return { "success": ![], "error": _0x1023cc(343) };
      const _0x38b33e = await fetch(_0x2e99f0() + _0x1023cc(1244), { "method": _0x1023cc(1031), "headers": { "Authorization": _0x1023cc(1324) + _0x3b47fa, "Content-Type": "application/json" }, "body": JSON[_0x1023cc(1516)](_0x1ef60c) });
      if (!_0x38b33e["ok"]) {
        const _0x5782c4 = await _0x38b33e[_0x1023cc(1360)]()[_0x1023cc(564)](() => ({}));
        return { "success": ![], "error": _0x5782c4[_0x1023cc(1486)] || _0x1023cc(1708) };
      }
      const _0x26e509 = await _0x38b33e[_0x1023cc(1360)]();
      return { "success": !![], "profile": _0x26e509[_0x1023cc(394)] };
    } catch (_0x4032ae) {
      return log[_0x1023cc(981)]("[IPC] Failed to update user profile:", _0x4032ae), { "success": ![], "error": _0x4032ae[_0x1023cc(1486)] || "Failed to update user profile" };
    }
  }), handleIPC("get-app-version", () => {
    const _0x5817a1 = _0x5b0eca;
    return _0x5817a1(1374);
  }), handleIPC("delete-user-data", async (_0x26466e) => {
    const _0x24a110 = _0x5b0eca, _0x4fb028 = getCurrentUserId();
    if (!_0x4fb028) return log[_0x24a110(981)]("No user ID found to delete data."), ![];
    const { deleteCompleteUserData: _0x87ae3a } = await Promise[_0x24a110(1786)]()[_0x24a110(843)](() => db$1);
    return _0x87ae3a(_0x4fb028);
  }), handleIPC("check-server-health", async () => {
    const _0x155a2a = _0x5b0eca;
    try {
      const _0x4b33ce = await fetch(_0x155a2a(179) + void 0, { "method": _0x155a2a(1334) });
      if (_0x4b33ce["ok"]) {
        const _0x1a7fd1 = await _0x4b33ce[_0x155a2a(785)](), _0x31b65d = _0x1a7fd1[_0x155a2a(1580)]("Building towards a future where voice is the universal computing interface.");
        return { "isHealthy": _0x31b65d, "error": _0x31b65d ? void 0 : "Invalid server response" };
      } else return { "isHealthy": ![], "error": _0x155a2a(1811) + _0x4b33ce[_0x155a2a(174)] };
    } catch (_0x1ebc97) {
      const _0x5aa1a0 = _0x1ebc97[_0x155a2a(1276)] === _0x155a2a(600) || _0x1ebc97[_0x155a2a(1276)] === _0x155a2a(795) ? "Connection timed out" : _0x1ebc97[_0x155a2a(1486)]?.[_0x155a2a(1580)](_0x155a2a(1490)) || _0x1ebc97[_0x155a2a(1486)]?.[_0x155a2a(1580)]("fetch") ? "Local server not running" : _0x1ebc97[_0x155a2a(1486)] || "Unknown error occurred";
      return { "isHealthy": ![], "error": _0x5aa1a0 };
    }
  }), handleIPC("debug:check-schema", async () => {
    const _0x1ce014 = _0x5b0eca, { getDb: _0x1431cc } = await Promise[_0x1ce014(1786)]()[_0x1ce014(843)](() => db$1), _0x4d10ee = _0x1431cc();
    return new Promise((_0x1fa501, _0x136ac6) => {
      const _0x2a2370 = _0x1ce014;
      _0x4d10ee[_0x2a2370(1050)]("PRAGMA table_info(interactions)", (_0x1c02b8, _0x577a19) => {
        if (_0x1c02b8) _0x136ac6(_0x1c02b8);
        else _0x1fa501(_0x577a19);
      });
    });
  }), handleIPC("pill-set-mouse-events", (_0x1fb6b3, _0x13e629, _0x5c5e36) => {
    const _0x55eb50 = _0x5b0eca, _0x299552 = getPillWindow();
    _0x299552 && _0x299552[_0x55eb50(736)](_0x13e629, _0x5c5e36);
  }), handleIPC("pill-set-focusable", (_0x8a0970, _0x3a5ce9) => {
    const _0x590f56 = _0x5b0eca, _0x116bee = getPillWindow();
    _0x116bee && !_0x116bee[_0x590f56(496)]() && (_0x116bee[_0x590f56(396)](_0x3a5ce9), _0x3a5ce9 && _0x116bee[_0x590f56(1704)]());
  });
  let _0x42a62d = null, _0x2b1e26 = { "x": 0, "y": 0 };
  const _0x2d2276 = () => {
    _0x42a62d && (clearInterval(_0x42a62d), _0x42a62d = null);
  };
  handleIPC(_0x5b0eca(1824), (_0x91457f, _0x241614, _0x231084) => {
    const _0x59f693 = _0x5b0eca, _0x3a6c0a = getPillWindow();
    if (!_0x3a6c0a || _0x3a6c0a[_0x59f693(496)]()) return;
    _0x2d2276(), setIsPillDragging(!![]);
    const [_0x380ca5, _0x4b8998] = _0x3a6c0a[_0x59f693(1794)]();
    return _0x2b1e26 = { "x": _0x241614 - _0x380ca5, "y": _0x231084 - _0x4b8998 }, _0x42a62d = setInterval(() => {
      const _0xae3002 = _0x59f693, _0x479e8d = getPillWindow();
      if (!_0x479e8d || _0x479e8d[_0xae3002(496)]()) {
        _0x2d2276();
        return;
      }
      const _0x4b4090 = electron[_0xae3002(451)][_0xae3002(687)]();
      _0x479e8d[_0xae3002(500)](Math[_0xae3002(303)](_0x4b4090["x"] - _0x2b1e26["x"]), Math[_0xae3002(303)](_0x4b4090["y"] - _0x2b1e26["y"]), ![]);
    }, 16), { "windowX": _0x380ca5, "windowY": _0x4b8998 };
  }), handleIPC(_0x5b0eca(712), () => {
  }), handleIPC(_0x5b0eca(583), () => {
    _0x2d2276();
  }), handleIPC(_0x5b0eca(284), () => {
    _0x2d2276(), setIsPillDragging(![]);
  }), handleIPC("pill-restore-position", () => {
    return setIsPillDragging(!![]), { "restored": ![] };
  }), handleIPC("check-focused-editable", async () => {
    const _0x1d43c3 = _0x5b0eca;
    try {
      const { isFocusedElementEditable: _0x5d50d1 } = await Promise[_0x1d43c3(1786)]()[_0x1d43c3(843)](() => focusedElementReader), _0x5e79de = await _0x5d50d1();
      return { "isEditable": _0x5e79de };
    } catch (_0x201258) {
      return log[_0x1d43c3(981)]("[IPC] check-focused-editable error:", _0x201258), { "isEditable": ![] };
    }
  }), handleIPC("paste-output-text", async (_0x191047, _0x377e0b) => {
    const _0x4a57ba = _0x5b0eca;
    try {
      const { isFocusedElementEditable: _0x4bef89 } = await Promise[_0x4a57ba(1786)]()[_0x4a57ba(843)](() => focusedElementReader), _0x4282d7 = await _0x4bef89();
      if (!_0x4282d7) return { "success": ![], "noTextField": !![] };
      const { setFocusedTextWithLinks: _0xee9c1e } = await Promise[_0x4a57ba(1786)]()[_0x4a57ba(843)](() => textWriter), _0x392418 = await _0xee9c1e(_0x377e0b, { "delay": 0, "charDelay": 0 });
      return { "success": _0x392418 };
    } catch (_0xfe7b85) {
      return log[_0x4a57ba(981)]("[IPC] paste-output-text error:", _0xfe7b85), { "success": ![], "error": String(_0xfe7b85) };
    }
  }), electron[_0x5b0eca(1822)]["on"]("start-native-recording", (_0x39a719) => {
    const _0x1fff05 = _0x5b0eca;
    log[_0x1fff05(1341)](_0x1fff05(138)), voiceInputService[_0x1fff05(896)](VoiceOSMode[_0x1fff05(124)]);
  }), electron[_0x5b0eca(1822)]["on"]("start-native-recording-test", (_0x565a71) => {
    const _0x80155b = _0x5b0eca;
    log[_0x80155b(1341)](_0x80155b(1677));
    const _0x1bffdd = store[_0x80155b(1043)](STORE_KEYS[_0x80155b(193)])[_0x80155b(548)];
    audioRecorderService[_0x80155b(802)](_0x1bffdd);
  }), electron[_0x5b0eca(1822)]["on"]("stop-native-recording", () => {
    const _0x2a1198 = _0x5b0eca;
    log[_0x2a1198(1341)]("IPC: Received stop-native-recording."), voiceInputService[_0x2a1198(1158)]();
  }), electron[_0x5b0eca(1822)]["on"]("stop-native-recording-test", () => {
    const _0x6bee95 = _0x5b0eca;
    log[_0x6bee95(1341)]("IPC: Received stop-native-recording-test."), audioRecorderService[_0x6bee95(976)]();
  }), handleIPC("start-gen-mode-from-pill", async () => {
    const _0x2450ea = _0x5b0eca;
    log[_0x2450ea(1341)]("[IPC] Received 'start-gen-mode-from-pill'");
    try {
      const { startGenModeFromPill: _0x2de532 } = await Promise[_0x2450ea(1786)]()[_0x2450ea(843)](() => pillRecording);
      return await _0x2de532(), { "success": !![] };
    } catch (_0x535445) {
      return log[_0x2450ea(981)](_0x2450ea(1097), _0x535445), { "success": ![], "error": String(_0x535445) };
    }
  }), handleIPC("start-dictation-from-pill", async () => {
    const _0x21bc97 = _0x5b0eca;
    log[_0x21bc97(1341)]("[IPC] Received 'start-dictation-from-pill'");
    try {
      const { startDictationFromPill: _0x57ba1b } = await Promise[_0x21bc97(1786)]()[_0x21bc97(843)](() => pillRecording);
      return await _0x57ba1b(), { "success": !![] };
    } catch (_0x2c2c7d) {
      return log[_0x21bc97(981)]("[IPC] Failed to start dictation from pill:", _0x2c2c7d), { "success": ![], "error": String(_0x2c2c7d) };
    }
  }), handleIPC(_0x5b0eca(1834), async () => {
    const _0x23db68 = _0x5b0eca;
    log[_0x23db68(1341)](_0x23db68(368));
    try {
      const { chatSessionManager: _0xdfb0f9 } = await Promise[_0x23db68(1786)]()[_0x23db68(843)](() => ChatSessionManager$1);
      if (!_0xdfb0f9[_0x23db68(1727)]) return log[_0x23db68(1697)]("[IPC] No active chat session for voice follow-up"), { "success": ![], "error": "No active chat session" };
      const { voiceInputService: _0x1ecc00 } = await Promise[_0x23db68(1786)]()[_0x23db68(843)](() => voiceInputService$1), { IPC_EVENTS: _0x17c06b } = await Promise[_0x23db68(1786)]()[_0x23db68(843)](() => ipc), { VoiceOSMode: _0x25d552 } = await Promise[_0x23db68(1786)]()[_0x23db68(843)](() => voiceos_pb), { getPillWindow: _0x468463 } = await Promise[_0x23db68(1786)]()[_0x23db68(843)](() => app), _0x5cf094 = _0x468463();
      return _0x5cf094 && !_0x5cf094[_0x23db68(496)]() && _0x5cf094[_0x23db68(890)][_0x23db68(965)](_0x17c06b[_0x23db68(471)], { "isRecording": !![], "mode": _0x25d552[_0x23db68(124)], "skipSound": ![], "isVoiceFollowUp": !![] }), _0x1ecc00[_0x23db68(896)](_0x25d552[_0x23db68(124)], { "isVoiceFollowUp": !![] }), { "success": !![] };
    } catch (_0x5ed906) {
      return log[_0x23db68(981)](_0x23db68(1446), _0x5ed906), { "success": ![], "error": String(_0x5ed906) };
    }
  }), handleIPC(_0x5b0eca(1681), async () => {
    const _0x1f7ace = _0x5b0eca;
    log[_0x1f7ace(1341)](_0x1f7ace(438));
    try {
      const _0x2666e9 = getPillWindow();
      _0x2666e9 && !_0x2666e9[_0x1f7ace(496)]() && _0x2666e9[_0x1f7ace(890)][_0x1f7ace(965)](IPC_EVENTS[_0x1f7ace(471)], { "isRecording": ![], "mode": VoiceOSMode[_0x1f7ace(124)], "skipSound": !![], "isVoiceFollowUp": !![] });
      const { voiceInputService: _0x389cab } = await Promise[_0x1f7ace(1786)]()[_0x1f7ace(843)](() => voiceInputService$1);
      return _0x389cab[_0x1f7ace(1158)](), { "success": !![] };
    } catch (_0x3fd4b7) {
      return log[_0x1f7ace(981)](_0x1f7ace(1866), _0x3fd4b7), { "success": ![], "error": String(_0x3fd4b7) };
    }
  }), handleIPC("stop-recording-from-pill", async () => {
    const _0x555d27 = _0x5b0eca;
    log[_0x555d27(1341)]("[IPC] Received 'stop-recording-from-pill'");
    try {
      const { stopRecordingFromPill: _0x176d37 } = await Promise[_0x555d27(1786)]()[_0x555d27(843)](() => pillRecording);
      return await _0x176d37(), { "success": !![] };
    } catch (_0xc801cd) {
      return log[_0x555d27(981)](_0x555d27(570), _0xc801cd), { "success": ![], "error": String(_0xc801cd) };
    }
  }), handleIPC("cancel-recording-from-pill", async () => {
    const _0x3a4736 = _0x5b0eca;
    log[_0x3a4736(1341)]("[IPC] Received 'cancel-recording-from-pill'");
    try {
      const { cancelRecordingFromPill: _0x5bde7d } = await Promise[_0x3a4736(1786)]()[_0x3a4736(843)](() => pillRecording);
      return await _0x5bde7d(), { "success": !![] };
    } catch (_0x4bca5b) {
      return log[_0x3a4736(981)](_0x3a4736(702), _0x4bca5b), { "success": ![], "error": String(_0x4bca5b) };
    }
  }), handleIPC(_0x5b0eca(1719), async () => {
    const _0x5c77a9 = _0x5b0eca;
    log[_0x5c77a9(1341)](_0x5c77a9(756));
    try {
      const { stopHandsFreeRecording: _0xfe7c4c } = await Promise[_0x5c77a9(1786)]()[_0x5c77a9(843)](() => keyboard);
      return _0xfe7c4c(), { "success": !![] };
    } catch (_0x3e9ff6) {
      return log[_0x5c77a9(981)](_0x5c77a9(1773), _0x3e9ff6), { "success": ![], "error": String(_0x3e9ff6) };
    }
  }), handleIPC(_0x5b0eca(1011), async () => {
    const _0x315967 = _0x5b0eca;
    log[_0x315967(1341)](_0x315967(1297));
    try {
      const { cancelHandsFreeRecording: _0x128a7c } = await Promise[_0x315967(1786)]()[_0x315967(843)](() => keyboard);
      return await _0x128a7c(), { "success": !![] };
    } catch (_0x5304d9) {
      return log[_0x315967(981)](_0x315967(1270), _0x5304d9), { "success": ![], "error": String(_0x5304d9) };
    }
  }), handleIPC(_0x5b0eca(547), async (_0x2a62fe, _0x239dfe) => {
    const _0x5b6007 = _0x5b0eca;
    log[_0x5b6007(1341)](_0x5b6007(729), { "textLength": _0x239dfe?.[_0x5b6007(1115)] });
    try {
      const { chatSessionManager: _0x187676 } = await Promise[_0x5b6007(1786)]()[_0x5b6007(843)](() => ChatSessionManager$1);
      if (!_0x187676[_0x5b6007(1727)]) return log[_0x5b6007(1697)]("[IPC] No active chat session for follow-up"), { "success": ![], "error": "No active chat session" };
      const _0x1fe27f = _0x187676[_0x5b6007(1791)](), _0x556fd8 = _0x187676[_0x5b6007(798)]();
      _0x187676[_0x5b6007(1433)](_0x239dfe);
      const _0xf0e6f7 = getPillWindow();
      _0xf0e6f7 && !_0xf0e6f7[_0x5b6007(496)]() && _0xf0e6f7[_0x5b6007(890)][_0x5b6007(965)](IPC_EVENTS[_0x5b6007(131)], { "isProcessing": !![] });
      try {
        const _0x4cd295 = await grpcClient[_0x5b6007(1614)]({ "text": _0x239dfe, "conversationHistory": _0x556fd8, "ocrText": _0x1fe27f?.[_0x5b6007(1751)], "selectedText": _0x1fe27f?.[_0x5b6007(493)], "appName": _0x1fe27f?.[_0x5b6007(1856)], "windowTitle": _0x1fe27f?.[_0x5b6007(688)], "windowUrl": _0x1fe27f?.[_0x5b6007(648)], "accessibilityText": _0x1fe27f?.[_0x5b6007(696)], "vlmDescription": _0x1fe27f?.[_0x5b6007(1806)], "originalTranscript": _0x1fe27f?.[_0x5b6007(1672)] });
        return _0x187676[_0x5b6007(737)](_0x4cd295[_0x5b6007(785)]), _0xf0e6f7 && !_0xf0e6f7[_0x5b6007(496)]() && (_0xf0e6f7[_0x5b6007(890)][_0x5b6007(965)](IPC_EVENTS[_0x5b6007(131)], { "isProcessing": ![] }), _0xf0e6f7[_0x5b6007(890)][_0x5b6007(965)](IPC_EVENTS[_0x5b6007(663)], { "text": _0x4cd295[_0x5b6007(785)] })), { "success": !![] };
      } catch (_0x3e1ce3) {
        return log[_0x5b6007(981)](_0x5b6007(642), _0x3e1ce3), _0xf0e6f7 && !_0xf0e6f7[_0x5b6007(496)]() && (_0xf0e6f7[_0x5b6007(890)][_0x5b6007(965)](IPC_EVENTS[_0x5b6007(131)], { "isProcessing": ![] }), _0xf0e6f7[_0x5b6007(890)][_0x5b6007(965)](IPC_EVENTS[_0x5b6007(663)], { "text": "", "error": String(_0x3e1ce3) })), { "success": ![], "error": String(_0x3e1ce3) };
      }
    } catch (_0x31bf11) {
      return log[_0x5b6007(981)](_0x5b6007(1026), _0x31bf11), { "success": ![], "error": String(_0x31bf11) };
    }
  }), electron[_0x5b0eca(1822)]["on"]("end-chat-session", async () => {
    const _0xf7008d = _0x5b0eca;
    log[_0xf7008d(1341)]("[IPC] Received 'end-chat-session'");
    try {
      const { chatSessionManager: _0x110aff } = await Promise[_0xf7008d(1786)]()[_0xf7008d(843)](() => ChatSessionManager$1);
      _0x110aff[_0xf7008d(755)]();
    } catch (_0xcac29f) {
      log[_0xf7008d(981)]("[IPC] Failed to end chat session:", _0xcac29f);
    }
  }), handleIPC("analytics:get-device-id", async () => {
    const _0x249e64 = _0x5b0eca;
    try {
      let _0x3a73a0 = await SyncMetadata[_0x249e64(1043)]("analytics_device_id");
      return !_0x3a73a0 ? (_0x3a73a0 = await nodeMachineId[_0x249e64(813)](), await SyncMetadata[_0x249e64(1359)]("analytics_device_id", _0x3a73a0), log[_0x249e64(1341)]("[Analytics] Generated new machine-based device ID:", _0x3a73a0)) : log[_0x249e64(1341)]("[Analytics] Using cached machine-based device ID:", _0x3a73a0), _0x3a73a0;
    } catch (_0x57db5e) {
      log[_0x249e64(981)]("[Analytics] Failed to get/generate device ID:", _0x57db5e);
      try {
        return await nodeMachineId[_0x249e64(813)]();
      } catch (_0xcdd9de) {
        return log[_0x249e64(981)]("[Analytics] Machine ID fallback failed:", _0xcdd9de), void 0;
      }
    }
  }), handleIPC("subscription:get-status", async () => {
    const _0x1001d5 = _0x5b0eca;
    try {
      const _0x5c37a5 = await grpcClient[_0x1001d5(848)]();
      return { "planType": _0x5c37a5[_0x1001d5(973)], "status": _0x5c37a5[_0x1001d5(174)], "isActive": _0x5c37a5[_0x1001d5(1727)], "currentPeriodEnd": _0x5c37a5[_0x1001d5(1293)], "cancelAtPeriodEnd": _0x5c37a5[_0x1001d5(889)] };
    } catch (_0x185ebd) {
      log[_0x1001d5(981)]("Failed to get subscription status:", _0x185ebd);
      throw _0x185ebd;
    }
  }), handleIPC("subscription:get-prices", async (_0x130c72, _0x31ede8) => {
    const _0x18f845 = _0x5b0eca;
    try {
      const _0x3f5426 = "https://api.voiceos.com";
      if (!_0x3f5426) ;
      const _0x1debe8 = new URL(_0x18f845(1041), _0x3f5426);
      _0x31ede8 && _0x1debe8[_0x18f845(613)][_0x18f845(1359)]("country", _0x31ede8);
      const _0x1ab839 = await fetch(_0x1debe8[_0x18f845(1450)](), { "method": _0x18f845(1334), "headers": { "Content-Type": "application/json" } });
      if (!_0x1ab839["ok"]) {
        const _0x1efedc = await _0x1ab839[_0x18f845(1360)]()[_0x18f845(564)](() => ({}));
        throw new Error(_0x1efedc[_0x18f845(981)] || _0x18f845(1121) + _0x1ab839[_0x18f845(174)]);
      }
      const _0x51360e = await _0x1ab839[_0x18f845(1360)]();
      return _0x51360e;
    } catch (_0x4c42f5) {
      log[_0x18f845(981)]("[IPC] Failed to fetch localized prices:", _0x4c42f5);
      throw _0x4c42f5;
    }
  }), handleIPC("subscription:get-usage-stats", async () => {
    const _0xd093cb = _0x5b0eca;
    try {
      const _0x50453a = await grpcClient[_0xd093cb(731)]();
      return { "currentUsage": _0x50453a[_0xd093cb(585)], "weeklyLimit": _0x50453a[_0xd093cb(1852)], "planType": _0x50453a[_0xd093cb(973)], "percentUsed": _0x50453a[_0xd093cb(1747)], "daysUntilReset": _0x50453a[_0xd093cb(836)] };
    } catch (_0x34ca5d) {
      log[_0xd093cb(981)]("Failed to get usage stats:", _0x34ca5d);
      throw _0x34ca5d;
    }
  }), handleIPC("subscription:create-checkout-session", async (_0x57d0e0, _0x5e37b9 = "yearly") => {
    const _0x15e92b = _0x5b0eca;
    try {
      const _0x475216 = "https://api.voiceos.com", _0x1fa374 = store[_0x15e92b(1043)](STORE_KEYS[_0x15e92b(684)]);
      log[_0x15e92b(1341)]("[IPC] Creating checkout session"), log[_0x15e92b(1341)](_0x15e92b(1599), _0x475216), log[_0x15e92b(1341)](_0x15e92b(764), !!_0x1fa374), log[_0x15e92b(1341)](_0x15e92b(928), _0x5e37b9);
      if (!_0x475216) ;
      if (!_0x1fa374) throw new Error(_0x15e92b(319));
      const _0xaa5e88 = new URL("/stripe/create-checkout-session", _0x475216);
      log[_0x15e92b(1341)](_0x15e92b(1414), _0xaa5e88[_0x15e92b(1450)]());
      const _0xac607d = await fetch(_0xaa5e88[_0x15e92b(1450)](), { "method": _0x15e92b(1031), "headers": { "Content-Type": "application/json", "Authorization": _0x15e92b(1324) + _0x1fa374 }, "body": JSON[_0x15e92b(1516)]({ "billingInterval": _0x5e37b9 }) });
      log[_0x15e92b(1341)]("[IPC] Response status:", _0xac607d[_0x15e92b(174)]);
      if (!_0xac607d["ok"]) {
        const _0x36abb8 = await _0xac607d[_0x15e92b(785)]();
        log[_0x15e92b(981)]("[IPC] Server error response:", _0x36abb8);
        let _0x30adb0 = {};
        try {
          _0x30adb0 = JSON[_0x15e92b(675)](_0x36abb8);
        } catch {
        }
        throw new Error(_0x30adb0[_0x15e92b(981)] || _0x30adb0[_0x15e92b(1863)] || _0x15e92b(1121) + _0xac607d[_0x15e92b(174)]);
      }
      const _0x4fc8d9 = await _0xac607d[_0x15e92b(1360)]();
      return log[_0x15e92b(1341)]("[IPC] Checkout session created successfully"), _0x4fc8d9[_0x15e92b(503)];
    } catch (_0x58139e) {
      log[_0x15e92b(981)]("[IPC] Failed to create checkout session:", _0x58139e);
      throw _0x58139e;
    }
  }), handleIPC("subscription:create-portal-session", async () => {
    const _0x445c47 = _0x5b0eca;
    try {
      const _0x15a9ec = "https://api.voiceos.com", _0x180af4 = store[_0x445c47(1043)](STORE_KEYS[_0x445c47(684)]);
      if (!_0x15a9ec) ;
      if (!_0x180af4) throw new Error(_0x445c47(343));
      const _0x23afbc = new URL("/stripe/create-portal-session", _0x15a9ec), _0xfcba17 = await fetch(_0x23afbc[_0x445c47(1450)](), { "method": _0x445c47(1031), "headers": { "Content-Type": "application/json", "Authorization": _0x445c47(1324) + _0x180af4 }, "body": JSON[_0x445c47(1516)]({}) });
      if (!_0xfcba17["ok"]) {
        const _0x5a875d = await _0xfcba17[_0x445c47(1360)]()[_0x445c47(564)](() => ({}));
        throw new Error(_0x5a875d[_0x445c47(981)] || _0x445c47(1121) + _0xfcba17[_0x445c47(174)]);
      }
      const _0x37246d = await _0xfcba17[_0x445c47(1360)]();
      return _0x37246d[_0x445c47(503)];
    } catch (_0x5a2be6) {
      log[_0x445c47(981)]("Failed to create portal session:", _0x5a2be6);
      throw _0x5a2be6;
    }
  }), handleIPC("subscription:activate-referral", async () => {
    const _0x3a6327 = _0x5b0eca;
    try {
      const _0x35ed9f = "https://api.voiceos.com", _0x3447fc = store[_0x3a6327(1043)](STORE_KEYS[_0x3a6327(684)]);
      if (!_0x35ed9f || !_0x3447fc) return { "success": ![], "error": _0x3a6327(343) };
      const _0x2f7af3 = new URL(_0x3a6327(604), _0x35ed9f), _0xe2e193 = await fetch(_0x2f7af3[_0x3a6327(1450)](), { "method": _0x3a6327(1031), "headers": { "Content-Type": "application/json", "Authorization": _0x3a6327(1324) + _0x3447fc }, "body": JSON[_0x3a6327(1516)]({}) }), _0x1bfd71 = await _0xe2e193[_0x3a6327(1360)]();
      return _0x1bfd71;
    } catch (_0x5772f0) {
      return log[_0x3a6327(981)](_0x3a6327(766), _0x5772f0), { "success": ![], "error": _0x3a6327(379) };
    }
  }), handleIPC("subscription:activate-trial", async () => {
    const _0x3f5d45 = _0x5b0eca;
    try {
      const _0x1aa269 = "https://api.voiceos.com", _0x302293 = store[_0x3f5d45(1043)](STORE_KEYS[_0x3f5d45(684)]);
      if (!_0x1aa269 || !_0x302293) return { "success": ![], "error": _0x3f5d45(343) };
      const _0x38b28c = new URL(_0x3f5d45(1381), _0x1aa269), _0xd27bb8 = await fetch(_0x38b28c[_0x3f5d45(1450)](), { "method": _0x3f5d45(1031), "headers": { "Content-Type": "application/json", "Authorization": _0x3f5d45(1324) + _0x302293 }, "body": JSON[_0x3f5d45(1516)]({}) }), _0x160187 = await _0xd27bb8[_0x3f5d45(1360)]();
      return _0x160187;
    } catch (_0x3b5194) {
      return log[_0x3f5d45(981)](_0x3f5d45(139), _0x3b5194), { "success": ![], "error": _0x3f5d45(1170) };
    }
  }), handleIPC("subscription:create-team-checkout-session", async (_0x20b40c, _0x43d395 = 3, _0x50fcfa = "yearly") => {
    const _0x3898da = _0x5b0eca;
    try {
      const _0x3cd366 = "https://api.voiceos.com", _0x1c4486 = store[_0x3898da(1043)](STORE_KEYS[_0x3898da(684)]);
      log[_0x3898da(1341)]("[IPC] Creating team checkout session"), log[_0x3898da(1341)](_0x3898da(545), _0x43d395), log[_0x3898da(1341)](_0x3898da(928), _0x50fcfa);
      if (!_0x3cd366) ;
      if (!_0x1c4486) throw new Error(_0x3898da(343));
      const _0x4369a8 = new URL("/stripe/create-team-checkout-session", _0x3cd366), _0x353b7e = await fetch(_0x4369a8[_0x3898da(1450)](), { "method": _0x3898da(1031), "headers": { "Content-Type": "application/json", "Authorization": _0x3898da(1324) + _0x1c4486 }, "body": JSON[_0x3898da(1516)]({ "seatCount": _0x43d395, "billingInterval": _0x50fcfa }) });
      if (!_0x353b7e["ok"]) {
        const _0x44cb20 = await _0x353b7e[_0x3898da(1360)]()[_0x3898da(564)](() => ({}));
        throw new Error(_0x44cb20[_0x3898da(981)] || _0x3898da(1121) + _0x353b7e[_0x3898da(174)]);
      }
      const _0x3fc1ba = await _0x353b7e[_0x3898da(1360)]();
      return log[_0x3898da(1341)]("[IPC] Team checkout session created successfully"), _0x3fc1ba[_0x3898da(503)];
    } catch (_0x59e661) {
      log[_0x3898da(981)]("[IPC] Failed to create team checkout session:", _0x59e661);
      throw _0x59e661;
    }
  }), handleIPC("subscription:get-team-status", async () => {
    const _0x34cae1 = _0x5b0eca;
    try {
      const _0x3b24da = "https://api.voiceos.com", _0x176979 = store[_0x34cae1(1043)](STORE_KEYS[_0x34cae1(684)]);
      if (!_0x3b24da) ;
      if (!_0x176979) throw new Error(_0x34cae1(343));
      const _0x4d5bf6 = new URL("/team-subscription/status", _0x3b24da), _0x9c462c = await fetch(_0x4d5bf6[_0x34cae1(1450)](), { "method": _0x34cae1(1334), "headers": { "Content-Type": "application/json", "Authorization": _0x34cae1(1324) + _0x176979 } });
      if (!_0x9c462c["ok"]) {
        const _0x20c70f = await _0x9c462c[_0x34cae1(1360)]()[_0x34cae1(564)](() => ({}));
        throw new Error(_0x20c70f[_0x34cae1(981)] || _0x34cae1(1121) + _0x9c462c[_0x34cae1(174)]);
      }
      const _0x16378a = await _0x9c462c[_0x34cae1(1360)]();
      return _0x16378a;
    } catch (_0x433bfc) {
      log[_0x34cae1(981)]("Failed to get team subscription status:", _0x433bfc);
      throw _0x433bfc;
    }
  }), handleIPC("subscription:link-team-subscription", async (_0x4a694b, _0x3ba257) => {
    const _0x122006 = _0x5b0eca;
    try {
      const _0x1f9501 = "https://api.voiceos.com", _0x59487b = store[_0x122006(1043)](STORE_KEYS[_0x122006(684)]);
      if (!_0x1f9501) ;
      if (!_0x59487b) throw new Error(_0x122006(343));
      if (!_0x3ba257) throw new Error(_0x122006(1523));
      log[_0x122006(1341)]("[IPC] Linking team subscription for team:", _0x3ba257);
      const _0x640cbe = new URL("/team-subscription/link", _0x1f9501), _0x2dca9d = await fetch(_0x640cbe[_0x122006(1450)](), { "method": _0x122006(1031), "headers": { "Content-Type": "application/json", "Authorization": _0x122006(1324) + _0x59487b }, "body": JSON[_0x122006(1516)]({ "teamId": _0x3ba257 }) });
      if (!_0x2dca9d["ok"]) {
        const _0x551996 = await _0x2dca9d[_0x122006(1360)]()[_0x122006(564)](() => ({}));
        throw new Error(_0x551996[_0x122006(981)] || _0x122006(1121) + _0x2dca9d[_0x122006(174)]);
      }
      const _0x3e10dc = await _0x2dca9d[_0x122006(1360)]();
      return log[_0x122006(1341)]("[IPC] Team subscription linked successfully:", _0x3e10dc), _0x3e10dc;
    } catch (_0x1cd2ed) {
      log[_0x122006(981)]("[IPC] Failed to link team subscription:", _0x1cd2ed);
      throw _0x1cd2ed;
    }
  });
}
electron[_0x54a1b7(1822)]["on"](IPC_EVENTS[_0x54a1b7(405)], (_0x2f40b4, _0x347055) => {
  const _0x54e8dc = _0x54a1b7;
  getPillWindow()?.[_0x54e8dc(890)][_0x54e8dc(965)](IPC_EVENTS[_0x54e8dc(405)], _0x347055);
}), electron[_0x54a1b7(1822)]["on"](IPC_EVENTS[_0x54a1b7(527)], (_0x51cf98, _0x1dc649) => {
  const _0x204590 = _0x54a1b7;
  getPillWindow()?.[_0x204590(890)][_0x204590(965)](IPC_EVENTS[_0x204590(527)], _0x1dc649), _0x1dc649 && typeof _0x1dc649[_0x204590(548)] === _0x204590(1305) && voiceInputService[_0x204590(1268)](_0x1dc649[_0x204590(548)]);
}), electron[_0x54a1b7(1822)]["on"](IPC_EVENTS[_0x54a1b7(1492)], async (_0x4a1b7d, _0xf27f4f) => {
  const _0x2bbc6b = _0x54a1b7;
  try {
    const _0x5f026e = getCurrentUserId();
    if (_0x5f026e && _0xf27f4f) {
      const _0x4c180f = { "onboardingStep": _0xf27f4f[_0x2bbc6b(1702)], "onboardingCompleted": _0xf27f4f[_0x2bbc6b(164)] };
      await SyncMetadata[_0x2bbc6b(1359)](_0x2bbc6b(1478) + _0x5f026e, JSON[_0x2bbc6b(1516)](_0x4c180f));
    }
  } catch (_0x24c962) {
    log[_0x2bbc6b(981)]("[IPC] Failed to persist onboarding update:", _0x24c962);
  }
  getPillWindow()?.[_0x2bbc6b(890)][_0x2bbc6b(965)](IPC_EVENTS[_0x2bbc6b(1492)], _0xf27f4f);
}), electron[_0x54a1b7(1822)]["on"](IPC_EVENTS[_0x54a1b7(1023)], (_0x36f81f, _0x13e1dc) => {
  const _0x25d542 = _0x54a1b7;
  getPillWindow()?.[_0x25d542(890)][_0x25d542(965)](IPC_EVENTS[_0x25d542(1023)], _0x13e1dc);
});
function registerDevIPC() {
  const _0x1eb488 = _0x54a1b7;
  electron[_0x1eb488(1822)][_0x1eb488(1295)]("dev:revert-last-migration", async () => {
    const _0x52e9f2 = _0x1eb488;
    console[_0x52e9f2(926)]("Received dev:revert-last-migration IPC call.");
    try {
      return await revertLastMigration(), { "success": !![] };
    } catch (_0x5b46e5) {
      return console[_0x52e9f2(981)]("Failed to revert last migration:", _0x5b46e5), { "success": ![], "error": _0x5b46e5[_0x52e9f2(1486)] };
    }
  }), electron[_0x1eb488(1822)][_0x1eb488(1295)]("dev:wipe-database", async () => {
    const _0x2d30c5 = _0x1eb488;
    console[_0x2d30c5(926)]("Received dev:wipe-database IPC call.");
    try {
      return await wipeDatabase(), { "success": !![] };
    } catch (_0x35be1b) {
      return console[_0x2d30c5(981)]("Failed to wipe database:", _0x35be1b), { "success": ![], "error": _0x35be1b[_0x2d30c5(1486)] };
    }
  });
}
const PROTOCOL = "voiceos";
function handleProtocolUrl(_0x3b778d) {
  const _0x3d5cc1 = _0x54a1b7;
  try {
    const _0x4a7d20 = new URL(_0x3b778d);
    if (_0x4a7d20[_0x3d5cc1(1430)] === PROTOCOL + ":" && (_0x4a7d20[_0x3d5cc1(590)] === "subscription-success" || _0x4a7d20[_0x3d5cc1(590)] === "subscription-updated" || _0x4a7d20[_0x3d5cc1(590)] === "subscription-canceled" || _0x4a7d20[_0x3d5cc1(590)] === "team-subscription-success")) {
      console[_0x3d5cc1(926)]("Subscription event received:", _0x4a7d20[_0x3d5cc1(590)]);
      mainWindow && !mainWindow[_0x3d5cc1(496)]() && !mainWindow[_0x3d5cc1(890)][_0x3d5cc1(496)]() && (mainWindow[_0x3d5cc1(890)][_0x3d5cc1(965)]("subscription-event", { "event": _0x4a7d20[_0x3d5cc1(590)] }), mainWindow[_0x3d5cc1(1286)](), mainWindow[_0x3d5cc1(1704)](), mainWindow[_0x3d5cc1(371)](!![]), mainWindow[_0x3d5cc1(371)](![]), process[_0x3d5cc1(1394)] === "darwin" && (mainWindow[_0x3d5cc1(941)](), electron[_0x3d5cc1(178)][_0x3d5cc1(1704)]({ "steal": !![] }), electron[_0x3d5cc1(178)][_0x3d5cc1(565)]?.[_0x3d5cc1(1286)]()));
      return;
    }
    if (_0x4a7d20[_0x3d5cc1(1430)] === PROTOCOL + ":" && _0x4a7d20[_0x3d5cc1(590)] === _0x3d5cc1(1808) && _0x4a7d20[_0x3d5cc1(160)] === "/callback") {
      const _0x2a37ea = _0x4a7d20[_0x3d5cc1(613)][_0x3d5cc1(1043)]("access_token") ? _0x4a7d20[_0x3d5cc1(613)] : _0x4a7d20[_0x3d5cc1(871)] && _0x4a7d20[_0x3d5cc1(871)][_0x3d5cc1(1115)] > 1 ? new URLSearchParams(_0x4a7d20[_0x3d5cc1(871)][_0x3d5cc1(350)](1)) : null;
      if (_0x2a37ea) {
        const _0x5d77c9 = _0x2a37ea[_0x3d5cc1(1043)]("access_token"), _0x8f5341 = _0x2a37ea[_0x3d5cc1(1043)]("refresh_token"), _0x3c7dd4 = _0x2a37ea[_0x3d5cc1(1043)]("expires_in");
        if (_0x5d77c9) {
          console[_0x3d5cc1(926)](_0x3d5cc1(1309));
          if (mainWindow && !mainWindow[_0x3d5cc1(496)]() && !mainWindow[_0x3d5cc1(890)][_0x3d5cc1(496)]()) {
            const _0x306149 = () => {
              const _0x3dabd8 = _0x3d5cc1;
              mainWindow && !mainWindow[_0x3dabd8(496)]() && !mainWindow[_0x3dabd8(890)][_0x3dabd8(496)]() && mainWindow[_0x3dabd8(890)][_0x3dabd8(965)]("supabase-auth-success", { "access_token": _0x5d77c9, "refresh_token": _0x8f5341, "expires_in": _0x3c7dd4 ? parseInt(_0x3c7dd4) : void 0 });
            };
            mainWindow[_0x3d5cc1(890)][_0x3d5cc1(1338)]() ? mainWindow[_0x3d5cc1(890)][_0x3d5cc1(1743)]("did-finish-load", () => {
              _0x306149();
            }) : _0x306149(), mainWindow[_0x3d5cc1(1286)](), mainWindow[_0x3d5cc1(1704)](), mainWindow[_0x3d5cc1(371)](!![]), mainWindow[_0x3d5cc1(371)](![]), process[_0x3d5cc1(1394)] === "darwin" && (mainWindow[_0x3d5cc1(941)](), electron[_0x3d5cc1(178)][_0x3d5cc1(1704)]({ "steal": !![] }), electron[_0x3d5cc1(178)][_0x3d5cc1(565)]?.[_0x3d5cc1(1286)]());
          } else console[_0x3d5cc1(981)]("No main window found to send auth tokens to");
          return;
        }
      }
      const _0x87fb05 = _0x4a7d20[_0x3d5cc1(613)][_0x3d5cc1(1043)]("code"), _0x48642 = _0x4a7d20[_0x3d5cc1(613)][_0x3d5cc1(1043)](_0x3d5cc1(1156));
      if (_0x87fb05 && _0x48642) {
        if (mainWindow && !mainWindow[_0x3d5cc1(496)]() && !mainWindow[_0x3d5cc1(890)][_0x3d5cc1(496)]()) {
          const _0x285171 = () => {
            const _0x3db32b = _0x3d5cc1;
            mainWindow && !mainWindow[_0x3db32b(496)]() && !mainWindow[_0x3db32b(890)][_0x3db32b(496)]() && mainWindow[_0x3db32b(890)][_0x3db32b(965)]("auth-code-received", _0x87fb05, _0x48642);
          };
          mainWindow[_0x3d5cc1(890)][_0x3d5cc1(1338)]() ? mainWindow[_0x3d5cc1(890)][_0x3d5cc1(1743)]("did-finish-load", () => {
            _0x285171();
          }) : _0x285171(), mainWindow[_0x3d5cc1(1286)](), mainWindow[_0x3d5cc1(1704)](), mainWindow[_0x3d5cc1(371)](!![]), mainWindow[_0x3d5cc1(371)](![]), process[_0x3d5cc1(1394)] === "darwin" && (mainWindow[_0x3d5cc1(941)](), electron[_0x3d5cc1(178)][_0x3d5cc1(1704)]({ "steal": !![] }), electron[_0x3d5cc1(178)][_0x3d5cc1(565)]?.[_0x3d5cc1(1286)]());
        } else console[_0x3d5cc1(981)]("No main window found to send auth code to");
      } else console[_0x3d5cc1(1697)]("No auth data found in protocol URL (neither tokens nor code)");
    } else console[_0x3d5cc1(1697)]("Protocol URL does not match expected format"), console[_0x3d5cc1(1697)](_0x3d5cc1(606) + PROTOCOL + _0x3d5cc1(645)), console[_0x3d5cc1(1697)](_0x3d5cc1(251) + _0x4a7d20[_0x3d5cc1(1430)] + _0x3d5cc1(695) + _0x4a7d20[_0x3d5cc1(590)] + _0x3d5cc1(1192) + _0x4a7d20[_0x3d5cc1(160)] + "'");
  } catch (_0xadaa32) {
    console[_0x3d5cc1(981)](_0x3d5cc1(646), _0xadaa32);
  }
}
function setupProtocolHandling() {
  const _0x996bab = _0x54a1b7;
  if (process[_0x996bab(235)] || !electron[_0x996bab(178)][_0x996bab(1664)]) {
    if (process[_0x996bab(1510)][_0x996bab(1115)] >= 2) {
      const _0xd76d80 = electron[_0x996bab(178)][_0x996bab(501)](PROTOCOL, process[_0x996bab(354)], [path[_0x996bab(1786)](process[_0x996bab(1510)][1])]);
      !_0xd76d80 && electron[_0x996bab(178)][_0x996bab(501)](PROTOCOL, process[_0x996bab(354)], [electron[_0x996bab(178)][_0x996bab(444)]()]);
    } else electron[_0x996bab(178)][_0x996bab(501)](PROTOCOL, process[_0x996bab(354)], [electron[_0x996bab(178)][_0x996bab(444)]()]);
  } else !electron[_0x996bab(178)][_0x996bab(1466)](PROTOCOL) && electron[_0x996bab(178)][_0x996bab(501)](PROTOCOL);
  const _0x2ef139 = electron[_0x996bab(178)][_0x996bab(699)]();
  if (!_0x2ef139) {
    electron[_0x996bab(178)][_0x996bab(277)]();
    return;
  }
  electron[_0x996bab(178)]["on"]("second-instance", (_0x4e6db3, _0x55a88e, _0x1eef9c) => {
    const _0x5ecaa8 = _0x996bab, _0x3b34f5 = electron[_0x5ecaa8(963)][_0x5ecaa8(1274)]()[_0x5ecaa8(445)]((_0x320de3) => !_0x320de3[_0x5ecaa8(496)]());
    if (_0x3b34f5) {
      if (_0x3b34f5[_0x5ecaa8(1267)]()) _0x3b34f5[_0x5ecaa8(1807)]();
      _0x3b34f5[_0x5ecaa8(1704)]();
    }
    const _0x55f6a1 = _0x55a88e[_0x5ecaa8(445)]((_0x2caed4) => _0x2caed4[_0x5ecaa8(137)](PROTOCOL + _0x5ecaa8(1812)));
    _0x55f6a1 && handleProtocolUrl(_0x55f6a1);
  }), electron[_0x996bab(178)]["on"]("open-url", (_0x6be71c, _0x28c2db) => {
    const _0x196e66 = _0x996bab;
    _0x6be71c[_0x196e66(554)](), handleProtocolUrl(_0x28c2db);
  });
}
function processStartupProtocolUrl() {
  const _0x2ec35c = _0x54a1b7, _0x2c3245 = process[_0x2ec35c(1510)][_0x2ec35c(445)]((_0x29860e) => _0x29860e[_0x2ec35c(137)](PROTOCOL + _0x2ec35c(1812)));
  _0x2c3245 && handleProtocolUrl(_0x2c3245);
}
let powerSaveBlockerId = null;
function preventAppNap() {
  const _0x328965 = _0x54a1b7;
  powerSaveBlockerId === null && (powerSaveBlockerId = electron[_0x328965(870)][_0x328965(376)]("prevent-app-suspension"));
}
function allowAppNap() {
  const _0xed1bf3 = _0x54a1b7;
  powerSaveBlockerId !== null && (electron[_0xed1bf3(870)][_0xed1bf3(1146)](powerSaveBlockerId), powerSaveBlockerId = null);
}
const nativeModuleName = "window-text-reader", DEFAULT_MAX_DEPTH = 50, DEFAULT_MAX_TEXT_LENGTH = 5e4;
class WindowTextReaderService extends events[_0x54a1b7(281)] {
  #windowTextProcess = null;
  #pendingRequests = /* @__PURE__ */ new Map();
  #requestIdCounter = 0;
  #isInitializing = ![];
  #buffer = "";
  constructor() {
    super();
  }
  [_0x54a1b7(1247)]() {
    const _0x49f290 = _0x54a1b7;
    if (this.#windowTextProcess) {
      log[_0x49f290(1697)]("[WindowTextReader] Process already running.");
      return;
    }
    if (this.#isInitializing) {
      log[_0x49f290(1697)]("[WindowTextReader] Already initializing.");
      return;
    }
    if (os[_0x49f290(1394)]() !== "darwin") {
      log[_0x49f290(1341)]("[WindowTextReader] Not supported on this platform, skipping.");
      return;
    }
    this.#isInitializing = !![];
    const _0x4568ec = getNativeBinaryPath(nativeModuleName);
    if (!_0x4568ec) {
      log[_0x49f290(981)](_0x49f290(754) + nativeModuleName + _0x49f290(920)), this[_0x49f290(569)]("error", new Error("Window text reader binary not found.")), this.#isInitializing = ![];
      return;
    }
    log[_0x49f290(1341)](_0x49f290(1762) + _0x4568ec);
    try {
      this.#windowTextProcess = child_process[_0x49f290(1424)](_0x4568ec, [], { "stdio": [_0x49f290(1155), _0x49f290(1155), _0x49f290(1155)] });
      if (!this.#windowTextProcess) throw new Error(_0x49f290(1496));
      this.#windowTextProcess[_0x49f290(1532)]?.["on"]("data", this.#onData[_0x49f290(334)](this)), this.#windowTextProcess[_0x49f290(595)]?.["on"]("data", this.#onStdErr[_0x49f290(334)](this)), this.#windowTextProcess["on"]("close", this.#onClose[_0x49f290(334)](this)), this.#windowTextProcess["on"]("error", this.#onError[_0x49f290(334)](this)), log[_0x49f290(1341)]("[WindowTextReader] Process started."), this.#isInitializing = ![];
    } catch (_0x45faf3) {
      log[_0x49f290(981)]("[WindowTextReader] Error spawning process:", _0x45faf3), this.#windowTextProcess = null, this.#isInitializing = ![], this[_0x49f290(569)]("error", _0x45faf3);
    }
  }
  [_0x54a1b7(268)]() {
    const _0x5983b8 = _0x54a1b7;
    this.#windowTextProcess && (log[_0x5983b8(1341)]("[WindowTextReader] Stopping process."), this.#windowTextProcess[_0x5983b8(1386)](), this.#windowTextProcess = null, this[_0x5983b8(569)](_0x5983b8(1336)), this.#pendingRequests[_0x5983b8(878)](({ reject: _0x4127db }) => {
      const _0x358c6 = _0x5983b8;
      _0x4127db(new Error(_0x358c6(557)));
    }), this.#pendingRequests[_0x5983b8(1723)](), this.#buffer = "");
  }
  async [_0x54a1b7(786)](_0x54d0e5 = {}) {
    const _0x1381de = _0x54a1b7;
    !this.#windowTextProcess && (this[_0x1381de(1247)](), await new Promise((_0x354c9b) => setTimeout(_0x354c9b, 100)));
    if (!this.#windowTextProcess) return { "success": ![], "text": null, "tree": null, "elementCount": 0, "appName": null, "windowTitle": null, "error": "Window text reader process not running" };
    return new Promise((_0x44bda4, _0x8e5350) => {
      const _0x147a78 = _0x1381de, _0x56ce44 = _0x147a78(1143) + ++this.#requestIdCounter + "_" + Date[_0x147a78(1536)]();
      this.#pendingRequests[_0x147a78(1359)](_0x56ce44, { "resolve": _0x44bda4, "reject": _0x8e5350 });
      const _0x1d6e77 = { "command": "get-window-text", "requestId": _0x56ce44, "maxDepth": _0x54d0e5[_0x147a78(399)] ?? DEFAULT_MAX_DEPTH, "maxTextLength": _0x54d0e5[_0x147a78(250)] ?? DEFAULT_MAX_TEXT_LENGTH, "targetPid": _0x54d0e5[_0x147a78(1636)] };
      this.#sendCommand(_0x1d6e77), setTimeout(() => {
        const _0x40c17d = _0x147a78;
        this.#pendingRequests[_0x40c17d(1764)](_0x56ce44) && (this.#pendingRequests[_0x40c17d(506)](_0x56ce44), _0x44bda4({ "success": ![], "text": null, "tree": null, "elementCount": 0, "appName": null, "windowTitle": null, "error": _0x40c17d(622) }));
      }, 1e4);
    });
  }
  #sendCommand(_0x495b34) {
    const _0x58b251 = _0x54a1b7;
    if (!this.#windowTextProcess) {
      log[_0x58b251(981)]("[WindowTextReader] Cannot send command, process not running");
      return;
    }
    try {
      const _0x1cc516 = JSON[_0x58b251(1516)](_0x495b34) + "\n";
      this.#windowTextProcess[_0x58b251(776)]?.[_0x58b251(1020)](_0x1cc516);
    } catch (_0x1fd0b7) {
      log[_0x58b251(981)]("[WindowTextReader] Error sending command:", _0x1fd0b7);
    }
  }
  #onData(_0x47efc1) {
    const _0x3ccc87 = _0x54a1b7;
    this.#buffer += _0x47efc1[_0x3ccc87(1450)]();
    const _0x33d3d7 = this.#buffer[_0x3ccc87(1163)]("\n");
    this.#buffer = _0x33d3d7[_0x3ccc87(175)]() || "";
    for (const _0x58596b of _0x33d3d7) {
      if (!_0x58596b[_0x3ccc87(1699)]()) continue;
      try {
        const _0x2659fc = JSON[_0x3ccc87(675)](_0x58596b);
        if (_0x2659fc[_0x3ccc87(437)] && this.#pendingRequests[_0x3ccc87(1764)](_0x2659fc[_0x3ccc87(437)])) {
          const { resolve: _0x2be362 } = this.#pendingRequests[_0x3ccc87(1043)](_0x2659fc[_0x3ccc87(437)]);
          this.#pendingRequests[_0x3ccc87(506)](_0x2659fc[_0x3ccc87(437)]), _0x2be362({ "success": _0x2659fc[_0x3ccc87(522)], "text": _0x2659fc[_0x3ccc87(785)], "tree": _0x2659fc[_0x3ccc87(1740)], "elementCount": _0x2659fc[_0x3ccc87(741)], "appName": _0x2659fc[_0x3ccc87(1856)], "windowTitle": _0x2659fc[_0x3ccc87(688)], "error": _0x2659fc[_0x3ccc87(981)] });
        } else log[_0x3ccc87(1697)]("[WindowTextReader] Received response for unknown request:", _0x2659fc[_0x3ccc87(437)]);
      } catch (_0x21ba94) {
        log[_0x3ccc87(981)]("[WindowTextReader] Error parsing response:", _0x21ba94, "Raw data:", _0x58596b[_0x3ccc87(350)](0, 200) + (_0x58596b[_0x3ccc87(1115)] > 200 ? _0x3ccc87(875) : ""));
      }
    }
  }
  #onStdErr(_0x22f334) {
    const _0x5453e4 = _0x54a1b7, _0xa0b2ab = _0x22f334[_0x5453e4(1450)]();
    (_0xa0b2ab[_0x5453e4(1580)](_0x5453e4(1117)) || _0xa0b2ab[_0x5453e4(1580)](_0x5453e4(1280)) || _0xa0b2ab[_0x5453e4(1580)](_0x5453e4(884))) && log[_0x5453e4(981)]("[WindowTextReader] stderr:", _0xa0b2ab);
  }
  #onClose(_0x43b61b, _0x2b2dc2) {
    const _0x2cc5c8 = _0x54a1b7;
    log[_0x2cc5c8(1697)](_0x2cc5c8(1191) + _0x43b61b + _0x2cc5c8(1318) + _0x2b2dc2), this.#windowTextProcess = null, this.#pendingRequests[_0x2cc5c8(878)](({ reject: _0x3f289a }) => {
      const _0x549758 = _0x2cc5c8;
      _0x3f289a(new Error(_0x549758(1110) + _0x43b61b));
    }), this.#pendingRequests[_0x2cc5c8(1723)](), this.#buffer = "", this[_0x2cc5c8(569)]("closed", { "code": _0x43b61b, "signal": _0x2b2dc2 });
  }
  #onError(_0x2b208c) {
    const _0x246492 = _0x54a1b7;
    log[_0x246492(981)]("[WindowTextReader] Process error:", _0x2b208c), this[_0x246492(569)]("error", _0x2b208c);
  }
  [_0x54a1b7(1084)]() {
    return this.#windowTextProcess !== null;
  }
}
const windowTextReaderService = new WindowTextReaderService();
function filterAroundCursor(_0x2b3d4d, _0x4b875a = 200, _0x525180 = 100) {
  const _0x3d3c76 = _0x54a1b7, _0xe36575 = _0x3d3c76(1108), _0x35506c = _0x2b3d4d[_0x3d3c76(1257)](_0xe36575);
  if (_0x35506c === -1) return _0x2b3d4d;
  const _0x43647a = _0x2b3d4d[_0x3d3c76(337)](0, _0x35506c), _0x6e9092 = _0x2b3d4d[_0x3d3c76(337)](_0x35506c + _0xe36575[_0x3d3c76(1115)]), _0x154811 = _0x43647a[_0x3d3c76(1163)](/(\s+)/), _0x4c260a = _0x6e9092[_0x3d3c76(1163)](/(\s+)/), _0x4c58a9 = _0x154811[_0x3d3c76(1380)]((_0xbd8459) => _0xbd8459[_0x3d3c76(1699)]()[_0x3d3c76(1115)] > 0), _0x662f5d = _0x4c260a[_0x3d3c76(1380)]((_0x4948f9) => _0x4948f9[_0x3d3c76(1699)]()[_0x3d3c76(1115)] > 0);
  let _0x2f0ac9 = "";
  if (_0x4c58a9[_0x3d3c76(1115)] > _0x4b875a) {
    let _0x283ac6 = 0, _0x181262 = _0x154811[_0x3d3c76(1115)] - 1;
    for (let _0x2247b5 = _0x154811[_0x3d3c76(1115)] - 1; _0x2247b5 >= 0; _0x2247b5--) {
      if (_0x154811[_0x2247b5][_0x3d3c76(1699)]()[_0x3d3c76(1115)] > 0) {
        _0x283ac6++;
        if (_0x283ac6 >= _0x4b875a) {
          _0x181262 = _0x2247b5;
          break;
        }
      }
    }
    _0x2f0ac9 = _0x3d3c76(1260) + _0x154811[_0x3d3c76(337)](_0x181262)[_0x3d3c76(1638)]("");
  } else _0x2f0ac9 = _0x43647a;
  let _0x158884 = "";
  if (_0x662f5d[_0x3d3c76(1115)] > _0x525180) {
    let _0x3a2efe = 0, _0x493432 = 0;
    for (let _0x57bc35 = 0; _0x57bc35 < _0x4c260a[_0x3d3c76(1115)]; _0x57bc35++) {
      if (_0x4c260a[_0x57bc35][_0x3d3c76(1699)]()[_0x3d3c76(1115)] > 0) {
        _0x3a2efe++;
        if (_0x3a2efe >= _0x525180) {
          _0x493432 = _0x57bc35 + 1;
          break;
        }
      }
    }
    _0x158884 = _0x4c260a[_0x3d3c76(337)](0, _0x493432)[_0x3d3c76(1638)]("") + _0x3d3c76(1617);
  } else _0x158884 = _0x6e9092;
  return _0x2f0ac9 + _0xe36575 + _0x158884;
}
async function getWindowTextString(_0x374c82, _0x23b210 = DEFAULT_MAX_TEXT_LENGTH, _0x194ea9 = 200, _0x1aa73c = 100) {
  const _0x1491d4 = _0x54a1b7;
  try {
    process[_0x1491d4(1532)][_0x1491d4(1020)](_0x1491d4(1844) + _0x374c82 + "\n"), process[_0x1491d4(1532)][_0x1491d4(1020)](_0x1491d4(701) + windowTextReaderService[_0x1491d4(1084)]() + "\n");
    const _0x5e6da1 = await windowTextReaderService[_0x1491d4(786)]({ "maxTextLength": _0x23b210, "targetPid": _0x374c82 });
    process[_0x1491d4(1532)][_0x1491d4(1020)](_0x1491d4(765) + _0x5e6da1[_0x1491d4(522)] + _0x1491d4(1688) + (_0x5e6da1[_0x1491d4(785)]?.[_0x1491d4(1115)] || 0) + _0x1491d4(1346) + _0x5e6da1[_0x1491d4(981)] + _0x1491d4(1091) + _0x5e6da1[_0x1491d4(1856)] + "\n");
    if (!_0x5e6da1[_0x1491d4(522)] || !_0x5e6da1[_0x1491d4(785)]) return process[_0x1491d4(1532)][_0x1491d4(1020)](_0x1491d4(611) + _0x5e6da1[_0x1491d4(522)] + _0x1491d4(1529) + !!_0x5e6da1[_0x1491d4(785)] + "\n"), null;
    const _0x1620f8 = filterAroundCursor(_0x5e6da1[_0x1491d4(785)], _0x194ea9, _0x1aa73c);
    return process[_0x1491d4(1532)][_0x1491d4(1020)](_0x1491d4(930) + _0x1620f8[_0x1491d4(1115)] + "\n"), _0x1620f8;
  } catch (_0x2668a9) {
    return log[_0x1491d4(981)]("[WindowTextReader] Error getting window text:", _0x2668a9), process[_0x1491d4(1532)][_0x1491d4(1020)](_0x1491d4(767) + _0x2668a9 + "\n"), null;
  }
}
function filterTreeAroundFocus(_0x5a30e3, _0x296f9b = 40, _0x42ed7e = 10) {
  const _0x10891b = _0x54a1b7, _0x9efb24 = _0x5a30e3[_0x10891b(1163)]("\n"), _0x2f41d8 = _0x9efb24[_0x10891b(283)]((_0x575069) => _0x575069[_0x10891b(1580)](_0x10891b(1122)));
  if (_0x2f41d8 === -1) {
    const _0x50eddf = _0x296f9b + _0x42ed7e;
    if (_0x9efb24[_0x10891b(1115)] > _0x50eddf) return "[... earlier content truncated ...]\n" + _0x9efb24[_0x10891b(337)](-_0x50eddf)[_0x10891b(1638)]("\n");
    return _0x5a30e3;
  }
  const _0x3205c1 = Math[_0x10891b(1507)](0, _0x2f41d8 - _0x296f9b), _0x403cb9 = Math[_0x10891b(1125)](_0x9efb24[_0x10891b(1115)], _0x2f41d8 + _0x42ed7e + 1), _0x256af9 = _0x9efb24[_0x10891b(337)](_0x3205c1, _0x403cb9);
  let _0x1edc3b = "";
  return _0x3205c1 > 0 && (_0x1edc3b = "[... earlier content truncated ...]\n"), _0x1edc3b += _0x256af9[_0x10891b(1638)]("\n"), _0x403cb9 < _0x9efb24[_0x10891b(1115)] && (_0x1edc3b += "\n[... later content truncated ...]"), _0x1edc3b;
}
function condenseAccessibilityTree(_0x283bb4, _0x343530, _0x4e022f) {
  const _0x18b8d1 = _0x54a1b7, _0x14073f = _0x283bb4[_0x18b8d1(1163)]("\n");
  if (!_0x343530) {
    const _0x4a97cb = _0x283bb4[_0x18b8d1(419)](/\[title: "([^"]+)"\]/);
    _0x343530 = _0x4a97cb ? _0x4a97cb[1] : _0x18b8d1(993);
  }
  const _0x282075 = /\[title: "([^"]+)"\]/, _0x38f9b3 = /\[desc: "([^"]+)"\]/, _0x12cfb9 = /\[value: "([^"]+)"\]/, _0x43447c = / \[FOCUSED/;
  let _0x5462f6 = -1, _0x7ad865 = null;
  for (let _0x1c23ba = 0; _0x1c23ba < _0x14073f[_0x18b8d1(1115)]; _0x1c23ba++) {
    if (_0x43447c[_0x18b8d1(1103)](_0x14073f[_0x1c23ba])) {
      _0x5462f6 = _0x1c23ba;
      const _0x1e9eaf = _0x14073f[_0x1c23ba][_0x18b8d1(419)](_0x282075), _0x5b99f2 = _0x14073f[_0x1c23ba][_0x18b8d1(419)](_0x38f9b3), _0x1263e5 = _0x14073f[_0x1c23ba][_0x18b8d1(419)](_0x12cfb9), _0x37ec12 = _0x14073f[_0x1c23ba][_0x18b8d1(419)](/AX(\w+)/);
      _0x7ad865 = { "type": _0x37ec12 ? _0x37ec12[1] : _0x18b8d1(993), "desc": _0x1e9eaf ? _0x1e9eaf[1] : _0x5b99f2 ? _0x5b99f2[1] : "", "value": _0x1263e5 ? _0x1263e5[1][_0x18b8d1(1699)]() : "" };
      break;
    }
  }
  _0x5462f6 === -1 && (_0x5462f6 = _0x14073f[_0x18b8d1(1115)] - 1);
  const _0x568d5d = [], _0x20f280 = /* @__PURE__ */ new Set(), _0x27cc64 = ["keyboard shortcut", _0x18b8d1(1476), "press to", _0x18b8d1(893), "close", "minimize", "maximize", "more options", "settings menu", "navigation", "sidebar", _0x18b8d1(681), "status bar", _0x18b8d1(1124), _0x18b8d1(1408), _0x18b8d1(1637), _0x18b8d1(134), _0x18b8d1(948), _0x18b8d1(485), _0x18b8d1(1218), _0x18b8d1(994), "show trimmed", "expand", _0x18b8d1(1785), "add reaction", "reply in thread", "forward message", _0x18b8d1(1660), "more actions", "message actions"], _0x3b2c24 = ["you sent", "your imessage", "you:", _0x18b8d1(427), _0x18b8d1(1273), "sent by you", "from you", "your message"], _0x45c4e1 = (_0x5ea511) => {
    const _0x2bf8ec = _0x18b8d1, _0x39e659 = _0x5ea511[_0x2bf8ec(1566)]();
    return _0x27cc64[_0x2bf8ec(620)]((_0x498081) => _0x39e659[_0x2bf8ec(1580)](_0x498081));
  }, _0x5e2053 = (_0x5a1c3e) => {
    const _0x5a6092 = _0x18b8d1;
    return /^\d{1,2}:\d{2}(\s*(AM|PM))?$/i[_0x5a6092(1103)](_0x5a1c3e) || /^(Mon|Tue|Wed|Thu|Fri|Sat|Sun|Today|Yesterday)/i[_0x5a6092(1103)](_0x5a1c3e) || /^(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)\s+\d{1,2}/i[_0x5a6092(1103)](_0x5a1c3e) || /^\d{1,2}\/\d{1,2}\/\d{2,4}/[_0x5a6092(1103)](_0x5a1c3e) || /at\s+\d{1,2}:\d{2}/i[_0x5a6092(1103)](_0x5a1c3e) || /^(Today|Yesterday)\s+at\s+\d{1,2}:\d{2}/i[_0x5a6092(1103)](_0x5a1c3e);
  }, _0x43442e = (_0x3c1cb9) => {
    const _0x4e2b7e = _0x18b8d1;
    return /^\d{1,2}[mhdw]$/i[_0x4e2b7e(1103)](_0x3c1cb9[_0x4e2b7e(1699)]());
  }, _0x425f00 = (_0x3ff9b7) => {
    const _0x1982a3 = _0x18b8d1, _0x437290 = _0x3ff9b7[_0x1982a3(419)](/^[\s]*/);
    return _0x437290 ? (_0x437290[0][_0x1982a3(419)](//g) || [])[_0x1982a3(1115)] : 0;
  }, _0x4a9f1e = (_0x20a94b, _0x317f53) => {
    const _0x195632 = _0x18b8d1;
    if (_0x317f53 <= 0) return 0;
    const _0x285676 = _0x425f00(_0x20a94b[_0x317f53]);
    if (_0x285676 < 3) return Math[_0x195632(1507)](0, _0x317f53 - 400);
    const _0x2da5c5 = 5, _0x13066d = [];
    let _0x294778 = _0x317f53, _0x10eed3 = _0x285676;
    for (let _0x2cc5bf = _0x317f53; _0x2cc5bf >= 0 && _0x2cc5bf >= _0x317f53 - 500; _0x2cc5bf--) {
      const _0x583dd0 = _0x425f00(_0x20a94b[_0x2cc5bf]);
      _0x13066d[_0x195632(529)]({ "idx": _0x2cc5bf, "depth": _0x583dd0 }), _0x583dd0 > 0 && _0x583dd0 < _0x10eed3 && (_0x10eed3 = _0x583dd0, _0x294778 = _0x2cc5bf);
    }
    if (_0x10eed3 < _0x285676 * 0.8 && _0x294778 < _0x317f53 - 10) {
      for (let _0x17eb6c = 0; _0x17eb6c < _0x13066d[_0x195632(1115)] - _0x2da5c5; _0x17eb6c++) {
        const _0x241e89 = _0x13066d[_0x17eb6c][_0x195632(1262)], _0x494403 = _0x13066d[_0x195632(337)](_0x17eb6c + 1, _0x17eb6c + 1 + _0x2da5c5)[_0x195632(1720)]((_0xde18a, _0x42b64b) => _0xde18a + _0x42b64b[_0x195632(1262)], 0) / _0x2da5c5;
        if (_0x241e89 > _0x494403 * 1.3 && _0x13066d[_0x17eb6c][_0x195632(1792)] > _0x294778) return _0x13066d[_0x17eb6c][_0x195632(1792)];
      }
      return _0x294778 + 1;
    }
    return Math[_0x195632(1507)](0, _0x317f53 - 400);
  }, _0x1db4ed = (_0x558629) => {
    const _0x4ef058 = _0x18b8d1, _0x37739a = _0x558629[_0x4ef058(1566)]();
    return _0x3b2c24[_0x4ef058(620)]((_0x4d8e89) => _0x37739a[_0x4ef058(1580)](_0x4d8e89));
  }, _0x9d2c = _0x4a9f1e(_0x14073f, _0x5462f6), _0x55fa3c = _0x425f00(_0x14073f[_0x5462f6] || "");
  console[_0x18b8d1(926)](_0x18b8d1(1096) + _0x5462f6 + _0x18b8d1(536) + _0x55fa3c + _0x18b8d1(1539) + _0x9d2c + _0x18b8d1(1565) + _0x14073f[_0x18b8d1(1115)]);
  const _0x16a152 = _0x9d2c, _0xd9a21f = _0x5462f6, _0xf2ef35 = [];
  for (let _0x450358 = _0x16a152; _0x450358 < _0xd9a21f; _0x450358++) {
    const _0x21ee60 = _0x14073f[_0x450358], _0x131ac8 = _0x21ee60[_0x18b8d1(419)](/\[value: "([^"]+)"\]/);
    if (_0x131ac8) {
      const _0x4e092c = _0x131ac8[1][_0x18b8d1(1699)]();
      if (_0x43442e(_0x4e092c)) {
        const _0x25b091 = Math[_0x18b8d1(1507)](_0x16a152, _0x450358 - 20), _0x2f46fc = Math[_0x18b8d1(1125)](_0xd9a21f, _0x450358 + 5);
        _0xf2ef35[_0x18b8d1(529)]({ "start": _0x25b091, "end": _0x2f46fc });
      }
    }
  }
  const _0x3b26d4 = [];
  for (const _0x238612 of _0xf2ef35) {
    const _0x31eb5a = _0x3b26d4[_0x3b26d4[_0x18b8d1(1115)] - 1];
    _0x31eb5a && _0x238612[_0x18b8d1(376)] <= _0x31eb5a[_0x18b8d1(1071)] + 5 ? _0x31eb5a[_0x18b8d1(1071)] = Math[_0x18b8d1(1507)](_0x31eb5a[_0x18b8d1(1071)], _0x238612[_0x18b8d1(1071)]) : _0x3b26d4[_0x18b8d1(529)]({ ..._0x238612 });
  }
  const _0x3e144e = (_0x57ef0d) => {
    const _0x573e91 = _0x18b8d1;
    return _0x3b26d4[_0x573e91(620)]((_0x2a7858) => _0x57ef0d >= _0x2a7858[_0x573e91(376)] && _0x57ef0d <= _0x2a7858[_0x573e91(1071)]);
  };
  console[_0x18b8d1(926)](_0x18b8d1(864) + _0x3b26d4[_0x18b8d1(1115)] + _0x18b8d1(700));
  for (let _0x3fdb9f = _0x16a152; _0x3fdb9f < _0xd9a21f; _0x3fdb9f++) {
    const _0x171100 = _0x14073f[_0x3fdb9f];
    if (!_0x171100[_0x18b8d1(1699)]() || !_0x171100[_0x18b8d1(1580)]("AX")) continue;
    if (_0x3e144e(_0x3fdb9f)) continue;
    const _0x4b7177 = _0x425f00(_0x171100);
    if (_0x171100[_0x18b8d1(1580)](_0x18b8d1(1530))) {
      const _0x56fb1d = _0x171100[_0x18b8d1(419)](_0x282075), _0x164075 = _0x171100[_0x18b8d1(419)](_0x12cfb9), _0x306fe9 = _0x171100[_0x18b8d1(419)](_0x38f9b3), _0x56ad5d = _0x56fb1d?.[1] || _0x164075?.[1] || _0x306fe9?.[1];
      _0x56ad5d && _0x56ad5d[_0x18b8d1(1115)] > 1 && !_0x45c4e1(_0x56ad5d) && !_0x20f280[_0x18b8d1(1764)](_0x56ad5d) && (_0x20f280[_0x18b8d1(1332)](_0x56ad5d), _0x568d5d[_0x18b8d1(529)]({ "type": _0x18b8d1(1120), "content": _0x56ad5d, "lineIndex": _0x3fdb9f, "depth": _0x4b7177 }));
    }
    if (_0x171100[_0x18b8d1(1580)]("AXStaticText") && !_0x171100[_0x18b8d1(1580)]("")) {
      const _0x449931 = _0x171100[_0x18b8d1(419)](_0x12cfb9);
      if (_0x449931) {
        const _0x3f8190 = _0x449931[1][_0x18b8d1(1699)]();
        if (_0x3f8190[_0x18b8d1(1115)] < 2 || _0x3f8190 === "" || _0x3f8190 === " ") continue;
        if (_0x45c4e1(_0x3f8190)) continue;
        if (_0x20f280[_0x18b8d1(1764)](_0x3f8190)) continue;
        _0x20f280[_0x18b8d1(1332)](_0x3f8190);
        if (_0x5e2053(_0x3f8190)) _0x568d5d[_0x18b8d1(529)]({ "type": _0x18b8d1(831), "content": _0x3f8190, "lineIndex": _0x3fdb9f, "depth": _0x4b7177 });
        else {
          if (_0x3f8190[_0x18b8d1(1115)] >= 3) {
            const _0x10f38d = _0x1db4ed(_0x3f8190) ? "metadata" : "message";
            _0x568d5d[_0x18b8d1(529)]({ "type": _0x10f38d, "content": _0x3f8190, "lineIndex": _0x3fdb9f, "depth": _0x4b7177 });
          }
        }
      }
    }
    if (_0x171100[_0x18b8d1(1580)]("AXTextArea") && !_0x171100[_0x18b8d1(1580)]("")) {
      const _0x5c2c7e = _0x171100[_0x18b8d1(419)](_0x12cfb9), _0x76c03a = _0x171100[_0x18b8d1(419)](_0x38f9b3);
      if (_0x5c2c7e || _0x76c03a) {
        const _0x263933 = (_0x5c2c7e?.[1] || _0x76c03a?.[1] || "")[_0x18b8d1(1699)]();
        _0x263933[_0x18b8d1(1115)] > 3 && !_0x45c4e1(_0x263933) && !_0x20f280[_0x18b8d1(1764)](_0x263933) && (_0x20f280[_0x18b8d1(1332)](_0x263933), _0x568d5d[_0x18b8d1(529)]({ "type": "message", "content": _0x263933, "lineIndex": _0x3fdb9f, "depth": _0x4b7177 }));
      }
    }
    if (_0x171100[_0x18b8d1(1580)](_0x18b8d1(290))) {
      const _0x77a290 = _0x171100[_0x18b8d1(419)](_0x282075), _0x27beaa = _0x171100[_0x18b8d1(419)](_0x38f9b3), _0x956abb = _0x77a290?.[1] || _0x27beaa?.[1];
      if (_0x956abb) {
        if (_0x956abb[_0x18b8d1(1115)] < 3 || _0x45c4e1(_0x956abb)) continue;
        if (_0x20f280[_0x18b8d1(1764)](_0x956abb)) continue;
        const _0x1fbda7 = _0x956abb[_0x18b8d1(1566)]();
        if (_0x1fbda7 === "messages" || _0x1fbda7 === "conversation" || _0x1fbda7 === _0x18b8d1(1641)) continue;
        _0x20f280[_0x18b8d1(1332)](_0x956abb), (_0x956abb[_0x18b8d1(1580)](".") || _0x956abb[_0x18b8d1(1580)](":") || _0x956abb[_0x18b8d1(1580)](_0x18b8d1(1732))) && _0x568d5d[_0x18b8d1(529)]({ "type": "metadata", "content": _0x956abb, "lineIndex": _0x3fdb9f, "depth": _0x4b7177 });
      }
    }
    if (_0x171100[_0x18b8d1(1580)](_0x18b8d1(558))) {
      const _0x1935c5 = _0x171100[_0x18b8d1(419)](_0x282075), _0x492954 = _0x171100[_0x18b8d1(419)](_0x38f9b3), _0x6032b6 = _0x1935c5?.[1] || _0x492954?.[1];
      if (_0x6032b6 && _0x6032b6[_0x18b8d1(1115)] > 1 && !_0x45c4e1(_0x6032b6) && !_0x20f280[_0x18b8d1(1764)](_0x6032b6)) {
        _0x20f280[_0x18b8d1(1332)](_0x6032b6);
        const _0xf751ef = _0x5e2053(_0x6032b6) ? _0x18b8d1(831) : "sender";
        _0x568d5d[_0x18b8d1(529)]({ "type": _0xf751ef, "content": _0x6032b6, "lineIndex": _0x3fdb9f, "depth": _0x4b7177 });
      }
    }
    if (_0x171100[_0x18b8d1(1580)]("AXButton")) {
      const _0x2379c1 = _0x171100[_0x18b8d1(419)](_0x282075), _0xcceefe = _0x171100[_0x18b8d1(419)](_0x38f9b3), _0x17b14e = _0x171100[_0x18b8d1(419)](_0x12cfb9), _0x43fb1d = _0x2379c1?.[1] || _0xcceefe?.[1] || _0x17b14e?.[1];
      if (_0x43fb1d && _0x43fb1d[_0x18b8d1(1115)] > 1 && !_0x45c4e1(_0x43fb1d)) {
        const _0x575c51 = _0x43fb1d[_0x18b8d1(1566)]();
        _0x575c51 !== "send" && _0x575c51 !== _0x18b8d1(1193) && _0x575c51 !== "ok" && _0x575c51 !== "close" && _0x575c51 !== _0x18b8d1(215) && !_0x575c51[_0x18b8d1(1580)]("add reaction") && !_0x575c51[_0x18b8d1(1580)]("more actions") && _0x568d5d[_0x18b8d1(529)]({ "type": "sender", "content": _0x43fb1d, "lineIndex": _0x3fdb9f, "depth": _0x4b7177 });
      }
    }
    if (_0x171100[_0x18b8d1(1580)](_0x18b8d1(908)) || _0x171100[_0x18b8d1(1580)](_0x18b8d1(1074))) {
      const _0x2baf5d = _0x171100[_0x18b8d1(419)](_0x12cfb9), _0x1311fc = _0x171100[_0x18b8d1(419)](_0x38f9b3), _0x4c3865 = _0x2baf5d?.[1] || _0x1311fc?.[1];
      _0x4c3865 && _0x4c3865[_0x18b8d1(1115)] > 2 && !_0x45c4e1(_0x4c3865) && !_0x20f280[_0x18b8d1(1764)](_0x4c3865) && (_0x20f280[_0x18b8d1(1332)](_0x4c3865), _0x568d5d[_0x18b8d1(529)]({ "type": "message", "content": _0x4c3865, "lineIndex": _0x3fdb9f, "depth": _0x4b7177 }));
    }
  }
  const _0x5de46f = [];
  _0x5de46f[_0x18b8d1(529)](_0x18b8d1(1382) + _0x343530 + '"' + (_0x4e022f ? _0x18b8d1(196) + _0x4e022f : "") + "]"), _0x5de46f[_0x18b8d1(529)]("");
  if (_0x568d5d[_0x18b8d1(1115)] > 0) {
    _0x5de46f[_0x18b8d1(529)](_0x18b8d1(1515));
    const _0x2970d1 = _0x568d5d[_0x18b8d1(1608)]((_0x4f34ac, _0x1e8236) => _0x4f34ac[_0x18b8d1(404)] - _0x1e8236[_0x18b8d1(404)]), _0x43e771 = [];
    let _0x49b35f = null;
    for (let _0x43180d = 0; _0x43180d < _0x2970d1[_0x18b8d1(1115)]; _0x43180d++) {
      const _0x355567 = _0x2970d1[_0x43180d];
      if (_0x355567[_0x18b8d1(1154)] === _0x18b8d1(831)) continue;
      if (_0x355567[_0x18b8d1(1154)] === "sender") {
        _0x49b35f = _0x355567[_0x18b8d1(1858)];
        continue;
      }
      _0x355567[_0x18b8d1(1154)] === "message" && (_0x49b35f ? (_0x43e771[_0x18b8d1(529)](_0x49b35f + ": " + _0x355567[_0x18b8d1(1858)]), _0x49b35f = null) : _0x43e771[_0x18b8d1(529)](_0x18b8d1(1857) + _0x355567[_0x18b8d1(1858)])), _0x355567[_0x18b8d1(1154)] === "metadata" && (_0x43e771[_0x18b8d1(529)]("" + _0x355567[_0x18b8d1(1858)]), _0x49b35f = null), _0x355567[_0x18b8d1(1154)] === _0x18b8d1(1120) && _0x43e771[_0x18b8d1(529)](_0x18b8d1(660) + _0x355567[_0x18b8d1(1858)]);
    }
    const _0x9ac54a = _0x43e771[_0x18b8d1(337)](-25);
    _0x5de46f[_0x18b8d1(529)](..._0x9ac54a), _0x5de46f[_0x18b8d1(529)]("");
  }
  if (_0x7ad865) {
    const _0x21a915 = _0x7ad865[_0x18b8d1(1208)] || _0x7ad865[_0x18b8d1(1154)], _0xa5380c = _0x7ad865[_0x18b8d1(418)] ? _0x18b8d1(311) + _0x7ad865[_0x18b8d1(418)] + '"]' : " [empty]";
    _0x5de46f[_0x18b8d1(529)](_0x18b8d1(1190) + _0x21a915 + _0xa5380c);
  }
  return _0x5de46f[_0x18b8d1(1638)]("\n");
}
async function getWindowTreeString(_0x1847d3, _0x5720d0 = DEFAULT_MAX_TEXT_LENGTH, _0x235623 = !![]) {
  const _0x349250 = _0x54a1b7;
  try {
    process[_0x349250(1532)][_0x349250(1020)](_0x349250(1179) + _0x1847d3 + "\n");
    const _0x121901 = await windowTextReaderService[_0x349250(786)]({ "maxTextLength": _0x5720d0, "targetPid": _0x1847d3 });
    process[_0x349250(1532)][_0x349250(1020)](_0x349250(1007) + _0x121901[_0x349250(522)] + _0x349250(1081) + (_0x121901[_0x349250(1740)]?.[_0x349250(1115)] || 0) + _0x349250(1346) + _0x121901[_0x349250(981)] + "\n");
    if (!_0x121901[_0x349250(522)] || !_0x121901[_0x349250(1740)]) return process[_0x349250(1532)][_0x349250(1020)](_0x349250(1734) + _0x121901[_0x349250(522)] + _0x349250(1181) + !!_0x121901[_0x349250(1740)] + "\n"), null;
    const _0x5be299 = await import("fs"), _0x5b75ea = await import("path"), _0x1cdc59 = await import("os"), _0x4383 = _0x5b75ea[_0x349250(1638)](_0x1cdc59[_0x349250(929)](), "accessibility-tree-debug.txt"), _0x487d5b = (/* @__PURE__ */ new Date())[_0x349250(582)](), _0x3fe81d = _0x349250(364) + _0x487d5b + _0x349250(1049) + (_0x121901[_0x349250(1856)] || _0x349250(993)) + _0x349250(259) + (_0x121901[_0x349250(688)] || _0x349250(993)) + _0x349250(1587) + _0x121901[_0x349250(1740)][_0x349250(1115)] + _0x349250(1415) + _0x121901[_0x349250(1740)] + "\n";
    _0x5be299[_0x349250(1813)](_0x4383, _0x3fe81d), process[_0x349250(1532)][_0x349250(1020)](_0x349250(1691) + _0x4383 + "\n");
    if (_0x235623) {
      const _0x598026 = condenseAccessibilityTree(_0x121901[_0x349250(1740)], _0x121901[_0x349250(688)], _0x121901[_0x349250(1856)]);
      return process[_0x349250(1532)][_0x349250(1020)](_0x349250(1588) + _0x121901[_0x349250(1740)][_0x349250(1115)] + _0x349250(1194) + _0x598026[_0x349250(1115)] + _0x349250(1526)), _0x598026;
    } else {
      const _0x463c99 = filterTreeAroundFocus(_0x121901[_0x349250(1740)], 40, 10);
      return process[_0x349250(1532)][_0x349250(1020)](_0x349250(288) + _0x121901[_0x349250(1740)][_0x349250(1115)] + _0x349250(1194) + _0x463c99[_0x349250(1115)] + _0x349250(1526)), _0x463c99;
    }
  } catch (_0x3c519d) {
    return log[_0x349250(981)]("[WindowTextReader] Error getting window tree:", _0x3c519d), process[_0x349250(1532)][_0x349250(1020)](_0x349250(1460) + _0x3c519d + "\n"), null;
  }
}
const windowTextReader = Object[_0x54a1b7(502)](Object[_0x54a1b7(634)]({ "__proto__": null, "getWindowTextString": getWindowTextString, "getWindowTreeString": getWindowTreeString, "windowTextReaderService": windowTextReaderService }, Symbol[_0x54a1b7(1177)], { "value": _0x54a1b7(1416) })), initializeMicrophoneSelection = async () => {
  const _0x1c5fac = _0x54a1b7;
  try {
    console[_0x1c5fac(926)]("[initializeMicrophoneSelection] Initializing microphone selection...");
    const _0x3f7b4f = store[_0x1c5fac(1043)](STORE_KEYS[_0x1c5fac(193)]);
    if (_0x3f7b4f?.[_0x1c5fac(548)] && _0x3f7b4f[_0x1c5fac(548)] !== _0x1c5fac(450)) {
      console[_0x1c5fac(926)](_0x1c5fac(905) + _0x3f7b4f[_0x1c5fac(548)] + _0x1c5fac(667));
      return;
    }
    const _0x4d2c76 = await audioRecorderService[_0x1c5fac(1242)](), _0x37cf4f = _0x4d2c76[_0x1c5fac(445)]((_0x4a866d) => {
      const _0x33b1de = _0x1c5fac, _0x393633 = _0x4a866d[_0x33b1de(1566)]();
      return _0x393633[_0x33b1de(1580)](_0x33b1de(1080)) || _0x393633[_0x33b1de(1580)](_0x33b1de(537)) || _0x393633[_0x33b1de(1580)](_0x33b1de(668)) || _0x393633[_0x33b1de(1580)]("system");
    });
    if (_0x37cf4f) {
      console[_0x1c5fac(926)](_0x1c5fac(491) + _0x37cf4f + '"');
      const _0x6e7fc6 = { ..._0x3f7b4f, "micDeviceId": _0x37cf4f, "micSelected": _0x37cf4f };
      store[_0x1c5fac(1359)](STORE_KEYS[_0x1c5fac(193)], _0x6e7fc6);
    } else console[_0x1c5fac(926)]('[initializeMicrophoneSelection] No built-in microphone found. Keeping "Auto select".');
  } catch (_0x36acd0) {
    console[_0x1c5fac(981)](" [initializeMicrophoneSelection] Failed to initialize microphone selection:", _0x36acd0);
  }
};
let tray = null;
const TRAY_GUID = _0x54a1b7(1429), TRAY_HEIGHT = 16;
function getTrayIconPath() {
  const _0x21935d = _0x54a1b7;
  if (!electron[_0x21935d(178)][_0x21935d(1664)]) return path[_0x21935d(1638)](__dirname, "../../resources/build/logo.png");
  return path[_0x21935d(1638)](process[_0x21935d(1613)], "build", _0x21935d(1610));
}
async function buildMicrophoneSubmenu() {
  const _0x2dd0dd = _0x54a1b7, _0x5db988 = store[_0x2dd0dd(1043)](STORE_KEYS[_0x2dd0dd(193)]), _0x44c656 = _0x5db988[_0x2dd0dd(548)];
  let _0x5e18cc = [];
  try {
    _0x5e18cc = await audioRecorderService[_0x2dd0dd(1242)]();
  } catch {
    _0x5e18cc = [];
  }
  const _0x39ec06 = (_0x3d7988, _0x123b63) => {
    const _0x321e21 = _0x2dd0dd, _0x61ed97 = store[_0x321e21(1043)](STORE_KEYS[_0x321e21(193)]), _0x374d06 = { ..._0x61ed97, "micDeviceId": _0x3d7988, "micSelected": _0x123b63 };
    store[_0x321e21(1359)](STORE_KEYS[_0x321e21(193)], _0x374d06), voiceInputService[_0x321e21(1268)](_0x3d7988), void rebuildTrayMenu();
  }, _0x4995e0 = [{ "label": _0x2dd0dd(534), "type": _0x2dd0dd(630), "checked": _0x44c656 === _0x2dd0dd(450), "click": () => _0x39ec06(_0x2dd0dd(450), _0x2dd0dd(534)) }];
  for (const _0x49719b of _0x5e18cc) {
    _0x4995e0[_0x2dd0dd(529)]({ "label": _0x49719b, "type": _0x2dd0dd(630), "checked": _0x44c656 === _0x49719b, "click": () => _0x39ec06(_0x49719b, _0x49719b) });
  }
  return _0x4995e0;
}
async function rebuildTrayMenu() {
  const _0x350edf = _0x54a1b7;
  if (!tray) return;
  const _0x4572e1 = await buildMicrophoneSubmenu(), _0x3699ea = [{ "label": _0x350edf(1511), "click": () => {
    const _0x22147d = _0x350edf;
    if (!mainWindow) createAppWindow();
    else {
      if (!mainWindow[_0x22147d(1639)]()) mainWindow[_0x22147d(1286)]();
      mainWindow[_0x22147d(1704)]();
    }
  } }, { "label": "Microphone", "submenu": _0x4572e1 }, { "type": _0x350edf(1045) }, { "label": _0x350edf(881), "role": "quit" }], _0x5b493d = electron[_0x350edf(672)][_0x350edf(245)](_0x3699ea);
  tray[_0x350edf(1217)](_0x5b493d);
}
async function createAppTray() {
  const _0x6a8e96 = _0x54a1b7;
  if (tray) return;
  const _0x1d1cbb = getTrayIconPath();
  let _0x350898 = electron[_0x6a8e96(1078)][_0x6a8e96(1422)](_0x1d1cbb);
  _0x350898[_0x6a8e96(868)]() && process[_0x6a8e96(1394)] === "darwin" && (_0x350898 = electron[_0x6a8e96(1078)][_0x6a8e96(1291)](_0x6a8e96(1860)));
  const _0x49f9a4 = _0x350898[_0x6a8e96(1370)]({ "height": TRAY_HEIGHT });
  tray = new electron[_0x6a8e96(1627)](_0x49f9a4, TRAY_GUID), tray[_0x6a8e96(1763)](_0x6a8e96(476)), await rebuildTrayMenu(), process[_0x6a8e96(1394)] !== "darwin" && (tray["on"](_0x6a8e96(842), async () => {
    const _0x415899 = _0x6a8e96;
    await rebuildTrayMenu(), tray?.[_0x415899(130)]();
  }), tray["on"](_0x6a8e96(1006), async () => {
    const _0x17052b = _0x6a8e96;
    await rebuildTrayMenu(), tray?.[_0x17052b(130)]();
  }));
}
function destroyAppTray() {
  const _0x507359 = _0x54a1b7;
  tray && (tray[_0x507359(1483)](), tray = null);
}
async function cropImage(_0x43d551, _0x3c5494) {
  const _0x2e110f = _0x54a1b7;
  try {
    log[_0x2e110f(1341)](_0x2e110f(1287) + _0x3c5494["x"] + _0x2e110f(1168) + _0x3c5494["y"] + _0x2e110f(365) + _0x3c5494[_0x2e110f(183)] + _0x2e110f(886) + _0x3c5494[_0x2e110f(553)]);
    const _0x1c5136 = electron[_0x2e110f(1078)][_0x2e110f(512)](_0x43d551);
    if (_0x1c5136[_0x2e110f(868)]()) return log[_0x2e110f(981)]("[ImageCrop] Failed to create image from data URI"), null;
    const _0xdf661 = _0x1c5136[_0x2e110f(955)]();
    log[_0x2e110f(1341)](_0x2e110f(676) + _0xdf661[_0x2e110f(183)] + "x" + _0xdf661[_0x2e110f(553)]);
    if (_0x3c5494["x"] < 0 || _0x3c5494["y"] < 0 || _0x3c5494[_0x2e110f(183)] <= 0 || _0x3c5494[_0x2e110f(553)] <= 0) return log[_0x2e110f(981)]("[ImageCrop] Invalid crop bounds - must be positive values"), null;
    (_0x3c5494["x"] + _0x3c5494[_0x2e110f(183)] > _0xdf661[_0x2e110f(183)] || _0x3c5494["y"] + _0x3c5494[_0x2e110f(553)] > _0xdf661[_0x2e110f(553)]) && (log[_0x2e110f(1697)]("[ImageCrop] Crop bounds exceed image dimensions, adjusting to fit"), _0x3c5494[_0x2e110f(183)] = Math[_0x2e110f(1125)](_0x3c5494[_0x2e110f(183)], _0xdf661[_0x2e110f(183)] - _0x3c5494["x"]), _0x3c5494[_0x2e110f(553)] = Math[_0x2e110f(1125)](_0x3c5494[_0x2e110f(553)], _0xdf661[_0x2e110f(553)] - _0x3c5494["y"]));
    const _0x42bfe9 = _0x1c5136[_0x2e110f(519)]({ "x": Math[_0x2e110f(303)](_0x3c5494["x"]), "y": Math[_0x2e110f(303)](_0x3c5494["y"]), "width": Math[_0x2e110f(303)](_0x3c5494[_0x2e110f(183)]), "height": Math[_0x2e110f(303)](_0x3c5494[_0x2e110f(553)]) });
    if (_0x42bfe9[_0x2e110f(868)]()) return log[_0x2e110f(981)]("[ImageCrop] Failed to crop image - result is empty"), null;
    const _0x281d38 = _0x42bfe9[_0x2e110f(955)]();
    log[_0x2e110f(1341)](_0x2e110f(1623) + _0x281d38[_0x2e110f(183)] + "x" + _0x281d38[_0x2e110f(553)]);
    const _0x38df4e = _0x42bfe9[_0x2e110f(515)](), _0x59aa1e = Math[_0x2e110f(303)](_0x38df4e[_0x2e110f(1115)] / 1024);
    return log[_0x2e110f(1341)](_0x2e110f(1623) + _0x59aa1e + "KB"), _0x38df4e;
  } catch (_0x27110d) {
    return log[_0x2e110f(981)](_0x2e110f(1222), _0x27110d), null;
  }
}
function isFullScreenWindow(_0xdfffc5, _0x5c5898, _0xdcb4d4 = 10) {
  const _0x3fcd6e = _0x54a1b7, _0x12bd53 = Math[_0x3fcd6e(915)](_0xdfffc5[_0x3fcd6e(183)] - _0x5c5898[_0x3fcd6e(183)]) <= _0xdcb4d4, _0x595651 = Math[_0x3fcd6e(915)](_0xdfffc5[_0x3fcd6e(553)] - _0x5c5898[_0x3fcd6e(553)]) <= _0xdcb4d4, _0x1a4bb4 = Math[_0x3fcd6e(915)](_0xdfffc5["x"] - _0x5c5898["x"]) <= _0xdcb4d4 && Math[_0x3fcd6e(915)](_0xdfffc5["y"] - _0x5c5898["y"]) <= _0xdcb4d4;
  return _0x12bd53 && _0x595651 && _0x1a4bb4;
}
function drawFilledRect(_0x4c8670, _0x2fe77c, _0x247868, _0x96adb0, _0x6a4b5e, _0x523e79, _0x546b66, _0x33a221, _0xda06a5, _0x4381d0 = 255) {
  const _0x471fee = _0x54a1b7;
  for (let _0x3e2d8e = 0; _0x3e2d8e < _0x523e79; _0x3e2d8e++) {
    for (let _0x4f9000 = 0; _0x4f9000 < _0x6a4b5e; _0x4f9000++) {
      const _0x5d3b04 = _0x247868 + _0x4f9000, _0x405a48 = _0x96adb0 + _0x3e2d8e;
      if (_0x5d3b04 >= 0 && _0x5d3b04 < _0x2fe77c && _0x405a48 >= 0) {
        const _0x5a04af = (_0x405a48 * _0x2fe77c + _0x5d3b04) * 4;
        if (_0x5a04af >= 0 && _0x5a04af + 3 < _0x4c8670[_0x471fee(1115)]) {
          const _0x302021 = _0x4381d0 / 255, _0x4af816 = _0x4c8670[_0x5a04af + 3] / 255, _0x17be4a = _0x302021 + _0x4af816 * (1 - _0x302021);
          _0x17be4a > 0 && (_0x4c8670[_0x5a04af] = Math[_0x471fee(303)]((_0x546b66 * _0x302021 + _0x4c8670[_0x5a04af] * _0x4af816 * (1 - _0x302021)) / _0x17be4a), _0x4c8670[_0x5a04af + 1] = Math[_0x471fee(303)]((_0x33a221 * _0x302021 + _0x4c8670[_0x5a04af + 1] * _0x4af816 * (1 - _0x302021)) / _0x17be4a), _0x4c8670[_0x5a04af + 2] = Math[_0x471fee(303)]((_0xda06a5 * _0x302021 + _0x4c8670[_0x5a04af + 2] * _0x4af816 * (1 - _0x302021)) / _0x17be4a), _0x4c8670[_0x5a04af + 3] = Math[_0x471fee(303)](_0x17be4a * 255));
        }
      }
    }
  }
}
function drawHollowRect(_0x1bc3d1, _0x4524d3, _0x1525b2, _0xddcbcd, _0x51a9d5, _0x4bbb1f, _0x28bb3c, _0x4db03c, _0x5d65dd, _0x2a17af, _0x4d4375) {
  drawFilledRect(_0x1bc3d1, _0x4524d3, _0xddcbcd, _0x51a9d5, _0x4bbb1f, _0x4db03c, _0x5d65dd, _0x2a17af, _0x4d4375, 255), drawFilledRect(_0x1bc3d1, _0x4524d3, _0xddcbcd, _0x51a9d5 + _0x28bb3c - _0x4db03c, _0x4bbb1f, _0x4db03c, _0x5d65dd, _0x2a17af, _0x4d4375, 255), drawFilledRect(_0x1bc3d1, _0x4524d3, _0xddcbcd, _0x51a9d5, _0x4db03c, _0x28bb3c, _0x5d65dd, _0x2a17af, _0x4d4375, 255), drawFilledRect(_0x1bc3d1, _0x4524d3, _0xddcbcd + _0x4bbb1f - _0x4db03c, _0x51a9d5, _0x4db03c, _0x28bb3c, _0x5d65dd, _0x2a17af, _0x4d4375, 255);
}
async function addCaretIndicator(_0x591122, _0x1cd210, _0x169811) {
  const _0x41096d = _0x54a1b7;
  try {
    log[_0x41096d(1341)](_0x41096d(1703) + _0x1cd210["x"] + _0x41096d(1168) + _0x1cd210["y"] + _0x41096d(365) + _0x1cd210[_0x41096d(183)] + _0x41096d(886) + _0x1cd210[_0x41096d(553)]), log[_0x41096d(1341)](_0x41096d(1130) + _0x169811["x"] + _0x41096d(1168) + _0x169811["y"] + _0x41096d(365) + _0x169811[_0x41096d(183)] + _0x41096d(886) + _0x169811[_0x41096d(553)]);
    const _0x581634 = _0x1cd210["y"];
    log[_0x41096d(1341)](_0x41096d(670) + _0x581634);
    const _0xff7554 = Math[_0x41096d(303)](_0x1cd210["x"] - _0x169811["x"]), _0x339d42 = Math[_0x41096d(303)](_0x581634 - _0x169811["y"]), _0x6d8aab = Math[_0x41096d(303)](_0x1cd210[_0x41096d(183)]), _0x24e188 = Math[_0x41096d(303)](_0x1cd210[_0x41096d(553)]);
    log[_0x41096d(1341)](_0x41096d(1010) + _0xff7554 + _0x41096d(1168) + _0x339d42 + _0x41096d(365) + _0x6d8aab + _0x41096d(886) + _0x24e188);
    if (_0xff7554 + _0x6d8aab < -50 || _0x339d42 + _0x24e188 < -50 || _0xff7554 > _0x169811[_0x41096d(183)] + 50 || _0x339d42 > _0x169811[_0x41096d(553)] + 50) return log[_0x41096d(1697)]("[ImageCrop] Element is far outside window bounds, skipping outline"), _0x591122;
    const _0x1a6896 = electron[_0x41096d(1078)][_0x41096d(512)](_0x591122);
    if (_0x1a6896[_0x41096d(868)]()) return log[_0x41096d(981)]("[ImageCrop] Failed to create image from data URI"), _0x591122;
    const _0x2c7421 = _0x1a6896[_0x41096d(955)](), _0x51271a = _0x2c7421[_0x41096d(183)], _0x41a0fa = _0x2c7421[_0x41096d(553)], _0x47dd47 = _0x1a6896[_0x41096d(832)](), _0x3eb95f = Buffer[_0x41096d(1840)](_0x47dd47), _0x444bac = 0, _0x448959 = 0, _0x2b22c3 = 255, _0x5d7252 = Math[_0x41096d(1507)](0, _0xff7554), _0xd1c814 = Math[_0x41096d(1507)](0, _0x339d42), _0x3f9424 = Math[_0x41096d(1125)](_0x6d8aab, _0x51271a - _0x5d7252), _0x493129 = Math[_0x41096d(1125)](_0x24e188, _0x41a0fa - _0xd1c814), _0x321bc6 = 3;
    drawHollowRect(_0x3eb95f, _0x51271a, _0x41a0fa, _0x5d7252, _0xd1c814, _0x3f9424, _0x493129, _0x321bc6, _0x444bac, _0x448959, _0x2b22c3);
    const _0x3acf54 = electron[_0x41096d(1078)][_0x41096d(677)](_0x3eb95f, { "width": _0x51271a, "height": _0x41a0fa });
    if (_0x3acf54[_0x41096d(868)]()) return log[_0x41096d(981)](_0x41096d(423)), _0x591122;
    const _0x108582 = _0x3acf54[_0x41096d(515)]();
    return log[_0x41096d(1341)]("[ImageCrop] Successfully added red outline to screenshot"), _0x108582;
  } catch (_0xf56294) {
    return log[_0x41096d(981)]("[ImageCrop] Error adding outline:", _0xf56294), _0x591122;
  }
}
class ScreenshotOverlay {
  [_0x54a1b7(609)] = null;
  [_0x54a1b7(483)] = ![];
  [_0x54a1b7(1286)](_0x369970) {
    const _0x3c7e3f = _0x54a1b7;
    this[_0x3c7e3f(483)] = ![];
    if (this[_0x3c7e3f(609)] && !this[_0x3c7e3f(609)][_0x3c7e3f(496)]()) {
      log[_0x3c7e3f(1697)]("[ScreenshotOverlay] Overlay already visible");
      return;
    }
    try {
      if (this[_0x3c7e3f(483)]) {
        log[_0x3c7e3f(1341)]("[ScreenshotOverlay] Show cancelled");
        return;
      }
      if (_0x369970 && _0x369970[_0x3c7e3f(1856)]) {
        const _0x431aec = _0x369970[_0x3c7e3f(1856)][_0x3c7e3f(1566)]();
        if (_0x431aec[_0x3c7e3f(1580)]("electron") || _0x431aec[_0x3c7e3f(1580)]("voiceos")) {
          log[_0x3c7e3f(1341)](_0x3c7e3f(1251) + _0x369970[_0x3c7e3f(1856)]);
          return;
        }
      }
      const _0x28ec61 = electron[_0x3c7e3f(451)][_0x3c7e3f(687)](), _0x3810a5 = electron[_0x3c7e3f(451)][_0x3c7e3f(1816)](_0x28ec61), _0x2a3d4e = _0x3810a5[_0x3c7e3f(1810)], _0x2e5bc4 = _0x3810a5[_0x3c7e3f(805)];
      let _0x3a458c, _0x12f18c, _0x1439e2, _0x28e5a4, _0x2311e2;
      if (_0x369970 && _0x369970[_0x3c7e3f(168)]) {
        const _0x39e8b5 = _0x369970[_0x3c7e3f(168)], _0x1f2a24 = _0x39e8b5[_0x3c7e3f(183)] > 0 && _0x39e8b5[_0x3c7e3f(553)] > 0 && _0x39e8b5[_0x3c7e3f(183)] <= 1e4 && _0x39e8b5[_0x3c7e3f(553)] <= 1e4, _0x3a854a = isFullScreenWindow(_0x39e8b5, _0x2a3d4e);
        _0x1f2a24 && !_0x3a854a ? (_0x3a458c = _0x39e8b5["x"], _0x12f18c = _0x39e8b5["y"], _0x1439e2 = _0x39e8b5[_0x3c7e3f(183)], _0x28e5a4 = _0x39e8b5[_0x3c7e3f(553)], _0x2311e2 = _0x3c7e3f(452) + _0x369970[_0x3c7e3f(1856)] + ")", log[_0x3c7e3f(1341)](_0x3c7e3f(1473) + _0x369970[_0x3c7e3f(1856)] + _0x3c7e3f(977) + _0x1439e2 + "x" + _0x28e5a4 + _0x3c7e3f(1351) + _0x3a458c + ", " + _0x12f18c + ")")) : (_0x3a458c = _0x2a3d4e["x"], _0x12f18c = _0x2a3d4e["y"], _0x1439e2 = _0x2a3d4e[_0x3c7e3f(183)], _0x28e5a4 = _0x2a3d4e[_0x3c7e3f(553)], _0x2311e2 = _0x3a854a ? _0x3c7e3f(673) : "display (invalid window bounds)", log[_0x3c7e3f(1341)](_0x3c7e3f(1216) + _0x2311e2 + _0x3c7e3f(415) + _0x1439e2 + "x" + _0x28e5a4 + _0x3c7e3f(1351) + _0x3a458c + ", " + _0x12f18c + ")"));
      } else _0x3a458c = _0x2a3d4e["x"], _0x12f18c = _0x2a3d4e["y"], _0x1439e2 = _0x2a3d4e[_0x3c7e3f(183)], _0x28e5a4 = _0x2a3d4e[_0x3c7e3f(553)], _0x2311e2 = "display (no window detected)", log[_0x3c7e3f(1341)](_0x3c7e3f(1111) + _0x1439e2 + "x" + _0x28e5a4 + _0x3c7e3f(1351) + _0x3a458c + ", " + _0x12f18c + _0x3c7e3f(1275) + _0x2e5bc4);
      if (this[_0x3c7e3f(483)]) {
        log[_0x3c7e3f(1341)]("[ScreenshotOverlay] Show cancelled before window creation");
        return;
      }
      this[_0x3c7e3f(609)] = new electron[_0x3c7e3f(963)]({ "width": _0x1439e2, "height": _0x28e5a4, "x": _0x3a458c, "y": _0x12f18c, "transparent": !![], "frame": ![], "alwaysOnTop": !![], "skipTaskbar": !![], "resizable": ![], "movable": ![], "minimizable": ![], "maximizable": ![], "closable": !![], "focusable": ![], "hasShadow": ![], "type": _0x3c7e3f(1695), "enableLargerThanScreen": !![], "show": ![], "webPreferences": { "nodeIntegration": ![], "contextIsolation": !![], "devTools": !electron[_0x3c7e3f(178)][_0x3c7e3f(1664)] }, "hiddenInMissionControl": !![] }), this[_0x3c7e3f(609)]["on"]("closed", () => {
        const _0x21a6be = _0x3c7e3f;
        log[_0x21a6be(1341)]("[ScreenshotOverlay] Overlay window closed event"), this[_0x21a6be(609)] = null;
      });
      process[_0x3c7e3f(1394)] === "darwin" && (this[_0x3c7e3f(609)][_0x3c7e3f(371)](!![], _0x3c7e3f(1457), 1), this[_0x3c7e3f(609)][_0x3c7e3f(1736)](![]), this[_0x3c7e3f(609)][_0x3c7e3f(1781)](!![], { "visibleOnFullScreen": !![], "skipTransformProcessType": !![] }));
      process[_0x3c7e3f(1394)] === "darwin" && this[_0x3c7e3f(609)][_0x3c7e3f(293)]?.(![]);
      this[_0x3c7e3f(609)][_0x3c7e3f(736)](!![]);
      const _0x3b047f = _0x3c7e3f(1495);
      this[_0x3c7e3f(609)][_0x3c7e3f(1278)](_0x3c7e3f(680) + encodeURIComponent(_0x3b047f));
      if (this[_0x3c7e3f(483)]) {
        log[_0x3c7e3f(1341)]("[ScreenshotOverlay] Show cancelled before display (destroying window)");
        this[_0x3c7e3f(609)] && !this[_0x3c7e3f(609)][_0x3c7e3f(496)]() && this[_0x3c7e3f(609)][_0x3c7e3f(1483)]();
        this[_0x3c7e3f(609)] = null;
        return;
      }
      this[_0x3c7e3f(609)] && !this[_0x3c7e3f(609)][_0x3c7e3f(496)]() && (this[_0x3c7e3f(609)][_0x3c7e3f(1178)](), log[_0x3c7e3f(1341)]("[ScreenshotOverlay] Overlay displayed (inactive)"));
    } catch (_0x21fa0f) {
      log[_0x3c7e3f(981)]("[ScreenshotOverlay] Failed to create overlay:", _0x21fa0f);
    }
  }
  [_0x54a1b7(129)]() {
    const _0x393dee = _0x54a1b7;
    this[_0x393dee(483)] = !![];
    if (this[_0x393dee(609)] && !this[_0x393dee(609)][_0x393dee(496)]()) try {
      this[_0x393dee(609)][_0x393dee(1483)](), this[_0x393dee(609)] = null, log[_0x393dee(1341)]("[ScreenshotOverlay] Overlay hidden and destroyed");
    } catch (_0x530e25) {
      log[_0x393dee(981)]("[ScreenshotOverlay] Error hiding overlay:", _0x530e25);
    }
    else log[_0x393dee(1341)]("[ScreenshotOverlay] Hide called (no window to destroy, but cancelled flag set)");
  }
  [_0x54a1b7(237)]() {
    const _0x304c8d = _0x54a1b7;
    if (this[_0x304c8d(609)]) try {
      !this[_0x304c8d(609)][_0x304c8d(496)]() && this[_0x304c8d(609)][_0x304c8d(1483)](), this[_0x304c8d(609)] = null, log[_0x304c8d(1341)]("[ScreenshotOverlay] Overlay cleaned up");
    } catch (_0x1b232b) {
      log[_0x304c8d(981)]("[ScreenshotOverlay] Error during cleanup:", _0x1b232b);
    }
  }
  [_0x54a1b7(1639)]() {
    const _0x6db233 = _0x54a1b7;
    return this[_0x6db233(609)] !== null && !this[_0x6db233(609)][_0x6db233(496)]();
  }
}
let screenshotOverlay = null;
function getScreenshotOverlay() {
  return !screenshotOverlay && (screenshotOverlay = new ScreenshotOverlay()), screenshotOverlay;
}
dotenv[_0x54a1b7(162)]();
{
  console[_0x54a1b7(926)] = () => {
  }, console[_0x54a1b7(972)] = () => {
  }, console[_0x54a1b7(1341)] = () => {
  };
}
let audioRecorderInitialized = ![], appSessionStartTime = 0;
process["on"]("uncaughtException", async (_0x12d391) => {
  const _0x29132b = _0x54a1b7;
  console[_0x29132b(981)](" Uncaught Exception in Main Process:", _0x12d391);
  try {
    const _0xb95d6f = "https://api.voiceos.com", _0x2ab290 = { "source": _0x29132b(1684), "errorType": _0x12d391[_0x29132b(1276)] || "UncaughtException", "message": _0x12d391[_0x29132b(1486)], "stack": _0x12d391[_0x29132b(1503)], "appVersion": electron[_0x29132b(178)][_0x29132b(177)](), "platform": process[_0x29132b(1394)] + "-" + process[_0x29132b(1129)], "timestamp": Date[_0x29132b(1536)]() };
    await fetch(new URL("/telemetry", _0xb95d6f)[_0x29132b(1450)](), { "method": _0x29132b(1031), "headers": { "Content-Type": "application/json" }, "body": JSON[_0x29132b(1516)](_0x2ab290) });
  } catch (_0x34091e) {
    console[_0x29132b(981)]("Failed to report uncaught exception:", _0x34091e);
  }
}), process["on"]("unhandledRejection", async (_0x294ee9) => {
  const _0x2269c6 = _0x54a1b7, _0x34d498 = _0x294ee9 instanceof Error ? _0x294ee9 : new Error(String(_0x294ee9));
  console[_0x2269c6(981)](" Unhandled Rejection in Main Process:", _0x34d498);
  try {
    const _0xc5cef1 = "https://api.voiceos.com", _0x1a217d = { "source": _0x2269c6(1684), "errorType": "UnhandledRejection", "message": _0x34d498[_0x2269c6(1486)], "stack": _0x34d498[_0x2269c6(1503)], "appVersion": electron[_0x2269c6(178)][_0x2269c6(177)](), "platform": process[_0x2269c6(1394)] + "-" + process[_0x2269c6(1129)], "timestamp": Date[_0x2269c6(1536)]() };
    await fetch(new URL("/telemetry", _0xc5cef1)[_0x2269c6(1450)](), { "method": _0x2269c6(1031), "headers": { "Content-Type": "application/json" }, "body": JSON[_0x2269c6(1516)](_0x1a217d) });
  } catch (_0x2b0828) {
    console[_0x2269c6(981)]("Failed to report unhandled rejection:", _0x2b0828);
  }
});
async function initializeAudioRecorder() {
  const _0x478603 = _0x54a1b7;
  if (audioRecorderInitialized) return console[_0x478603(926)]("[initializeAudioRecorder] Audio recorder already initialized."), !![];
  return console[_0x478603(926)](_0x478603(1851)), voiceInputService[_0x478603(1364)](), await initializeMicrophoneSelection(), audioRecorderInitialized = !![], console[_0x478603(926)]("[initializeAudioRecorder] Audio recorder initialized successfully."), !![];
}
electron[_0x54a1b7(1430)][_0x54a1b7(1233)]([{ "scheme": "res", "privileges": { "standard": !![], "secure": !![], "supportFetchAPI": !![] } }]), electron[_0x54a1b7(178)][_0x54a1b7(957)]()[_0x54a1b7(843)](async () => {
  const _0x303792 = _0x54a1b7;
  appSessionStartTime = Date[_0x303792(1536)](), initializeLogging(), console[_0x303792(1341)]("App starting. Environment diagnostics:", { "ELECTRON_RENDERER_URL": process[_0x303792(1498)][_0x303792(1255)], "ELECTRON_VITE_DEV_SERVER_URL": process[_0x303792(1498)]?.[_0x303792(1550)], "isPackaged": electron[_0x303792(178)][_0x303792(1664)], "platform": process[_0x303792(1394)], "arch": process[_0x303792(1129)] }), captureAppLifecycle(_0x303792(568), { "app_version": electron[_0x303792(178)][_0x303792(177)](), "os_version": process[_0x303792(1394)] + "-" + process[_0x303792(1129)] });
  try {
    await initializeDatabase();
  } catch (_0x1ee690) {
    console[_0x303792(981)](" Failed to initialize database, quitting app.", _0x1ee690);
    return;
  }
  const _0xf45a40 = store[_0x303792(1043)](STORE_KEYS[_0x303792(684)]);
  _0xf45a40 ? (console[_0x303792(926)]("Found stored access token, setting up gRPC client"), grpcClient[_0x303792(1843)](_0xf45a40)) : console[_0x303792(926)](_0x303792(1648));
  setupProtocolHandling(), preventAppNap(), registerResourcesProtocol(), utils[_0x303792(856)][_0x303792(1573)]("com.electron"), registerIPC();
  !electron[_0x303792(178)][_0x303792(1664)] && registerDevIPC();
  createAppWindow(), createPillWindow(), startPillPositioner(), processStartupProtocolUrl();
  mainWindow && grpcClient[_0x303792(1706)](mainWindow);
  const _0x5d4122 = getAccessibilityPermissionStatus();
  console[_0x303792(926)](_0x303792(727) + _0x5d4122);
  _0x5d4122 === _0x303792(808) && (console[_0x303792(926)]("Accessibility permissions found, starting key listener."), startKeyListener(), console[_0x303792(926)]("Starting selected text reader service."), selectedTextReaderService[_0x303792(1247)](), process[_0x303792(1394)] === "darwin" && (console[_0x303792(926)]("Starting window text reader service."), windowTextReaderService[_0x303792(1247)]()));
  let _0x284a3b = _0x5d4122 === _0x303792(808);
  setInterval(() => {
    const _0x91ab9d = _0x303792, _0x163572 = getAccessibilityPermissionStatus(), _0x3fb467 = _0x163572 === _0x91ab9d(808);
    if (_0x3fb467 && !_0x284a3b) console[_0x91ab9d(926)]("Accessibility permission granted, starting key listener."), startKeyListener(), console[_0x91ab9d(926)]("Starting selected text reader service."), selectedTextReaderService[_0x91ab9d(1247)](), process[_0x91ab9d(1394)] === "darwin" && (console[_0x91ab9d(926)]("Starting window text reader service."), windowTextReaderService[_0x91ab9d(1247)]()), _0x284a3b = !![];
    else !_0x3fb467 && _0x284a3b && (console[_0x91ab9d(1697)]("Accessibility permission revoked, stopping key listener to prevent system freeze."), stopKeyListener(), selectedTextReaderService[_0x91ab9d(268)](), process[_0x91ab9d(1394)] === "darwin" && windowTextReaderService[_0x91ab9d(268)](), _0x284a3b = ![]);
  }, 2e3), transcriptionService[_0x303792(1706)](mainWindow);
  const _0x26970f = store[_0x303792(1043)](STORE_KEYS[_0x303792(900)]), _0x295942 = _0x26970f && typeof _0x26970f === _0x303792(656) && typeof _0x26970f[_0x303792(164)] === _0x303792(1670), _0x435d5d = _0x295942 ? _0x26970f[_0x303792(164)] : ![], _0x3210cb = getMicrophonePermissionStatus(), _0x2064e3 = _0x3210cb === _0x303792(808);
  console[_0x303792(926)](_0x303792(1619) + _0x3210cb + _0x303792(236) + _0x435d5d);
  const _0x2e0bef = _0x295942 && _0x435d5d || _0x2064e3;
  _0x2e0bef ? (console[_0x303792(926)](_0x303792(1025) + _0x435d5d + _0x303792(1575) + _0x2064e3 + ")."), await initializeAudioRecorder()) : console[_0x303792(926)]("Deferring audio recorder initialization until microphone permission is granted during onboarding."), !store[_0x303792(1043)](STORE_KEYS[_0x303792(1692)]) && (console[_0x303792(926)](_0x303792(674)), store[_0x303792(1359)](STORE_KEYS[_0x303792(1692)], !![])), await createAppTray(), electron[_0x303792(178)]["on"](_0x303792(826), function() {
    const _0x4ba04f = _0x303792;
    mainWindow === null && (createAppWindow(), mainWindow && grpcClient[_0x4ba04f(1706)](mainWindow));
  }), electron[_0x303792(178)]["on"]("before-quit", async () => {
    const _0x184450 = _0x303792;
    console[_0x184450(926)]("App is quitting, cleaning up resources..."), electron[_0x184450(178)][_0x184450(1556)] = !![];
    const _0x4bd817 = appSessionStartTime ? Date[_0x184450(1536)]() - appSessionStartTime : 0;
    captureAppLifecycle("app_quit", { "app_version": electron[_0x184450(178)][_0x184450(177)](), "os_version": process[_0x184450(1394)] + "-" + process[_0x184450(1129)], "session_duration_ms": _0x4bd817 });
    try {
      getScreenshotOverlay()[_0x184450(237)]();
    } catch (_0x26fe1c) {
      console[_0x184450(981)](" Error cleaning up screenshot overlay:", _0x26fe1c);
    }
    stopKeyListener(), audioRecorderService[_0x184450(268)](), selectedTextReaderService[_0x184450(268)](), windowTextReaderService[_0x184450(268)](), syncService[_0x184450(1146)](), destroyAppTray(), allowAppNap(), await shutdownPostHog();
  }), electron[_0x303792(178)]["on"](_0x303792(914), (_0x471805, _0x177366) => {
    const _0xa4345f = _0x303792;
    utils[_0xa4345f(953)][_0xa4345f(155)](_0x177366);
  }), initializeAutoUpdater();
}), electron[_0x54a1b7(178)]["on"]("window-all-closed", () => {
  const _0x4ccbff = _0x54a1b7;
  process[_0x4ccbff(1394)] !== "darwin" && electron[_0x4ccbff(178)][_0x4ccbff(277)]();
}), exports[_0x54a1b7(455)] = addCaretIndicator, exports[_0x54a1b7(631)] = cropImage, exports[_0x54a1b7(460)] = getActiveWindow, exports[_0x54a1b7(1829)] = getCaretBounds, exports[_0x54a1b7(593)] = initializeAudioRecorder, exports[_0x54a1b7(1632)] = isFullScreenWindow