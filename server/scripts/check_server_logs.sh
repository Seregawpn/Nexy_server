#!/bin/bash
# –°–∫—Ä–∏–ø—Ç –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –ª–æ–≥–æ–≤ –∏ —Å—Ç–∞—Ç—É—Å–∞ —Å–µ—Ä–≤–µ—Ä–∞ –Ω–∞ —É–¥–∞–ª–µ–Ω–Ω–æ–π –º–∞—à–∏–Ω–µ

echo "=================================================================================="
echo "üìã –ü–†–û–í–ï–†–ö–ê –õ–û–ì–û–í –ò –°–¢–ê–¢–£–°–ê –°–ï–†–í–ï–†–ê"
echo "=================================================================================="
echo ""

echo "1. –°–¢–ê–¢–£–° –°–ï–†–í–ò–°–ê:"
echo "--------------------------------------------------------------------------------"
systemctl is-active voice-assistant.service
echo ""

echo "2. –ü–û–°–õ–ï–î–ù–ò–ï 50 –°–¢–†–û–ö –õ–û–ì–û–í:"
echo "--------------------------------------------------------------------------------"
journalctl -u voice-assistant.service --no-pager -n 50
echo ""

echo "3. –û–®–ò–ë–ö–ò (ERROR, Exception, Failed):"
echo "--------------------------------------------------------------------------------"
journalctl -u voice-assistant.service --no-pager -n 500 | grep -iE "ERROR|Exception|Failed|Traceback" | tail -20
echo ""

echo "4. –ü–†–û–¶–ï–°–°–´:"
echo "--------------------------------------------------------------------------------"
ps aux | grep "python.*main.py" | grep -v grep
echo ""

echo "5. –ü–û–†–¢–´:"
echo "--------------------------------------------------------------------------------"
ss -tlnp | grep -E "50051|8080|8081"
echo ""

echo "6. HEALTH ENDPOINT:"
echo "--------------------------------------------------------------------------------"
curl -s http://127.0.0.1:8080/health
echo ""
echo ""

echo "7. –ò–°–¢–û–†–ò–Ø –ó–ê–ü–£–°–ö–û–í (–ø–æ—Å–ª–µ–¥–Ω–∏–π —á–∞—Å):"
echo "--------------------------------------------------------------------------------"
journalctl -u voice-assistant.service --since "1 hour ago" --no-pager | grep -E "Started|Stopped|active|inactive|–∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω" | tail -10
echo ""

echo "8. –ü–†–û–ë–õ–ï–ú–´ –° –ú–û–î–£–õ–Ø–ú–ò:"
echo "--------------------------------------------------------------------------------"
journalctl -u voice-assistant.service --no-pager -n 1000 | grep -iE "(TextProcessor|AudioProcessor|gRPC|database|postgres)" | grep -iE "(error|failed|exception)" | tail -10
echo ""

echo "=================================================================================="
echo "‚úÖ –ü–†–û–í–ï–†–ö–ê –ó–ê–í–ï–†–®–ï–ù–ê"
echo "=================================================================================="
