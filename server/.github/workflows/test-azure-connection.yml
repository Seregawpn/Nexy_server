name: Test Azure Connection

on:
  workflow_dispatch:

jobs:
  test:
    runs-on: ubuntu-latest
    timeout-minutes: 5
    
    steps:
    - name: Azure Login
      uses: azure/login@v1
      with:
        creds: ${{ secrets.AZURE_CREDENTIALS }}
    
    - name: Test Azure Authentication
      run: |
        echo "üîê –¢–µ—Å—Ç–∏—Ä—É–µ–º –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—é..."
        az account show
        
        echo ""
        echo "üîç –¢–µ—Å—Ç–∏—Ä—É–µ–º –¥–æ—Å—Ç—É–ø –∫ VM..."
        az vm show --resource-group Nexy --name nexy-regular --query "name" -o tsv
        
        echo ""
        echo "üß™ –¢–µ—Å—Ç–∏—Ä—É–µ–º –ø—Ä–æ—Å—Ç—É—é –∫–æ–º–∞–Ω–¥—É..."
        az vm run-command invoke \
          --resource-group Nexy \
          --name nexy-regular \
          --command-id RunShellScript \
          --scripts "echo 'GitHub Actions test successful - $(date)'"
        
        echo ""
        echo "‚úÖ –í—Å–µ —Ç–µ—Å—Ç—ã –ø—Ä–æ–π–¥–µ–Ω—ã —É—Å–ø–µ—à–Ω–æ!"
