# üî¥ –ö–†–ò–¢–ò–ß–ï–°–ö–û–ï –ò–°–ü–†–ê–í–õ–ï–ù–ò–ï: –§–æ—Ä–º–∞—Ç—ã –≤–µ—Ä—Å–∏–π

**–î–∞—Ç–∞:** 19 –¥–µ–∫–∞–±—Ä—è 2024  
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –†–ï–®–ï–ù–û  
**–ö—Ä–∏—Ç–∏—á–Ω–æ—Å—Ç—å:** üî¥ –í–´–°–û–ö–ê–Ø - –±–ª–æ–∫–∏—Ä–æ–≤–∞–ª–∞ —Ä–∞–±–æ—Ç—É –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

---

## üö® **–ü–†–û–ë–õ–ï–ú–ê**

### **–°–∏–º–ø—Ç–æ–º—ã:**
- Updater –ø–æ—Å—Ç–æ—è–Ω–Ω–æ –ø—ã—Ç–∞–ª—Å—è –æ–±–Ω–æ–≤–∏—Ç—å—Å—è
- –ë–µ—Å–∫–æ–Ω–µ—á–Ω—ã–µ —Ü–∏–∫–ª—ã –≤ –ª–æ–≥–∞—Ö `~/Library/Logs/Nexy/updater.log`
- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –Ω–µ –º–æ–≥–ª–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
- –î–µ—Å—è—Ç–∫–∏ –ø–æ–ø—ã—Ç–æ–∫ —Å–∫–∞—á–∏–≤–∞–Ω–∏—è –∏ —É—Å—Ç–∞–Ω–æ–≤–∫–∏

### **–ö–æ—Ä–Ω–µ–≤–∞—è –ø—Ä–∏—á–∏–Ω–∞:**
**–ù–µ—Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ —Ñ–æ—Ä–º–∞—Ç–æ–≤ –≤–µ—Ä—Å–∏–π –º–µ–∂–¥—É –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ–º –∏ —Å–µ—Ä–≤–µ—Ä–æ–º –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π**

---

## üìä **–î–ï–¢–ê–õ–¨–ù–´–ô –ê–ù–ê–õ–ò–ó**

### **–§–æ—Ä–º–∞—Ç—ã –≤–µ—Ä—Å–∏–π:**

| –ö–æ–º–ø–æ–Ω–µ–Ω—Ç | –§–æ—Ä–º–∞—Ç | –ó–Ω–∞—á–µ–Ω–∏–µ | –°—Ç–∞—Ç—É—Å |
|-----------|--------|----------|--------|
| **macOS App** | `CFBundleVersion` | `"1.0.1"` (—Å—Ç—Ä–æ–∫–∞) | ‚úÖ –ö–æ—Ä—Ä–µ–∫—Ç–Ω–æ |
| **AppCast XML** | `sparkle:version` | `"1001"` (—á–∏—Å–ª–æ) | ‚ùå –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ |
| **–ú–∞–Ω–∏—Ñ–µ—Å—Ç** | `build` | `1001` (—á–∏—Å–ª–æ) | ‚ùå –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ |

### **–õ–æ–≥–∏–∫–∞ —Å—Ä–∞–≤–Ω–µ–Ω–∏—è –≤ updater:**
```python
# modules/updater/updater.py:70
latest_build > current_build
Version("1001") > Version("1.0.1")  # = True ‚ùå
```

### **–†–µ–∑—É–ª—å—Ç–∞—Ç:**
- Updater **–≤—Å–µ–≥–¥–∞ —Å—á–∏—Ç–∞–ª** –≤–µ—Ä—Å–∏—é —É—Å—Ç–∞—Ä–µ–≤—à–µ–π
- **–ë–µ—Å–∫–æ–Ω–µ—á–Ω—ã–π —Ü–∏–∫–ª:** "–ù–∞–π–¥–µ–Ω–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ ‚Üí —Å–∫–∞—á–∏–≤–∞–Ω–∏–µ ‚Üí relaunch ‚Üí –ø–æ–≤—Ç–æ—Ä"
- **–°–∏—Å—Ç–µ–º–∞ –±–ª–æ–∫–∏—Ä–æ–≤–∞–ª–∞—Å—å** - –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –Ω–µ –º–æ–≥–ª–∏ —Ä–∞–±–æ—Ç–∞—Ç—å

---

## üõ†Ô∏è **–†–ï–®–ï–ù–ò–ï**

### **1. –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞–ª–∏ —Ñ–æ—Ä–º–∞—Ç—ã –≤–µ—Ä—Å–∏–π:**

#### **–ë—ã–ª–æ:**
```json
{
  "version": "1.0.1",
  "build": 1001  // ‚ùå –ß–∏—Å–ª–æ
}
```

#### **–°—Ç–∞–ª–æ:**
```json
{
  "version": "1.0.1", 
  "build": "1.0.1"  // ‚úÖ –°—Ç—Ä–æ–∫–∞
}
```

### **2. AppCast XML –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–±–Ω–æ–≤–∏–ª—Å—è:**

#### **–ë—ã–ª–æ:**
```xml
<sparkle:version="1001">  <!-- ‚ùå –ß–∏—Å–ª–æ -->
```

#### **–°—Ç–∞–ª–æ:**
```xml
<sparkle:version="1.0.1">  <!-- ‚úÖ –°—Ç—Ä–æ–∫–∞ -->
```

### **3. –†–µ–∑—É–ª—å—Ç–∞—Ç —Å—Ä–∞–≤–Ω–µ–Ω–∏—è:**
```python
Version("1.0.1") > Version("1.0.1")  # = False ‚úÖ
```

---

## ‚úÖ **–ü–†–û–í–ï–†–ö–ê –ò–°–ü–†–ê–í–õ–ï–ù–ò–Ø**

### **–ö–æ–º–∞–Ω–¥—ã –ø—Ä–æ–≤–µ—Ä–∫–∏:**
```bash
# 1. –ü—Ä–æ–≤–µ—Ä–∫–∞ AppCast XML:
curl -s http://20.151.51.172:8081/appcast.xml | grep sparkle:version
# –†–µ–∑—É–ª—å—Ç–∞—Ç: sparkle:version="1.0.1"

# 2. –ü—Ä–æ–≤–µ—Ä–∫–∞ Health Check:
curl -s http://20.151.51.172:8081/health | jq '.latest_version, .latest_build'
# –†–µ–∑—É–ª—å—Ç–∞—Ç: "1.0.1", "1.0.1"

# 3. –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–∑–º–µ—Ä–æ–≤ —Ñ–∞–π–ª–æ–≤:
APPCAST_SIZE=$(curl -s http://20.151.51.172:8081/appcast.xml | grep -o 'length="[^"]*"' | cut -d'"' -f2)
GITHUB_SIZE=$(curl -s -L -I https://github.com/Seregawpn/Nexy_production/releases/download/Update/Nexy.dmg | grep -i "content-length:" | tail -1 | awk '{print $2}' | tr -d '\r\n')
echo "AppCast: $APPCAST_SIZE –±–∞–π—Ç"
echo "GitHub:  $GITHUB_SIZE –±–∞–π—Ç"
echo "–°–æ–≤–ø–∞–¥–∞—é—Ç: $([ "$APPCAST_SIZE" = "$GITHUB_SIZE" ] && echo "‚úÖ –î–ê" || echo "‚ùå –ù–ï–¢")"
```

### **–†–µ–∑—É–ª—å—Ç–∞—Ç—ã:**
- ‚úÖ **AppCast XML:** `sparkle:version="1.0.1"`
- ‚úÖ **Health Check:** –í–µ—Ä—Å–∏—è: 1.0.1, Build: 1.0.1
- ‚úÖ **–†–∞–∑–º–µ—Ä—ã —Ñ–∞–π–ª–æ–≤:** –°–æ–≤–ø–∞–¥–∞—é—Ç (97,368,832 –±–∞–π—Ç)
- ‚úÖ **–õ–æ–≥–∏–∫–∞ —Å—Ä–∞–≤–Ω–µ–Ω–∏—è:** –ö–æ—Ä—Ä–µ–∫—Ç–Ω–∞—è

---

## üõ°Ô∏è **–ü–†–ï–î–û–¢–í–†–ê–©–ï–ù–ò–ï –ü–û–í–¢–û–†–ï–ù–ò–Ø**

### **üî¥ –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –ø—Ä–∞–≤–∏–ª–∞:**

#### **1. –í—Å–µ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Å—Ç—Ä–æ–∫–æ–≤—ã–π —Ñ–æ—Ä–º–∞—Ç –≤–µ—Ä—Å–∏–π:**
```json
// ‚úÖ –ü–†–ê–í–ò–õ–¨–ù–û
{
  "version": "1.0.1",
  "build": "1.0.1"  // –°—Ç—Ä–æ–∫–∞, –∫–∞–∫ CFBundleVersion
}

// ‚ùå –ù–ï–ü–†–ê–í–ò–õ–¨–ù–û
{
  "version": "1.0.1",
  "build": 1001  // –ß–∏—Å–ª–æ - –≤—ã–∑–æ–≤–µ—Ç –±–µ—Å–∫–æ–Ω–µ—á–Ω—ã–µ —Ü–∏–∫–ª—ã!
}
```

#### **2. –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä—É–π—Ç–µ —Ñ–æ—Ä–º–∞—Ç—ã –º–µ–∂–¥—É –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞–º–∏:**
- **–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ:** `CFBundleVersion = "1.0.1"`
- **–ú–∞–Ω–∏—Ñ–µ—Å—Ç:** `build: "1.0.1"`
- **AppCast:** `sparkle:version="1.0.1"`

#### **3. –ü—Ä–æ–≤–µ—Ä—è–π—Ç–µ –ø–µ—Ä–µ–¥ –∫–∞–∂–¥—ã–º –¥–µ–ø–ª–æ–µ–º:**
```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ñ–æ—Ä–º–∞—Ç–∞ –≤–µ—Ä—Å–∏–∏ –≤ –º–∞–Ω–∏—Ñ–µ—Å—Ç–µ:
cat manifest_1.0.0.json | jq '.build' | grep -q '^"[0-9]' && echo "‚úÖ –°—Ç—Ä–æ–∫–∞" || echo "‚ùå –ß–∏—Å–ª–æ"

# –ü—Ä–æ–≤–µ—Ä–∫–∞ AppCast XML:
curl -s http://20.151.51.172:8081/appcast.xml | grep sparkle:version | grep -q '"[0-9]' && echo "‚úÖ –°—Ç—Ä–æ–∫–∞" || echo "‚ùå –ß–∏—Å–ª–æ"
```

### **üß™ –ß–µ–∫–ª–∏—Å—Ç –ø–µ—Ä–µ–¥ –¥–µ–ø–ª–æ–µ–º:**
- [ ] –í–µ—Ä—Å–∏—è –≤ –º–∞–Ω–∏—Ñ–µ—Å—Ç–µ - —Å—Ç—Ä–æ–∫–∞ (–Ω–µ —á–∏—Å–ª–æ)
- [ ] Build –≤ –º–∞–Ω–∏—Ñ–µ—Å—Ç–µ - —Å—Ç—Ä–æ–∫–∞ (–Ω–µ —á–∏—Å–ª–æ)
- [ ] –†–∞–∑–º–µ—Ä —Ñ–∞–π–ª–∞ –ø–æ–ª—É—á–µ–Ω —Å GitHub
- [ ] –õ–æ–∫–∞–ª—å–Ω—ã–µ —Ñ–∞–π–ª—ã —É–¥–∞–ª–µ–Ω—ã —Å —Å–µ—Ä–≤–µ—Ä–∞
- [ ] AppCast XML —Å–æ–¥–µ—Ä–∂–∏—Ç –ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
- [ ] Health check –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–µ –≤–µ—Ä—Å–∏–∏
- [ ] **üî¥ –ö–†–ò–¢–ò–ß–ù–û:** –§–æ—Ä–º–∞—Ç—ã –≤–µ—Ä—Å–∏–π —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞–Ω—ã

---

## üìã **–ö–û–ú–ê–ù–î–´ –î–õ–Ø –ë–´–°–¢–†–û–ì–û –ò–°–ü–†–ê–í–õ–ï–ù–ò–Ø**

### **–ï—Å–ª–∏ –ø—Ä–æ–±–ª–µ–º–∞ –ø–æ–≤—Ç–æ—Ä–∏—Ç—Å—è:**

```bash
# 1. –û–±–Ω–æ–≤–∏—Ç—å –º–∞–Ω–∏—Ñ–µ—Å—Ç —Å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–º —Ñ–æ—Ä–º–∞—Ç–æ–º –≤–µ—Ä—Å–∏–∏:
az vm run-command invoke --resource-group "Nexy" --name "nexy-regular" \
  --command-id RunShellScript --scripts "
cd /home/azureuser/voice-assistant/updates/manifests
# –ò–∑–º–µ–Ω–∏—Ç—å build —Å —á–∏—Å–ª–∞ –Ω–∞ —Å—Ç—Ä–æ–∫—É
sed -i 's/\"build\": [0-9]*/\"build\": \"1.0.1\"/' manifest_1.0.0.json
"

# 2. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ:
curl -s http://20.151.51.172:8081/appcast.xml | grep sparkle:version

# 3. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å Health Check:
curl -s http://20.151.51.172:8081/health | jq '.latest_version, .latest_build'
```

---

## üéØ **–ò–¢–û–ì**

**–ü—Ä–æ–±–ª–µ–º–∞ –±—ã–ª–∞ –≤ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω–æ–º –Ω–µ—Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–∏** –º–µ–∂–¥—É —Ñ–æ—Ä–º–∞—Ç–∞–º–∏ –≤–µ—Ä—Å–∏–π –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –∏ —Å–µ—Ä–≤–µ—Ä–∞.

**–¢–µ–ø–µ—Ä—å –≤—Å–µ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞–Ω–æ:**
- ‚úÖ **–§–æ—Ä–º–∞—Ç—ã –≤–µ—Ä—Å–∏–π:** –í—Å–µ —Å—Ç—Ä–æ–∫–æ–≤—ã–µ "1.0.1"
- ‚úÖ **–†–∞–∑–º–µ—Ä—ã —Ñ–∞–π–ª–æ–≤:** –°–æ–≤–ø–∞–¥–∞—é—Ç
- ‚úÖ **–ò—Å—Ç–æ—á–Ω–∏–∫ —Ñ–∞–π–ª–æ–≤:** GitHub CDN
- ‚úÖ **–õ–æ–≥–∏–∫–∞ —Å—Ä–∞–≤–Ω–µ–Ω–∏—è:** –ö–æ—Ä—Ä–µ–∫—Ç–Ω–∞—è
- ‚úÖ **–¶–∏–∫–ª—ã –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π:** –û—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã

**–°–∏—Å—Ç–µ–º–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ!** üöÄ

---

**‚ö†Ô∏è –í–ê–ñ–ù–û:** –≠—Ç–∞ –ø—Ä–æ–±–ª–µ–º–∞ –º–æ–∂–µ—Ç –ø–æ–≤—Ç–æ—Ä–∏—Ç—å—Å—è –ø—Ä–∏ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ–º —Ñ–æ—Ä–º–∞—Ç–µ –≤–µ—Ä—Å–∏–π –≤ –º–∞–Ω–∏—Ñ–µ—Å—Ç–µ. –í—Å–µ–≥–¥–∞ –ø—Ä–æ–≤–µ—Ä—è–π—Ç–µ —Ñ–æ—Ä–º–∞—Ç—ã –ø–µ—Ä–µ–¥ –¥–µ–ø–ª–æ–µ–º!
