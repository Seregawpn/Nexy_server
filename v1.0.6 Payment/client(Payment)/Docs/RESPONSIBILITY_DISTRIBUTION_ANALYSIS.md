# üîç –ê–Ω–∞–ª–∏–∑ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç–∏ –º–µ–∂–¥—É –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞–º–∏

## üìã –¢–µ–∫—É—â–µ–µ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç–∏

### 1. **InputProcessingIntegration** (–û–±—Ä–∞–±–æ—Ç–∫–∞ –∫–ª–∞–≤–∏–∞—Ç—É—Ä—ã)
**–û—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å:**
- ‚úÖ –û–±—Ä–∞–±–æ—Ç–∫–∞ —Å–æ–±—ã—Ç–∏–π –∫–ª–∞–≤–∏–∞—Ç—É—Ä—ã (PRESS, LONG_PRESS, RELEASE, SHORT_PRESS)
- ‚úÖ –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ–º –∫–æ–º–±–∏–Ω–∞—Ü–∏–∏ (InputState: IDLE, PENDING, LISTENING, PROCESSING)
- ‚úÖ –ü—É–±–ª–∏–∫–∞—Ü–∏—è `voice.recording_start` –ø—Ä–∏ LONG_PRESS
- ‚úÖ –ü—É–±–ª–∏–∫–∞—Ü–∏—è `voice.recording_stop` –ø—Ä–∏ RELEASE –∏–ª–∏ SHORT_PRESS
- ‚úÖ –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ session_id —á–µ—Ä–µ–∑ `state_manager`
- ‚ùå **–ü–†–û–ë–õ–ï–ú–ê:** –ü—É–±–ª–∏–∫—É–µ—Ç `voice.mic_closed` –Ω–∞–ø—Ä—è–º—É—é (—Å—Ç—Ä–æ–∫–∏ 912, 1402, 739) - —ç—Ç–æ –Ω–∞—Ä—É—à–µ–Ω–∏–µ –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç–∏

**–ù–ï –¥–æ–ª–∂–µ–Ω:**
- ‚ùå –£–ø—Ä–∞–≤–ª—è—Ç—å –º–∏–∫—Ä–æ—Ñ–æ–Ω–æ–º –Ω–∞–ø—Ä—è–º—É—é
- ‚ùå –ü—É–±–ª–∏–∫–æ–≤–∞—Ç—å `voice.mic_opened` –∏–ª–∏ `voice.mic_closed` (—ç—Ç–æ –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å `MicrophoneStateManager`)

---

### 2. **VoiceRecognitionIntegration** (–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏–µ–º)
**–û—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å:**
- ‚úÖ –ü–æ–¥–ø–∏—Å–∫–∞ –Ω–∞ `voice.recording_start` –∏ `voice.recording_stop`
- ‚úÖ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ `MicrophoneStateManager` –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Å–æ—Å—Ç–æ—è–Ω–∏–µ–º –º–∏–∫—Ä–æ—Ñ–æ–Ω–∞
- ‚úÖ –ü—É–±–ª–∏–∫–∞—Ü–∏—è `microphone.opened/closed/error` –≤ –æ—Ç–≤–µ—Ç –Ω–∞ –∑–∞–ø—Ä–æ—Å—ã –æ—Ç `MicrophoneStateManager`
- ‚úÖ –ö–æ–æ—Ä–¥–∏–Ω–∞—Ü–∏—è —Å `SpeechRecognizer` –¥–ª—è –Ω–∏–∑–∫–æ—É—Ä–æ–≤–Ω–µ–≤–æ–π —Ä–∞–±–æ—Ç—ã —Å –º–∏–∫—Ä–æ—Ñ–æ–Ω–æ–º
- ‚ùå **–ü–†–û–ë–õ–ï–ú–ê:** –ü—É–±–ª–∏–∫—É–µ—Ç `voice.mic_opened` –Ω–∞–ø—Ä—è–º—É—é (—Å—Ç—Ä–æ–∫–∞ 351) - —ç—Ç–æ –Ω–∞—Ä—É—à–µ–Ω–∏–µ –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç–∏
- ‚ùå **–ü–†–û–ë–õ–ï–ú–ê:** –ü—É–±–ª–∏–∫—É–µ—Ç `voice.mic_closed` –Ω–∞–ø—Ä—è–º—É—é (—Å—Ç—Ä–æ–∫–∏ 465, 497) - —ç—Ç–æ –Ω–∞—Ä—É—à–µ–Ω–∏–µ –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç–∏

**–ù–ï –¥–æ–ª–∂–µ–Ω:**
- ‚ùå –ü—É–±–ª–∏–∫–æ–≤–∞—Ç—å `voice.mic_opened` –∏–ª–∏ `voice.mic_closed` –Ω–∞–ø—Ä—è–º—É—é (—ç—Ç–æ –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å `MicrophoneStateManager`)

---

### 3. **MicrophoneStateManager** (–¶–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ–º –º–∏–∫—Ä–æ—Ñ–æ–Ω–∞)
**–û—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å:**
- ‚úÖ –ï–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω—ã–π –∏—Å—Ç–æ—á–Ω–∏–∫ –∏—Å—Ç–∏–Ω—ã –¥–ª—è —Å–æ—Å—Ç–æ—è–Ω–∏—è –º–∏–∫—Ä–æ—Ñ–æ–Ω–∞
- ‚úÖ –ü—É–±–ª–∏–∫–∞—Ü–∏—è `microphone.open_requested` –∏ `microphone.close_requested`
- ‚úÖ –ü–æ–¥–ø–∏—Å–∫–∞ –Ω–∞ `microphone.opened/closed/error` –æ—Ç `VoiceRecognitionIntegration`
- ‚úÖ –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è —Å–æ—Å—Ç–æ—è–Ω–∏—è —Å `ApplicationStateManager`
- ‚ùå **–ü–†–û–ë–õ–ï–ú–ê:** –ù–ï –ø—É–±–ª–∏–∫—É–µ—Ç `voice.mic_opened` –∏ `voice.mic_closed` - —ç—Ç–æ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å –µ–≥–æ –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å—é

**–î–û–õ–ñ–ï–ù:**
- ‚úÖ –ü—É–±–ª–∏–∫–æ–≤–∞—Ç—å `voice.mic_opened` –ø–æ—Å–ª–µ –ø–æ–ª—É—á–µ–Ω–∏—è `microphone.opened`
- ‚úÖ –ü—É–±–ª–∏–∫–æ–≤–∞—Ç—å `voice.mic_closed` –ø–æ—Å–ª–µ –ø–æ–ª—É—á–µ–Ω–∏—è `microphone.closed` –∏–ª–∏ –ø—Ä–∏ –ø—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ–º –∑–∞–∫—Ä—ã—Ç–∏–∏

---

### 4. **SpeechRecognizer** (–ù–∏–∑–∫–æ—É—Ä–æ–≤–Ω–µ–≤–∞—è —Ä–∞–±–æ—Ç–∞ —Å –º–∏–∫—Ä–æ—Ñ–æ–Ω–æ–º)
**–û—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å:**
- ‚úÖ –û—Ç–∫—Ä—ã—Ç–∏–µ/–∑–∞–∫—Ä—ã—Ç–∏–µ –∞—É–¥–∏–æ –ø–æ—Ç–æ–∫–∞ —á–µ—Ä–µ–∑ PortAudio
- ‚úÖ –ó–∞–ø–∏—Å—å –∞—É–¥–∏–æ –¥–∞–Ω–Ω—ã—Ö
- ‚úÖ –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ –Ω–∞ —É—Ä–æ–≤–Ω–µ –ø–æ—Ç–æ–∫–∞

**–ù–ï –¥–æ–ª–∂–µ–Ω:**
- ‚ùå –£–ø—Ä–∞–≤–ª—è—Ç—å —Å–æ—Å—Ç–æ—è–Ω–∏–µ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
- ‚ùå –ü—É–±–ª–∏–∫–æ–≤–∞—Ç—å —Å–æ–±—ã—Ç–∏—è –≤ EventBus

---

## üêõ –í—ã—è–≤–ª–µ–Ω–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã

### –ü—Ä–æ–±–ª–µ–º–∞ 1: –î—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—É–±–ª–∏–∫–∞—Ü–∏–∏ `voice.mic_opened` (–ö–†–ò–¢–ò–ß–ï–°–ö–ê–Ø)

**–¢–µ–∫—É—â–∞—è —Å–∏—Ç—É–∞—Ü–∏—è:**
1. `VoiceRecognitionIntegration._on_recording_start` (—Å—Ç—Ä–æ–∫–∞ 351) –ø—É–±–ª–∏–∫—É–µ—Ç `voice.mic_opened` –°–†–ê–ó–£ –ø—Ä–∏ `recording_start`
2. `MicrophoneStateManager` –¥–æ–ª–∂–µ–Ω –ø—É–±–ª–∏–∫–æ–≤–∞—Ç—å —ç—Ç–æ —Å–æ–±—ã—Ç–∏–µ –ø–æ—Å–ª–µ –ø–æ–ª—É—á–µ–Ω–∏—è `microphone.opened`

**–ü—Ä–æ–±–ª–µ–º—ã:**
- –î—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–æ–±—ã—Ç–∏–π (–º–æ–∂–µ—Ç –ø—Ä–∏–≤–µ—Å—Ç–∏ –∫ –¥–≤–æ–π–Ω–æ–º—É –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏—é —Å–∏–≥–Ω–∞–ª–∞)
- –ù–µ—Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–Ω–æ—Å—Ç—å: `voice.mic_opened` –ø—É–±–ª–∏–∫—É–µ—Ç—Å—è –î–û —Ñ–∞–∫—Ç–∏—á–µ—Å–∫–æ–≥–æ –æ—Ç–∫—Ä—ã—Ç–∏—è –º–∏–∫—Ä–æ—Ñ–æ–Ω–∞
- –ù–∞—Ä—É—à–µ–Ω–∏–µ –ø—Ä–∏–Ω—Ü–∏–ø–∞ –µ–¥–∏–Ω–æ–π –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç–∏

**–ü—Ä–∞–≤–∏–ª—å–Ω–∞—è –ª–æ–≥–∏–∫–∞:**
```
voice.recording_start ‚Üí VoiceRecognitionIntegration ‚Üí MicrophoneStateManager.request_open()
‚Üí microphone.open_requested ‚Üí VoiceRecognitionIntegration ‚Üí SpeechRecognizer.start_listening()
‚Üí microphone.opened ‚Üí MicrophoneStateManager ‚Üí voice.mic_opened (–ï–î–ò–ù–°–¢–í–ï–ù–ù–´–ô –ò–°–¢–û–ß–ù–ò–ö)
```

---

### –ü—Ä–æ–±–ª–µ–º–∞ 2: –î—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—É–±–ª–∏–∫–∞—Ü–∏–∏ `voice.mic_closed` (–ö–†–ò–¢–ò–ß–ï–°–ö–ê–Ø)

**–¢–µ–∫—É—â–∞—è —Å–∏—Ç—É–∞—Ü–∏—è:**
1. `InputProcessingIntegration` –ø—É–±–ª–∏–∫—É–µ—Ç `voice.mic_closed` –≤ 3 –º–µ—Å—Ç–∞—Ö:
   - –°—Ç—Ä–æ–∫–∞ 912: –ø—Ä–∏ SHORT_PRESS (force_close_on_short_press)
   - –°—Ç—Ä–æ–∫–∞ 1402: –ø—Ä–∏ RELEASE (force_close_on_release)
   - –°—Ç—Ä–æ–∫–∞ 739: –ø—Ä–∏ —Ç–∞–π–º–∞—É—Ç–µ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ –º–∏–∫—Ä–æ—Ñ–æ–Ω–∞
2. `VoiceRecognitionIntegration` –ø—É–±–ª–∏–∫—É–µ—Ç `voice.mic_closed` –≤ 2 –º–µ—Å—Ç–∞—Ö:
   - –°—Ç—Ä–æ–∫–∞ 465: –ø—Ä–∏ –ø—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ–π –æ—Å—Ç–∞–Ω–æ–≤–∫–µ –±–µ–∑ session_id
   - –°—Ç—Ä–æ–∫–∞ 497: –ø—Ä–∏ –Ω–æ—Ä–º–∞–ª—å–Ω–æ–π –æ—Å—Ç–∞–Ω–æ–≤–∫–µ –∑–∞–ø–∏—Å–∏
3. `MicrophoneStateManager` –ù–ï –ø—É–±–ª–∏–∫—É–µ—Ç `voice.mic_closed`

**–ü—Ä–æ–±–ª–µ–º—ã:**
- –ú–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ –∏—Å—Ç–æ—á–Ω–∏–∫–∏ —Å–æ–±—ã—Ç–∏—è (–º–æ–∂–µ—Ç –ø—Ä–∏–≤–µ—Å—Ç–∏ –∫ –¥–≤–æ–π–Ω–æ–º—É/—Ç—Ä–æ–π–Ω–æ–º—É —Å—Ä–∞–±–∞—Ç—ã–≤–∞–Ω–∏—é)
- –ù–∞—Ä—É—à–µ–Ω–∏–µ –ø—Ä–∏–Ω—Ü–∏–ø–∞ –µ–¥–∏–Ω–æ–π –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç–∏
- –ù–µ–≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å —Ü–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–æ–≥–æ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Å–æ–±—ã—Ç–∏—è–º–∏ –º–∏–∫—Ä–æ—Ñ–æ–Ω–∞

**–ü—Ä–∞–≤–∏–ª—å–Ω–∞—è –ª–æ–≥–∏–∫–∞:**
```
voice.recording_stop ‚Üí VoiceRecognitionIntegration ‚Üí MicrophoneStateManager.request_close()
‚Üí microphone.close_requested ‚Üí VoiceRecognitionIntegration ‚Üí SpeechRecognizer.stop_listening()
‚Üí microphone.closed ‚Üí MicrophoneStateManager ‚Üí voice.mic_closed (–ï–î–ò–ù–°–¢–í–ï–ù–ù–´–ô –ò–°–¢–û–ß–ù–ò–ö)
```

---

### –ü—Ä–æ–±–ª–µ–º–∞ 3: –ù–∞—Ä—É—à–µ–Ω–∏–µ –ø—Ä–∏–Ω—Ü–∏–ø–∞ –µ–¥–∏–Ω–æ–π –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç–∏

**–¢–µ–∫—É—â–∞—è —Å–∏—Ç—É–∞—Ü–∏—è:**
- `InputProcessingIntegration` —É–ø—Ä–∞–≤–ª—è–µ—Ç –∫–ª–∞–≤–∏–∞—Ç—É—Ä–æ–π –ò –ø—ã—Ç–∞–µ—Ç—Å—è —É–ø—Ä–∞–≤–ª—è—Ç—å –º–∏–∫—Ä–æ—Ñ–æ–Ω–æ–º (–ø—É–±–ª–∏–∫—É–µ—Ç `voice.mic_closed`)
- `VoiceRecognitionIntegration` —É–ø—Ä–∞–≤–ª—è–µ—Ç —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏–µ–º –ò –ø—ã—Ç–∞–µ—Ç—Å—è —É–ø—Ä–∞–≤–ª—è—Ç—å —Å–æ–±—ã—Ç–∏—è–º–∏ –º–∏–∫—Ä–æ—Ñ–æ–Ω–∞ (–ø—É–±–ª–∏–∫—É–µ—Ç `voice.mic_opened/closed`)
- `MicrophoneStateManager` –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –µ–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω—ã–º –∏—Å—Ç–æ—á–Ω–∏–∫–æ–º —Å–æ–±—ã—Ç–∏–π –º–∏–∫—Ä–æ—Ñ–æ–Ω–∞, –Ω–æ –Ω–µ –ø—É–±–ª–∏–∫—É–µ—Ç –∏—Ö

**–ü—Ä–∞–≤–∏–ª—å–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞:**
```
InputProcessingIntegration ‚Üí voice.recording_start/stop (—Ç–æ–ª—å–∫–æ —Å–æ–±—ã—Ç–∏—è –∑–∞–ø–∏—Å–∏)
VoiceRecognitionIntegration ‚Üí microphone.opened/closed/error (—Ç–æ–ª—å–∫–æ —Å–æ–±—ã—Ç–∏—è –º–∏–∫—Ä–æ—Ñ–æ–Ω–∞)
MicrophoneStateManager ‚Üí voice.mic_opened/closed (–µ–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω—ã–π –∏—Å—Ç–æ—á–Ω–∏–∫ –¥–ª—è UI/—Å–∏–≥–Ω–∞–ª–æ–≤)
```

---

## ‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω–æ–µ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç–∏

### InputProcessingIntegration
**–î–û–õ–ñ–ï–ù:**
- ‚úÖ –û–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å —Å–æ–±—ã—Ç–∏—è –∫–ª–∞–≤–∏–∞—Ç—É—Ä—ã
- ‚úÖ –£–ø—Ä–∞–≤–ª—è—Ç—å —Å–æ—Å—Ç–æ—è–Ω–∏–µ–º –∫–æ–º–±–∏–Ω–∞—Ü–∏–∏ (InputState)
- ‚úÖ –ü—É–±–ª–∏–∫–æ–≤–∞—Ç—å `voice.recording_start` –ø—Ä–∏ LONG_PRESS
- ‚úÖ –ü—É–±–ª–∏–∫–æ–≤–∞—Ç—å `voice.recording_stop` –ø—Ä–∏ RELEASE/SHORT_PRESS
- ‚úÖ –ü–æ–¥–ø–∏—Å—ã–≤–∞—Ç—å—Å—è –Ω–∞ `voice.mic_opened/closed` –¥–ª—è –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ (–Ω–æ –ù–ï –ø—É–±–ª–∏–∫–æ–≤–∞—Ç—å)

**–ù–ï –î–û–õ–ñ–ï–ù:**
- ‚ùå –ü—É–±–ª–∏–∫–æ–≤–∞—Ç—å `voice.mic_opened` –∏–ª–∏ `voice.mic_closed`
- ‚ùå –£–ø—Ä–∞–≤–ª—è—Ç—å –º–∏–∫—Ä–æ—Ñ–æ–Ω–æ–º –Ω–∞–ø—Ä—è–º—É—é

---

### VoiceRecognitionIntegration
**–î–û–õ–ñ–ï–ù:**
- ‚úÖ –ü–æ–¥–ø–∏—Å—ã–≤–∞—Ç—å—Å—è –Ω–∞ `voice.recording_start/stop`
- ‚úÖ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `MicrophoneStateManager` –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –º–∏–∫—Ä–æ—Ñ–æ–Ω–æ–º
- ‚úÖ –ü—É–±–ª–∏–∫–æ–≤–∞—Ç—å `microphone.opened/closed/error` –≤ –æ—Ç–≤–µ—Ç –Ω–∞ –∑–∞–ø—Ä–æ—Å—ã –æ—Ç `MicrophoneStateManager`
- ‚úÖ –ö–æ–æ—Ä–¥–∏–Ω–∏—Ä–æ–≤–∞—Ç—å —Ä–∞–±–æ—Ç—É —Å `SpeechRecognizer`

**–ù–ï –î–û–õ–ñ–ï–ù:**
- ‚ùå –ü—É–±–ª–∏–∫–æ–≤–∞—Ç—å `voice.mic_opened` –∏–ª–∏ `voice.mic_closed` –Ω–∞–ø—Ä—è–º—É—é
- ‚ùå –£–ø—Ä–∞–≤–ª—è—Ç—å —Å–æ—Å—Ç–æ—è–Ω–∏–µ–º –º–∏–∫—Ä–æ—Ñ–æ–Ω–∞ –Ω–∞–ø—Ä—è–º—É—é (—Ç–æ–ª—å–∫–æ —á–µ—Ä–µ–∑ `MicrophoneStateManager`)

---

### MicrophoneStateManager
**–î–û–õ–ñ–ï–ù:**
- ‚úÖ –ë—ã—Ç—å –µ–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω—ã–º –∏—Å—Ç–æ—á–Ω–∏–∫–æ–º –∏—Å—Ç–∏–Ω—ã –¥–ª—è —Å–æ—Å—Ç–æ—è–Ω–∏—è –º–∏–∫—Ä–æ—Ñ–æ–Ω–∞
- ‚úÖ –ü—É–±–ª–∏–∫–æ–≤–∞—Ç—å `microphone.open_requested` –∏ `microphone.close_requested`
- ‚úÖ –ü–æ–¥–ø–∏—Å—ã–≤–∞—Ç—å—Å—è –Ω–∞ `microphone.opened/closed/error`
- ‚úÖ **–ü—É–±–ª–∏–∫–æ–≤–∞—Ç—å `voice.mic_opened` –ø–æ—Å–ª–µ –ø–æ–ª—É—á–µ–Ω–∏—è `microphone.opened`**
- ‚úÖ **–ü—É–±–ª–∏–∫–æ–≤–∞—Ç—å `voice.mic_closed` –ø–æ—Å–ª–µ –ø–æ–ª—É—á–µ–Ω–∏—è `microphone.closed` –∏–ª–∏ –ø—Ä–∏ –ø—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ–º –∑–∞–∫—Ä—ã—Ç–∏–∏**
- ‚úÖ –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞—Ç—å —Å–æ—Å—Ç–æ—è–Ω–∏–µ —Å `ApplicationStateManager`

---

## üîß –ü–ª–∞–Ω –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π

### –≠—Ç–∞–ø 1: –£–±—Ä–∞—Ç—å –ø—É–±–ª–∏–∫–∞—Ü–∏—é `voice.mic_opened` –∏–∑ `VoiceRecognitionIntegration`
- –£–¥–∞–ª–∏—Ç—å —Å—Ç—Ä–æ–∫—É 351: `await self.event_bus.publish("voice.mic_opened", ...)`
- `MicrophoneStateManager` –±—É–¥–µ—Ç –ø—É–±–ª–∏–∫–æ–≤–∞—Ç—å —ç—Ç–æ —Å–æ–±—ã—Ç–∏–µ –ø–æ—Å–ª–µ –ø–æ–ª—É—á–µ–Ω–∏—è `microphone.opened`

### –≠—Ç–∞–ø 2: –£–±—Ä–∞—Ç—å –ø—É–±–ª–∏–∫–∞—Ü–∏—é `voice.mic_closed` –∏–∑ `InputProcessingIntegration`
- –£–¥–∞–ª–∏—Ç—å —Å—Ç—Ä–æ–∫–∏ 912, 1402, 739: `await self.event_bus.publish("voice.mic_closed", ...)`
- `MicrophoneStateManager` –±—É–¥–µ—Ç –ø—É–±–ª–∏–∫–æ–≤–∞—Ç—å —ç—Ç–æ —Å–æ–±—ã—Ç–∏–µ –ø–æ—Å–ª–µ –ø–æ–ª—É—á–µ–Ω–∏—è `microphone.closed`

### –≠—Ç–∞–ø 3: –£–±—Ä–∞—Ç—å –ø—É–±–ª–∏–∫–∞—Ü–∏—é `voice.mic_closed` –∏–∑ `VoiceRecognitionIntegration`
- –£–¥–∞–ª–∏—Ç—å —Å—Ç—Ä–æ–∫–∏ 465, 497: `await self.event_bus.publish("voice.mic_closed", ...)`
- `MicrophoneStateManager` –±—É–¥–µ—Ç –ø—É–±–ª–∏–∫–æ–≤–∞—Ç—å —ç—Ç–æ —Å–æ–±—ã—Ç–∏–µ –ø–æ—Å–ª–µ –ø–æ–ª—É—á–µ–Ω–∏—è `microphone.closed`

### –≠—Ç–∞–ø 4: –î–æ–±–∞–≤–∏—Ç—å –ø—É–±–ª–∏–∫–∞—Ü–∏—é `voice.mic_opened/closed` –≤ `MicrophoneStateManager`
- –í `_on_microphone_opened`: –ø—É–±–ª–∏–∫–æ–≤–∞—Ç—å `voice.mic_opened`
- –í `_on_microphone_closed`: –ø—É–±–ª–∏–∫–æ–≤–∞—Ç—å `voice.mic_closed`
- –í `_force_close_internal`: –ø—É–±–ª–∏–∫–æ–≤–∞—Ç—å `voice.mic_closed` –ø—Ä–∏ –ø—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ–º –∑–∞–∫—Ä—ã—Ç–∏–∏

---

## üìä –î–∏–∞–≥—Ä–∞–º–º–∞ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–≥–æ –ø–æ—Ç–æ–∫–∞ —Å–æ–±—ã—Ç–∏–π

```
[–ö–ª–∞–≤–∏–∞—Ç—É—Ä–∞] ‚Üí InputProcessingIntegration
    ‚Üì
voice.recording_start
    ‚Üì
VoiceRecognitionIntegration._on_recording_start
    ‚Üì
MicrophoneStateManager.request_open()
    ‚Üì
microphone.open_requested
    ‚Üì
VoiceRecognitionIntegration._on_microphone_open_requested
    ‚Üì
SpeechRecognizer.start_listening()
    ‚Üì
microphone.opened
    ‚Üì
MicrophoneStateManager._on_microphone_opened
    ‚Üì
voice.mic_opened (–ï–î–ò–ù–°–¢–í–ï–ù–ù–´–ô –ò–°–¢–û–ß–ù–ò–ö)
    ‚Üì
[SignalIntegration, TrayControllerIntegration, InputProcessingIntegration]
```

---

## ‚úÖ –ö—Ä–∏—Ç–µ—Ä–∏–∏ —É—Å–ø–µ—Ö–∞

1. ‚úÖ `voice.mic_opened` –ø—É–±–ª–∏–∫—É–µ—Ç—Å—è –¢–û–õ–¨–ö–û –∏–∑ `MicrophoneStateManager`
2. ‚úÖ `voice.mic_closed` –ø—É–±–ª–∏–∫—É–µ—Ç—Å—è –¢–û–õ–¨–ö–û –∏–∑ `MicrophoneStateManager`
3. ‚úÖ `InputProcessingIntegration` –ù–ï –ø—É–±–ª–∏–∫—É–µ—Ç —Å–æ–±—ã—Ç–∏—è –º–∏–∫—Ä–æ—Ñ–æ–Ω–∞
4. ‚úÖ `VoiceRecognitionIntegration` –ù–ï –ø—É–±–ª–∏–∫—É–µ—Ç `voice.mic_opened/closed` –Ω–∞–ø—Ä—è–º—É—é
5. ‚úÖ –í—Å–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –ø–æ–¥–ø–∏—Å—ã–≤–∞—é—Ç—Å—è –Ω–∞ —Å–æ–±—ã—Ç–∏—è –º–∏–∫—Ä–æ—Ñ–æ–Ω–∞, –Ω–æ –Ω–µ –ø—É–±–ª–∏–∫—É—é—Ç –∏—Ö

---

## üéØ –ò—Ç–æ–≥–æ–≤–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ InputProcessingIntegration‚îÇ
‚îÇ - –û–±—Ä–∞–±–æ—Ç–∫–∞ –∫–ª–∞–≤–∏–∞—Ç—É—Ä—ã   ‚îÇ
‚îÇ - voice.recording_start  ‚îÇ
‚îÇ - voice.recording_stop   ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
            ‚îÇ
            ‚Üì
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ VoiceRecognitionIntegration‚îÇ
‚îÇ - microphone.opened     ‚îÇ
‚îÇ - microphone.closed     ‚îÇ
‚îÇ - microphone.error      ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
            ‚îÇ
            ‚Üì
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ MicrophoneStateManager   ‚îÇ
‚îÇ - voice.mic_opened       ‚îÇ ‚Üê –ï–î–ò–ù–°–¢–í–ï–ù–ù–´–ô –ò–°–¢–û–ß–ù–ò–ö
‚îÇ - voice.mic_closed       ‚îÇ ‚Üê –ï–î–ò–ù–°–¢–í–ï–ù–ù–´–ô –ò–°–¢–û–ß–ù–ò–ö
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
            ‚îÇ
            ‚Üì
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ SignalIntegration        ‚îÇ
‚îÇ TrayControllerIntegration‚îÇ
‚îÇ InputProcessingIntegration‚îÇ
‚îÇ (–ø–æ–¥–ø–∏—Å—á–∏–∫–∏)            ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```


