# üîÑ –ü–æ—Ç–æ–∫–∏ –¥–∞–Ω–Ω—ã—Ö

**‚Üí –û—Å–Ω–æ–≤–Ω–æ–π –¥–æ–∫—É–º–µ–Ω—Ç:** `../APPLICATION_FLOW_SCHEMA.md`

---

## üìã –ö—Ä–∞—Ç–∫–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ

–ü–æ—Ç–æ–∫–∏ –¥–∞–Ω–Ω—ã—Ö –æ–ø–∏—Å—ã–≤–∞—é—Ç –≤—Å–µ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è –º–µ–∂–¥—É –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞–º–∏ —Å–∏—Å—Ç–µ–º—ã.

---

## üîó –ü–æ–ª–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

**–°–º. `../APPLICATION_FLOW_SCHEMA.md`** –¥–ª—è:
- –î–µ—Ç–∞–ª—å–Ω–æ–π —Å—Ö–µ–º—ã –≤—Å–µ—Ö flow
- –í–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤
- –ü–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –æ–ø–µ—Ä–∞—Ü–∏–π

**–°–º. —Ç–∞–∫–∂–µ `../COMPLETE_SYSTEM_LOGIC.md` —Ä–∞–∑–¥–µ–ª "üîÑ –ü–æ–ª–Ω—ã–π Flow –æ–±—Ä–∞–±–æ—Ç–∫–∏ –¥–∞–Ω–Ω—ã—Ö"**

---

## üìù –û—Å–Ω–æ–≤–Ω—ã–µ –ø–æ—Ç–æ–∫–∏

### 1. User Request Flow

```
User ‚Üí Client ‚Üí gRPC ‚Üí Server
  ‚Üì
Server: Subscription Context (cache/DB)
  ‚Üì
Server: LLM (Gemini) —Å –∫–æ–Ω—Ç–µ–∫—Å—Ç–æ–º
  ‚Üì
Server: –ü–∞—Ä—Å–∏–Ω–≥ –∫–æ–º–∞–Ω–¥—ã (–µ—Å–ª–∏ –µ—Å—Ç—å)
  ‚Üì
Server: –í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –∫–æ–º–∞–Ω–¥—ã (Stripe API)
  ‚Üì
Server: –û—Ç–ø—Ä–∞–≤–∫–∞ URL –Ω–∞ –∫–ª–∏–µ–Ω—Ç (action_message)
  ‚Üì
Client: –û—Ç–∫—Ä—ã—Ç–∏–µ URL –≤ –±—Ä–∞—É–∑–µ—Ä–µ
  ‚Üì
Server: TTS –≥–µ–Ω–µ—Ä–∞—Ü–∏—è
  ‚Üì
Client: –í–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–µ –∞—É–¥–∏–æ
```

### 2. Webhook Flow

```
Stripe ‚Üí Webhook ‚Üí Server
  ‚Üì
Server: –í–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—è signature
  ‚Üì
Server: –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥—É–±–ª–∏–∫–∞—Ç–æ–≤ (subscription_events)
  ‚Üì
Server: –û–±—Ä–∞–±–æ—Ç–∫–∞ —Å–æ–±—ã—Ç–∏—è
  ‚Üì
Server: –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ë–î
  ‚Üì
Server: –ò–Ω–≤–∞–ª–∏–¥–∞—Ü–∏—è –∫—ç—à–∞
```

### 3. Deep Link Flow

```
Stripe Checkout/Portal ‚Üí Deep Link (nexy://payment/*)
  ‚Üì
Client: PaymentIntegration –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç URL
  ‚Üì
Client: gRPC –∑–∞–ø—Ä–æ—Å –Ω–∞ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—é
  ‚Üì
Server: –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞ –∏–∑ –ë–î
  ‚Üì
Server: –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è —Å–æ Stripe (–µ—Å–ª–∏ –Ω—É–∂–Ω–æ)
  ‚Üì
Server: TTS —Å –æ–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–º —Å—Ç–∞—Ç—É—Å–æ–º
```

---

**–°–ª–µ–¥—É—é—â–∏–π —à–∞–≥:** –û—Ç–∫—Ä–æ–π—Ç–µ `../APPLICATION_FLOW_SCHEMA.md` –¥–ª—è –¥–µ—Ç–∞–ª—å–Ω–æ–π —Å—Ö–µ–º—ã

