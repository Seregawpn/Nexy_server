# üé§ –û—Ç—á–µ—Ç –æ —Ä–µ—à–µ–Ω–∏–∏ –ø—Ä–æ–±–ª–µ–º—ã –∞–∫—Ç–∏–≤–∞—Ü–∏–∏ –º–∏–∫—Ä–æ—Ñ–æ–Ω–∞

## üìã –ü—Ä–æ–±–ª–µ–º–∞
–ú–∏–∫—Ä–æ—Ñ–æ–Ω –±—ã–ª –ø–æ—Å—Ç–æ—è–Ω–Ω–æ –∞–∫—Ç–∏–≤–µ–Ω –≤–º–µ—Å—Ç–æ –∞–∫—Ç–∏–≤–∞—Ü–∏–∏ —Ç–æ–ª—å–∫–æ –ø—Ä–∏ –ø–µ—Ä–µ—Ö–æ–¥–µ –≤ —Ä–µ–∂–∏–º LISTENING.

## üîç –ö–æ—Ä–µ–Ω—å –ø—Ä–æ–±–ª–µ–º—ã
1. **–ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ —Å–æ–±—ã—Ç–∏—è**: –°–æ–±—ã—Ç–∏–µ `app.mode_changed` –∏–º–µ–ª–æ –≤–ª–æ–∂–µ–Ω–Ω—É—é —Å—Ç—Ä—É–∫—Ç—É—Ä—É `data.data.mode` –≤–º–µ—Å—Ç–æ `data.mode`
2. **–ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–∞—è –ª–æ–≥–∏–∫–∞ —Ä–µ–∂–∏–º–æ–≤**: –ê—É–¥–∏–æ –æ—Å—Ç–∞–≤–∞–ª–æ—Å—å –∞–∫—Ç–∏–≤–Ω—ã–º –≤ —Ä–µ–∂–∏–º–µ PROCESSING

## ‚úÖ –†–µ—à–µ–Ω–∏–µ

### 1. –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–∞—Ä—Å–∏–Ω–≥–∞ —Å–æ–±—ã—Ç–∏—è
```python
# –ë—ã–ª–æ:
mode = data.get("mode")

# –°—Ç–∞–ª–æ:
mode = data.get("mode")
if not mode and "data" in data:
    mode = data.get("data", {}).get("mode")
```

### 2. –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ª–æ–≥–∏–∫–∏ —Ä–µ–∂–∏–º–æ–≤
```python
# –ë—ã–ª–æ:
elif mode_value == "processing":
    # –†–µ–∂–∏–º –æ–±—Ä–∞–±–æ—Ç–∫–∏ - –∞—É–¥–∏–æ –æ—Å—Ç–∞–µ—Ç—Å—è –∞–∫—Ç–∏–≤–Ω—ã–º –¥–ª—è –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏—è
    logger.info(f"‚öôÔ∏è [AUDIO] –†–µ–∂–∏–º PROCESSING - –∞—É–¥–∏–æ –æ—Å—Ç–∞–µ—Ç—Å—è –∞–∫—Ç–∏–≤–Ω—ã–º, is_running={self.is_running}")

# –°—Ç–∞–ª–æ:
elif mode_value == "processing":
    # –†–µ–∂–∏–º –æ–±—Ä–∞–±–æ—Ç–∫–∏ - –æ—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –∞—É–¥–∏–æ (–º–∏–∫—Ä–æ—Ñ–æ–Ω –Ω–µ –Ω—É–∂–µ–Ω)
    logger.info(f"‚öôÔ∏è [AUDIO] –û–±—Ä–∞–±–æ—Ç–∫–∞ —Ä–µ–∂–∏–º–∞ PROCESSING, is_running={self.is_running}")
    if self.is_running:
        logger.info("‚öôÔ∏è [AUDIO] –û—Å—Ç–∞–Ω–æ–≤–∫–∞ –∞—É–¥–∏–æ –¥–ª—è —Ä–µ–∂–∏–º–∞ PROCESSING")
        await self.stop()
```

## üéØ –†–µ–∑—É–ª—å—Ç–∞—Ç
–¢–µ–ø–µ—Ä—å –º–∏–∫—Ä–æ—Ñ–æ–Ω –∞–∫—Ç–∏–≤–∏—Ä—É–µ—Ç—Å—è **—Ç–æ–ª—å–∫–æ** –≤ —Ä–µ–∂–∏–º–µ LISTENING:

- ‚úÖ **SLEEPING** ‚Üí –º–∏–∫—Ä–æ—Ñ–æ–Ω –≤—ã–∫–ª—é—á–µ–Ω
- ‚úÖ **LISTENING** ‚Üí –º–∏–∫—Ä–æ—Ñ–æ–Ω –≤–∫–ª—é—á–µ–Ω  
- ‚úÖ **PROCESSING** ‚Üí –º–∏–∫—Ä–æ—Ñ–æ–Ω –≤—ã–∫–ª—é—á–µ–Ω

## üìÅ –ò–∑–º–µ–Ω–µ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã
- `integration/integrations/default_audio_integration.py` - –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ –ª–æ–≥–∏–∫–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∏ —Å–æ–±—ã—Ç–∏–π –∏ —Ä–µ–∂–∏–º–æ–≤

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
–í—Å–µ —Ç–µ—Å—Ç—ã –≤ `test_audio_mode_control.py` –ø—Ä–æ—Ö–æ–¥—è—Ç —É—Å–ø–µ—à–Ω–æ:
- ‚úÖ –ê—É–¥–∏–æ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –ø—Ä–∏ –ø–µ—Ä–µ—Ö–æ–¥–µ –≤ LISTENING
- ‚úÖ –ê—É–¥–∏–æ –æ—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è –ø—Ä–∏ –ø–µ—Ä–µ—Ö–æ–¥–µ –≤ SLEEPING  
- ‚úÖ –ê—É–¥–∏–æ –æ—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è –ø—Ä–∏ –ø–µ—Ä–µ—Ö–æ–¥–µ –≤ PROCESSING

## üéâ –°—Ç–∞—Ç—É—Å
**–ü–†–û–ë–õ–ï–ú–ê –†–ï–®–ï–ù–ê** - –º–∏–∫—Ä–æ—Ñ–æ–Ω —Ç–µ–ø–µ—Ä—å –∞–∫—Ç–∏–≤–∏—Ä—É–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏!
