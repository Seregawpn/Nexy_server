# –ê–Ω–∞–ª–∏–∑ —Å–∏—Å—Ç–µ–º—ã –ø—Ä–æ–≤–µ—Ä–æ–∫ (—ç—Ç–∞–∂–∏ –∏ –ø—Ä–∞–≤–∏–ª–∞)

**–¶–µ–ª—å**: –ü–æ–Ω—è—Ç—å —Ç–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –ø—Ä–æ–≤–µ—Ä–æ–∫ ‚Äî —á—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏, —á—Ç–æ —É—á–∏—Ç—ã–≤–∞–µ—Ç—Å—è, —á—Ç–æ –∏–≥–Ω–æ—Ä–∏—Ä—É–µ—Ç—Å—è, –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ —Ç–æ—á–∫–∏.

**–î–∞—Ç–∞**: 2025-01-30

---

## üìä –°—Ç—Ä—É–∫—Ç—É—Ä–∞ "—ç—Ç–∞–∂–µ–π" –ø—Ä–æ–≤–µ—Ä–æ–∫

### –≠–¢–ê–ñ 1: –õ–∏–Ω—Ç–µ—Ä –∏ —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏–π –∞–Ω–∞–ª–∏–∑ (‚úÖ –†–ê–ë–û–¢–ê–ï–¢)

**CI job**: `lint`

| –ü—Ä–æ–≤–µ—Ä–∫–∞ | –°—Ç–∞—Ç—É—Å | –ß—Ç–æ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç | –ö—Ä–∏—Ç–∏—á–Ω–æ—Å—Ç—å |
|---------|--------|---------------|-------------|
| **ruff** | ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç | Code style, –æ—à–∏–±–∫–∏, —Å–ª–æ–∂–Ω–æ—Å—Ç—å | –°—Ä–µ–¥–Ω—è—è (–º–æ–∂–Ω–æ –∏—Å–ø—Ä–∞–≤–∏—Ç—å) |
| **verify_no_direct_state_access.py** | ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç | –ü—Ä—è–º–æ–π –¥–æ—Å—Ç—É–ø –∫ –æ—Å—è–º —Å–æ—Å—Ç–æ—è–Ω–∏—è | **–ö–†–ò–¢–ò–ß–ù–û** ‚Äî –±–ª–æ–∫–∏—Ä—É–µ—Ç –º–µ—Ä–¥–∂ |

**–ß—Ç–æ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è:**
- ‚úÖ –ü–∞—Ç—Ç–µ—Ä–Ω—ã: `perm_mic`, `perm_screen`, `first_run`, `state_manager.get`, etc.
- ‚úÖ –ò—Å–∫–ª—é—á–µ–Ω–∏—è: `**/selectors.py`, `**/gateways.py`, `**/test*.py`
- ‚úÖ –§–µ–π–ª–∏—Ç –ø—Ä–∏ –Ω–∞—Ä—É—à–µ–Ω–∏–∏ (exit code 1)

**–ß—Ç–æ –ù–ï –ø—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è:**
- ‚ùå –ü—Ä—è–º–æ–π –¥–æ—Å—Ç—É–ø –∫ `update_in_progress` —á–µ—Ä–µ–∑ `state_manager.get_state_data()` (–ø–∞—Ç—Ç–µ—Ä–Ω –Ω–µ –ø–æ–∫—Ä—ã—Ç)
- ‚ùå –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –æ—Å–µ–π —á–µ—Ä–µ–∑ `getattr()` –∏–ª–∏ –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–µ –≤—ã–∑–æ–≤—ã
- ‚ùå –î–æ—Å—Ç—É–ø —á–µ—Ä–µ–∑ `self._state_manager` (–Ω–µ —á–µ—Ä–µ–∑ `state_manager`)

**–ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ —Ç–æ—á–∫–∏:**
- ‚ö†Ô∏è –°–∫—Ä–∏–ø—Ç –ø—Ä–æ–≤–µ—Ä—è–µ—Ç —Ç–æ–ª—å–∫–æ —Å—Ç—Ä–æ–∫–æ–≤—ã–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã ‚Äî –º–æ–∂–µ—Ç –ø—Ä–æ–ø—É—Å—Ç–∏—Ç—å –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–π –¥–æ—Å—Ç—É–ø
- ‚ö†Ô∏è –ù–µ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –∏–º–ø–æ—Ä—Ç—ã –∏ –∫–æ—Å–≤–µ–Ω–Ω—ã–π –¥–æ—Å—Ç—É–ø

---

### –≠–¢–ê–ñ 2: –í–∞–ª–∏–¥–∞—Ü–∏—è —Å—Ö–µ–º (‚úÖ –†–ê–ë–û–¢–ê–ï–¢)

**CI job**: `schema-validate`

| –ü—Ä–æ–≤–µ—Ä–∫–∞ | –°—Ç–∞—Ç—É—Å | –ß—Ç–æ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç | –ö—Ä–∏—Ç–∏—á–Ω–æ—Å—Ç—å |
|---------|--------|---------------|-------------|
| **test_schemas.py** | ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç | JSON Schema –¥–ª—è `unified_config.yaml` –∏ `interaction_matrix.yaml` | **–ö–†–ò–¢–ò–ß–ù–û** ‚Äî –±–ª–æ–∫–∏—Ä—É–µ—Ç –º–µ—Ä–¥–∂ |

**–ß—Ç–æ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è:**
- ‚úÖ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ `unified_config.yaml` —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç —Å—Ö–µ–º–µ
- ‚úÖ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ `interaction_matrix.yaml` —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç —Å—Ö–µ–º–µ
- ‚úÖ –¢–∏–ø—ã –¥–∞–Ω–Ω—ã—Ö –∏ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø–æ–ª—è

**–ß—Ç–æ –ù–ï –ø—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è:**
- ‚ùå –°–µ–º–∞–Ω—Ç–∏—á–µ—Å–∫–∞—è –≤–∞–ª–∏–¥–Ω–æ—Å—Ç—å (–Ω–∞–ø—Ä–∏–º–µ—Ä, –æ—Å–∏ –∏–∑ –º–∞—Ç—Ä–∏—Ü—ã –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –≤ STATE_CATALOG)
- ‚ùå –°—Å—ã–ª–∫–∏ –º–µ–∂–¥—É –¥–æ–∫—É–º–µ–Ω—Ç–∞–º–∏ (gateway –∏–∑ –º–∞—Ç—Ä–∏—Ü—ã –¥–æ–ª–∂–µ–Ω —Å—É—â–µ—Å—Ç–≤–æ–≤–∞—Ç—å –≤ –∫–æ–¥–µ)
- ‚ùå –î—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –∑–Ω–∞—á–µ–Ω–∏–π (–Ω–∞–ø—Ä–∏–º–µ—Ä, —Ç–∞–π–º–∏–Ω–≥–∏ –≤ —Ä–∞–∑–Ω—ã—Ö –º–µ—Å—Ç–∞—Ö)

**–ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ —Ç–æ—á–∫–∏:**
- ‚ö†Ô∏è –°—Ö–µ–º–∞ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç —Å—Ç—Ä—É–∫—Ç—É—Ä—É, –Ω–æ –Ω–µ –ª–æ–≥–∏—á–µ—Å–∫—É—é —Å–≤—è–∑–Ω–æ—Å—Ç—å
- ‚ö†Ô∏è –ú–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –ø—Ä–∞–≤–∏–ª–æ –≤ –º–∞—Ç—Ä–∏—Ü—É, –Ω–æ –Ω–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –≤ gateway ‚Äî —Å—Ö–µ–º–∞ –Ω–µ –∑–∞–º–µ—Ç–∏—Ç

---

### –≠–¢–ê–ñ 3: –¢–µ—Å—Ç—ã –∫–æ–Ω—Ç—Ä–∞–∫—Ç–æ–≤ –∏ gateways (‚úÖ –†–ê–ë–û–¢–ê–ï–¢)

**CI job**: `contracts-test`

| –ü—Ä–æ–≤–µ—Ä–∫–∞ | –°—Ç–∞—Ç—É—Å | –ß—Ç–æ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç | –ö—Ä–∏—Ç–∏—á–Ω–æ—Å—Ç—å |
|---------|--------|---------------|-------------|
| **test_gateways.py** | ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç | –õ–æ–≥–∏–∫–∞ gateways + decision-–ª–æ–≥–∏ | **–ö–†–ò–¢–ò–ß–ù–û** ‚Äî –±–ª–æ–∫–∏—Ä—É–µ—Ç –º–µ—Ä–¥–∂ |
| **TestGatewayDecisionLogs** | ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç | –§–æ—Ä–º–∞—Ç decision-–ª–æ–≥–æ–≤ | –°—Ä–µ–¥–Ω—è—è |
| **TestPermissionRestartGateway** | ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç | –õ–æ–≥–∏–∫–∞ `decide_permission_restart_safety` | **–ö–†–ò–¢–ò–ß–ù–û** |
| **TestDecisionLogFormatValidation** | ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç | –ù–µ–≥–∞—Ç–∏–≤–Ω—ã–µ —Ç–µ—Å—Ç—ã —Ñ–æ—Ä–º–∞—Ç–∞ | –°—Ä–µ–¥–Ω—è—è |
| **test_init_order.py** | ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç | –ü–æ—Ä—è–¥–æ–∫ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–π | **–ö–†–ò–¢–ò–ß–ù–û** |

**–ß—Ç–æ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è:**
- ‚úÖ –õ–æ–≥–∏–∫–∞ gateways (start/abort/retry/degrade)
- ‚úÖ –§–æ—Ä–º–∞—Ç decision-–ª–æ–≥–æ–≤ –≤ –∫–∞–Ω–æ–Ω–∏—á–µ—Å–∫–æ–º —Ñ–æ—Ä–º–∞—Ç–µ
- ‚úÖ –ù–µ–≥–∞—Ç–∏–≤–Ω—ã–µ —Ç–µ—Å—Ç—ã (–ø–∞–¥–∞—é—Ç –ø—Ä–∏ –Ω–∞—Ä—É—à–µ–Ω–∏–∏ —Ñ–æ—Ä–º–∞—Ç–∞)
- ‚úÖ –ü–æ—Ä—è–¥–æ–∫ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ (first_run_permissions –Ω–∞ –ø–æ–∑–∏—Ü–∏–∏ 3, permission_restart –Ω–∞ 4)

**–ß—Ç–æ –ù–ï –ø—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è:**
- ‚ùå –ü–æ–∫—Ä—ã—Ç–∏–µ –≤—Å–µ—Ö –ø—Ä–∞–≤–∏–ª –∏–∑ `interaction_matrix.yaml` (–Ω–µ –≤—Å–µ –ø—Ä–∞–≤–∏–ª–∞ –∏–º–µ—é—Ç —Ç–µ—Å—Ç—ã)
- ‚ùå Pairwise –∫–æ–º–±–∏–Ω–∞—Ü–∏–∏ –¥–ª—è –≤—Å–µ—Ö –æ—Å–µ–π (—Ç–µ—Å—Ç—ã –µ—Å—Ç—å, –Ω–æ –Ω–µ –ø–æ–ª–Ω—ã–µ)
- ‚ùå –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã (—Ä–µ–∞–ª—å–Ω—ã–π –∑–∞–ø—É—Å–∫ —Å EventBus)

**–ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ —Ç–æ—á–∫–∏:**
- ‚ö†Ô∏è –¢–µ—Å—Ç—ã –ø—Ä–æ–≤–µ—Ä—è—é—Ç –æ—Ç–¥–µ–ª—å–Ω—ã–µ gateways, –Ω–æ –Ω–µ –ø–æ–ª–Ω—ã–π —Ü–∏–∫–ª "–ø—Ä–∞–≤–∏–ª–æ ‚Üí gateway ‚Üí —Ç–µ—Å—Ç"
- ‚ö†Ô∏è –ù–µ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ –ø—Ä–∞–≤–∏–ª –∏–∑ –º–∞—Ç—Ä–∏—Ü—ã —Ç–µ—Å—Ç–∞–º (–º–æ–∂–µ—Ç –±—ã—Ç—å —Ä–∞–∑—Ä—ã–≤)

---

### –≠–¢–ê–ñ 4: Impact-gate (4-–∞—Ä—Ç–µ—Ñ–∞–∫—Ç—ã) (‚úÖ –†–ê–ë–û–¢–ê–ï–¢, –Ω–æ —á–∞—Å—Ç–∏—á–Ω–æ)

**CI job**: `impact-gate`

| –ü—Ä–æ–≤–µ—Ä–∫–∞ | –°—Ç–∞—Ç—É—Å | –ß—Ç–æ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç | –ö—Ä–∏—Ç–∏—á–Ω–æ—Å—Ç—å |
|---------|--------|---------------|-------------|
| **verify_4_artifacts_invariant.py** | ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç | STATE_CATALOG ‚Üí matrix ‚Üí gateways ‚Üí tests | **–ö–†–ò–¢–ò–ß–ù–û** ‚Äî –±–ª–æ–∫–∏—Ä—É–µ—Ç –º–µ—Ä–¥–∂ |
| **verify_feature_flags.py** | ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç | –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è —Ñ–ª–∞–≥–æ–≤ –≤ FEATURE_FLAGS.md | **–ö–†–ò–¢–ò–ß–ù–û** ‚Äî –±–ª–æ–∫–∏—Ä—É–µ—Ç –º–µ—Ä–¥–∂ |
| **change_impact.yaml check** | ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç | –ù–∞–ª–∏—á–∏–µ —Ñ–∞–π–ª–∞ –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ matrix/gateways | –°—Ä–µ–¥–Ω—è—è |

**–ß—Ç–æ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è:**
- ‚úÖ –ù–∞–ª–∏—á–∏–µ –æ—Å–∏ –≤ STATE_CATALOG.md (–ø–æ–∏—Å–∫ –ø–æ –∏–º–µ–Ω–∏)
- ‚úÖ –ù–∞–ª–∏—á–∏–µ –æ—Å–∏ –≤ interaction_matrix.yaml (–ø–æ–∏—Å–∫ –ø–æ –∏–º–µ–Ω–∏)
- ‚úÖ –ù–∞–ª–∏—á–∏–µ –æ—Å–∏ –≤ gateways (–ø–æ–∏—Å–∫ –ø–æ –∏–º–µ–Ω–∏ –≤ —Ñ–∞–π–ª–∞—Ö)
- ‚úÖ –ù–∞–ª–∏—á–∏–µ –æ—Å–∏ –≤ —Ç–µ—Å—Ç–∞—Ö (–ø–æ–∏—Å–∫ –ø–æ –∏–º–µ–Ω–∏ –≤ test_gateways.py)
- ‚úÖ –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è —Ñ–∏—á–∞-—Ñ–ª–∞–≥–æ–≤ –≤ FEATURE_FLAGS.md

**–ß—Ç–æ –ù–ï –ø—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è:**
- ‚ùå **–°–µ–º–∞–Ω—Ç–∏—á–µ—Å–∫–∞—è —Å–≤—è–∑–Ω–æ—Å—Ç—å**: –ø—Ä–∞–≤–∏–ª–æ –≤ –º–∞—Ç—Ä–∏—Ü–µ –º–æ–∂–µ—Ç –Ω–µ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–æ–≤–∞—Ç—å gateway –ª–æ–≥–∏–∫–µ
- ‚ùå **–ü–æ–∫—Ä—ã—Ç–∏–µ —Ç–µ—Å—Ç–∞–º–∏**: –Ω–µ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç, —á—Ç–æ –≤—Å–µ –ø—Ä–∞–≤–∏–ª–∞ –∏–∑ –º–∞—Ç—Ä–∏—Ü—ã –ø–æ–∫—Ä—ã—Ç—ã —Ç–µ—Å—Ç–∞–º–∏
- ‚ùå **–ü–æ—Ä—è–¥–æ–∫ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è**: –Ω–µ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç, —á—Ç–æ STATE_CATALOG –æ–±–Ω–æ–≤–ª—ë–Ω –î–û –º–∞—Ç—Ä–∏—Ü—ã
- ‚ùå **Gateway —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è**: –Ω–µ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç, —á—Ç–æ gateway —Ä–µ–∞–ª—å–Ω–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –æ—Å—å –∏–∑ –º–∞—Ç—Ä–∏—Ü—ã

**–ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ —Ç–æ—á–∫–∏:**
- ‚ö†Ô∏è –°–∫—Ä–∏–ø—Ç –∏—â–µ—Ç –ø–æ –∏–º–µ–Ω–∏, –Ω–æ –Ω–µ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –ª–æ–≥–∏—á–µ—Å–∫—É—é —Å–≤—è–∑—å
- ‚ö†Ô∏è –ú–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –æ—Å—å –≤ STATE_CATALOG, –Ω–æ –Ω–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –≤ gateway ‚Äî —Å–∫—Ä–∏–ø—Ç –Ω–µ –∑–∞–º–µ—Ç–∏—Ç
- ‚ö†Ô∏è –ú–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –ø—Ä–∞–≤–∏–ª–æ –≤ –º–∞—Ç—Ä–∏—Ü—É, –Ω–æ –Ω–µ –ø–æ–∫—Ä—ã—Ç—å —Ç–µ—Å—Ç–æ–º ‚Äî —Å–∫—Ä–∏–ø—Ç –Ω–µ –∑–∞–º–µ—Ç–∏—Ç

---

### –≠–¢–ê–ñ 5: Golden-—Ç–µ—Å—Ç—ã –∏ SLO (‚ö†Ô∏è –ù–ï –†–ê–ë–û–¢–ê–ï–¢)

**CI job**: `golden-tests`, `perf-slo`

| –ü—Ä–æ–≤–µ—Ä–∫–∞ | –°—Ç–∞—Ç—É—Å | –ß—Ç–æ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç | –ö—Ä–∏—Ç–∏—á–Ω–æ—Å—Ç—å |
|---------|--------|---------------|-------------|
| **test_golden_permission_restart.py** | ‚ùå –ù–ï –†–ê–ë–û–¢–ê–ï–¢ | Golden-–ª–æ–≥ —Ç–µ—Å—Ç –¥–ª—è first-run | **–ö–†–ò–¢–ò–ß–ù–û** ‚Äî —Å–µ–π—á–∞—Å `|| true` |
| **test_slo.py** | ‚ùå –ù–ï –†–ê–ë–û–¢–ê–ï–¢ | SLO –º–µ—Ç—Ä–∏–∫–∏ –∏–∑ –ª–æ–≥–æ–≤ | –°—Ä–µ–¥–Ω—è—è ‚Äî —Å–µ–π—á–∞—Å `|| true` |

**–ß—Ç–æ –î–û–õ–ñ–ù–û –ø—Ä–æ–≤–µ—Ä—è—Ç—å—Å—è (–Ω–æ –Ω–µ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è):**
- ‚ùå –°–≤–µ—Ä–∫–∞ –ª–æ–≥–æ–≤ —Å–æ —Å–ø–µ–∫–æ–º `NEXY_FIRST_RUN_LOG_EXPECTED.md`
- ‚ùå –ù–µ—Ç "–ø—Ä–æ–∏–≥—Ä—ã–≤–∞–Ω–∏—è –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏—è –¥–æ —Ä–µ—Å—Ç–∞—Ä—Ç–∞"
- ‚ùå –ù–µ—Ç –ø—É–±–ª–∏–∫–∞—Ü–∏–∏ `permissions.first_run_completed` –≤ —Å—Ç–∞—Ä–æ–º –ø—Ä–æ—Ü–µ—Å—Å–µ
- ‚ùå –ú–µ—Ç—Ä–∏–∫–∏: `tcc_prompt_duration_ms` (p95 ‚â§ 5s), `permission_restart_success_rate` (‚â• 98%)

**–ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ —Ç–æ—á–∫–∏:**
- üö® **–ö–†–ò–¢–ò–ß–ù–û**: Golden-—Ç–µ—Å—Ç—ã –æ—Ç–∫–ª—é—á–µ–Ω—ã (`|| true`) ‚Äî –º–æ–∂–Ω–æ –ø—Ä–æ–ø—É—Å—Ç–∏—Ç—å —Ä–µ–≥—Ä–µ—Å—Å–∏–∏
- üö® **–ö–†–ò–¢–ò–ß–ù–û**: SLO —Ç–µ—Å—Ç—ã –æ—Ç–∫–ª—é—á–µ–Ω—ã ‚Äî –º–æ–∂–Ω–æ –ø—Ä–æ–ø—É—Å—Ç–∏—Ç—å –¥–µ–≥—Ä–∞–¥–∞—Ü–∏—é –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

---

## üéØ –ß—Ç–æ —É—á–∏—Ç—ã–≤–∞–µ—Ç—Å—è / —á—Ç–æ –∏–≥–Ω–æ—Ä–∏—Ä—É–µ—Ç—Å—è

### ‚úÖ –£—á–∏—Ç—ã–≤–∞–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏

1. **–ü–æ—Ä—è–¥–æ–∫ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏** ‚Äî —Ç–µ—Å—Ç `test_init_order.py` –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –ø–æ–∑–∏—Ü–∏–∏
2. **–§–æ—Ä–º–∞—Ç decision-–ª–æ–≥–æ–≤** ‚Äî –Ω–µ–≥–∞—Ç–∏–≤–Ω—ã–µ —Ç–µ—Å—Ç—ã –ø–∞–¥–∞—é—Ç –ø—Ä–∏ –Ω–∞—Ä—É—à–µ–Ω–∏–∏
3. **–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è —Ñ–∏—á–∞-—Ñ–ª–∞–≥–æ–≤** ‚Äî —Å–∫—Ä–∏–ø—Ç –ø—Ä–æ–≤–µ—Ä—è–µ—Ç FEATURE_FLAGS.md
4. **–ü—Ä—è–º–æ–π –¥–æ—Å—Ç—É–ø –∫ —Å–æ—Å—Ç–æ—è–Ω–∏—é** ‚Äî —Å–∫—Ä–∏–ø—Ç –±–ª–æ–∫–∏—Ä—É–µ—Ç –º–µ—Ä–¥–∂
5. **–°—Ç—Ä—É–∫—Ç—É—Ä–∞ –∫–æ–Ω—Ñ–∏–≥–æ–≤** ‚Äî —Å—Ö–µ–º—ã –ø—Ä–æ–≤–µ—Ä—è—é—Ç –≤–∞–ª–∏–¥–Ω–æ—Å—Ç—å

### ‚ö†Ô∏è –ß–∞—Å—Ç–∏—á–Ω–æ —É—á–∏—Ç—ã–≤–∞–µ—Ç—Å—è (–º–æ–∂–µ—Ç –ø—Ä–æ–ø—É—Å—Ç–∏—Ç—å)

1. **4-–∞—Ä—Ç–µ—Ñ–∞–∫—Ç—ã –∏–Ω–≤–∞—Ä–∏–∞–Ω—Ç** ‚Äî –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –Ω–∞–ª–∏—á–∏–µ, –Ω–æ –Ω–µ –ª–æ–≥–∏—á–µ—Å–∫—É—é —Å–≤—è–∑–Ω–æ—Å—Ç—å
2. **–ü–æ–∫—Ä—ã—Ç–∏–µ —Ç–µ—Å—Ç–∞–º–∏** ‚Äî –Ω–µ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç, —á—Ç–æ –≤—Å–µ –ø—Ä–∞–≤–∏–ª–∞ –∏–∑ –º–∞—Ç—Ä–∏—Ü—ã –ø–æ–∫—Ä—ã—Ç—ã
3. **Gateway —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è** ‚Äî –Ω–µ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç, —á—Ç–æ gateway –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –æ—Å—å –∏–∑ –º–∞—Ç—Ä–∏—Ü—ã
4. **–°–µ–º–∞–Ω—Ç–∏—á–µ—Å–∫–∞—è –≤–∞–ª–∏–¥–Ω–æ—Å—Ç—å** ‚Äî –Ω–µ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ –ª–æ–≥–∏–∫–∏ –ø—Ä–∞–≤–∏–ª–∞–º

### ‚ùå –ò–≥–Ω–æ—Ä–∏—Ä—É–µ—Ç—Å—è (TODO / || true)

1. **Golden-—Ç–µ—Å—Ç—ã** ‚Äî –æ—Ç–∫–ª—é—á–µ–Ω—ã (`|| true`), –Ω–µ –±–ª–æ–∫–∏—Ä—É—é—Ç –º–µ—Ä–¥–∂
2. **SLO —Ç–µ—Å—Ç—ã** ‚Äî –æ—Ç–∫–ª—é—á–µ–Ω—ã (`|| true`), –Ω–µ –±–ª–æ–∫–∏—Ä—É—é—Ç –º–µ—Ä–¥–∂
3. **–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã** ‚Äî –Ω–µ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏
4. **Shadow-mode –ø—Ä–æ–≤–µ—Ä–∫–∏** ‚Äî –Ω–µ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏

---

## üö® –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ —Ç–æ—á–∫–∏

### 1. –†–∞–∑—Ä—ã–≤ –º–µ–∂–¥—É –ø—Ä–∞–≤–∏–ª–∞–º–∏ –∏ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–µ–π

**–ü—Ä–æ–±–ª–µ–º–∞**: –ú–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –ø—Ä–∞–≤–∏–ª–æ –≤ `interaction_matrix.yaml`, –Ω–æ –Ω–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –≤ gateway ‚Äî —Å–∫—Ä–∏–ø—Ç –Ω–µ –∑–∞–º–µ—Ç–∏—Ç.

**–ü—Ä–∏–º–µ—Ä**: 
- –ü—Ä–∞–≤–∏–ª–æ: `update_in_progress: true ‚Üí abort_permission_restart`
- Gateway: –º–æ–∂–µ—Ç –Ω–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `update_in_progress` –≤ –ª–æ–≥–∏–∫–µ
- –°–∫—Ä–∏–ø—Ç: –Ω–∞–π–¥—ë—Ç `update_in_progress` –≤ –æ–±–æ–∏—Ö —Ñ–∞–π–ª–∞—Ö ‚Üí ‚úÖ PASS

**–†–µ—à–µ–Ω–∏–µ**: –ù—É–∂–Ω–∞ –ø—Ä–æ–≤–µ—Ä–∫–∞ —Å–µ–º–∞–Ω—Ç–∏—á–µ—Å–∫–æ–π —Å–≤—è–∑–Ω–æ—Å—Ç–∏ (–ø—Ä–∞–≤–∏–ª–æ ‚Üí gateway –ª–æ–≥–∏–∫–∞).

---

### 2. –ü–æ–∫—Ä—ã—Ç–∏–µ —Ç–µ—Å—Ç–∞–º–∏ –ø—Ä–∞–≤–∏–ª

**–ü—Ä–æ–±–ª–µ–º–∞**: –ù–µ –≤—Å–µ –ø—Ä–∞–≤–∏–ª–∞ –∏–∑ `interaction_matrix.yaml` –ø–æ–∫—Ä—ã—Ç—ã —Ç–µ—Å—Ç–∞–º–∏.

**–ü—Ä–∏–º–µ—Ä**:
- –ü—Ä–∞–≤–∏–ª–æ: `respect_updates: true + update_available: true ‚Üí skip_restart`
- –¢–µ—Å—Ç: –º–æ–∂–µ—Ç –æ—Ç—Å—É—Ç—Å—Ç–≤–æ–≤–∞—Ç—å
- –°–∫—Ä–∏–ø—Ç: –Ω–∞–π–¥—ë—Ç –ø—Ä–∞–≤–∏–ª–æ –≤ –º–∞—Ç—Ä–∏—Ü–µ ‚Üí ‚úÖ PASS

**–†–µ—à–µ–Ω–∏–µ**: –ù—É–∂–Ω–∞ –ø—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–∫—Ä—ã—Ç–∏—è (–ø—Ä–∞–≤–∏–ª–æ ‚Üí —Ç–µ—Å—Ç).

---

### 3. Golden-—Ç–µ—Å—Ç—ã –æ—Ç–∫–ª—é—á–µ–Ω—ã

**–ü—Ä–æ–±–ª–µ–º–∞**: Golden-—Ç–µ—Å—Ç—ã –¥–ª—è first-run/restart –æ—Ç–∫–ª—é—á–µ–Ω—ã (`|| true`) ‚Äî –º–æ–∂–Ω–æ –ø—Ä–æ–ø—É—Å—Ç–∏—Ç—å —Ä–µ–≥—Ä–µ—Å—Å–∏–∏.

**–†–µ—à–µ–Ω–∏–µ**: –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å golden-–ª–æ–≥ —Ç–µ—Å—Ç –∏ —É–±—Ä–∞—Ç—å `|| true`.

---

### 4. SLO –º–µ—Ç—Ä–∏–∫–∏ –Ω–µ –ø—Ä–æ–≤–µ—Ä—è—é—Ç—Å—è

**–ü—Ä–æ–±–ª–µ–º–∞**: SLO —Ç–µ—Å—Ç—ã –æ—Ç–∫–ª—é—á–µ–Ω—ã ‚Äî –º–æ–∂–Ω–æ –ø—Ä–æ–ø—É—Å—Ç–∏—Ç—å –¥–µ–≥—Ä–∞–¥–∞—Ü–∏—é –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏.

**–†–µ—à–µ–Ω–∏–µ**: –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å smoke-—Ç–µ—Å—Ç –¥–ª—è –º–µ—Ç—Ä–∏–∫ –∏–∑ –ª–æ–≥–æ–≤.

---

### 5. –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–π –¥–æ—Å—Ç—É–ø –∫ —Å–æ—Å—Ç–æ—è–Ω–∏—é

**–ü—Ä–æ–±–ª–µ–º–∞**: –°–∫—Ä–∏–ø—Ç –ø—Ä–æ–≤–µ—Ä—è–µ—Ç —Ç–æ–ª—å–∫–æ —Å—Ç—Ä–æ–∫–æ–≤—ã–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã ‚Äî –º–æ–∂–µ—Ç –ø—Ä–æ–ø—É—Å—Ç–∏—Ç—å –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–π –¥–æ—Å—Ç—É–ø.

**–ü—Ä–∏–º–µ—Ä**:
```python
# –ù–µ –±—É–¥–µ—Ç –æ–±–Ω–∞—Ä—É–∂–µ–Ω–æ:
axis_name = "update_in_progress"
value = state_manager.get_state_data(axis_name)  # –ü–∞—Ç—Ç–µ—Ä–Ω –Ω–µ –Ω–∞–π–¥–µ–Ω
```

**–†–µ—à–µ–Ω–∏–µ**: –£–ª—É—á—à–∏—Ç—å —Å–∫—Ä–∏–ø—Ç –¥–ª—è –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏—è –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞.

---

## üìã –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ —É–ª—É—á—à–µ–Ω–∏—é

### –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç 1 (–∫—Ä–∏—Ç–∏—á–Ω–æ)

1. **–†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å golden-–ª–æ–≥ —Ç–µ—Å—Ç** ‚Äî —É–±—Ä–∞—Ç—å `|| true`, –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞—Ç—å —Å–≤–µ—Ä–∫—É –ª–æ–≥–æ–≤
2. **–ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–µ–º–∞–Ω—Ç–∏—á–µ—Å–∫–æ–π —Å–≤—è–∑–Ω–æ—Å—Ç–∏** ‚Äî –ø—Ä–∞–≤–∏–ª–æ ‚Üí gateway –ª–æ–≥–∏–∫–∞
3. **–ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–∫—Ä—ã—Ç–∏—è —Ç–µ—Å—Ç–∞–º–∏** ‚Äî –ø—Ä–∞–≤–∏–ª–æ ‚Üí —Ç–µ—Å—Ç

### –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç 2 (–≤–∞–∂–Ω–æ)

4. **–†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å SLO smoke-—Ç–µ—Å—Ç** ‚Äî –ø—Ä–æ–≤–µ—Ä–∫–∞ –º–µ—Ç—Ä–∏–∫ –∏–∑ –ª–æ–≥–æ–≤
5. **–£–ª—É—á—à–∏—Ç—å –ø—Ä–æ–≤–µ—Ä–∫—É –ø—Ä—è–º–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞** ‚Äî –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞
6. **–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã** ‚Äî –ø–æ–ª–Ω—ã–π —Ü–∏–∫–ª —Å EventBus

### –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç 3 (–∂–µ–ª–∞—Ç–µ–ª—å–Ω–æ)

7. **Shadow-mode –ø—Ä–æ–≤–µ—Ä–∫–∏** ‚Äî –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è –ø—Ä–æ–≤–µ—Ä–∫–∏ shadow-mode
8. **–¢–∞–±–ª–∏—Ü–∞ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏—è** ‚Äî –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –≥–µ–Ω–µ—Ä–∞—Ü–∏—è STATE_CATALOG ‚Üî matrix

---

## üîç –ë—ã—Å—Ç—Ä—ã–π –∞—É–¥–∏—Ç (—á—Ç–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –≤—Ä—É—á–Ω—É—é)

### ‚úÖ –ü—Ä–æ–≤–µ—Ä–µ–Ω–æ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏

- –ü–æ—Ä—è–¥–æ–∫ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏
- –§–æ—Ä–º–∞—Ç decision-–ª–æ–≥–æ–≤
- –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è —Ñ–∏—á–∞-—Ñ–ª–∞–≥–æ–≤
- –ü—Ä—è–º–æ–π –¥–æ—Å—Ç—É–ø –∫ —Å–æ—Å—Ç–æ—è–Ω–∏—é (—Å—Ç—Ä–æ–∫–∞–º–∏)

### ‚ö†Ô∏è –¢—Ä–µ–±—É–µ—Ç —Ä—É—á–Ω–æ–π –ø—Ä–æ–≤–µ—Ä–∫–∏

- [ ] –í—Å–µ –ø—Ä–∞–≤–∏–ª–∞ –∏–∑ –º–∞—Ç—Ä–∏—Ü—ã –ø–æ–∫—Ä—ã—Ç—ã —Ç–µ—Å—Ç–∞–º–∏
- [ ] –í—Å–µ gateway –∏—Å–ø–æ–ª—å–∑—É—é—Ç –æ—Å–∏ –∏–∑ –º–∞—Ç—Ä–∏—Ü—ã
- [ ] –õ–æ–≥–∏ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—Ç —Å–ø–µ–∫–µ `NEXY_FIRST_RUN_LOG_EXPECTED.md`
- [ ] –ú–µ—Ç—Ä–∏–∫–∏ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—Ç SLO (p95 latency, success-rate)

---

**–í–ª–∞–¥–µ–ª–µ—Ü**: Tech Lead –∫–ª–∏–µ–Ω—Ç–∞  
**–ü–æ—Å–ª–µ–¥–Ω–µ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ**: 2025-01-30



