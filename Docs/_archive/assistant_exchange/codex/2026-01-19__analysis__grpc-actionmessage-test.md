# gRPC ActionMessage Test

## Метаданные
- Ассистент: codex
- Тип: analysis
- Дата: 2026-01-19
- ID (INS-###): INS-001

## Diagnosis
Локальный сервер на 127.0.0.1:50051 возвращает корректный ActionMessage с command=open_app; проблема command=unknown не воспроизводится в текущем запуске.

## Root Cause
Ранее не удавалось подключиться к localhost из-за sandbox-ограничений; после запуска с эскалацией удалось получить корректный ActionMessage. Это указывает на возможное расхождение версии сервера/клиента или другой инстанс сервера при возникновении command=unknown.

## Optimal Fix
Сопоставить версию сервера, к которому подключен клиент, и убедиться, что именно этот сервер формирует ActionMessage. При необходимости добавить логирование command_payload в серверной цепочке.

## Verification
Проведен gRPC запрос к 127.0.0.1:50051 с prompt="Open Calculator"; ActionMessage получен с command=open_app.

## Запрос/цель
Проверить, что сервер формирует ActionMessage корректно.

## Контекст
- Файлы: server/server/modules/grpc_service/streaming_pb2.py
- Логи: /Users/sergiyzasorin/Library/Logs/Nexy/nexy.log
- Ограничения: требовалась эскалация для доступа к localhost

## Решения/выводы
- Сервер отвечает ActionMessage корректно в текущем окружении.
- Ранее ошибка command=unknown вероятно из-за другого сервера/версии или клиентской стороны.

## Открытые вопросы
- К какому адресу/серверу подключается клиент при ошибке command=unknown?

## Следующие шаги
- Сравнить конфигурацию client grpc target с текущим локальным сервером.
- Проверить логи сервера во время клиентского запроса.
