# –ü–õ–ê–ù –†–£–ß–ù–û–ì–û –¢–ï–°–¢–ò–†–û–í–ê–ù–ò–Ø –ò–°–ü–†–ê–í–õ–ï–ù–ò–ô FIRST_RUN

## –¶–µ–ª—å —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

–ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ –≤—Å–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Ä–∞–±–æ—Ç–∞—é—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ:
1. ‚úÖ –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ **–ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è** –ø–æ—Å–ª–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è first_run
2. ‚úÖ –ê—Å—Å–∏—Å—Ç–µ–Ω—Ç **–ù–ï –∞–∫—Ç–∏–≤–∏—Ä—É–µ—Ç—Å—è** –≤–æ –≤—Ä–µ–º—è –∑–∞–ø—Ä–æ—Å–∞ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–π
3. ‚úÖ –°–æ–±—ã—Ç–∏—è –ø—É–±–ª–∏–∫—É—é—Ç—Å—è –≤ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–º –ø–æ—Ä—è–¥–∫–µ
4. ‚úÖ –§–ª–∞–≥–∏ —Å–æ—Å—Ç–æ—è–Ω–∏—è –æ–±–Ω–æ–≤–ª—è—é—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ

---

## –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –∫ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—é

### 1. –£–¥–∞–ª–µ–Ω–∏–µ —Ñ–ª–∞–≥–∞ –ø–µ—Ä–≤–æ–≥–æ –∑–∞–ø—É—Å–∫–∞

```bash
# –£–¥–∞–ª–∏—Ç—å —Ñ–ª–∞–≥ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è first_run
rm ~/Library/Application\ Support/Nexy/permissions_first_run_completed.flag

# –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ: —É–¥–∞–ª–∏—Ç—å –≤—Å–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –¥–ª—è —á–∏—Å—Ç–æ–≥–æ —Ç–µ—Å—Ç–∞
rm -rf ~/Library/Application\ Support/Nexy/
```

### 2. –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏

–£–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ –≤ `config/unified_config.yaml` —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã –ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã:

```yaml
permissions:
  first_run:
    enabled: true                         # –í–∫–ª—é—á–µ–Ω –∑–∞–ø—Ä–æ—Å —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–π
    activation_hold_duration_sec: 13.0    # –î–µ—Ä–∂–∏–º –æ—Ç–∫—Ä—ã—Ç—ã–º 13 —Å–µ–∫—É–Ω–¥
    wait_for_grant: true                  # –û–ø—Ä–æ—Å —Å—Ç–∞—Ç—É—Å–∞ –≤–∫–ª—é—á–µ–Ω
    grant_wait_timeout_sec: 30            # –ñ–¥—ë–º –æ—Ç–≤–µ—Ç–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è 30 —Å–µ–∫—É–Ω–¥
```

### 3. –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è

–î–ª—è –¥–µ—Ç–∞–ª—å–Ω–æ–π –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏ –º–æ–∂–Ω–æ —É–≤–µ–ª–∏—á–∏—Ç—å —É—Ä–æ–≤–µ–Ω—å –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è:

```python
# –í main.py –∏–ª–∏ –≥–¥–µ –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç—Å—è –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
logging.basicConfig(level=logging.DEBUG)
```

---

## –¢–µ—Å—Ç–æ–≤—ã–π —Å—Ü–µ–Ω–∞—Ä–∏–π 1: –ü–æ–ª–Ω—ã–π —Ü–∏–∫–ª first_run —Å –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª–µ–Ω–∏–µ–º —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–π

### –®–∞–≥–∏:

1. **–£–¥–∞–ª–∏—Ç—å —Ñ–ª–∞–≥** –ø–µ—Ä–≤–æ–≥–æ –∑–∞–ø—É—Å–∫–∞ (—Å–º. –ø–æ–¥–≥–æ—Ç–æ–≤–∫—É)
2. **–ó–∞–ø—É—Å—Ç–∏—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ** –∏–∑ —Ç–µ—Ä–º–∏–Ω–∞–ª–∞ –¥–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ –ª–æ–≥–æ–≤
3. **–°–ª–µ–¥–∏—Ç—å –∑–∞ –ª–æ–≥–∞–º–∏** –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏:

### –û–∂–∏–¥–∞–µ–º—ã–µ —Å–æ–±—ã—Ç–∏—è –≤ –ª–æ–≥–∞—Ö:

#### –≠—Ç–∞–ø 1: –ù–∞—á–∞–ª–æ first_run (0-2 —Å–µ–∫—É–Ω–¥—ã)
```
üîê [FIRST_RUN_PERMISSIONS] –ü–µ—Ä–≤—ã–π –∑–∞–ø—É—Å–∫ –æ–±–Ω–∞—Ä—É–∂–µ–Ω - –∑–∞–ø—Ä–∞—à–∏–≤–∞–µ–º —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è
‚è≥ [PERMISSIONS] –ù–∞—á–∞—Ç –ø—Ä–æ—Ü–µ—Å—Å –∑–∞–ø—Ä–æ—Å–∞ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–π (session=...)
üîí [VOICE_RECOGNITION] First run –Ω–∞—á–∞—Ç - –±–ª–æ–∫–∏—Ä–æ–≤–∫–∞ –∞–∫—Ç–∏–≤–∞—Ü–∏–∏ –º–∏–∫—Ä–æ—Ñ–æ–Ω–∞
‚è≥ –û–∂–∏–¥–∞–Ω–∏–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –∑–∞–ø—Ä–æ—Å–∞ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–π...
```

**‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞**:
- –°–æ–±—ã—Ç–∏–µ `permissions.first_run_started` –æ–ø—É–±–ª–∏–∫–æ–≤–∞–Ω–æ
- VoiceRecognitionIntegration –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–∞ (`_first_run_in_progress = True`)
- Coordinator –∂–¥—ë—Ç –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è (`_permissions_in_progress = True`)

#### –≠—Ç–∞–ø 2: –ó–∞–ø—Ä–æ—Å Microphone (2-15 —Å–µ–∫—É–Ω–¥)
```
üéôÔ∏è [FIRST_RUN_PERMISSIONS] –ü—Ä–æ–≤–µ—Ä–∫–∞ Microphone...
   –°—Ç–∞—Ç—É—Å: not_determined
   –ê–∫—Ç–∏–≤–∏—Ä—É–µ–º Microphone —Å hold_duration=13.0 —Å–µ–∫...
   ‚úÖ Microphone activation –∑–∞–≤–µ—Ä—à–µ–Ω–∞ –∑–∞ 13.XX —Å–µ–∫ (–æ–∂–∏–¥–∞–ª–æ—Å—å 13.0 —Å–µ–∫)
   ‚è≥ –û–∂–∏–¥–∞–µ–º –æ—Ç–≤–µ—Ç–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è...
```

**–î–µ–π—Å—Ç–≤–∏–µ**:
- macOS –ø–æ–∫–∞–∂–µ—Ç –¥–∏–∞–ª–æ–≥ "Nexy would like to access your microphone"
- **–ù–∞–∂–∞—Ç—å "OK"**

**–û–∂–∏–¥–∞–µ–º—ã–π –ª–æ–≥**:
```
   ‚úÖ Microphone GRANTED (–ø—Ä–æ–≤–µ—Ä–µ–Ω–æ –∑–∞ X.X —Å–µ–∫)
```

**‚ö†Ô∏è –ö–†–ò–¢–ò–ß–ï–°–ö–ê–Ø –ü–†–û–í–ï–†–ö–ê**:
- **–ù–ï –î–û–õ–ñ–ù–û –ë–´–¢–¨** –ª–æ–≥–æ–≤ —Ç–∏–ø–∞:
  - `SessionCore_macOS_Legacy.mm:131   --> setPlayState Started  Input`
  - `MXCoreSession starting recording`
  - `VOICE: recording_start`
- –ï—Å–ª–∏ –µ—Å—Ç—å - –∑–Ω–∞—á–∏—Ç –±–ª–æ–∫–∏—Ä–æ–≤–∫–∞ –Ω–µ —Å—Ä–∞–±–æ—Ç–∞–ª–∞!

#### –≠—Ç–∞–ø 3: –ó–∞–ø—Ä–æ—Å Accessibility (15-30 —Å–µ–∫—É–Ω–¥)
```
‚ôø [FIRST_RUN_PERMISSIONS] –ü—Ä–æ–≤–µ—Ä–∫–∞ Accessibility...
   –°—Ç–∞—Ç—É—Å: not_determined
   –ê–∫—Ç–∏–≤–∏—Ä—É–µ–º Accessibility —Å hold_duration=13.0 —Å–µ–∫...
```

**–î–µ–π—Å—Ç–≤–∏–µ**:
- macOS –æ—Ç–∫—Ä–æ–µ—Ç System Settings ‚Üí Privacy & Security ‚Üí Accessibility
- **–í–∫–ª—é—á–∏—Ç—å –ø–µ—Ä–µ–∫–ª—é—á–∞—Ç–µ–ª—å** –¥–ª—è Nexy
- –í–µ—Ä–Ω—É—Ç—å—Å—è –≤ —Ç–µ—Ä–º–∏–Ω–∞–ª

**–û–∂–∏–¥–∞–µ–º—ã–π –ª–æ–≥**:
```
   ‚úÖ Accessibility GRANTED (–ø—Ä–æ–≤–µ—Ä–µ–Ω–æ –∑–∞ X.X —Å–µ–∫)
```

#### –≠—Ç–∞–ø 4: –ó–∞–ø—Ä–æ—Å Input Monitoring (30-45 —Å–µ–∫—É–Ω–¥)
```
‚å®Ô∏è [FIRST_RUN_PERMISSIONS] –ü—Ä–æ–≤–µ—Ä–∫–∞ Input Monitoring...
   –ê–∫—Ç–∏–≤–∏—Ä—É–µ–º Input Monitoring —Å hold_duration=13.0 —Å–µ–∫...
   ‚úÖ Input Monitoring GRANTED (–ø—Ä–æ–≤–µ—Ä–µ–Ω–æ –∑–∞ X.X —Å–µ–∫)
```

#### –≠—Ç–∞–ø 5: –ó–∞–ø—Ä–æ—Å Screen Capture (45-60 —Å–µ–∫—É–Ω–¥)
```
üì∫ [FIRST_RUN_PERMISSIONS] –ü—Ä–æ–≤–µ—Ä–∫–∞ Screen Capture...
   –ê–∫—Ç–∏–≤–∏—Ä—É–µ–º Screen Capture —Å hold_duration=13.0 —Å–µ–∫...
   ‚úÖ Screen Capture GRANTED (–ø—Ä–æ–≤–µ—Ä–µ–Ω–æ –∑–∞ X.X —Å–µ–∫)
```

#### –≠—Ç–∞–ø 6: –ó–∞–≤–µ—Ä—à–µ–Ω–∏–µ first_run –∏ –ø—É–±–ª–∏–∫–∞—Ü–∏—è —Å–æ–±—ã—Ç–∏—è
```
‚úÖ [FIRST_RUN_PERMISSIONS] –í—Å–µ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è –æ–±—Ä–∞–±–æ—Ç–∞–Ω—ã
‚úÖ [FIRST_RUN_PERMISSIONS] –§–ª–∞–≥ —Å–æ—Ö—Ä–∞–Ω—ë–Ω: /Users/.../permissions_first_run_completed.flag
[FIRST_RUN_PERMISSIONS] –§–ª–∞–≥ permissions_in_progress —Å–±—Ä–æ—à–µ–Ω
‚úÖ [FIRST_RUN_PERMISSIONS] –ü–µ—Ä–≤—ã–π –∑–∞–ø—É—Å–∫ –∑–∞–≤–µ—Ä—à—ë–Ω
‚úÖ [PERMISSIONS] –ó–∞–ø—Ä–æ—Å —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–π –∑–∞–≤–µ—Ä—à–µ–Ω (session=...)
‚úÖ –ó–∞–ø—Ä–æ—Å —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–π –∑–∞–≤–µ—Ä—à–µ–Ω, –ø—Ä–æ–¥–æ–ª–∂–∞–µ–º –∑–∞–ø—É—Å–∫...
```

**‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞**:
- –°–æ–±—ã—Ç–∏–µ `permissions.first_run_completed` –æ–ø—É–±–ª–∏–∫–æ–≤–∞–Ω–æ
- –§–ª–∞–≥ `_permissions_in_progress` —Å–±—Ä–æ—à–µ–Ω **–ü–û–°–õ–ï** –ø—É–±–ª–∏–∫–∞—Ü–∏–∏
- Coordinator —Ä–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∞–ª –∑–∞–ø—É—Å–∫ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–π

#### –≠—Ç–∞–ø 7: –ü–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞
```
[PERMISSION_RESTART] First run completed (session_id=...), scheduling restart
[PERMISSION_RESTART] Marked as first_run restart
[PERMISSION_RESTART] Scheduling application restart for Accessibility
[PERMISSION_RESTART] Restart scheduled successfully
```

**‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞**:
- –§–ª–∞–≥ `_is_first_run_restart = True` —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω
- –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫ –∑–∞–ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω

#### –≠—Ç–∞–ø 8: –í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞
```
[PERMISSION_RESTART] First run restart - bypassing SLEEPING mode check
[PERMISSION_RESTART] Restart requested for: Accessibility, Input Monitoring
[PERMISSION_RESTART] Relaunching packaged app: /Applications/Nexy.app
```

**–î–µ–π—Å—Ç–≤–∏–µ**:
- –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –¥–æ–ª–∂–Ω–æ **–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å—Å—è** –≤ —Ç–µ—á–µ–Ω–∏–µ 5-10 —Å–µ–∫—É–Ω–¥

**‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞**:
- –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∑–∞–∫—Ä—ã–≤–∞–µ—Ç—Å—è (`os._exit(0)`)
- –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç—Å—è —Å–Ω–æ–≤–∞
- **–ù–ï–¢** –ø–æ–≤—Ç–æ—Ä–Ω–æ–≥–æ –∑–∞–ø—Ä–æ—Å–∞ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–π

#### –≠—Ç–∞–ø 9: –ü–æ—Å–ª–µ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞
```
‚úÖ [FIRST_RUN_PERMISSIONS] –ü–µ—Ä–≤—ã–π –∑–∞–ø—É—Å–∫ —É–∂–µ –∑–∞–≤–µ—Ä—à—ë–Ω - –ø—Ä–æ–ø—É—Å–∫–∞–µ–º
üîì [VOICE_RECOGNITION] First run –∑–∞–≤–µ—Ä—à—ë–Ω - —Ä–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∫–∞ –∞–∫—Ç–∏–≤–∞—Ü–∏–∏ –º–∏–∫—Ä–æ—Ñ–æ–Ω–∞
```

**‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞**:
- FirstRunPermissionsIntegration –ø—Ä–æ–ø—É—Å–∫–∞–µ—Ç –ø–æ–≤—Ç–æ—Ä–Ω—ã–π –∑–∞–ø—Ä–æ—Å
- VoiceRecognitionIntegration —Ä–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–∞ (`_first_run_in_progress = False`)
- –ê—Å—Å–∏—Å—Ç–µ–Ω—Ç —Ä–∞–±–æ—Ç–∞–µ—Ç –Ω–æ—Ä–º–∞–ª—å–Ω–æ

---

## –¢–µ—Å—Ç–æ–≤—ã–π —Å—Ü–µ–Ω–∞—Ä–∏–π 2: –û—Ç–∫–∞–∑ –≤ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è—Ö

### –®–∞–≥–∏:

1. –£–¥–∞–ª–∏—Ç—å —Ñ–ª–∞–≥ –∏ –∑–∞–ø—É—Å—Ç–∏—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
2. –ü—Ä–∏ –∑–∞–ø—Ä–æ—Å–µ Microphone –Ω–∞–∂–∞—Ç—å **"Don't Allow"**
3. –ü—Ä–∏ –∑–∞–ø—Ä–æ—Å–µ Accessibility **–Ω–µ –≤–∫–ª—é—á–∞—Ç—å** –ø–µ—Ä–µ–∫–ª—é—á–∞—Ç–µ–ª—å

### –û–∂–∏–¥–∞–µ–º—ã–µ –ª–æ–≥–∏:

```
‚ö†Ô∏è Microphone DENIED (–ø—Ä–æ–≤–µ—Ä–µ–Ω–æ –∑–∞ X.X —Å–µ–∫)
‚ö†Ô∏è [FIRST_RUN_PERMISSIONS] Microphone –Ω–µ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª–µ–Ω –∏–ª–∏ —Ç–∞–π–º–∞—É—Ç
```

**‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞**:
- –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ **–≤—Å—ë —Ä–∞–≤–Ω–æ** –∑–∞–≤–µ—Ä—à–∞–µ—Ç first_run
- –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫ **–≤—Å—ë —Ä–∞–≤–Ω–æ** –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç
- –ü–æ—Å–ª–µ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —Ä–∞–±–æ—Ç–∞–µ—Ç (—Å –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è–º–∏)

---

## –¢–µ—Å—Ç–æ–≤—ã–π —Å—Ü–µ–Ω–∞—Ä–∏–π 3: –¢–∞–π–º–∞—É—Ç –æ–∂–∏–¥–∞–Ω–∏—è –æ—Ç–≤–µ—Ç–∞

### –®–∞–≥–∏:

1. –£–¥–∞–ª–∏—Ç—å —Ñ–ª–∞–≥ –∏ –∑–∞–ø—É—Å—Ç–∏—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
2. –ü—Ä–∏ –∑–∞–ø—Ä–æ—Å–µ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–π **–Ω–µ –Ω–∞–∂–∏–º–∞—Ç—å** –Ω–∏—á–µ–≥–æ –≤ —Ç–µ—á–µ–Ω–∏–µ 30 —Å–µ–∫—É–Ω–¥

### –û–∂–∏–¥–∞–µ–º—ã–µ –ª–æ–≥–∏:

```
‚è±Ô∏è Microphone - —Ç–∞–π–º–∞—É—Ç –æ–∂–∏–¥–∞–Ω–∏—è –æ—Ç–≤–µ—Ç–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (30 —Å–µ–∫)
‚ö†Ô∏è [FIRST_RUN_PERMISSIONS] Microphone –Ω–µ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª–µ–Ω –∏–ª–∏ —Ç–∞–π–º–∞—É—Ç
```

**‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞**:
- –ü–æ—Å–ª–µ —Ç–∞–π–º–∞—É—Ç–∞ –ø–µ—Ä–µ—Ö–æ–¥–∏—Ç –∫ —Å–ª–µ–¥—É—é—â–µ–º—É —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—é
- –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –Ω–µ –∑–∞–≤–∏—Å–∞–µ—Ç
- First_run –∑–∞–≤–µ—Ä—à–∞–µ—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ

---

## –¢–µ—Å—Ç–æ–≤—ã–π —Å—Ü–µ–Ω–∞—Ä–∏–π 4: –ü—Ä–æ–≤–µ—Ä–∫–∞ –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ –∞–∫—Ç–∏–≤–∞—Ü–∏–∏

### –¶–µ–ª—å: –£–±–µ–¥–∏—Ç—å—Å—è —á—Ç–æ –º–∏–∫—Ä–æ—Ñ–æ–Ω –ù–ï –∞–∫—Ç–∏–≤–∏—Ä—É–µ—Ç—Å—è –≤–æ –≤—Ä–µ–º—è first_run

### –®–∞–≥–∏:

1. –£–¥–∞–ª–∏—Ç—å —Ñ–ª–∞–≥ –∏ –∑–∞–ø—É—Å—Ç–∏—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
2. **–í–æ –≤—Ä–µ–º—è** –ø–æ–∫–∞–∑–∞ –¥–∏–∞–ª–æ–≥–æ–≤ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–π –ø–æ–ø—ã—Ç–∞—Ç—å—Å—è –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞—Ç—å –∞—Å—Å–∏—Å—Ç–µ–Ω—Ç:
   - –ù–∞–∂–∞—Ç—å –∫–Ω–æ–ø–∫—É –∞–∫—Ç–∏–≤–∞—Ü–∏–∏ (–µ—Å–ª–∏ –µ—Å—Ç—å)
   - –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å hotkey
   - –õ—é–±—ã–º –¥—Ä—É–≥–∏–º —Å–ø–æ—Å–æ–±–æ–º

### –û–∂–∏–¥–∞–µ–º—ã–µ –ª–æ–≥–∏:

```
‚ö†Ô∏è [VOICE_RECOGNITION] –ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞ –∞–∫—Ç–∏–≤–∞—Ü–∏–∏ - first_run –≤ –ø—Ä–æ—Ü–µ—Å—Å–µ.
   –ó–∞–ø–∏—Å—å –º–∏–∫—Ä–æ—Ñ–æ–Ω–∞ –≤–æ –≤—Ä–µ–º—è –∑–∞–ø—Ä–æ—Å–∞ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–π –∑–∞–ø—Ä–µ—â–µ–Ω–∞.
```

**‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞**:
- –ú–∏–∫—Ä–æ—Ñ–æ–Ω **–ù–ï –∞–∫—Ç–∏–≤–∏—Ä—É–µ—Ç—Å—è**
- –ó–∞–ø–∏—Å—å **–ù–ï –Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è**
- –ù–µ—Ç –ª–æ–≥–æ–≤ CoreAudio –æ —Å—Ç–∞—Ä—Ç–µ –∑–∞–ø–∏—Å–∏

---

## –ü—Ä–æ–≤–µ—Ä–æ—á–Ω—ã–π —á–µ–∫-–ª–∏—Å—Ç

### –ü–æ—Å–ª–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –≤—Å–µ—Ö —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤ —É–±–µ–¥–∏—Ç–µ—Å—å:

- [ ] –°–æ–±—ã—Ç–∏–µ `permissions.first_run_started` –ø—É–±–ª–∏–∫—É–µ—Ç—Å—è –≤ –Ω–∞—á–∞–ª–µ
- [ ] –°–æ–±—ã—Ç–∏–µ `permissions.first_run_completed` –ø—É–±–ª–∏–∫—É–µ—Ç—Å—è –≤ –∫–æ–Ω—Ü–µ
- [ ] –§–ª–∞–≥ `_permissions_in_progress` —Å–±—Ä–∞—Å—ã–≤–∞–µ—Ç—Å—è **–ø–æ—Å–ª–µ** –ø—É–±–ª–∏–∫–∞—Ü–∏–∏ —Å–æ–±—ã—Ç–∏—è
- [ ] VoiceRecognitionIntegration –±–ª–æ–∫–∏—Ä—É–µ—Ç—Å—è –Ω–∞ –≤—Å—ë –≤—Ä–µ–º—è first_run
- [ ] –ü–æ–ø—ã—Ç–∫–∏ –∞–∫—Ç–∏–≤–∞—Ü–∏–∏ –º–∏–∫—Ä–æ—Ñ–æ–Ω–∞ –±–ª–æ–∫–∏—Ä—É—é—Ç—Å—è —Å –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ–º
- [ ] –û–ø—Ä–æ—Å —Å—Ç–∞—Ç—É—Å–æ–≤ —Ä–∞–±–æ—Ç–∞–µ—Ç (–ª–æ–≥–∏ `‚úÖ ... GRANTED` –∏–ª–∏ `‚ö†Ô∏è ... DENIED/—Ç–∞–π–º–∞—É—Ç`)
- [ ] –§–ª–∞–≥ `_is_first_run_restart = True` —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è
- [ ] –ü—Ä–æ–≤–µ—Ä–∫–∞ SLEEPING —Ä–µ–∂–∏–º–∞ –ø—Ä–æ–ø—É—Å–∫–∞–µ—Ç—Å—è (–ª–æ–≥ `bypassing SLEEPING mode check`)
- [ ] –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –≤ —Ç–µ—á–µ–Ω–∏–µ 5-10 —Å–µ–∫—É–Ω–¥ –ø–æ—Å–ª–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è first_run
- [ ] –ü–æ—Å–ª–µ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞ first_run –Ω–µ –ø–æ–≤—Ç–æ—Ä—è–µ—Ç—Å—è
- [ ] –ü–æ—Å–ª–µ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞ –∞—Å—Å–∏—Å—Ç–µ–Ω—Ç —Ä–∞–±–æ—Ç–∞–µ—Ç –Ω–æ—Ä–º–∞–ª—å–Ω–æ

---

## –ï—Å–ª–∏ —á—Ç–æ-—Ç–æ –ø–æ—à–ª–æ –Ω–µ —Ç–∞–∫

### –ü—Ä–æ–±–ª–µ–º–∞ 1: –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –Ω–µ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è

**–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏**:
```bash
grep "PERMISSION_RESTART" /path/to/logfile
grep "Marked as first_run restart" /path/to/logfile
grep "bypassing SLEEPING mode check" /path/to/logfile
```

**–í–æ–∑–º–æ–∂–Ω—ã–µ –ø—Ä–∏—á–∏–Ω—ã**:
- –§–ª–∞–≥ `_is_first_run_restart` –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω
- –°–æ–±—ã—Ç–∏–µ `permissions.first_run_completed` –Ω–µ –æ–ø—É–±–ª–∏–∫–æ–≤–∞–Ω–æ
- PermissionRestartIntegration –Ω–µ –ø–æ–¥–ø–∏—Å–∞–Ω–∞ –Ω–∞ —Å–æ–±—ã—Ç–∏–µ

### –ü—Ä–æ–±–ª–µ–º–∞ 2: –ú–∏–∫—Ä–æ—Ñ–æ–Ω –∞–∫—Ç–∏–≤–∏—Ä—É–µ—Ç—Å—è –≤–æ –≤—Ä–µ–º—è first_run

**–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏**:
```bash
grep "first_run_in_progress" /path/to/logfile
grep "VOICE_RECOGNITION.*–±–ª–æ–∫–∏—Ä–æ–≤–∫–∞" /path/to/logfile
```

**–í–æ–∑–º–æ–∂–Ω—ã–µ –ø—Ä–∏—á–∏–Ω—ã**:
- VoiceRecognitionIntegration –Ω–µ –ø–æ–¥–ø–∏—Å–∞–Ω–∞ –Ω–∞ `permissions.first_run_started`
- –§–ª–∞–≥ `_first_run_in_progress` –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω
- –°–æ–±—ã—Ç–∏–µ `permissions.first_run_started` –Ω–µ –æ–ø—É–±–ª–∏–∫–æ–≤–∞–Ω–æ

### –ü—Ä–æ–±–ª–µ–º–∞ 3: Coordinator –Ω–µ —Ä–∞–∑–±–ª–æ–∫–∏—Ä—É–µ—Ç –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏

**–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏**:
```bash
grep "_permissions_in_progress" /path/to/logfile
grep "permissions.first_run_completed" /path/to/logfile
```

**–í–æ–∑–º–æ–∂–Ω—ã–µ –ø—Ä–∏—á–∏–Ω—ã**:
- –§–ª–∞–≥ —Å–±—Ä–∞—Å—ã–≤–∞–µ—Ç—Å—è –¥–æ –ø—É–±–ª–∏–∫–∞—Ü–∏–∏ —Å–æ–±—ã—Ç–∏—è (race condition –Ω–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω)
- –°–æ–±—ã—Ç–∏–µ –Ω–µ –ø—É–±–ª–∏–∫—É–µ—Ç—Å—è
- –¢–∞–π–º–∞—É—Ç –æ–∂–∏–¥–∞–Ω–∏—è (5 –º–∏–Ω—É—Ç)

---

## –û—Ç—á—ë—Ç –æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–∏

–ü–æ—Å–ª–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –∑–∞–ø–æ–ª–Ω–∏—Ç–µ:

### –û–∫—Ä—É–∂–µ–Ω–∏–µ:
- macOS –≤–µ—Ä—Å–∏—è: __________
- Python –≤–µ—Ä—Å–∏—è: __________
- –î–∞—Ç–∞ —Ç–µ—Å—Ç–∞: __________

### –†–µ–∑—É–ª—å—Ç–∞—Ç—ã:

| –°—Ü–µ–Ω–∞—Ä–∏–π | –°—Ç–∞—Ç—É—Å | –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ |
|----------|--------|-------------|
| –°—Ü–µ–Ω–∞—Ä–∏–π 1: –ü–æ–ª–Ω—ã–π —Ü–∏–∫–ª —Å –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª–µ–Ω–∏–µ–º —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–π | ‚òê Pass ‚òê Fail | |
| –°—Ü–µ–Ω–∞—Ä–∏–π 2: –û—Ç–∫–∞–∑ –≤ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è—Ö | ‚òê Pass ‚òê Fail | |
| –°—Ü–µ–Ω–∞—Ä–∏–π 3: –¢–∞–π–º–∞—É—Ç –æ–∂–∏–¥–∞–Ω–∏—è | ‚òê Pass ‚òê Fail | |
| –°—Ü–µ–Ω–∞—Ä–∏–π 4: –ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞ –∞–∫—Ç–∏–≤–∞—Ü–∏–∏ | ‚òê Pass ‚òê Fail | |

### –ù–∞–π–¥–µ–Ω–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã:
1. _____________________
2. _____________________
3. _____________________

### –õ–æ–≥–∏ (–ø—Ä–∏–∫—Ä–µ–ø–∏—Ç—å):
```
[–í—Å—Ç–∞–≤–∏—Ç—å —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω—ã–µ —Ñ—Ä–∞–≥–º–µ–Ω—Ç—ã –ª–æ–≥–æ–≤]
```

---

## –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

### –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å:
- –í—Ä–µ–º—è –ø–æ–ª–Ω–æ–≥–æ —Ü–∏–∫–ª–∞ first_run: _______ —Å–µ–∫—É–Ω–¥
- –í—Ä–µ–º—è –¥–æ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞ –ø–æ—Å–ª–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è: _______ —Å–µ–∫—É–Ω–¥
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ CPU –≤–æ –≤—Ä–µ–º—è –æ–ø—Ä–æ—Å–∞ —Å—Ç–∞—Ç—É—Å–æ–≤: _______%

### –°—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å:
- –ü–æ–≤—Ç–æ—Ä–∏—Ç—å —Å—Ü–µ–Ω–∞—Ä–∏–π 1 **3 —Ä–∞–∑–∞** - –≤—Å–µ –∑–∞–ø—É—Å–∫–∏ –¥–æ–ª–∂–Ω—ã –ø—Ä–æ–π—Ç–∏ –∏–¥–µ–Ω—Ç–∏—á–Ω–æ
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–∞–±–æ—Ç—É –ø–æ—Å–ª–µ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞ —Å–∏—Å—Ç–µ–º—ã

---

**–£—Å–ø–µ—à–Ω–æ–≥–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è!** üöÄ
