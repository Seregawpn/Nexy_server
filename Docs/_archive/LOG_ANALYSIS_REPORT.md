# üìã –ê–Ω–∞–ª–∏–∑ –ª–æ–≥–æ–≤: –ü–æ—á–µ–º—É –∞—Å—Å–∏—Å—Ç–µ–Ω—Ç –Ω–µ —Ä–µ–∞–≥–∏—Ä—É–µ—Ç

**–î–∞—Ç–∞:** 2025-12-13  
**–ü—Ä–æ–±–ª–µ–º–∞:** –ê—Å—Å–∏—Å—Ç–µ–Ω—Ç –Ω–µ —Ä–µ–∞–≥–∏—Ä—É–µ—Ç, –∫–æ–≥–¥–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∞–∫—Ç–∏–≤–∏—Ä—É–µ—Ç –º–∏–∫—Ä–æ—Ñ–æ–Ω –∏ –≥–æ–≤–æ—Ä–∏—Ç –∑–∞–¥–∞—á—É

## üîç –ö–ª—é—á–µ–≤—ã–µ –Ω–∞—Ö–æ–¥–∫–∏ –∏–∑ –ª–æ–≥–æ–≤

### –ü—Ä–æ–±–ª–µ–º–∞ 1: Google Speech Recognition callback –ù–ï –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è (–ö–†–ò–¢–ò–ß–ï–°–ö–ê–Ø)

**–°—Ç—Ä–æ–∫–∞ 87-101 –≤ –ª–æ–≥–∞—Ö:**
```
‚ùå [Google] Callback –ù–ï –≤—ã–∑–≤–∞–Ω —á–µ—Ä–µ–∑ 2 —Å–µ–∫—É–Ω–¥—ã –ø–æ—Å–ª–µ listen_in_background!
‚ùå [Google] –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞:
   - _google_recording_active=True
   - _google_stop_listening=True
   - state_mic_active=True
   - energy_threshold=1764.782411753234
   - device_index=0
   - sample_rate=24000
   - AVF is_input_active=False
```

**–ü—Ä–∏—á–∏–Ω–∞:** Callback –æ—Ç `listen_in_background()` –Ω–µ –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è, —á—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç, —á—Ç–æ –∞—É–¥–∏–æ –¥–∞–Ω–Ω—ã–µ –Ω–µ –ø–æ—Å—Ç—É–ø–∞—é—Ç –≤ Google Speech Recognition.

### –ü—Ä–æ–±–ª–µ–º–∞ 2: –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è LEGACY –ø—É—Ç—å –≤–º–µ—Å—Ç–æ Google –ø—É—Ç–∏ (–ö–†–ò–¢–ò–ß–ï–°–ö–ê–Ø)

**–°—Ç—Ä–æ–∫–∞ 103 –≤ –ª–æ–≥–∞—Ö:**
```
‚ö†Ô∏è [VOICE] –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è LEGACY –ø—É—Ç—å —á–µ—Ä–µ–∑ SpeechRecognizer.start_listening() - —ç—Ç–æ –∞–∫—Ç–∏–≤–∏—Ä—É–µ—Ç AVF –ø–æ—Ç–æ–∫!
```

**–ü—Ä–∏—á–∏–Ω–∞:** –ö–æ–¥ –Ω–µ –¥–æ—à–µ–ª –¥–æ —Å–æ–∑–¥–∞–Ω–∏—è Google –æ–±—ä–µ–∫—Ç–æ–≤ (`_google_recognizer`, `_google_microphone`), –ø–æ—ç—Ç–æ–º—É –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è LEGACY –ø—É—Ç—å.

### –ü—Ä–æ–±–ª–µ–º–∞ 3: Google –æ–±—ä–µ–∫—Ç—ã –Ω–µ —Å–æ–∑–¥–∞–Ω—ã, —Ö–æ—Ç—è _use_avf=True (–ö–†–ò–¢–ò–ß–ï–°–ö–ê–Ø)

**–°—Ç—Ä–æ–∫–∞ 421 –≤ –ª–æ–≥–∞—Ö:**
```
üîç [Google] –ü—Ä–æ–≤–µ—Ä–∫–∞ —É—Å–ª–æ–≤–∏–π –¥–ª—è –Ω–æ–≤–æ–π –ª–æ–≥–∏–∫–∏: _use_avf=True, _google_recognizer=None, _google_microphone=None
```

**–ü—Ä–∏—á–∏–Ω–∞:** –£—Å–ª–æ–≤–∏–µ `if self._use_avf and self._avf_engine is not None:` –Ω–µ –≤—ã–ø–æ–ª–Ω–∏–ª–æ—Å—å –ø—Ä–∏ –≤—ã–∑–æ–≤–µ `_on_recording_start`, –ø–æ—ç—Ç–æ–º—É Google –æ–±—ä–µ–∫—Ç—ã –Ω–µ –±—ã–ª–∏ —Å–æ–∑–¥–∞–Ω—ã.

### –ü—Ä–æ–±–ª–µ–º–∞ 4: –ù–µ—Ç –∞—É–¥–∏–æ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏—è (–°–õ–ï–î–°–¢–í–ò–ï)

**–°—Ç—Ä–æ–∫–∞ 243 –≤ –ª–æ–≥–∞—Ö:**
```
‚ö†Ô∏è –ù–µ—Ç –∞—É–¥–∏–æ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏—è
‚ö†Ô∏è –†–µ—á—å –Ω–µ —Ä–∞—Å–ø–æ–∑–Ω–∞–Ω–∞
```

**–ü—Ä–∏—á–∏–Ω–∞:** LEGACY –ø—É—Ç—å –Ω–µ –ø–æ–ª—É—á–∞–µ—Ç –∞—É–¥–∏–æ –¥–∞–Ω–Ω—ã–µ, –∏–ª–∏ –¥–∞–Ω–Ω—ã–µ –Ω–µ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—é—Ç—Å—è –ø—Ä–∞–≤–∏–ª—å–Ω–æ.

## üîç –ê–Ω–∞–ª–∏–∑ –ø–æ—Ç–æ–∫–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è

### –û–∂–∏–¥–∞–µ–º—ã–π –ø–æ—Ç–æ–∫ (–Ω–æ–≤–∞—è –ª–æ–≥–∏–∫–∞):
1. `_on_recording_start()` –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è
2. –ü—Ä–æ–≤–µ—Ä–∫–∞: `if self._use_avf and self._avf_engine is not None:`
3. –ü–æ–ª—É—á–µ–Ω–∏–µ –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏ —á–µ—Ä–µ–∑ AVF
4. –î–µ–∞–∫—Ç–∏–≤–∞—Ü–∏—è AVF
5. –°–æ–∑–¥–∞–Ω–∏–µ Google –æ–±—ä–µ–∫—Ç–æ–≤ (`_google_recognizer`, `_google_microphone`)
6. –ó–∞–ø—É—Å–∫ `listen_in_background()`
7. Callback –ø–æ–ª—É—á–∞–µ—Ç –∞—É–¥–∏–æ –¥–∞–Ω–Ω—ã–µ
8. –†–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏–µ —Ä–µ—á–∏

### –§–∞–∫—Ç–∏—á–µ—Å–∫–∏–π –ø–æ—Ç–æ–∫ (–∏–∑ –ª–æ–≥–æ–≤):
1. `_on_recording_start()` –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è
2. ‚ùå –£—Å–ª–æ–≤–∏–µ `if self._use_avf and self._avf_engine is not None:` –ù–ï –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è
3. –ü–µ—Ä–µ—Ö–æ–¥ –Ω–∞ LEGACY –ø—É—Ç—å
4. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ `SpeechRecognizer.start_listening()`
5. ‚ùå Callback –ù–ï –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è (–µ—Å–ª–∏ –±—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª—Å—è Google –ø—É—Ç—å)
6. ‚ùå –ù–µ—Ç –∞—É–¥–∏–æ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏—è

## üéØ –ö–æ—Ä–Ω–µ–≤–∞—è –ø—Ä–∏—á–∏–Ω–∞

**–í–µ—Ä–æ—è—Ç–Ω–∞—è –ø—Ä–∏—á–∏–Ω–∞:** `_avf_engine is None` –ø—Ä–∏ –≤—ã–∑–æ–≤–µ `_on_recording_start()`, —Ö–æ—Ç—è `_use_avf=True`.

**–í–æ–∑–º–æ–∂–Ω—ã–µ –ø—Ä–∏—á–∏–Ω—ã:**
1. `_avf_engine` –Ω–µ –±—ã–ª —Å–æ–∑–¥–∞–Ω –ø—Ä–∏ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ (–∏—Å–∫–ª—é—á–µ–Ω–∏–µ –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ `AVFAudioEngine`)
2. `_avf_engine` –±—ã–ª —Å–æ–∑–¥–∞–Ω, –Ω–æ –∑–∞—Ç–µ–º —Å—Ç–∞–ª `None` (–æ—á–∏—Å—Ç–∫–∞ –∏–ª–∏ –æ—à–∏–±–∫–∞)
3. –ò—Å–∫–ª—é—á–µ–Ω–∏–µ –≤ –±–ª–æ–∫–µ –Ω–æ–≤–æ–π –ª–æ–≥–∏–∫–∏ –¥–æ —Å–æ–∑–¥–∞–Ω–∏—è Google –æ–±—ä–µ–∫—Ç–æ–≤

## üîß –†–µ—à–µ–Ω–∏–µ

### –®–∞–≥ 1: –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—é AVF
- –£–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ `_avf_engine` —Å–æ–∑–¥–∞–µ—Ç—Å—è –ø—Ä–∏ `initialize()`
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ –Ω–∞ –Ω–∞–ª–∏—á–∏–µ –∏—Å–∫–ª—é—á–µ–Ω–∏–π

### –®–∞–≥ 2: –î–æ–±–∞–≤–∏—Ç—å –¥–µ—Ç–∞–ª—å–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
- –õ–æ–≥–∏—Ä–æ–≤–∞—Ç—å —Å–æ—Å—Ç–æ—è–Ω–∏–µ `_avf_engine` –ø—Ä–∏ –≤—ã–∑–æ–≤–µ `_on_recording_start()`
- –õ–æ–≥–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–∏—á–∏–Ω—É, –ø–æ—á–µ–º—É –Ω–æ–≤–∞—è –ª–æ–≥–∏–∫–∞ –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è

### –®–∞–≥ 3: –ò—Å–ø—Ä–∞–≤–∏—Ç—å –ø—Ä–æ–±–ª–µ–º—É —Å callback
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, –ø–æ—á–µ–º—É `listen_in_background()` callback –Ω–µ –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è –º–∏–∫—Ä–æ—Ñ–æ–Ω–∞
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, –Ω–µ –∑–∞–Ω—è—Ç –ª–∏ –º–∏–∫—Ä–æ—Ñ–æ–Ω –¥—Ä—É–≥–∏–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ–º

### –®–∞–≥ 4: –ò—Å–ø—Ä–∞–≤–∏—Ç—å LEGACY –ø—É—Ç—å
- –£–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ LEGACY –ø—É—Ç—å –ø—Ä–∞–≤–∏–ª—å–Ω–æ –ø–æ–ª—É—á–∞–µ—Ç –∏ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –∞—É–¥–∏–æ –¥–∞–Ω–Ω—ã–µ
- –ò–ª–∏ –∏—Å–ø—Ä–∞–≤–∏—Ç—å –ø—Ä–æ–±–ª–µ–º—É —Å AVF, —á—Ç–æ–±—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å Google –ø—É—Ç—å

## üìù –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

1. **–ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏:** –ù–∞–π—Ç–∏, –ø–æ—á–µ–º—É `_avf_engine` –º–æ–∂–µ—Ç –±—ã—Ç—å `None`
2. **–î–æ–±–∞–≤–∏—Ç—å –¥–µ—Ç–∞–ª—å–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ:** –õ–æ–≥–∏—Ä–æ–≤–∞—Ç—å —Å–æ—Å—Ç–æ—è–Ω–∏–µ `_avf_engine` –ø—Ä–∏ –∫–∞–∂–¥–æ–º –≤—ã–∑–æ–≤–µ `_on_recording_start()`
3. **–ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è:** –£–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è –º–∏–∫—Ä–æ—Ñ–æ–Ω–∞ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª–µ–Ω—ã
4. **–ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∑–∞–Ω—è—Ç–æ—Å—Ç—å –º–∏–∫—Ä–æ—Ñ–æ–Ω–∞:** –£–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ –º–∏–∫—Ä–æ—Ñ–æ–Ω –Ω–µ –∑–∞–Ω—è—Ç –¥—Ä—É–≥–∏–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ–º
