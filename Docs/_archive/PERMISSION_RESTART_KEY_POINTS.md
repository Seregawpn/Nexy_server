# üîë Permission Restart - –ö–ª—é—á–µ–≤—ã–µ –º–æ–º–µ–Ω—Ç—ã –∏ –Ω—é–∞–Ω—Å—ã

**–í–µ—Ä—Å–∏—è**: 1.0
**–î–∞—Ç–∞**: 2025-10-30
**–ê—É–¥–∏—Ç–æ—Ä–∏—è**: –†–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∏, QA, DevOps

---

## üìã –ö—Ä–∞—Ç–∫–æ–µ —Ä–µ–∑—é–º–µ

–≠—Ç–æ—Ç –¥–æ–∫—É–º–µ–Ω—Ç —Å–æ–¥–µ—Ä–∂–∏—Ç **—Å–∞–º—ã–µ –≤–∞–∂–Ω—ã–µ –º–æ–º–µ–Ω—Ç—ã**, –∫–æ—Ç–æ—Ä—ã–µ –Ω—É–∂–Ω–æ –ø–æ–Ω–∏–º–∞—Ç—å –æ –º–µ—Ö–∞–Ω–∏–∑–º–µ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞ –ø–æ—Å–ª–µ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª–µ–Ω–∏—è —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–π.

---

## üéØ 1. –ü–æ—á–µ–º—É –≤–æ–æ–±—â–µ –Ω—É–∂–µ–Ω –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫?

### –ü—Ä–æ–±–ª–µ–º–∞ macOS TCC (Transparency, Consent, and Control)

```
‚ùå –ù–ï–ü–†–ê–í–ò–õ–¨–ù–û–ï –ü–û–ù–ò–ú–ê–ù–ò–ï:
"–ï—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–∏—Ç —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–µ –≤ System Settings,
–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —Å—Ä–∞–∑—É –ø–æ–ª—É—á–∏—Ç –¥–æ—Å—Ç—É–ø"

‚úÖ –ü–†–ê–í–ò–õ–¨–ù–û–ï –ü–û–ù–ò–ú–ê–ù–ò–ï:
"macOS –ø—Ä–∏–º–µ–Ω—è–µ—Ç —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è –¢–û–õ–¨–ö–û –∫ –ù–û–í–û–ú–£ –ø—Ä–æ—Ü–µ—Å—Å—É –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è.
–¢–µ–∫—É—â–∏–π –ø—Ä–æ—Ü–µ—Å—Å –ù–ï –ü–û–õ–£–ß–ê–ï–¢ –¥–æ—Å—Ç—É–ø –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏"
```

**–¢–µ—Ö–Ω–∏—á–µ—Å–∫–∞—è –ø—Ä–∏—á–∏–Ω–∞**:
- TCC –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è ‚Üí `‚úÖ granted`
- –ù–û –ø—Ä–æ—Ü–µ—Å—Å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –£–ñ–ï –∑–∞–ø—É—â–µ–Ω —Å –ø—Ä–∞–≤–∞–º–∏ ‚Üí `‚ùå denied`
- –ù—É–∂–µ–Ω **–ù–û–í–´–ô –ø—Ä–æ—Ü–µ—Å—Å** —á—Ç–æ–±—ã macOS –ø—Ä–æ–≤–µ—Ä–∏–ª TCC –∑–∞–Ω–æ–≤–æ

**–°–ª–µ–¥—Å—Ç–≤–∏—è –±–µ–∑ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞**:
```
–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è ‚úÖ
         ‚Üì
–ù–æ —Ç–µ–∫—É—â–∏–π –ø—Ä–æ—Ü–µ—Å—Å –∏—Ö –ù–ï –≤–∏–¥–∏—Ç ‚ùå
         ‚Üì
–ö–ª–∞–≤–∏–∞—Ç—É—Ä–∞ –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç ‚ùå
–ú–∏–∫—Ä–æ—Ñ–æ–Ω –Ω–µ –∞–∫—Ç–∏–≤–∏—Ä—É–µ—Ç—Å—è ‚ùå
Accessibility API –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω ‚ùå
         ‚Üì
–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –¥—É–º–∞–µ—Ç "–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —Å–ª–æ–º–∞–Ω–æ" üòû
```

**–° –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–æ–º**:
```
–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è ‚úÖ
         ‚Üì
–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –æ–±–Ω–∞—Ä—É–∂–∏–≤–∞–µ—Ç –∏–∑–º–µ–Ω–µ–Ω–∏–µ (polling 3 —Å–µ–∫) ‚úÖ
         ‚Üì
–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫ —á–µ—Ä–µ–∑ 5 —Å–µ–∫—É–Ω–¥ üîÑ
         ‚Üì
–ù–æ–≤—ã–π –ø—Ä–æ—Ü–µ—Å—Å –ø–æ–ª—É—á–∞–µ—Ç —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è –æ—Ç macOS ‚úÖ
         ‚Üì
–í—Å—ë —Ä–∞–±–æ—Ç–∞–µ—Ç! üéâ
```

---

## üèóÔ∏è 2. –î–≤–∞ —Ä–µ–∂–∏–º–∞ —Ä–∞–±–æ—Ç—ã

### –†–µ–∂–∏–º 1: –ü–µ—Ä–≤—ã–π –∑–∞–ø—É—Å–∫ (—Ñ–ª–∞–≥–∞ –Ω–µ—Ç)

**–ö–æ–≥–¥–∞**: –°–∞–º—ã–π –ø–µ—Ä–≤—ã–π –∑–∞–ø—É—Å–∫ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –Ω–∞ –Ω–æ–≤–æ–π –º–∞—à–∏–Ω–µ –∏–ª–∏ –ø–æ—Å–ª–µ —Å–±—Ä–æ—Å–∞

**–ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç**:
```
1. FirstRunPermissionsIntegration –ø—Ä–æ–≤–µ—Ä—è–µ—Ç —Ñ–ª–∞–≥
   permissions_first_run_completed.flag ‚Üí –ù–ï –°–£–©–ï–°–¢–í–£–ï–¢

2. –ó–∞–ø—Ä–∞—à–∏–≤–∞–µ—Ç —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è —á–µ—Ä–µ–∑ –¥–∏–∞–ª–æ–≥–∏ macOS
   - Microphone ‚Üí AVFoundation –¥–∏–∞–ª–æ–≥
   - Accessibility ‚Üí –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –≤ System Settings
   - Input Monitoring ‚Üí –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –≤ System Settings

3. –°–æ–∑–¥–∞—ë—Ç —Ñ–ª–∞–≥:
   ~/Library/Application Support/Nexy/permissions_first_run_completed.flag

4. –ü—É–±–ª–∏–∫—É–µ—Ç —Å–æ–±—ã—Ç–∏–µ:
   permissions.first_run_completed

5. PermissionRestartIntegration –ø–æ–ª—É—á–∞–µ—Ç —Å–æ–±—ã—Ç–∏–µ

6. –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ ‚úÖ
```

**–§–∞–π–ª**: [first_run_permissions_integration.py:110-145](../integration/integrations/first_run_permissions_integration.py#L110-L145)

---

### –†–µ–∂–∏–º 2: –ü–æ—Å–ª–µ –ø–µ—Ä–≤–æ–≥–æ –∑–∞–ø—É—Å–∫–∞ (—Ñ–ª–∞–≥ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç) üÜï

**–ö–æ–≥–¥–∞**: –ü—Ä–∏ –≤—Å–µ—Ö –ø–æ—Å–ª–µ–¥—É—é—â–∏—Ö –∑–∞–ø—É—Å–∫–∞—Ö –ø–æ—Å–ª–µ –ø–µ—Ä–≤–æ–≥–æ

**–ü—Ä–æ–±–ª–µ–º–∞ –∫–æ—Ç–æ—Ä—É—é —Ä–µ—à–∞–µ—Ç**:
```
–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –û–¢–ö–õ–û–ù–ò–õ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è –ø—Ä–∏ –ø–µ—Ä–≤–æ–º –∑–∞–ø—É—Å–∫–µ ‚ùå
         ‚Üì
–§–ª–∞–≥ —Å–æ–∑–¥–∞—ë—Ç—Å—è –≤—Å—ë —Ä–∞–≤–Ω–æ (—á—Ç–æ–±—ã –Ω–µ —Ä–∞–∑–¥—Ä–∞–∂–∞—Ç—å –ø–æ–≤—Ç–æ—Ä–Ω—ã–º–∏ –∑–∞–ø—Ä–æ—Å–∞–º–∏)
         ‚Üì
–ü—Ä–∏ —Å–ª–µ–¥—É—é—â–∏—Ö –∑–∞–ø—É—Å–∫–∞—Ö FirstRunPermissions –ø—Ä–æ–ø—É—Å–∫–∞–µ—Ç –ø—Ä–æ—Ü–µ–¥—É—Ä—É
         ‚Üì
–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∏–¥—ë—Ç –≤ System Settings –∏ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è –≤—Ä—É—á–Ω—É—é ‚úÖ
         ‚Üì
‚ùå –ë–ï–ó —Ä–µ–∂–∏–º–∞ 2: –ù–∏–∫—Ç–æ –Ω–µ —É–∑–Ω–∞–µ—Ç! –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫ –Ω–µ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç!
‚úÖ –° —Ä–µ–∂–∏–º–æ–º 2: –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –æ–±–Ω–∞—Ä—É–∂–∏–≤–∞–µ—Ç! –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç!
```

**–ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç**:
```
1. PermissionRestartIntegration._do_start() –ø—Ä–æ–≤–µ—Ä—è–µ—Ç —Ñ–ª–∞–≥
   permissions_first_run_completed.flag ‚Üí –°–£–©–ï–°–¢–í–£–ï–¢

2. –ó–∞–ø—É—Å–∫–∞–µ—Ç —Ñ–æ–Ω–æ–≤—ã–π –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ (polling):
   _start_permission_monitoring()

3. –ö–∞–∂–¥—ã–µ 3 —Å–µ–∫—É–Ω–¥—ã –ø—Ä–æ–≤–µ—Ä—è–µ—Ç —Å—Ç–∞—Ç—É—Å—ã:
   - check_accessibility_status()
   - check_input_monitoring_status()

4. –°—Ä–∞–≤–Ω–∏–≤–∞–µ—Ç —Å _last_known_statuses

5. –ï—Å–ª–∏ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–æ –∏–∑–º–µ–Ω–µ–Ω–∏–µ –Ω–∞ GRANTED:
   - –ü—É–±–ª–∏–∫—É–µ—Ç —Å–∏–Ω—Ç–µ—Ç–∏—á–µ—Å–∫–æ–µ —Å–æ–±—ã—Ç–∏–µ
   - RestartScheduler –ø–æ–ª—É—á–∞–µ—Ç —Å–æ–±—ã—Ç–∏–µ
   - –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ ‚úÖ
```

**–§–∞–π–ª**: [permission_restart_integration.py:120-124, 295-444](../integration/integrations/permission_restart_integration.py#L120-L124)

---

## ‚öôÔ∏è 3. –ö–ª—é—á–µ–≤–∞—è —Ä–æ–ª—å —Ñ–ª–∞–≥–∞

### –ß—Ç–æ —Ç–∞–∫–æ–µ —Ñ–ª–∞–≥?

```
–ü—É—Ç—å: ~/Library/Application Support/Nexy/permissions_first_run_completed.flag
–¢–∏–ø: –ü—É—Å—Ç–æ–π —Ñ–∞–π–ª (0 –±–∞–π—Ç)
–°–æ–∑–¥–∞—ë—Ç—Å—è: –ü—Ä–∏ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–∏ –ø–µ—Ä–≤–æ–≥–æ –∑–∞–ø—Ä–æ—Å–∞ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–π
–£–¥–∞–ª—è–µ—Ç—Å—è: –ù–∏–∫–æ–≥–¥–∞ (–∏–ª–∏ –≤—Ä—É—á–Ω—É—é –¥–ª—è —Å–±—Ä–æ—Å–∞)
```

### –ó–∞—á–µ–º –Ω—É–∂–µ–Ω —Ñ–ª–∞–≥?

**–ë–ï–ó —Ñ–ª–∞–≥–∞** (–ø–ª–æ—Ö–æ):
```
–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∑–∞–ø—É—Å–∫–∞–µ—Ç –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
         ‚Üì
–î–∏–∞–ª–æ–≥: "–†–∞–∑—Ä–µ—à–∏—Ç—å –º–∏–∫—Ä–æ—Ñ–æ–Ω?" ‚Üí –û—Ç–∫–ª–æ–Ω–∏—Ç—å ‚ùå
         ‚Üì
–°–ª–µ–¥—É—é—â–∏–π –∑–∞–ø—É—Å–∫
         ‚Üì
–î–∏–∞–ª–æ–≥: "–†–∞–∑—Ä–µ—à–∏—Ç—å –º–∏–∫—Ä–æ—Ñ–æ–Ω?" ‚Üí –û–ø—è—Ç—å??? üò†
         ‚Üì
–°–ª–µ–¥—É—é—â–∏–π –∑–∞–ø—É—Å–∫
         ‚Üì
–î–∏–∞–ª–æ–≥: "–†–∞–∑—Ä–µ—à–∏—Ç—å –º–∏–∫—Ä–æ—Ñ–æ–Ω?" ‚Üí –î–û–°–¢–ê–õ–û! ü§¨
```

**–° —Ñ–ª–∞–≥–æ–º** (—Ö–æ—Ä–æ—à–æ):
```
–ü–µ—Ä–≤—ã–π –∑–∞–ø—É—Å–∫
         ‚Üì
–î–∏–∞–ª–æ–≥: "–†–∞–∑—Ä–µ—à–∏—Ç—å –º–∏–∫—Ä–æ—Ñ–æ–Ω?" ‚Üí –û—Ç–∫–ª–æ–Ω–∏—Ç—å ‚ùå
         ‚Üì
–§–ª–∞–≥ —Å–æ–∑–¥–∞–Ω ‚úÖ
         ‚Üì
–°–ª–µ–¥—É—é—â–∏–π –∑–∞–ø—É—Å–∫
         ‚Üì
–î–∏–∞–ª–æ–≥–∏ –ù–ï –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç—Å—è ‚úÖ
–ù–û –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —Ä–∞–±–æ—Ç–∞–µ—Ç —Ñ–æ–Ω–æ–º üîç
         ‚Üì
–ï—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø–µ—Ä–µ–¥—É–º–∞–µ—Ç ‚Üí –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –æ–±–Ω–∞—Ä—É–∂–∏—Ç ‚úÖ
```

### –ü–æ—á–µ–º—É —Ñ–ª–∞–≥ —Å–æ–∑–¥–∞—ë—Ç—Å—è –¥–∞–∂–µ –ø—Ä–∏ –æ—à–∏–±–∫–µ?

**–ö–æ–¥**: [first_run_permissions_integration.py:162-165](../integration/integrations/first_run_permissions_integration.py#L162-L165)

```python
# –°–æ—Ö—Ä–∞–Ω—è–µ–º —Ñ–ª–∞–≥ –¥–∞–∂–µ –ø—Ä–∏ –æ—à–∏–±–∫–µ —á—Ç–æ–±—ã –Ω–µ –∑–∞—Å—Ç—Ä—è—Ç—å –≤ —Ü–∏–∫–ª–µ
try:
    self.flag_file.touch()
    logger.info("‚úÖ [FIRST_RUN_PERMISSIONS] –§–ª–∞–≥ —Å–æ—Ö—Ä–∞–Ω—ë–Ω (–ø–æ—Å–ª–µ –æ—à–∏–±–∫–∏)")
except Exception:
    pass
```

**–ü—Ä–∏—á–∏–Ω–∞**: –ó–∞—â–∏—Ç–∞ –æ—Ç –±–µ—Å–∫–æ–Ω–µ—á–Ω–æ–≥–æ —Ü–∏–∫–ª–∞ –ø–æ–ø—ã—Ç–æ–∫

**–°—Ü–µ–Ω–∞—Ä–∏–π –±–µ–∑ –∑–∞—â–∏—Ç—ã**:
```
–ü–µ—Ä–≤—ã–π –∑–∞–ø—É—Å–∫ ‚Üí –û—à–∏–±–∫–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä, macOS API –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω) ‚Üí –§–ª–∞–≥ –ù–ï —Å–æ–∑–¥–∞–Ω
         ‚Üì
–í—Ç–æ—Ä–æ–π –∑–∞–ø—É—Å–∫ ‚Üí –¢–∞ –∂–µ –æ—à–∏–±–∫–∞ ‚Üí –§–ª–∞–≥ –ù–ï —Å–æ–∑–¥–∞–Ω
         ‚Üì
–¢—Ä–µ—Ç–∏–π –∑–∞–ø—É—Å–∫ ‚Üí –¢–∞ –∂–µ –æ—à–∏–±–∫–∞ ‚Üí –§–ª–∞–≥ –ù–ï —Å–æ–∑–¥–∞–Ω
         ‚Üì
... –ë–µ—Å–∫–æ–Ω–µ—á–Ω—ã–π —Ü–∏–∫–ª! ‚ôæÔ∏è
```

**–°—Ü–µ–Ω–∞—Ä–∏–π —Å –∑–∞—â–∏—Ç–æ–π**:
```
–ü–µ—Ä–≤—ã–π –∑–∞–ø—É—Å–∫ ‚Üí –û—à–∏–±–∫–∞ ‚Üí –§–ª–∞–≥ —Å–æ–∑–¥–∞—ë—Ç—Å—è –≤—Å—ë —Ä–∞–≤–Ω–æ ‚úÖ
         ‚Üì
–í—Ç–æ—Ä–æ–π –∑–∞–ø—É—Å–∫ ‚Üí FirstRunPermissions –ø—Ä–æ–ø—É—Å–∫–∞–µ—Ç—Å—è ‚úÖ
         ‚Üì
–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —Ä–∞–±–æ—Ç–∞–µ—Ç —Ñ–æ–Ω–æ–º üîç
         ‚Üì
–ï—Å–ª–∏ –ø—Ä–æ–±–ª–µ–º–∞ —Ä–µ—à–∏—Ç—Å—è ‚Üí –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –æ–±–Ω–∞—Ä—É–∂–∏—Ç ‚úÖ
```

---

## üîÑ 4. –°–æ–±—ã—Ç–∏—è –∏ –∏—Ö –ø—É–±–ª–∏–∫–∞—Ü–∏—è

### –ü–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å —Å–æ–±—ã—Ç–∏–π

```
–ò–∑–º–µ–Ω–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–∞ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è (System Settings)
         ‚Üì
[–ß–ï–†–ï–ó 0-3 –°–ï–ö] –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –æ–±–Ω–∞—Ä—É–∂–∏–≤–∞–µ—Ç (polling)
         ‚Üì
permissions.synthetic (–≤–Ω—É—Ç—Ä–µ–Ω–Ω–µ–µ —Å–æ–±—ã—Ç–∏–µ)
         ‚Üì
PermissionChangeDetector.process_event()
         ‚Üì
PermissionTransition —Å–æ–∑–¥–∞—ë—Ç—Å—è
         ‚Üì
RestartScheduler.maybe_schedule_restart()
         ‚Üì
permission_restart.scheduled (–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–æ–µ —Å–æ–±—ã—Ç–∏–µ)
         ‚Üì
[–ß–ï–†–ï–ó 5 –°–ï–ö] –ó–∞–¥–µ—Ä–∂–∫–∞ restart_delay_sec
         ‚Üì
[–¶–ò–ö–õ –û–ñ–ò–î–ê–ù–ò–Ø] –ñ–¥—ë–º –±–µ–∑–æ–ø–∞—Å–Ω—ã—Ö —É—Å–ª–æ–≤–∏–π
         ‚Üì
permission_restart.executing (–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–æ–µ —Å–æ–±—ã—Ç–∏–µ)
         ‚Üì
MacOSRestartHandler.restart_application()
         ‚Üì
[–ù–û–í–´–ô –ü–†–û–¶–ï–°–°] –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –ø–µ—Ä–µ–∑–∞–ø—É—â–µ–Ω–æ ‚úÖ
```

### –í–∞–∂–Ω—ã–π –Ω—é–∞–Ω—Å: –°–æ–±—ã—Ç–∏—è –ø—É–±–ª–∏–∫—É—é—Ç—Å—è –°–†–ê–ó–£

```
‚ùå –ù–ï–ü–†–ê–í–ò–õ–¨–ù–û–ï –ü–û–ù–ò–ú–ê–ù–ò–ï:
"–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∂–¥—ë—Ç –ø–æ–∫–∞ –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ –æ—Ç–∫–ª—é—á–∞—Ç—Å—è,
–ø–æ—Ç–æ–º –ø—É–±–ª–∏–∫—É–µ—Ç —Å–æ–±—ã—Ç–∏–µ"

‚úÖ –ü–†–ê–í–ò–õ–¨–ù–û–ï –ü–û–ù–ò–ú–ê–ù–ò–ï:
"–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –ø—É–±–ª–∏–∫—É–µ—Ç —Å–æ–±—ã—Ç–∏–µ –ù–ï–ú–ï–î–õ–ï–ù–ù–û –ø—Ä–∏ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏–∏.
–ë–ª–æ–∫–∏—Ä–æ–≤–∫–∏ –ø—Ä–æ–≤–µ—Ä—è—é—Ç—Å—è –í RestartScheduler,
–æ–Ω–∏ –û–¢–ö–õ–ê–î–´–í–ê–Æ–¢ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ, –Ω–æ –ù–ï –æ—Ç–º–µ–Ω—è—é—Ç –ø—É–±–ª–∏–∫–∞—Ü–∏—é"
```

**–ü–æ—á–µ–º—É —ç—Ç–æ –≤–∞–∂–Ω–æ**:
1. **–ü—Ä–æ–∑—Ä–∞—á–Ω–æ—Å—Ç—å**: –í –ª–æ–≥–∞—Ö –≤–∏–¥–Ω–æ –∫–æ–≥–¥–∞ –∏–∑–º–µ–Ω–µ–Ω–∏–µ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–æ
2. **–†–∞–∑–¥–µ–ª–µ–Ω–∏–µ –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç–∏**: –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ ‚Üí –æ–±–Ω–∞—Ä—É–∂–∏–≤–∞–µ—Ç, Scheduler ‚Üí –ø—Ä–∏–Ω–∏–º–∞–µ—Ç —Ä–µ—à–µ–Ω–∏—è
3. **–û—Ç–ª–∞–¥–∫–∞**: –ú–æ–∂–Ω–æ —É–≤–∏–¥–µ—Ç—å "—Å–æ–±—ã—Ç–∏–µ –±—ã–ª–æ, –Ω–æ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫ –Ω–µ —Å–ª—É—á–∏–ª—Å—è" ‚Üí –∑–Ω–∞—á–∏—Ç –±–ª–æ–∫–∏—Ä–æ–≤–∫–∞

---

## üö´ 5. –ë–ª–æ–∫–∏—Ä–æ–≤–∫–∏ - –¥–≤–∞ —É—Ä–æ–≤–Ω—è

### –£—Ä–æ–≤–µ–Ω—å 1: –û–¢–ú–ï–ù–ê –ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è

–≠—Ç–∏ –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ **–ø–æ–ª–Ω–æ—Å—Ç—å—é –æ—Ç–º–µ–Ω—è—é—Ç** –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫ - –æ–Ω –ù–ï –ø–ª–∞–Ω–∏—Ä—É–µ—Ç—Å—è –≤–æ–æ–±—â–µ:

#### 1.1 –î–æ—Å—Ç—É–ø–Ω–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

```python
if self._config.respect_updates and self._is_update_available():
    logger.info("[PERMISSION_RESTART] Update available - skipping")
    return None  # ‚Üê –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫ –ù–ï –ø–ª–∞–Ω–∏—Ä—É–µ—Ç—Å—è
```

**–õ–æ–≥–∏–∫–∞**: –ó–∞—á–µ–º –¥–µ–ª–∞—Ç—å 2 –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞?
- ‚ùå –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫ –¥–ª—è —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–π ‚Üí –ø–æ—Ç–æ–º –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫ –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è
- ‚úÖ –û–¥–∏–Ω –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫ –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è ‚Üí —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è –ø—Ä–∏–º–µ–Ω—è—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏

**–ö–æ–Ω—Ñ–∏–≥**: `respect_updates: true`

#### 1.2 –ü—Ä–µ–≤—ã—à–µ–Ω –ª–∏–º–∏—Ç –ø–æ–ø—ã—Ç–æ–∫

```python
if self._attempts >= self._config.max_restart_attempts:
    logger.warning("[PERMISSION_RESTART] Max restart attempts reached")
    return None  # ‚Üê –ó–∞—â–∏—Ç–∞ –æ—Ç –±–µ—Å–∫–æ–Ω–µ—á–Ω–æ–≥–æ —Ü–∏–∫–ª–∞
```

**–ö–æ–Ω—Ñ–∏–≥**: `max_restart_attempts: 3`

#### 1.3 –ú–µ—Ö–∞–Ω–∏–∑–º –æ—Ç–∫–ª—é—á–µ–Ω

```python
if not self._config.enabled:
    logger.debug("[PERMISSION_RESTART] Scheduler disabled")
    return None
```

**–ö–æ–Ω—Ñ–∏–≥**: `enabled: false`

---

### –£—Ä–æ–≤–µ–Ω—å 2: –û–¢–°–†–û–ß–ö–ê –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è

–≠—Ç–∏ –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ **–Ω–µ –æ—Ç–º–µ–Ω—è—é—Ç** –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫, –Ω–æ **–æ—Ç–∫–ª–∞–¥—ã–≤–∞—é—Ç** –µ–≥–æ:

#### 2.1 –ò–¥—ë—Ç —É—Å—Ç–∞–Ω–æ–≤–∫–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è

```python
if self._config.respect_updates and self._is_update_in_progress():
    await asyncio.sleep(2)  # –ñ–¥—ë–º...
    continue  # –ü—Ä–æ–≤–µ—Ä—è–µ–º –µ—â—ë —Ä–∞–∑
```

**–õ–æ–≥–∏–∫–∞**: –ù–µ –ø—Ä–µ—Ä—ã–≤–∞—Ç—å —É—Å—Ç–∞–Ω–æ–≤–∫—É –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è

**–ú–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –æ–∂–∏–¥–∞–Ω–∏–µ**: 10 –º–∏–Ω—É—Ç ‚Üí –ø–æ—Ç–æ–º –ø—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω—ã–π –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫

**–ö–æ–Ω—Ñ–∏–≥**: `respect_updates: true`

#### 2.2 –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∞–∫—Ç–∏–≤–Ω–æ (–Ω–µ SLEEPING)

```python
if self._config.respect_active_sessions and not self._is_idle_mode():
    await asyncio.sleep(2)  # –ñ–¥—ë–º...
    continue  # –ü—Ä–æ–≤–µ—Ä—è–µ–º –µ—â—ë —Ä–∞–∑
```

**–õ–æ–≥–∏–∫–∞**: –ù–µ –ø—Ä–µ—Ä—ã–≤–∞—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∫–æ–≥–¥–∞ –æ–Ω –≥–æ–≤–æ—Ä–∏—Ç –∏–ª–∏ –ø–æ–ª—É—á–∞–µ—Ç –æ—Ç–≤–µ—Ç

**–†–µ–∂–∏–º—ã**:
- `AppMode.SLEEPING` ‚úÖ ‚Üí –ú–æ–∂–Ω–æ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞—Ç—å
- `AppMode.LISTENING` ‚ùå ‚Üí –ñ–¥—ë–º (–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –º–æ–∂–µ—Ç –Ω–∞—á–∞—Ç—å –≥–æ–≤–æ—Ä–∏—Ç—å)
- `AppMode.PROCESSING` ‚ùå ‚Üí –ñ–¥—ë–º (–∏–¥—ë—Ç –æ–±—Ä–∞–±–æ—Ç–∫–∞ –∫–æ–º–∞–Ω–¥—ã)

**–ú–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –æ–∂–∏–¥–∞–Ω–∏–µ**: 10 –º–∏–Ω—É—Ç ‚Üí –ø–æ—Ç–æ–º –ø—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω—ã–π –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫

**–ö–æ–Ω—Ñ–∏–≥**: `respect_active_sessions: true`

---

## ‚è±Ô∏è 6. –¢–∞–π–º–ª–∞–π–Ω —Ç–∏–ø–∏—á–Ω–æ–≥–æ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞

```
T+0:00  –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç System Settings
T+0:10  –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø–µ—Ä–µ—Ö–æ–¥–∏—Ç –≤ Privacy & Security ‚Üí Accessibility
T+0:15  –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Å—Ç–∞–≤–∏—Ç –≥–∞–ª–æ—á–∫—É –Ω–∞ Nexy.app ‚úÖ
T+0:15  macOS –æ–±–Ω–æ–≤–ª—è–µ—Ç TCC –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö

[–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –ù–ï –ó–ù–ê–ï–¢ –æ–± –∏–∑–º–µ–Ω–µ–Ω–∏–∏!]

T+0:17  –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –≤—ã–ø–æ–ª–Ω—è–µ—Ç –æ—á–µ—Ä–µ–¥–Ω—É—é –ø—Ä–æ–≤–µ—Ä–∫—É (polling –∫–∞–∂–¥—ã–µ 3 —Å–µ–∫)
T+0:17  check_accessibility_status() ‚Üí GRANTED (–±—ã–ª–æ NOT_DETERMINED)
T+0:17  üîî –ò–∑–º–µ–Ω–µ–Ω–∏–µ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–æ!
T+0:17  –ü—É–±–ª–∏–∫—É–µ—Ç—Å—è —Å–∏–Ω—Ç–µ—Ç–∏—á–µ—Å–∫–æ–µ —Å–æ–±—ã—Ç–∏–µ
T+0:17  RestartScheduler –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏:
        - enabled? ‚úÖ true
        - update_available? ‚úÖ false
        - max_attempts? ‚úÖ 0/3
T+0:17  ‚úÖ –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫ –∑–∞–ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω!
T+0:17  –ü—É–±–ª–∏–∫—É–µ—Ç—Å—è —Å–æ–±—ã—Ç–∏–µ: permission_restart.scheduled

[–ó–∞–¥–µ—Ä–∂–∫–∞ restart_delay_sec = 5.0]

T+0:22  –ó–∞–¥–µ—Ä–∂–∫–∞ –ø—Ä–æ—à–ª–∞, –Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è —Ü–∏–∫–ª –æ–∂–∏–¥–∞–Ω–∏—è
T+0:22  –ü—Ä–æ–≤–µ—Ä–∫–∞ —É—Å–ª–æ–≤–∏–π:
        - update_in_progress? ‚úÖ false
        - current_mode? ‚ùå LISTENING (–Ω–µ SLEEPING)
T+0:22  ‚è≥ –ñ–¥—ë–º... sleep(2 —Å–µ–∫)
T+0:24  –ü—Ä–æ–≤–µ—Ä–∫–∞ —É—Å–ª–æ–≤–∏–π:
        - update_in_progress? ‚úÖ false
        - current_mode? ‚ùå LISTENING
T+0:24  ‚è≥ –ñ–¥—ë–º... sleep(2 —Å–µ–∫)
T+0:26  –ü—Ä–æ–≤–µ—Ä–∫–∞ —É—Å–ª–æ–≤–∏–π:
        - update_in_progress? ‚úÖ false
        - current_mode? ‚úÖ SLEEPING (idle!)
T+0:26  ‚úÖ –í—Å–µ —É—Å–ª–æ–≤–∏—è –≤—ã–ø–æ–ª–Ω–µ–Ω—ã!
T+0:26  –ü—É–±–ª–∏–∫—É–µ—Ç—Å—è —Å–æ–±—ã—Ç–∏–µ: permission_restart.executing
T+0:26  –í—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è: open -a Nexy.app
T+0:27  –í—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è: os._exit(0)

[–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∑–∞–≤–µ—Ä—à–∞–µ—Ç—Å—è]

T+0:28  macOS –∑–∞–ø—É—Å–∫–∞–µ—Ç –Ω–æ–≤—ã–π –ø—Ä–æ—Ü–µ—Å—Å Nexy.app
T+0:29  –ù–û–í–´–ô –ø—Ä–æ—Ü–µ—Å—Å –ø–æ–ª—É—á–∞–µ—Ç —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è –∏–∑ TCC ‚úÖ
T+0:30  –ö–ª–∞–≤–∏–∞—Ç—É—Ä–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç ‚úÖ
T+0:30  –ú–∏–∫—Ä–æ—Ñ–æ–Ω —Ä–∞–±–æ—Ç–∞–µ—Ç ‚úÖ
T+0:30  –í—Å—ë –≥–æ—Ç–æ–≤–æ! üéâ

–ò–¢–û–ì–û: 15 —Å–µ–∫—É–Ω–¥ –æ—Ç –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª–µ–Ω–∏—è —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è –¥–æ –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏
```

---

## üîç 7. –û—Ç–ª–∞–¥–∫–∞ - —á—Ç–æ —Å–º–æ—Ç—Ä–µ—Ç—å –≤ –ª–æ–≥–∞—Ö

### –ü—Ä–æ–≤–µ—Ä–∫–∞ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ (—Ä–∞–±–æ—Ç–∞–µ—Ç –ª–∏?)

```bash
tail -f ~/Library/Logs/Nexy/nexy.log | grep "Permission monitoring"
```

**–û–∂–∏–¥–∞–µ–º—ã–π –≤—ã–≤–æ–¥**:
```
[PERMISSION_RESTART] Initial permission state: accessibility=not_determined, input_monitoring=not_determined
[PERMISSION_RESTART] Permission monitoring task started
[PERMISSION_RESTART] Permission monitoring started (post first-run)
```

**–ï—Å–ª–∏ –Ω–µ—Ç** ‚Üí –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –ù–ï –∑–∞–ø—É—Å—Ç–∏–ª—Å—è:
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ: —Ñ–ª–∞–≥ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç? `ls ~/Library/Application\ Support/Nexy/permissions_first_run_completed.flag`
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ: enabled=true? `grep "permission_restart:" config/unified_config.yaml -A 10`

---

### –ü—Ä–æ–≤–µ—Ä–∫–∞ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π

```bash
tail -f ~/Library/Logs/Nexy/nexy.log | grep "status changed"
```

**–û–∂–∏–¥–∞–µ–º—ã–π –≤—ã–≤–æ–¥**:
```
[PERMISSION_RESTART] Accessibility status changed: not_determined ‚Üí granted
[PERMISSION_RESTART] Publishing synthetic event: accessibility not_determined ‚Üí granted
```

**–ï—Å–ª–∏ –Ω–µ—Ç** ‚Üí –ò–∑–º–µ–Ω–µ–Ω–∏–µ –ù–ï –æ–±–Ω–∞—Ä—É–∂–µ–Ω–æ:
- –í—ã –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–∏–ª–∏ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–µ?
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –≤—Ä—É—á–Ω—É—é: System Settings ‚Üí Privacy & Security ‚Üí Accessibility ‚Üí Nexy.app ‚úÖ?
- –ü–æ–¥–æ–∂–¥–∏—Ç–µ –¥–æ 3 —Å–µ–∫—É–Ω–¥ (–∏–Ω—Ç–µ—Ä–≤–∞–ª polling)

---

### –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞

```bash
tail -f ~/Library/Logs/Nexy/nexy.log | grep "Scheduling application restart"
```

**–û–∂–∏–¥–∞–µ–º—ã–π –≤—ã–≤–æ–¥**:
```
[PERMISSION_RESTART] Scheduling application restart (delay=5.0s, permissions=['accessibility'])
```

**–ï—Å–ª–∏ –Ω–µ—Ç** ‚Üí –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫ –ù–ï –∑–∞–ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω (–±–ª–æ–∫–∏—Ä–æ–≤–∫–∞ —É—Ä–æ–≤–Ω—è 1):
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ: `grep "Update available - skipping" ~/Library/Logs/Nexy/nexy.log`
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ: `grep "Max restart attempts reached" ~/Library/Logs/Nexy/nexy.log`
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ: `grep "Scheduler disabled" ~/Library/Logs/Nexy/nexy.log`

---

### –ü—Ä–æ–≤–µ—Ä–∫–∞ –±–ª–æ–∫–∏—Ä–æ–≤–æ–∫ —É—Ä–æ–≤–Ω—è 2

```bash
tail -f ~/Library/Logs/Nexy/nexy.log | grep -E "current_mode|update_in_progress"
```

**–ï—Å–ª–∏ –≤–∏–¥–∏—Ç–µ**:
```
[STATE] current_mode=LISTENING
[STATE] current_mode=LISTENING
[STATE] current_mode=LISTENING
```

‚Üí –ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞ –∞–∫—Ç–∏–≤–Ω–∞! –ñ–¥—ë—Ç –ø–æ–∫–∞ —Å—Ç–∞–Ω–µ—Ç SLEEPING

**–†–µ—à–µ–Ω–∏–µ**: –°–∫–∞–∂–∏—Ç–µ "Hey Nexy, stop" –∏–ª–∏ –¥–æ–∂–¥–∏—Ç–µ—Å—å idle

---

### –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞

```bash
tail -f ~/Library/Logs/Nexy/nexy.log | grep "permission_restart.executing"
```

**–û–∂–∏–¥–∞–µ–º—ã–π –≤—ã–≤–æ–¥**:
```
[PERMISSION_RESTART] Publishing executing event
[RESTART] Executing: open -a Nexy.app
[RESTART] Exiting with os._exit(0)

[–ù–û–í–´–ô –ü–†–û–¶–ï–°–° –ù–ê–ß–ò–ù–ê–ï–¢–°–Ø]
```

---

## üß™ 8. –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### –ë—ã—Å—Ç—Ä—ã–π —Ç–µ—Å—Ç (—Ç–µ—Å—Ç–æ–≤—ã–π —Å–∫—Ä–∏–ø—Ç)

```bash
python3 tests/test_permission_monitoring.py
```

1. –ó–∞–ø—É—Å—Ç–∏—Ç–µ —Å–∫—Ä–∏–ø—Ç
2. –û—Ç–∫—Ä–æ–π—Ç–µ System Settings ‚Üí Privacy & Security ‚Üí Accessibility
3. –í–∫–ª—é—á–∏—Ç–µ/–≤—ã–∫–ª—é—á–∏—Ç–µ Nexy.app
4. –ù–∞–±–ª—é–¥–∞–π—Ç–µ –∫–∞–∫ —Å–∫—Ä–∏–ø—Ç –æ–±–Ω–∞—Ä—É–∂–∏–≤–∞–µ—Ç –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏

**–§–∞–π–ª**: [test_permission_monitoring.py](../tests/test_permission_monitoring.py)

---

### –ü–æ–ª–Ω—ã–π —Ç–µ—Å—Ç (–≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏)

#### –°—Ü–µ–Ω–∞—Ä–∏–π 1: –°–∏–º—É–ª—è—Ü–∏—è –ø–µ—Ä–≤–æ–≥–æ –∑–∞–ø—É—Å–∫–∞

```bash
# 1. –£–¥–∞–ª–∏—Ç—å —Ñ–ª–∞–≥
rm -f ~/Library/Application\ Support/Nexy/permissions_first_run_completed.flag

# 2. –°–±—Ä–æ—Å–∏—Ç—å —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
tccutil reset Accessibility com.nexy.assistant
tccutil reset ListenEvent com.nexy.assistant

# 3. –ó–∞–ø—É—Å—Ç–∏—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
open -a Nexy.app

# 4. –°–ª–µ–¥–∏—Ç—å –∑–∞ –ª–æ–≥–∞–º–∏
tail -f ~/Library/Logs/Nexy/nexy.log | grep PERMISSION

# –û–∂–∏–¥–∞–µ–º–æ–µ –ø–æ–≤–µ–¥–µ–Ω–∏–µ:
# - FirstRunPermissions –∑–∞–ø—Ä–∞—à–∏–≤–∞–µ—Ç —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è
# - –§–ª–∞–≥ —Å–æ–∑–¥–∞—ë—Ç—Å—è
# - –°–æ–±—ã—Ç–∏–µ permissions.first_run_completed –ø—É–±–ª–∏–∫—É–µ—Ç—Å—è
# - –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç
```

---

#### –°—Ü–µ–Ω–∞—Ä–∏–π 2: –¢–µ—Å—Ç –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ (—Ñ–ª–∞–≥ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç)

```bash
# 1. –£–±–µ–¥–∏—Ç—å—Å—è —á—Ç–æ —Ñ–ª–∞–≥ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç
ls -la ~/Library/Application\ Support/Nexy/permissions_first_run_completed.flag

# 2. –ó–∞–ø—É—Å—Ç–∏—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
open -a Nexy.app

# 3. –°–ª–µ–¥–∏—Ç—å –∑–∞ –ª–æ–≥–∞–º–∏ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞
tail -f ~/Library/Logs/Nexy/nexy.log | grep "Permission monitoring"

# –î–æ–ª–∂–Ω—ã —É–≤–∏–¥–µ—Ç—å:
# [PERMISSION_RESTART] Permission monitoring task started
# [PERMISSION_RESTART] Initial permission state: ...

# 4. –ò–∑–º–µ–Ω–∏—Ç—å —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–µ
# System Settings ‚Üí Privacy & Security ‚Üí Accessibility
# –£–±—Ä–∞—Ç—å –≥–∞–ª–æ—á–∫—É —Å Nexy.app
# –ü–æ—Å—Ç–∞–≤–∏—Ç—å –≥–∞–ª–æ—á–∫—É –æ–±—Ä–∞—Ç–Ω–æ

# 5. –ù–∞–±–ª—é–¥–∞—Ç—å –≤ –ª–æ–≥–∞—Ö (–≤ —Ç–µ—á–µ–Ω–∏–µ 0-3 —Å–µ–∫—É–Ω–¥):
# [PERMISSION_RESTART] Accessibility status changed: ... ‚Üí granted
# [PERMISSION_RESTART] Publishing synthetic event: ...
# [PERMISSION_RESTART] Scheduling application restart (delay=5.0s, ...)

# 6. –ß–µ—Ä–µ–∑ ~5-15 —Å–µ–∫—É–Ω–¥:
# –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –¥–æ–ª–∂–Ω–æ –ø–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å—Å—è ‚úÖ
```

---

#### –°—Ü–µ–Ω–∞—Ä–∏–π 3: –¢–µ—Å—Ç –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ–º

```bash
# 1. –°–∏–º—É–ª–∏—Ä–æ–≤–∞—Ç—å –¥–æ—Å—Ç—É–ø–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ
# (—Ç—Ä–µ–±—É–µ—Ç –∏–∑–º–µ–Ω–µ–Ω–∏–π –≤ UpdaterIntegration –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è)

# 2. –ü—Ä–µ–¥–æ—Å—Ç–∞–≤–∏—Ç—å —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–µ –≤—Ä—É—á–Ω—É—é

# 3. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏:
tail -f ~/Library/Logs/Nexy/nexy.log | grep "Update available"

# –û–∂–∏–¥–∞–µ–º–æ–µ:
# [PERMISSION_RESTART] Update available - skipping permission restart

# –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫ –ù–ï –¥–æ–ª–∂–µ–Ω –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç—å ‚ùå
# (–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–∞–º–æ –ø–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ)
```

---

## üìä 9. –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –¥–ª—è —Ä–∞–∑–Ω—ã—Ö —Å—Ä–µ–¥

### Development (—Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞)

```yaml
# config/unified_config.yaml
permission_restart:
  enabled: true
  restart_delay_sec: 1.0              # –ë—ã—Å—Ç—Ä–æ –¥–ª—è —Ç–µ—Å—Ç–æ–≤
  max_restart_attempts: 999           # –ë–µ–∑ –ª–∏–º–∏—Ç–∞
  respect_active_sessions: false      # –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞—Ç—å —Å—Ä–∞–∑—É
  respect_updates: true               # –ù–æ —É—á–∏—Ç—ã–≤–∞—Ç—å –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è
  critical_permissions:
    - accessibility
    - input_monitoring
```

**–ü–ª—é—Å—ã**:
- ‚úÖ –ë—ã—Å—Ç—Ä–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ (delay 1 —Å–µ–∫ –≤–º–µ—Å—Ç–æ 5)
- ‚úÖ –ë–µ–∑ –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ –Ω–∞ active sessions
- ‚úÖ –ú–æ–∂–Ω–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –º–Ω–æ–≥–æ–∫—Ä–∞—Ç–Ω–æ

**–ú–∏–Ω—É—Å—ã**:
- ‚ùå –ú–æ–∂–µ—Ç –ø—Ä–µ—Ä–≤–∞—Ç—å —Ä–∞–±–æ—Ç—É –≤–æ –≤—Ä–µ–º—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏

---

### Staging (—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ)

```yaml
permission_restart:
  enabled: true
  restart_delay_sec: 3.0              # –°—Ä–µ–¥–Ω—è—è –∑–∞–¥–µ—Ä–∂–∫–∞
  max_restart_attempts: 10            # –£–≤–µ–ª–∏—á–µ–Ω–Ω—ã–π –ª–∏–º–∏—Ç –¥–ª—è QA
  respect_active_sessions: true       # –ö–∞–∫ –≤ –ø—Ä–æ–¥–∞–∫—à–Ω–µ
  respect_updates: true
  critical_permissions:
    - accessibility
    - input_monitoring
```

**–ü–ª—é—Å—ã**:
- ‚úÖ –ü–æ–≤–µ–¥–µ–Ω–∏–µ –±–ª–∏–∑–∫–æ–µ –∫ –ø—Ä–æ–¥–∞–∫—à–Ω—É
- ‚úÖ –ë–æ–ª—å—à–µ –ø–æ–ø—ã—Ç–æ–∫ –¥–ª—è QA —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

---

### Production (–ø—Ä–æ–¥–∞–∫—à–Ω)

```yaml
permission_restart:
  enabled: true
  restart_delay_sec: 5.0              # –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤–∏–¥–∏—Ç —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ
  max_restart_attempts: 3             # –ó–∞—â–∏—Ç–∞ –æ—Ç —Ü–∏–∫–ª–æ–≤
  respect_active_sessions: true       # –ù–µ –ø—Ä–µ—Ä—ã–≤–∞—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
  respect_updates: true               # –ò–∑–±–µ–≥–∞—Ç—å –¥–≤–æ–π–Ω–æ–≥–æ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞
  critical_permissions:
    - microphone
    - accessibility
    - input_monitoring
    - screen_capture
```

**–ü–ª—é—Å—ã**:
- ‚úÖ UX: –ù–µ –ø—Ä–µ—Ä—ã–≤–∞–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤–æ –≤—Ä–µ–º—è —Ä–∞–±–æ—Ç—ã
- ‚úÖ –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å: –ó–∞—â–∏—Ç–∞ –æ—Ç —Ü–∏–∫–ª–æ–≤
- ‚úÖ –≠—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å: –ò–∑–±–µ–≥–∞–µ—Ç –¥–≤–æ–π–Ω—ã—Ö –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–æ–≤

---

## üéì 10. –ß–∞—Å—Ç—ã–µ –≤–æ–ø—Ä–æ—Å—ã (FAQ)

### Q1: –ü–æ—á–µ–º—É –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫ –Ω–µ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç —Å—Ä–∞–∑—É –ø–æ—Å–ª–µ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª–µ–Ω–∏—è —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è?

**A**: –ù–µ—Å–∫–æ–ª—å–∫–æ –ø—Ä–∏—á–∏–Ω:
1. **Polling –∏–Ω—Ç–µ—Ä–≤–∞–ª** - –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç —Ä–∞–∑ –≤ 3 —Å–µ–∫—É–Ω–¥—ã (–∑–∞–¥–µ—Ä–∂–∫–∞ 0-3 —Å–µ–∫)
2. **restart_delay_sec** - –∑–∞–¥–µ—Ä–∂–∫–∞ 5 —Å–µ–∫—É–Ω–¥ –¥–ª—è –ø–æ–∫–∞–∑–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
3. **–ë–ª–æ–∫–∏—Ä–æ–≤–∫–∏** - –æ–∂–∏–¥–∞–Ω–∏–µ SLEEPING —Ä–µ–∂–∏–º–∞ –∏–ª–∏ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è

**–ú–∏–Ω–∏–º–∞–ª—å–Ω–æ–µ –≤—Ä–µ–º—è**: 5 —Å–µ–∫—É–Ω–¥
**–¢–∏–ø–∏—á–Ω–æ–µ –≤—Ä–µ–º—è**: 7-15 —Å–µ–∫—É–Ω–¥
**–ú–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –≤—Ä–µ–º—è**: 10 –º–∏–Ω—É—Ç + 5 —Å–µ–∫—É–Ω–¥ (–µ—Å–ª–∏ –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ –∞–∫—Ç–∏–≤–Ω—ã)

---

### Q2: –ü–æ—á–µ–º—É —Ñ–ª–∞–≥ —Å–æ–∑–¥–∞—ë—Ç—Å—è –¥–∞–∂–µ –µ—Å–ª–∏ —è –æ—Ç–∫–ª–æ–Ω–∏–ª —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è?

**A**: –ó–∞—â–∏—Ç–∞ –æ—Ç —Ä–∞–∑–¥—Ä–∞–∂–∞—é—â–∏—Ö –ø–æ–≤—Ç–æ—Ä–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤. –ü—Ä–µ–¥—Å—Ç–∞–≤—å—Ç–µ:
```
–ü–µ—Ä–≤—ã–π –∑–∞–ø—É—Å–∫: "–†–∞–∑—Ä–µ—à–∏—Ç—å –º–∏–∫—Ä–æ—Ñ–æ–Ω?" ‚Üí –û—Ç–∫–ª–æ–Ω–∏—Ç—å ‚ùå
–í—Ç–æ—Ä–æ–π –∑–∞–ø—É—Å–∫: "–†–∞–∑—Ä–µ—à–∏—Ç—å –º–∏–∫—Ä–æ—Ñ–æ–Ω?" ‚Üí –û–ø—è—Ç—å??? üò†
–¢—Ä–µ—Ç–∏–π –∑–∞–ø—É—Å–∫: "–†–∞–∑—Ä–µ—à–∏—Ç—å –º–∏–∫—Ä–æ—Ñ–æ–Ω?" ‚Üí –î–û–°–¢–ê–õ–û! ü§¨
```

–õ—É—á—à–µ –æ–¥–∏–Ω —Ä–∞–∑ –ø–æ–∫–∞–∑–∞—Ç—å, —Å–æ–∑–¥–∞—Ç—å —Ñ–ª–∞–≥, –∏ –¥–∞—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é —Ä–µ—à–∏—Ç—å –ø–æ–∑–∂–µ —á–µ—Ä–µ–∑ System Settings. –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –æ–±–Ω–∞—Ä—É–∂–∏—Ç –µ—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø–µ—Ä–µ–¥—É–º–∞–µ—Ç.

---

### Q3: –ú–æ–∂–Ω–æ –ª–∏ –æ—Ç–∫–ª—é—á–∏—Ç—å –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥?

**A**: –î–∞, —á–µ—Ä–µ–∑ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é:
```yaml
permission_restart:
  enabled: false  # –û—Ç–∫–ª—é—á–∏—Ç –≤–µ—Å—å –º–µ—Ö–∞–Ω–∏–∑–º
```

–ù–æ —ç—Ç–æ –æ—Ç–∫–ª—é—á–∏—Ç –∏ –ø–µ—Ä–≤—ã–π –∑–∞–ø—É—Å–∫, –∏ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥. –†–∞–∑—Ä–µ—à–µ–Ω–∏—è –Ω—É–∂–Ω–æ –±—É–¥–µ—Ç –ø—Ä–∏–º–µ–Ω—è—Ç—å –≤—Ä—É—á–Ω—É—é —á–µ—Ä–µ–∑ –ø–æ–ª–Ω—ã–π –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è.

---

### Q4: –ü–æ—á–µ–º—É –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ polling –∞ –Ω–µ —Å–æ–±—ã—Ç–∏—è macOS?

**A**: macOS –Ω–µ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç —Å–æ–±—ã—Ç–∏—è –¥–ª—è –∏–∑–º–µ–Ω–µ–Ω–∏–π TCC —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–π. –°—É—â–µ—Å—Ç–≤—É—é—Ç:
- `NSDistributedNotificationCenter` - –Ω–æ TCC –Ω–µ –ø—É–±–ª–∏–∫—É–µ—Ç —Ç—É–¥–∞
- `kqueue/FSEvents` - –Ω–æ TCC –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–∞ –¥–ª—è —á—Ç–µ–Ω–∏—è

–ï–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω—ã–π –Ω–∞–¥—ë–∂–Ω—ã–π —Å–ø–æ—Å–æ–± - –ø–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ —á–µ—Ä–µ–∑ –ø—É–±–ª–∏—á–Ω—ã–µ API.

**–ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤—ã —Ä–∞—Å—Å–º–æ—Ç—Ä–µ–Ω–Ω—ã–µ**:
1. ‚ùå Distributed Notifications - TCC –∏—Ö –Ω–µ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç
2. ‚ùå FSEvents –Ω–∞ TCC.db - —Ñ–∞–π–ª –∑–∞—â–∏—â—ë–Ω SIP
3. ‚ùå XPC —Å–µ—Ä–≤–∏—Å - —Ç—Ä–µ–±—É–µ—Ç –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–π
4. ‚úÖ Polling —Ä–∞–∑ –≤ 3 —Å–µ–∫—É–Ω–¥—ã - —Ä–∞–±–æ—Ç–∞–µ—Ç –Ω–∞–¥—ë–∂–Ω–æ

---

### Q5: –ß—Ç–æ –¥–µ–ª–∞—Ç—å –µ—Å–ª–∏ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫ –∑–∞—Å—Ç—Ä—è–ª –≤ –æ–∂–∏–¥–∞–Ω–∏–∏?

**A**: –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏:

```bash
# –†–µ–∂–∏–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
tail -f ~/Library/Logs/Nexy/nexy.log | grep current_mode

# –ï—Å–ª–∏ LISTENING/PROCESSING ‚Üí –°–∫–∞–∂–∏—Ç–µ "stop" –∏–ª–∏ –¥–æ–∂–¥–∏—Ç–µ—Å—å idle
```

–ú–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –æ–∂–∏–¥–∞–Ω–∏–µ - 10 –º–∏–Ω—É—Ç, –ø–æ—Ç–æ–º –ø—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω—ã–π –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫.

---

### Q6: –ú–æ–∂–Ω–æ –ª–∏ —Å–¥–µ–ª–∞—Ç—å –∏–Ω—Ç–µ—Ä–≤–∞–ª –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ –º–µ–Ω—å—à–µ 3 —Å–µ–∫—É–Ω–¥?

**A**: –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏ –¥–∞, –Ω–æ –Ω–µ —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è:

**–ü–ª—é—Å—ã –º–µ–Ω—å—à–µ–≥–æ –∏–Ω—Ç–µ—Ä–≤–∞–ª–∞**:
- ‚úÖ –ë—ã—Å—Ç—Ä–µ–µ –æ–±–Ω–∞—Ä—É–∂–∏–≤–∞–µ—Ç –∏–∑–º–µ–Ω–µ–Ω–∏—è

**–ú–∏–Ω—É—Å—ã –º–µ–Ω—å—à–µ–≥–æ –∏–Ω—Ç–µ—Ä–≤–∞–ª–∞**:
- ‚ùå –ë–æ–ª—å—à–µ –Ω–∞–≥—Ä—É–∑–∫–∞ –Ω–∞ CPU
- ‚ùå –ë–æ–ª—å—à–µ —Å–∏—Å—Ç–µ–º–Ω—ã—Ö –≤—ã–∑–æ–≤–æ–≤
- ‚ùå –ë—ã—Å—Ç—Ä–µ–µ —Ä–∞–∑—Ä—è–∂–∞–µ—Ç –±–∞—Ç–∞—Ä–µ—é

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è**: 3 —Å–µ–∫—É–Ω–¥—ã - –æ–ø—Ç–∏–º–∞–ª—å–Ω—ã–π –±–∞–ª–∞–Ω—Å –º–µ–∂–¥—É –æ—Ç–∑—ã–≤—á–∏–≤–æ—Å—Ç—å—é –∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å—é.

–ï—Å–ª–∏ –Ω—É–∂–Ω–æ –∏–∑–º–µ–Ω–∏—Ç—å - –∫–æ–Ω—Å—Ç–∞–Ω—Ç–∞ –≤ –∫–æ–¥–µ:
```python
# permission_restart_integration.py:348
monitoring_interval = 3.0  # —Å–µ–∫—É–Ω–¥—ã
```

---

## üìö 11. –°–≤—è–∑–∞–Ω–Ω—ã–µ –¥–æ–∫—É–º–µ–Ω—Ç—ã

| –î–æ–∫—É–º–µ–Ω—Ç | –û–ø–∏—Å–∞–Ω–∏–µ | –î–ª—è –∫–æ–≥–æ |
|----------|----------|----------|
| [PERMISSION_RESTART_LOGIC.md](./_archive/PERMISSION_RESTART_LOGIC.md) | –ü–æ–ª–Ω–∞—è —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è | –†–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∏ |
| [PERMISSION_RESTART_BLOCKERS.md](./PERMISSION_RESTART_BLOCKERS.md) | –í—Å–µ –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ –∏ —É—Å–ª–æ–≤–∏—è | –†–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∏, QA |
| [PERMISSION_MONITORING_FEATURE.md](./_archive/PERMISSION_MONITORING_FEATURE.md) | –ù–æ–≤–∞—è —Ñ—É–Ω–∫—Ü–∏—è –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ | –†–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∏ |
| [test_permission_monitoring.py](../tests/test_permission_monitoring.py) | –¢–µ—Å—Ç–æ–≤—ã–π —Å–∫—Ä–∏–ø—Ç | QA, –†–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∏ |
| [unified_config.yaml](../config/unified_config.yaml) | –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è | DevOps, –†–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∏ |

---

## ‚úÖ –ß–µ–∫-–ª–∏—Å—Ç –ø–æ–Ω–∏–º–∞–Ω–∏—è

–ï—Å–ª–∏ –≤—ã –º–æ–∂–µ—Ç–µ –æ—Ç–≤–µ—Ç–∏—Ç—å "–î–∞" –Ω–∞ –≤—Å–µ –≤–æ–ø—Ä–æ—Å—ã, –≤—ã –ø–æ–ª–Ω–æ—Å—Ç—å—é –ø–æ–Ω–∏–º–∞–µ—Ç–µ –º–µ—Ö–∞–Ω–∏–∑–º:

- [ ] –ü–æ–Ω–∏–º–∞—é –ø–æ—á–µ–º—É –Ω—É–∂–µ–Ω –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫ (macOS TCC –Ω–µ –ø—Ä–∏–º–µ–Ω—è–µ—Ç –∫ —Ç–µ–∫—É—â–µ–º—É –ø—Ä–æ—Ü–µ—Å—Å—É)
- [ ] –ü–æ–Ω–∏–º–∞—é —Ä–∞–∑–Ω–∏—Ü—É –º–µ–∂–¥—É —Ä–µ–∂–∏–º–æ–º 1 (–ø–µ—Ä–≤—ã–π –∑–∞–ø—É—Å–∫) –∏ —Ä–µ–∂–∏–º–æ–º 2 (–º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥)
- [ ] –ü–æ–Ω–∏–º–∞—é —Ä–æ–ª—å —Ñ–ª–∞–≥–∞ `permissions_first_run_completed.flag`
- [ ] –ü–æ–Ω–∏–º–∞—é –ø–æ—á–µ–º—É —Ñ–ª–∞–≥ —Å–æ–∑–¥–∞—ë—Ç—Å—è –¥–∞–∂–µ –ø—Ä–∏ –æ—Ç–∫–∞–∑–µ/–æ—à–∏–±–∫–µ
- [ ] –ü–æ–Ω–∏–º–∞—é —Ä–∞–∑–Ω–∏—Ü—É –º–µ–∂–¥—É –±–ª–æ–∫–∏—Ä–æ–≤–∫–∞–º–∏ —É—Ä–æ–≤–Ω—è 1 (–æ—Ç–º–µ–Ω–∞) –∏ —É—Ä–æ–≤–Ω—è 2 (–æ—Ç—Å—Ä–æ—á–∫–∞)
- [ ] –ü–æ–Ω–∏–º–∞—é —á—Ç–æ —Å–æ–±—ã—Ç–∏—è –ø—É–±–ª–∏–∫—É—é—Ç—Å—è —Å—Ä–∞–∑—É, –∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –æ—Ç–∫–ª–∞–¥—ã–≤–∞–µ—Ç—Å—è
- [ ] –ó–Ω–∞—é –∫–∞–∫ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –≤ –ª–æ–≥–∞—Ö —Ä–∞–±–æ—Ç–∞–µ—Ç –ª–∏ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥
- [ ] –ó–Ω–∞—é –∫–∞–∫ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –≤ –ª–æ–≥–∞—Ö –æ–±–Ω–∞—Ä—É–∂–µ–Ω–æ –ª–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–µ
- [ ] –ó–Ω–∞—é –∫–∞–∫ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –≤ –ª–æ–≥–∞—Ö –ø–æ—á–µ–º—É –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫ –Ω–µ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç
- [ ] –ú–æ–≥—É –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é –¥–ª—è —Ä–∞–∑–Ω—ã—Ö —Å—Ä–µ–¥

---

**–°–æ–∑–¥–∞–Ω–æ**: 2025-10-30
**–ê–≤—Ç–æ—Ä**: Development Team
**–°—Ç–∞—Ç—É—Å**: ‚úÖ –ì–æ—Ç–æ–≤–æ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é
