# –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã—Ö –ø—Ä–æ–±–ª–µ–º

## –î–∞—Ç–∞: 2025-12-09

## –ü—Ä–æ–±–ª–µ–º—ã –∏ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è

### 1. ‚úÖ –ü—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏–µ –Ω–µ –≤–æ—Å–ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç—Å—è

**–ü—Ä–æ–±–ª–µ–º–∞:**
- `_send_audio_to_playback` –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é `trigger`, –∫–æ—Ç–æ—Ä–∞—è –Ω–µ –ø–µ—Ä–µ–¥–∞–≤–∞–ª–∞—Å—å –∫–∞–∫ –∞—Ä–≥—É–º–µ–Ω—Ç ‚Üí `NameError`
- `_welcome_played` —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–ª—Å—è —Å–ª–∏—à–∫–æ–º —Ä–∞–Ω–æ (–¥–æ —Ñ–∞–∫—Ç–∏—á–µ—Å–∫–æ–π –æ—Ç–ø—Ä–∞–≤–∫–∏ –∞—É–¥–∏–æ)
- `_wait_for_playback_completion` –Ω–µ –ø–æ–ª—É—á–∞–ª `playback.completed` –∏–∑-–∑–∞ –Ω–µ—Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏—è `session_id`

**–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è:**
1. ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω –ø–∞—Ä–∞–º–µ—Ç—Ä `trigger` –≤ `_send_audio_to_playback(audio_data, trigger=trigger)`
2. ‚úÖ `_welcome_played` —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –ø–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–π –æ—Ç–ø—Ä–∞–≤–∫–∏ –∏ –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏—è –∞—É–¥–∏–æ
3. ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω `session_id` –≤ —Å–æ–±—ã—Ç–∏–µ `playback.raw_audio` –¥–ª—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–π –ø—Ä–æ–≤–µ—Ä–∫–∏ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è
4. ‚úÖ –£–ª—É—á—à–µ–Ω–∞ –ø—Ä–æ–≤–µ—Ä–∫–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏—è (–ø–æ–¥–¥–µ—Ä–∂–∫–∞ `session_id` –∏ `pattern`)

**–§–∞–π–ª—ã:**
- `integration/integrations/welcome_message_integration.py` (—Å—Ç—Ä–æ–∫–∏ 190, 328-358, 242-268)

---

### 2. ‚úÖ –î—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ/—Ä–∞—Å—Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –∞–∫—Ç–∏–≤–∞—Ü–∏–∏ –º–∏–∫—Ä–æ—Ñ–æ–Ω–∞

**–ü—Ä–æ–±–ª–µ–º–∞:**
- `VoiceRecognitionIntegration` –ø—É–±–ª–∏–∫–æ–≤–∞–ª `microphone.opened`, –Ω–æ –Ω–µ –æ–±–Ω–æ–≤–ª—è–ª —Å–æ—Å—Ç–æ—è–Ω–∏–µ –≤ `state_manager`
- `_wait_for_mic_opened()` –ø—Ä–æ–≤–µ—Ä—è–ª `state_manager.is_microphone_active()`, –Ω–æ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –Ω–µ –æ–±–Ω–æ–≤–ª—è–ª–æ—Å—å ‚Üí —Ç–∞–π–º–∞—É—Ç

**–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è:**
1. ‚úÖ –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è –º–∏–∫—Ä–æ—Ñ–æ–Ω–∞ –≤ `state_manager` –ø—Ä–∏ –æ—Ç–∫—Ä—ã—Ç–∏–∏ —á–µ—Ä–µ–∑ AVF (—Å—Ç—Ä–æ–∫–∞ 580)
2. ‚úÖ –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è –º–∏–∫—Ä–æ—Ñ–æ–Ω–∞ –ø—Ä–∏ –æ—Ç–∫—Ä—ã—Ç–∏–∏ —á–µ—Ä–µ–∑ legacy –ø—É—Ç—å (—Å—Ç—Ä–æ–∫–∞ 605)
3. ‚úÖ –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è –º–∏–∫—Ä–æ—Ñ–æ–Ω–∞ –ø—Ä–∏ —Å–∏–º—É–ª—è—Ü–∏–∏ (—Å—Ç—Ä–æ–∫–∞ 614)
4. ‚úÖ –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è –º–∏–∫—Ä–æ—Ñ–æ–Ω–∞ –ø—Ä–∏ –∑–∞–∫—Ä—ã—Ç–∏–∏ —á–µ—Ä–µ–∑ AVF (—Å—Ç—Ä–æ–∫–∞ 810)
5. ‚úÖ –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è –º–∏–∫—Ä–æ—Ñ–æ–Ω–∞ –ø—Ä–∏ –∑–∞–∫—Ä—ã—Ç–∏–∏ —á–µ—Ä–µ–∑ legacy –ø—É—Ç—å (—Å—Ç—Ä–æ–∫–∞ 853)
6. ‚úÖ –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è –º–∏–∫—Ä–æ—Ñ–æ–Ω–∞ –ø—Ä–∏ –æ—à–∏–±–∫–∞—Ö –æ—Ç–∫—Ä—ã—Ç–∏—è/–∑–∞–∫—Ä—ã—Ç–∏—è

**–§–∞–π–ª—ã:**
- `integration/integrations/voice_recognition_integration.py` (—Å—Ç—Ä–æ–∫–∏ 580, 605, 614, 810, 853, 585, 593, 886, 891)

---

### 3. ‚úÖ –ù–µ—Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ –∫–ª—é—á–µ–π –≤ screenshot.captured

**–ü—Ä–æ–±–ª–µ–º–∞:**
- `ScreenshotCaptureIntegration` –ø—É–±–ª–∏–∫—É–µ—Ç `image_path` (—Å—Ç—Ä–æ–∫–∏ 286, 506)
- `ProcessingWorkflow` —á–∏—Ç–∞–µ—Ç `path` (—Å—Ç—Ä–æ–∫–∞ 262) ‚Üí –≤—Å–µ–≥–¥–∞ `path=None`

**–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è:**
1. ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–∞ –ø–æ–¥–¥–µ—Ä–∂–∫–∞ –æ–±–æ–∏—Ö –∫–ª—é—á–µ–π: `data.get("image_path") or data.get("path")`

**–§–∞–π–ª—ã:**
- `integration/workflows/processing_workflow.py` (—Å—Ç—Ä–æ–∫–∞ 262)

---

### 4. ‚úÖ –û–±—Ä–µ–∑–∫–∞ –∞—É–¥–∏–æ –ø—Ä–∏ –æ—Å—Ç–∞–Ω–æ–≤–∫–µ –∑–∞–ø–∏—Å–∏

**–ü—Ä–æ–±–ª–µ–º–∞:**
- –ó–∞–ø–∏—Å—å –ø—Ä–æ–¥–æ–ª–∂–∞–ª–∞—Å—å –ø–æ—Å–ª–µ —Å–æ–±—ã—Ç–∏—è `release` ‚Üí –Ω–∞–∫–∞–ø–ª–∏–≤–∞–ª–æ—Å—å –±–æ–ª—å—à–µ –¥–∞–Ω–Ω—ã—Ö (12.8s –≤–º–µ—Å—Ç–æ 4.5s)
- Google Speech API –ø–æ–ª—É—á–∞–ª –≤ –æ—Å–Ω–æ–≤–Ω–æ–º —Ç–∏—à–∏–Ω—É ‚Üí `UnknownValueError`

**–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è:**
1. ‚úÖ –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–∏ –Ω–∞—á–∞–ª–∞ –∑–∞–ø–∏—Å–∏ (`_recording_start_time`)
2. ‚úÖ –û–±—Ä–µ–∑–∫–∞ –∞—É–¥–∏–æ –ø–æ `duration` –∏–∑ —Å–æ–±—ã—Ç–∏—è `voice.recording_stop`
3. ‚úÖ –û—á–∏—Å—Ç–∫–∞ `_recording_start_time` –ø–æ—Å–ª–µ –æ–±—Ä–∞–±–æ—Ç–∫–∏

**–§–∞–π–ª—ã:**
- `integration/integrations/voice_recognition_integration.py` (—Å—Ç—Ä–æ–∫–∏ 102, 580, 650, 788-805, 810)

---

### 5. ‚úÖ –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–ª—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏ SFSpeechRecognizer

**–ü—Ä–æ–±–ª–µ–º–∞:**
- –í –ª–æ–≥–∞—Ö –Ω–µ—Ç —Å—Ç—Ä–æ–∫ `üé§ [SFSpeech]` ‚Üí —Å—Ç—Ä–∏–º–∏–Ω–≥ –Ω–µ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è
- –ù–µ—Ç –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏, –ø–æ—á–µ–º—É —Å—Ç—Ä–∏–º–∏–Ω–≥ –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç

**–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è:**
1. ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–æ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –ø—Ä–∏ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ (—Å—Ç—Ä–æ–∫–∞ 249)
2. ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–æ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è –ø–µ—Ä–µ–¥ –∑–∞–ø—É—Å–∫–æ–º —Å—Ç—Ä–∏–º–∏–Ω–≥–∞ (—Å—Ç—Ä–æ–∫–∞ 523)
3. ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–æ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ —É—Å–ø–µ—à–Ω–æ–≥–æ –∑–∞–ø—É—Å–∫–∞ —Å—Ç—Ä–∏–º–∏–Ω–≥–∞ (—Å—Ç—Ä–æ–∫–∞ 549)
4. ‚úÖ –£–ª—É—á—à–µ–Ω–æ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ `SFSpeechRecognizerWrapper` (—Å—Ç—Ä–æ–∫–∞ 259)

**–§–∞–π–ª—ã:**
- `integration/integrations/voice_recognition_integration.py` (—Å—Ç—Ä–æ–∫–∏ 249, 259, 523, 549, 555)

---

## –û—Å—Ç–∞–≤—à–∏–µ—Å—è –ø—Ä–æ–±–ª–µ–º—ã

### ‚ö†Ô∏è –Ø–∑—ã–∫ —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏—è –∂–µ—Å—Ç–∫–æ –∑–∞–∫–æ–¥–∏—Ä–æ–≤–∞–Ω –Ω–∞ `en-US`

**–ü—Ä–æ–±–ª–µ–º–∞:**
- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≥–æ–≤–æ—Ä–∏—Ç –ø–æ-–∞–Ω–≥–ª–∏–π—Å–∫–∏, –Ω–æ –µ—Å–ª–∏ –∑–∞—Ö–æ—á–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ä—É—Å—Å–∫–∏–π, –Ω—É–∂–Ω–æ –∏–∑–º–µ–Ω–∏—Ç—å –∫–æ–Ω—Ñ–∏–≥
- –ù–µ—Ç –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–≥–æ –≤—ã–±–æ—Ä–∞ —è–∑—ã–∫–∞

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:**
- –î–æ–±–∞–≤–∏—Ç—å UI –¥–ª—è –≤—ã–±–æ—Ä–∞ —è–∑—ã–∫–∞ –∏–ª–∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —è–∑—ã–∫–∞
- –°–µ–π—á–∞—Å —è–∑—ã–∫ –º–æ–∂–Ω–æ –∏–∑–º–µ–Ω–∏—Ç—å –≤ `config/unified_config.yaml` (—Å—Ç—Ä–æ–∫–∞ 528)

**–§–∞–π–ª—ã:**
- `config/unified_config.yaml` (—Å—Ç—Ä–æ–∫–∞ 528: `language: "en-US"`)

---

## –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

–ü–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π –Ω—É–∂–Ω–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å:

1. ‚úÖ **–ü—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏–µ –≤–æ—Å–ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç—Å—è** ‚Äî –Ω–µ—Ç —Ç–∞–π–º–∞—É—Ç–∞, `playback.completed` –ø–æ–ª—É—á–∞–µ—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
2. ‚úÖ **–ú–∏–∫—Ä–æ—Ñ–æ–Ω –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ** ‚Äî `_wait_for_mic_opened()` –≤–∏–¥–∏—Ç –æ—Ç–∫—Ä—ã—Ç–∏–µ, –Ω–µ—Ç —Ç–∞–π–º–∞—É—Ç–∞
3. ‚úÖ **–ê—É–¥–∏–æ –æ–±—Ä–µ–∑–∞–µ—Ç—Å—è –ø—Ä–∞–≤–∏–ª—å–Ω–æ** ‚Äî –¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç –≤—Ä–µ–º–µ–Ω–∏ –Ω–∞–∂–∞—Ç–∏—è
4. ‚úÖ **SFSpeechRecognizer –ª–æ–≥–∏—Ä—É–µ—Ç—Å—è** ‚Äî –≤–∏–¥–Ω—ã —Å—Ç—Ä–æ–∫–∏ `üîç [SFSpeech]` –∏ `üé§ [SFSpeech]` –≤ –ª–æ–≥–∞—Ö
5. ‚úÖ **–°–∫—Ä–∏–Ω—à–æ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç—Å—è** ‚Äî `ProcessingWorkflow` –ø–æ–ª—É—á–∞–µ—Ç `path` –∏–∑ `image_path`

---

## –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

1. –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∏ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏
2. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏–µ –≤–æ—Å–ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç—Å—è
3. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ –º–∏–∫—Ä–æ—Ñ–æ–Ω –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç—Å—è –±–µ–∑ —Ç–∞–π–º–∞—É—Ç–∞
4. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ –∞—É–¥–∏–æ –æ–±—Ä–µ–∑–∞–µ—Ç—Å—è –ø—Ä–∞–≤–∏–ª—å–Ω–æ (–¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç –≤—Ä–µ–º–µ–Ω–∏ –Ω–∞–∂–∞—Ç–∏—è)
5. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏ SFSpeechRecognizer –¥–ª—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏ —Å—Ç—Ä–∏–º–∏–Ω–≥–∞


