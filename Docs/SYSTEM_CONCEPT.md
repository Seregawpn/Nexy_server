# SYSTEM_CONCEPT

Единый обзор системы для общего понимания клиентской и серверной частей. Детальные флоу и контракты описаны в канонах:
- Клиент: `client/Docs/FLOW_INTERACTION_SPEC.md`
- Сервер: `server/server/Docs/FLOW_INTERACTION_SPEC.md`

---

## Роли компонентов

### Клиент (macOS)
- Собирает пользовательский ввод и контекст.
- Управляет локальными режимами и UX.
- Отправляет запросы на сервер и воспроизводит ответы.

### Сервер
- Принимает gRPC запросы.
- Обрабатывает текст/контекст.
- Стримит ответы (аудио/текст) клиенту.

---

## Границы и контракты

- Граница между клиентом и сервером проходит по gRPC протоколу (`modules/grpc_service/streaming.proto`).
- Клиент и сервер имеют свои отдельные каноны flow.
- Изменения протокола фиксируются в `server/server/Docs/GRPC_PROTOCOL_AUDIT.md`.

## Feature Flags System Capability

Система поддерживает глобальное управление функциональностью через Feature Flags:
- **Гранулярный контроль**: возможность полного отключения Browser, Messages, Payment.
- **Сквозная синхронизация**: флаг на сервере меняет промпт, флаг на клиенте меняет UI и загрузку модулей.
- **Защита**: многоуровневая валидация (L1-L5) гарантирует безопасность при отключенных фичах.
