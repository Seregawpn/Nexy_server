# ASSISTANT_COORDINATION_PROTOCOL

Цель: единый механизм обмена документами между ассистентами (Codex, Cursor, Antigravity, Ultra) для постановки задач, анализа и перекрестной проверки.

## 1. Единый каталог

Базовый путь: `Docs/assistant_exchange/`

Правила:
- Каждый ассистент пишет документы в подкаталог со своим именем (нижний регистр).
- Имена ассистентов фиксированы: `codex`, `cursor`, `antigravity`, `ultra`.
- Если появляется новый ассистент, добавляем его имя в этот список и используем тот же формат.

## 1.1 Роли по умолчанию

- Codex: анализ/управление/план.
- Antigravity: анализ/управление/план.
- Cursor: выполнение действий (локальные команды, запуск).
- Ultra: внешняя проверка/ревью (если используется).

## 2. Типы документов

- `task-brief` — постановка задачи, ограничения, критерии готовности.
- `analysis` — анализ, риски, варианты решений.
- `review` — проверка результата другого ассистента (ревью/аудит).
- `handoff` — передача контекста и следующих шагов.

## 3. Именование файлов

Формат:
`YYYY-MM-DD__type__short-title.md`

Правила:
- `short-title` — ASCII, kebab-case.
- `type` — только из списка в разделе 2.
- Дата — локальная, по времени автора документа.

Пример:
`2025-01-20__review__grpc-parser.md`

## 4. Обязательные поля

В каждом документе должны быть:
- Автор (ассистент).
- Запрос/цель.
- Контекст (ссылки на файлы/документы).
- Решения или выводы.
- Открытые вопросы.
- Следующие шаги.

## 5. Правило перекрестной проверки

Если один ассистент просит проверить работу другого:
- Создаем `review` документ в каталоге проверяющего ассистента.
- Ссылаемся на файл, который проверяем (точный путь).
- Фиксируем найденные проблемы и их критичность.
- Если проблем нет, фиксируем это явно.

## 6. Минимальный процесс

1. Автор получает запрос и создает `task-brief`.
2. По необходимости создается `analysis`.
3. При запросе на проверку создается `review`.
4. Для передачи контекста между ассистентами создается `handoff`.

## 7. Шаблон

Используйте шаблон: `Docs/assistant_exchange/TEMPLATE.md`.

## 8. Prompt-файлы ассистентов

Индивидуальные правила и формат ответов:
- `Docs/ANTIGRAVITY_PROMPT.md` — правила для Antigravity.
- `Docs/CODEX_PROMPT.md` — правила для Codex.

## 9. Git/Release Routing (единое правило)

- `Seregawpn/Nexy` — корневой workspace (общий код/документация).
- `Seregawpn/Nexy_server` — только server deploy source (Azure), обновляется через subtree:
  - `git subtree push --prefix=server server_repo <branch>`
- `Seregawpn/Nexy_production` — только клиентские release assets (`Nexy.dmg`, `Nexy.pkg`) и update URLs/manifest.

Запреты:
- Нельзя пушить root-историю напрямую в `Nexy_server`.
- Нельзя публиковать DMG/PKG в `Nexy` или `Nexy_server`.
- Нельзя смешивать code deploy pipeline и artifact release pipeline.
