# –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –æ—à–∏–±–∫–∏ –∞–∫—Ç–∏–≤–∞—Ü–∏–∏ –º–∏–∫—Ä–æ—Ñ–æ–Ω–∞

## –î–∞—Ç–∞
2025-12-12

## –ü—Ä–æ–±–ª–µ–º–∞
–ê–∫—Ç–∏–≤–∞—Ü–∏—è –º–∏–∫—Ä–æ—Ñ–æ–Ω–∞ –Ω–µ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏–ª–∞ –∏–∑-–∑–∞ –æ—à–∏–±–∫–∏:
```
‚ö†Ô∏è –û—à–∏–±–∫–∞ –Ω–∞—á–∞–ª–∞ –ø—Ä–æ—Å–ª—É—à–∏–≤–∞–Ω–∏—è (–ø—Ä–æ–¥–æ–ª–∂–∞–µ–º —Ä–∞–±–æ—Ç—É): name 'preflight_peak' is not defined
üîÑ [AUDIO_STATE] starting ‚Üí idle (–æ—à–∏–±–∫–∞)
```

## –ü—Ä–∏—á–∏–Ω–∞
–í `modules/voice_recognition/core/speech_recognizer.py` –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è `preflight_peak` –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª–∞—Å—å –≤ —Å—Ç—Ä–æ–∫–∞—Ö 438 –∏ 450, –Ω–æ –Ω–µ –±—ã–ª–∞ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∞, —Ç–∞–∫ –∫–∞–∫ `preflight_check` –±—ã–ª –ø—Ä–æ–ø—É—â–µ–Ω –¥–ª—è –±—ã—Å—Ç—Ä–æ–π –∞–∫—Ç–∏–≤–∞—Ü–∏–∏ (—Å—Ç—Ä–æ–∫–∞ 433 –∑–∞–∫–æ–º–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∞).

## –†–µ—à–µ–Ω–∏–µ
1. **–£—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ –∑–Ω–∞—á–µ–Ω–∏–µ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é**: `preflight_peak = 0.0` (—Å—Ç—Ä–æ–∫–∞ 435)
2. **–£–±—Ä–∞–Ω–∞ –ø—Ä–æ–≤–µ—Ä–∫–∞ `preflight_success`**: –¢–∞–∫ –∫–∞–∫ –º—ã –≤—Å–µ–≥–¥–∞ –ø—Ä–æ–ø—É—Å–∫–∞–µ–º preflight –¥–ª—è —Å–∫–æ—Ä–æ—Å—Ç–∏, –ø—Ä–æ–≤–µ—Ä–∫–∞ –Ω–µ –Ω—É–∂–Ω–∞. –ö–æ–¥ –ø—Ä–æ–≤–µ—Ä–∫–∏ –∑–∞–∫–æ–º–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω –¥–ª—è –≤–æ–∑–º–æ–∂–Ω–æ–≥–æ –≤–∫–ª—é—á–µ–Ω–∏—è –≤ –±—É–¥—É—â–µ–º.

## –ò–∑–º–µ–Ω–µ–Ω–∏—è
- `modules/voice_recognition/core/speech_recognizer.py`:
  - –î–æ–±–∞–≤–ª–µ–Ω–æ `preflight_peak = 0.0` –ø–æ—Å–ª–µ —É—Å—Ç–∞–Ω–æ–≤–∫–∏ `preflight_success = True`
  - –ó–∞–∫–æ–º–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∞ –ø—Ä–æ–≤–µ—Ä–∫–∞ `if not preflight_success:` –∏ —Å–≤—è–∑–∞–Ω–Ω—ã–π –∫–æ–¥

## –†–µ–∑—É–ª—å—Ç–∞—Ç
- ‚úÖ –û—à–∏–±–∫–∞ `preflight_peak is not defined` –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∞
- ‚úÖ –ú–∏–∫—Ä–æ—Ñ–æ–Ω —Ç–µ–ø–µ—Ä—å –¥–æ–ª–∂–µ–Ω –æ—Ç–∫—Ä—ã–≤–∞—Ç—å—Å—è –±–µ–∑ –æ—à–∏–±–æ–∫
- ‚úÖ Preflight –ø—Ä–æ–ø—É—â–µ–Ω –¥–ª—è –±—ã—Å—Ç—Ä–æ–π –∞–∫—Ç–∏–≤–∞—Ü–∏–∏ (–∫–∞–∫ –∏ –ø–ª–∞–Ω–∏—Ä–æ–≤–∞–ª–æ—Å—å)

## –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
–ü–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –º–∏–∫—Ä–æ—Ñ–æ–Ω –¥–æ–ª–∂–µ–Ω –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞—Ç—å—Å—è –ø—Ä–∏ LONG_PRESS –±–µ–∑ –æ—à–∏–±–æ–∫.

