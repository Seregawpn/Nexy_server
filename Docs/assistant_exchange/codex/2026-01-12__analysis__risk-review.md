# Анализ рисков и архитектурных отклонений

## Метаданные
- Ассистент: codex
- Тип: analysis
- Дата: 2026-01-12
- ID (INS-###): INS-005

## Diagnosis
Есть риск рассинхронизации конфигурации и отсутствие UX-пути для критического сбоя аудио, что противоречит принципу централизованного источника истины и стабильности клиентского рантайма.

## Root Cause
Несогласованность источников конфигурации и отсутствие обязательного UI-эскейпа → ручные/неявные ожидания в рантайме → скрытые деградации и неочевидные ошибки для пользователя.

## Optimal Fix
Цель: централизовать конфигурацию и закрыть критический UX-провал восстановления аудио без добавления новых сущностей.

## Verification
DoD: единый источник истины по конфигам, реализован UX-диалог для ручного восстановления аудио, нет ручных синхронизаций параметров.
Шаги проверки: сверка источников конфигурации, ручной сценарий тишины CoreAudio с отображением UI, сравнение sample_rate клиент/сервер.
Ожидаемое поведение: понятный UI-диалог при пороге D, отсутствие несогласованных конфигов.

## Запрос/цель
Оценить риски и предложить оптимальные архитектурно совместимые шаги.

## Контекст
- Файлы: client/config/unified_config.yaml, server/server/config/unified_config.yaml, client/modules/voice_recognition/core/audio_recovery_manager.py
- Документы: Docs/ARCHITECTURE_OVERVIEW.md, Docs/PROJECT_REQUIREMENTS.md
- Ограничения: без реархитектуры

## Решения/выводы
- Главный приоритет: устранить критический UX-пробел и центрировать конфигурацию.
- Рефакторинг по импорту сервера и hardware_id — вторичный, после конфигурации/аудио.

## Открытые вопросы
- Нужен ли единый механизм доставки конфигурации клиенту при установке (build-time vs runtime)?

## Следующие шаги
- Уточнить текущий механизм поставки конфигурации клиенту.
- Согласовать UI-диалог для AudioRecoveryManager.
