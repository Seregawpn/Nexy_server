# üîê –ë—ã—Å—Ç—Ä–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–π Nexy

## üìã –ò—Ç–æ–≥ –ø–æ —Ç–µ–∫—É—â–µ–π —Å–∏—Ç—É–∞—Ü–∏–∏

### üîê –ö—Ç–æ —É–ø—Ä–∞–≤–ª—è–µ—Ç —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è–º–∏?

| –°—Ç–æ—Ä–æ–Ω–∞ | –†–æ–ª—å |
|---------|------|
| üçé macOS | –•—Ä–∞–Ω–∏—Ç —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è –≤ TCC.db (user –∏–ª–∏ system) |
| üë§ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å | –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–∞–µ—Ç —Å–∏—Å—Ç–µ–º–Ω—ã–µ –¥–∏–∞–ª–æ–≥–∏ –∏ –ø–µ—Ä–µ–∫–ª—é—á–∞—Ç–µ–ª–∏ |
| üì± Nexy | –ó–∞–ø—Ä–∞—à–∏–≤–∞–µ—Ç —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è —á–µ—Ä–µ–∑ –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω—ã–µ Apple API |

### üéØ –ö–∞–∫ Nexy –∑–∞–ø—Ä–∞—à–∏–≤–∞–µ—Ç —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è

| –†–∞–∑—Ä–µ—à–µ–Ω–∏–µ | API | –ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç |
|-----------|-----|--------------|
| üé§ Microphone | `AVCaptureDevice.requestAccessForMediaType` | –°–∏—Å—Ç–µ–º–Ω—ã–π –¥–∏–∞–ª–æ–≥ –ø—Ä–∏ –ø–µ—Ä–≤–æ–º –∑–∞–ø—É—Å–∫–µ |
| ‚ôø Accessibility | `AXIsProcessTrustedWithOptions` | –°–∏—Å—Ç–µ–º–Ω—ã–π –¥–∏–∞–ª–æ–≥ –ø—Ä–∏ –ø–µ—Ä–≤–æ–º –∑–∞–ø—É—Å–∫–µ |
| ‚å®Ô∏è Input Monitoring | **`IOKit.HID.IOHIDRequestAccess`** | **–°–∏—Å—Ç–µ–º–Ω—ã–π –¥–∏–∞–ª–æ–≥ (IOHID API)** |
| üì∏ Screen Capture | `CGRequestScreenCaptureAccess` | –î–∏–∞–ª–æ–≥ –ø—Ä–∏ –ø–µ—Ä–≤–æ–º —Å–∫—Ä–∏–Ω—à–æ—Ç–µ |

**üí° Input Monitoring –∏—Å–ø–æ–ª—å–∑—É–µ—Ç IOHID API:**
- ‚úÖ –ï–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω—ã–π –Ω–∞–¥—ë–∂–Ω—ã–π —Å–ø–æ—Å–æ–± —É–∑–Ω–∞—Ç—å —Å—Ç–∞—Ç—É—Å TCC
- ‚úÖ –ü—Ä—è–º–æ–π –∑–∞–ø—Ä–æ—Å —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è —á–µ—Ä–µ–∑ —Å–∏—Å—Ç–µ–º–Ω—ã–π –¥–∏–∞–ª–æ–≥
- ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç –¥–∞–∂–µ –∫–æ–≥–¥–∞ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–µ –≤ system TCC.db
- ‚úÖ –ù–µ —Ç—Ä–µ–±—É–µ—Ç root –¥–æ—Å—Ç—É–ø–∞

### ‚ö†Ô∏è –°–∏–º–ø—Ç–æ–º

```
–ì–∞–ª–æ—á–∫–∏ –≤ System Settings —Å—Ç–æ—è—Ç   ‚úì
       ‚Üì
TCC.db –ø—É—Å—Ç–∞                      ‚ùå
       ‚Üì
CoreAudio error 35                üí•
```

**–ü—Ä–∏—á–∏–Ω–∞:** –∫—ç—à TCC –∏–ª–∏ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è –≤—ã–¥–∞–Ω—ã –¥–ª—è –¥—Ä—É–≥–æ–≥–æ Bundle ID/–ø—É—Ç–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è.

### ‚úÖ –û–∂–∏–¥–∞–µ–º–æ–µ –ø–æ–≤–µ–¥–µ–Ω–∏–µ (UX)

**üéØ –ü–ï–†–í–´–ô –ó–ê–ü–£–°–ö (—Ä–∞–∑—Ä–µ—à–µ–Ω–∏–π –Ω–µ—Ç):**

1. –ó–∞–ø—É—Å–∫–∞–µ—Ç–µ Nexy ‚Üí –ø–æ—è–≤–ª—è–µ—Ç—Å—è –¥–∏–∞–ª–æ–≥ **Microphone** ‚Üí –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–∞–µ—Ç–µ ‚úì
2. –ü–æ—è–≤–ª—è–µ—Ç—Å—è –¥–∏–∞–ª–æ–≥ **Accessibility** ‚Üí –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–∞–µ—Ç–µ ‚úì
3. –ü–æ—è–≤–ª—è–µ—Ç—Å—è –¥–∏–∞–ª–æ–≥ **Input Monitoring** (—á–µ—Ä–µ–∑ IOHID API) ‚Üí –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–∞–µ—Ç–µ ‚úì
4. –ï—Å–ª–∏ –∫–∞–∫–æ–π-—Ç–æ –¥–∏–∞–ª–æ–≥ –æ—Ç–∫–ª–æ–Ω—ë–Ω ‚Üí –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ—Ç–∫—Ä–æ–µ—Ç—Å—è System Settings
5. **–û–¥–∏–Ω —Ä–∞–∑** –∑–∞ –∑–∞–ø—É—Å–∫ ‚Äî –±–æ–ª—å—à–µ –Ω–∏–∫–∞–∫–∏—Ö –¥–∏–∞–ª–æ–≥–æ–≤!

**üîÑ –ü–û–í–¢–û–†–ù–´–ï –ó–ê–ü–£–°–ö–ò (—Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è –µ—Å—Ç—å):**

1. –ó–∞–ø—É—Å–∫–∞–µ—Ç–µ Nexy ‚Üí **–Ω–∏–∫–∞–∫–∏–µ –¥–∏–∞–ª–æ–≥–∏ –ù–ï –ø–æ—è–≤–ª—è—é—Ç—Å—è** ‚úì
2. System Settings **–ù–ï –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç—Å—è** ‚úì
3. –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —Å—Ä–∞–∑—É –≥–æ—Ç–æ–≤–æ –∫ —Ä–∞–±–æ—Ç–µ ‚úì

### ‚úÖ –ë—ã—Å—Ç—Ä–æ–µ —Ä–µ—à–µ–Ω–∏–µ –ø—Ä–∏ –ø—Ä–æ–±–ª–µ–º–∞—Ö

1. –ó–∞–ø—É—Å—Ç–∏—Ç–µ `./fix_tcc_cache.sh`
2. –°–ª–µ–¥—É–π—Ç–µ –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–º –ø–æ–¥—Å–∫–∞–∑–∫–∞–º (–ø—Ä–æ–≤–µ—Ä–∫–∞ —Å–ø–∏—Å–∫–∞, —Å–±—Ä–æ—Å TCC, –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫)
3. –ü–æ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–∏ –ø–µ—Ä–µ–ø—Ä–æ–≤–µ—Ä—å—Ç–µ `./check_permissions.sh`

–ï—Å–ª–∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π —Å—Ü–µ–Ω–∞—Ä–∏–π –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω, –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –≤—Ä—É—á–Ω—É—é –æ–ø–∏—Å–∞–Ω–Ω—ã–µ —à–∞–≥–∏ –Ω–∏–∂–µ.

## –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞

### –ë—ã—Å—Ç—Ä–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–π
```bash
./check_permissions.sh
```

–ü–æ–∫–∞–∂–µ—Ç —Å—Ç–∞—Ç—É—Å –≤—Å–µ—Ö 4 –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–π:
- üé§ **Microphone** ‚Äî –¥–æ—Å—Ç—É–ø –∫ –º–∏–∫—Ä–æ—Ñ–æ–Ω—É
- ‚å®Ô∏è **Input Monitoring** ‚Äî –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∫–ª–∞–≤–∏–∞—Ç—É—Ä—ã (–¥–ª—è –ø—Ä–æ–±–µ–ª–∞)
- ‚ôø **Accessibility** ‚Äî –∫–æ–Ω—Ç—Ä–æ–ª—å —Å–∏—Å—Ç–µ–º—ã
- üì∏ **Screen Recording** ‚Äî —Å–Ω–∏–º–∫–∏ —ç–∫—Ä–∞–Ω–∞ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

### –ü–æ–ª–Ω–∞—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞
```bash
./diagnose_permissions.sh
```

–ü–æ–∫–∞–∂–µ—Ç:
- –°—Ç–∞—Ç—É—Å —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
- –¢–µ–∫—É—â–∏–µ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è TCC
- –ê—É–¥–∏–æ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞
- –õ–æ–≥–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
- –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—é

## –†–µ—à–µ–Ω–∏–µ

### ‚úÖ –ü—Ä–æ—Å—Ç–æ–π —Å–ø–æ—Å–æ–±

1. **–ó–∞–ø—É—Å—Ç–∏—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ:**
   ```bash
   open /Applications/Nexy.app
   ```

2. **–ù–∞–∂–º–∏—Ç–µ –∏ –¥–µ—Ä–∂–∏—Ç–µ –ü–†–û–ë–ï–õ** 2-3 —Å–µ–∫—É–Ω–¥—ã

3. **–ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç–µ –≤—Å–µ –¥–∏–∞–ª–æ–≥–∏:**
   - Accessibility ‚Üí –û—Ç–∫—Ä—ã—Ç—å –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ ‚Üí –í–∫–ª—é—á–∏—Ç—å ‚Üí –ì–æ—Ç–æ–≤–æ
   - Microphone ‚Üí OK
   - Input Monitoring ‚Üí OK

4. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç:**
   ```bash
   ./check_permissions.sh
   ```

### üîß –ï—Å–ª–∏ –¥–∏–∞–ª–æ–≥–∏ –Ω–µ –ø–æ—è–≤–∏–ª–∏—Å—å

–í–∫–ª—é—á–∏—Ç–µ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è –≤—Ä—É—á–Ω—É—é:

1. –û—Ç–∫—Ä–æ–π—Ç–µ **System Settings** (‚öôÔ∏è)
2. **Privacy & Security**
3. –í–∫–ª—é—á–∏—Ç–µ Nexy –≤:
   - ‚ôø Accessibility
   - üé§ Microphone  
   - ‚å®Ô∏è Input Monitoring
   - üì∏ Screen Recording
4. –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ:
   ```bash
   pkill Nexy && open /Applications/Nexy.app
   ```

### üîÑ –ï—Å–ª–∏ –Ω—É–∂–Ω–æ —Å–±—Ä–æ—Å–∏—Ç—å

```bash
sudo tccutil reset Microphone com.nexy.assistant
sudo tccutil reset ListenEvent com.nexy.assistant
sudo tccutil reset Accessibility com.nexy.assistant
sudo tccutil reset ScreenCapture com.nexy.assistant
```

–ó–∞—Ç–µ–º —Å–Ω–æ–≤–∞ –∑–∞–ø—É—Å—Ç–∏—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∏ –ø–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç–µ –¥–∏–∞–ª–æ–≥–∏.

## –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ—Å–ª–µ –≤—ã–¥–∞—á–∏ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–π

### –¢–µ—Ä–º–∏–Ω–∞–ª 1: –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥
```bash
./watch_logs.sh
```

### –¢–µ—Ä–º–∏–Ω–∞–ª 2: –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
```bash
# –ó–∞–ø—É—Å—Ç–∏—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ (–µ—Å–ª–∏ –Ω–µ –∑–∞–ø—É—â–µ–Ω–æ)
open /Applications/Nexy.app

# –ù–∞–∂–º–∏—Ç–µ –∏ –¥–µ—Ä–∂–∏—Ç–µ –ü–†–û–ë–ï–õ, –≥–æ–≤–æ—Ä–∏—Ç–µ 2-3 —Å–µ–∫—É–Ω–¥—ã
```

### ‚úÖ –ß—Ç–æ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å –≤ –ª–æ–≥–∞—Ö

- `Audio stream started`
- `chunks=X` (–≥–¥–µ X > 0)
- `–†–∞—Å–ø–æ–∑–Ω–∞–Ω–æ: [–≤–∞—à —Ç–µ–∫—Å—Ç]`
- `gRPC sending request`

### ‚ùå –ß–µ–≥–æ –ù–ï –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å

- `HALC_ProxyIOContext::_StartIO(): Start failed`
- `error 35`
- `–ù–µ—Ç –∞—É–¥–∏–æ –¥–∞–Ω–Ω—ã—Ö`
- `–∑–∞–ø–∏—Å—å —Å–ª–∏—à–∫–æ–º –∫–æ—Ä–æ—Ç–∫–∞—è`

## –ü–æ–ª–µ–∑–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã

| –ö–æ–º–∞–Ω–¥–∞ | –û–ø–∏—Å–∞–Ω–∏–µ |
|---------|----------|
| `./check_permissions.sh` | –ë—ã—Å—Ç—Ä–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–π |
| `./check_bundle_mismatch.sh` | –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–µ—Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏—è Bundle ID |
| `./fix_tcc_cache.sh` | –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º —Å TCC –∫—ç—à–µ–º (–∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–æ) |
| `./diagnose_permissions.sh` | –ü–æ–ª–Ω–∞—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ |
| `./watch_logs.sh` | –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –ª–æ–≥–æ–≤ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏ |
| `./test_installed_app.sh` | –ü–æ–ª–Ω—ã–π —Ç–µ—Å—Ç —Å –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–æ–π |
| `pkill Nexy` | –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ |
| `open /Applications/Nexy.app` | –ó–∞–ø—É—Å—Ç–∏—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ |
| `sudo killall -9 tccd` | –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å TCC daemon (—Å–±—Ä–æ—Å –∫—ç—à–∞) |

## –°—Ç–∞—Ç—É—Å —Å–±–æ—Ä–∫–∏

‚úÖ **PKG** (95M) ‚Äî –ø–æ–ª–Ω–æ—Å—Ç—å—é –ø–æ–¥–ø–∏—Å–∞–Ω –∏ –Ω–æ—Ç–∞—Ä–∏–∑–æ–≤–∞–Ω
- Developer Certificate: ‚úÖ
- Apple Notary Service: ‚úÖ
- Timestamp: 2025-10-11 14:57:46 UTC

## –ò–∑–º–µ–Ω–µ–Ω–∏—è –≤ –ø–æ—Å–ª–µ–¥–Ω–µ–π –≤–µ—Ä—Å–∏–∏

1. ‚úÖ **Accessibility Prompt** ‚Äî –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –ø—Ä–∏ –ø–µ—Ä–≤–æ–º –∑–∞–ø—É—Å–∫–µ
2. ‚úÖ **PKG Payload** ‚Äî –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è –æ—à–∏–±–∫–∞ (tar ‚Üí cpio)
3. ‚úÖ **PyObjC** ‚Äî –≤—Å–µ –º–æ–¥—É–ª–∏ —É–ø–∞–∫–æ–≤–∞–Ω—ã –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
4. ‚úÖ **AppleDouble** ‚Äî –æ—á–∏—Å—Ç–∫–∞ –ø–µ—Ä–µ–¥ –ø–æ–¥–ø–∏—Å—å—é

---

**üöÄ –ù–∞—á–Ω–∏—Ç–µ —Å —ç—Ç–æ–≥–æ:**
```bash
open /Applications/Nexy.app
# –ó–∞—Ç–µ–º –Ω–∞–∂–º–∏—Ç–µ –ü–†–û–ë–ï–õ –∏ –ø–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç–µ –¥–∏–∞–ª–æ–≥–∏!
```
